<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>mysql 面试必备 | Bishop</title><meta name="keywords" content="面试,必看必会,mysql"><meta name="author" content="Bishop"><meta name="copyright" content="Bishop"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. 事务ACID 特性 **原子性(Atomicity)**：事务是一个不可分割的单位，因此在一个事务里的所有操作要么全部生效，要么全部不生效。  **一致性(Consistency)**：也可以理解为是预期状态的正确性，即从一个正确的状态到另一个正确的状态，这里的状态往往是由业务来定义的。比如转账中的一个扣钱一个加钱，是我们规定的一个数据流转，那么执行前的账户余额和转账后的账户余额就得满足加减">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql 面试必备">
<meta property="og:url" content="https://bishoptylaor.github.io/interview/db/mysql101/index.html">
<meta property="og:site_name" content="Bishop">
<meta property="og:description" content="1. 事务ACID 特性 **原子性(Atomicity)**：事务是一个不可分割的单位，因此在一个事务里的所有操作要么全部生效，要么全部不生效。  **一致性(Consistency)**：也可以理解为是预期状态的正确性，即从一个正确的状态到另一个正确的状态，这里的状态往往是由业务来定义的。比如转账中的一个扣钱一个加钱，是我们规定的一个数据流转，那么执行前的账户余额和转账后的账户余额就得满足加减">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bishoptylaor.github.io/img/index.jpg">
<meta property="article:published_time" content="2022-02-25T08:54:39.000Z">
<meta property="article:modified_time" content="2024-04-25T12:03:59.208Z">
<meta property="article:author" content="Bishop">
<meta property="article:tag" content="面试">
<meta property="article:tag" content="必看必会">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bishoptylaor.github.io/img/index.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://bishoptylaor.github.io/interview/db/mysql101/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'mysql 面试必备',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-25 20:03:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="Bishop" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-flask"></i><span> 研究所</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-graduation-cap"></i><span> 学习</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/golang/"><i class="fa-fw fa-brands fa-golang"></i><span> Go</span></a></li><li><a class="site-page child" href="/categories/python/"><i class="fa-fw fa-brands fa-python"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/interview/"><i class="fa-fw fa-solid fa-glasses"></i><span> 面试</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-indent"></i><span> 索引</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw fas fa-book"></i><span> 日志</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-ghost"></i><span> 俺</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-bug"></i><span> 俺</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.bilibili.com"><i class="fa-fw fa-brands fa-bilibili"></i><span> Bilibili</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/relax/"><i class="fa-fw fas fa-gamepad"></i><span> 休息一下</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/index.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Bishop</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-flask"></i><span> 研究所</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-graduation-cap"></i><span> 学习</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/golang/"><i class="fa-fw fa-brands fa-golang"></i><span> Go</span></a></li><li><a class="site-page child" href="/categories/python/"><i class="fa-fw fa-brands fa-python"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/interview/"><i class="fa-fw fa-solid fa-glasses"></i><span> 面试</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-indent"></i><span> 索引</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw fas fa-book"></i><span> 日志</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-ghost"></i><span> 俺</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-bug"></i><span> 俺</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.bilibili.com"><i class="fa-fw fa-brands fa-bilibili"></i><span> Bilibili</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/relax/"><i class="fa-fw fas fa-gamepad"></i><span> 休息一下</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">mysql 面试必备</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-25T08:54:39.000Z" title="发表于 2022-02-25 16:54:39">2022-02-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-25T12:03:59.208Z" title="更新于 2024-04-25 20:03:59">2024-04-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/interview/">面试</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/interview/db/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="mysql 面试必备"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h1><h2 id="ACID-特性"><a href="#ACID-特性" class="headerlink" title="ACID 特性"></a>ACID 特性</h2><ul>
<li><p>**原子性(Atomicity)**：事务是一个不可分割的单位，因此在一个事务里的所有操作要么全部生效，要么全部不生效。</p>
</li>
<li><p>**一致性(Consistency)**：也可以理解为是预期状态的正确性，即从一个正确的状态到另一个正确的状态，这里的状态往往是由业务来定义的。比如转账中的一个扣钱一个加钱，是我们规定的一个数据流转，那么执行前的账户余额和转账后的账户余额就得满足加减特性，这就是所谓的业务正确。题外话：银行家舍入 —— 四舍六入五考虑，五后非零则进一，五后皆零看奇偶，奇进偶舍不连续。</p>
</li>
<li><p>**隔离性(Isolation)**：事务并发执行时，各个事务之间相互影响的程度。</p>
</li>
<li><p>**持久化(Durability)**：通过日志等手段，只要我们的事务提交成功了，那么就意味着这次的数据操作是成功的。即使下次重启了程序，也不会丢失此处的操作结果。</p>
</li>
</ul>
<h2 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h2><ul>
<li><p><strong>未提交读：</strong> 即所谓的脏读，事务读取的数据可能是另一个事务已修改但还没提交的，这部分数据有可能产生回滚。导致后续的操作依赖了无效的数据。</p>
</li>
<li><p><strong>已提交读：</strong> 如果想防止脏读，就需要等待其他事务提交后再进行读取操作。</p>
</li>
<li><p><strong>可重复读：</strong> 已提交读的隔离级别考虑到了数据回滚的无效性，却无法阻止事务的多次提交。比如事务 A 不断的对表进行修改提交，那么事务 B 就会在不同的时间点读取到不同的数据。为了让事务 B 在执行期间读取的数据都是一致的，就有了可重复读的隔离级别，即事务 B 在执行期间，其他事务不得进行修改操作。</p>
</li>
<li><p><strong>可串行化：</strong> 上面的可重复读隔离级别保证了事务执行期间读取的一致性。然而这里并不包括插入、删除操作。即会出现读多读少数据的情况，这种现象叫做幻读。为了解决幻读，只得进行串行化执行事务，才能互不影响。而此时的事务并发性是最低的</p>
</li>
</ul>
<h1 id="2-索引"><a href="#2-索引" class="headerlink" title="2. 索引"></a>2. 索引</h1><h2 id="Mysql-的索引分类"><a href="#Mysql-的索引分类" class="headerlink" title="Mysql 的索引分类"></a>Mysql 的索引分类</h2><ul>
<li><p><strong>从数据结构划分：</strong> B+ 树、hash 索引、全文索引</p>
</li>
<li><p><strong>从物理结构划分：</strong> 聚集索引、非聚集索引</p>
</li>
<li><p><strong>从逻辑用户划分：</strong> 主键、唯一索引、复合索引、普通单列索引</p>
</li>
</ul>
<h2 id="聚集索引、非聚集索引、主建的区别"><a href="#聚集索引、非聚集索引、主建的区别" class="headerlink" title="聚集索引、非聚集索引、主建的区别"></a>聚集索引、非聚集索引、主建的区别</h2><ul>
<li><p>聚集索引：在索引的叶子节点直接存 data 数据, 使用的是物理排序，一个表只能有一个字段设置了聚集索引（因为物理排序规则只能有一个），允许有 null 的数据存在，数据也不一定是唯一的。实现方案是B+树</p>
</li>
<li><p>主建：唯一标识某行记录，不允许有 null 的数据，要求数据必须唯一。在设置某个字段为主建时，数据库一般会自动在这个主建上建立一个唯一索引，并且如果之前表没有创建过聚集索引，还会在这个主建上建立一个聚集索引。自增Id强制设定为主键索引，这是为了b+tree和分页。这棵树的非叶子结点上存的都是主键，那如果一个表没有主键会怎么样？在innodb中，如果一个表没有主键，那默认会找建了唯一索引的列，如果也没有，则会生成一个隐形的字段作为主键！</p>
</li>
<li><p>非聚集索引：索引的叶子节点存的是数据域的记录指针，需要跳转查找。排序规则是逻辑排序，因此可以有多个非聚集索引存在。非聚集索引的存储结构与聚集索引是一样的，不同的是在叶子结点的数据部分存的不再是具体的数据，而数据的聚集索引的key。所以通过非聚集索引查找的过程是先找到该索引key对应的聚集索引的key，然后再拿聚集索引的key到主键索引树上查找对应的数据，这个过程称为<strong>回表</strong>！</p>
</li>
</ul>
<h2 id="有哪些情况会让索引失效？"><a href="#有哪些情况会让索引失效？" class="headerlink" title="有哪些情况会让索引失效？"></a>有哪些情况会让索引失效？</h2><ul>
<li><p>在 where 字段 上使用了函数或其他隐式转换</p>
</li>
<li><p>Like 模糊查询，开头使用了 “%”，例如 like ‘%hello%’</p>
</li>
<li><p>where 条件里使用了 or</p>
</li>
<li><p>建立了复合索引，但 where 条件里使用的是第二个字段的搜索</p>
</li>
</ul>
<h2 id="最左匹配原则是指？"><a href="#最左匹配原则是指？" class="headerlink" title="最左匹配原则是指？"></a>最左匹配原则是指？</h2><p>mysql 建立联合索引后，是按最左匹配原则来筛选记录的，即检索数据是从联合索引的第一个字段来筛选的。如果 where 里的条件只有第二个字段，那么将无法应用到索引。</p>
<h2 id="索引的底层数据结构-B-树是怎么样的？"><a href="#索引的底层数据结构-B-树是怎么样的？" class="headerlink" title="索引的底层数据结构 B+ 树是怎么样的？"></a>索引的底层数据结构 B+ 树是怎么样的？</h2><p>B+ 树是二叉搜索树的一个扩充，是多路搜索树。它只在叶子节点存储具体的数据或者数据的指向指针，而非叶子节点存放索引数据。这样可以降低磁盘 IO，还能充分利用磁盘的预读功能，批量的加载索引数据。</p>
<p><img src="/img/loading.gif" data-original="https://static001.geekbang.org/infoq/46/467603fbd92fdada63040ebad9b7f628.png"></p>
<h2 id="b-树-b-树-b-树的区别"><a href="#b-树-b-树-b-树的区别" class="headerlink" title="b 树 b+树 b-树的区别"></a>b 树 b+树 b-树的区别</h2><ul>
<li><p>b 树就是 b-树， 国外叫 b-tree, 也就是 b 树。</p>
</li>
<li><p>b-tree 是在非叶子节点存放了数据，在查询索引时，只要找到索引值也就可以找到数据了，这样可以提前终止搜索。但每个节点就得存储索引值+数据值，占用的页空间会比较大，需要的磁盘 io 次数也会变多，即使是不需要关心的数据也会被预加载出来，浪费性能。</p>
</li>
<li><p>b+树是将索引值存在非叶子节点，数据值存在叶子节点，这样可以压缩树的高度，减少磁盘 io。</p>
</li>
</ul>
<h2 id="为什么不能在重复率高，例如性别字段上建立索引？"><a href="#为什么不能在重复率高，例如性别字段上建立索引？" class="headerlink" title="为什么不能在重复率高，例如性别字段上建立索引？"></a>为什么不能在重复率高，例如<code>性别</code>字段上建立索引？</h2><p>对于性别这种索引， 由于重复率高，对于 B+树(多路搜索树)来讲，得遍历多条路径，搜索代价大。还不如全表扫描，这样不需要维护索引，降低开销。</p>
<h2 id="Mysql-的-hash-索引是怎么样，有什么优缺点？"><a href="#Mysql-的-hash-索引是怎么样，有什么优缺点？" class="headerlink" title="Mysql 的 hash 索引是怎么样，有什么优缺点？"></a>Mysql 的 hash 索引是怎么样，有什么优缺点？</h2><p>hash 索引将列通过 hash 运算得到 hash code，然后将 hash code 跟数据行的指针地址关联在一起，下次查找时只需查找对应 hash code 的数据行地址即可。</p>
<p>hash 索引非常的紧凑，查找速度很快，适用于内存存储引擎的应用。不过它只能精确查询，不支持范围查找，也不能直接进行排序。限制还是挺多的。</p>
<p><img src="/img/loading.gif" data-original="https://static001.geekbang.org/infoq/12/12bc94c294080d240a165e97e0a5f75e.png"></p>
<h2 id="Mysql-的全文索引"><a href="#Mysql-的全文索引" class="headerlink" title="Mysql 的全文索引"></a>Mysql 的全文索引</h2><p>全文索引主要是用于文档查找，像我们可能会从多篇文章中查找包含某些词语的文章，这时就可以使用全文索引了。虽然 like 也可以使用，但是效率太低了。全文索引在接收到文档时，会对它进行分词处理，以获取到关键词。然后会将关键词和属于这个文档的 id 关联起来。下次查找，就会先到关键词列表里找到关联的文档 id ，最后利用文档 id 去查找到文档数据。</p>
<h1 id="3-日志"><a href="#3-日志" class="headerlink" title="3. 日志"></a>3. 日志</h1><h2 id="日志类别"><a href="#日志类别" class="headerlink" title="日志类别"></a>日志类别</h2><ul>
<li><p><strong>binlog：</strong> 二进制日志，记录了数据库对数据的修改记录，包括了 DDL：例如表的创建，数据更新等。但并不包括 select 这些查询语句。binlog 日志是属于逻辑语句的记录，可用于主从数据库的同步。</p>
</li>
<li><p><strong>relay log：</strong> 中继日志，用于主从备份恢复使用的。有主服务器的 binlog 逻辑操作语句，以及当前的恢复位置。</p>
</li>
<li><p><strong>慢查询日志：</strong> 记录在 mysql 里执行时间超过预期值的耗时语句</p>
</li>
<li><p><strong>redo log：</strong> redo log 是对加载到内存数据页的修改结果的记录，和 binlog 不同的是，binlog 记录的是逻辑操作语句，偏向于过程记录。而 redo log 是一个数据页的修改日志，偏向于结果的记录。</p>
</li>
<li><p><strong>undo log：</strong> 回滚日志主要用于回滚数据，和 redo log 不一样的是，undo log 是逻辑日志，是一种相反操作的记录，比如在回滚时，如果是 insert 操作时，则会逆向为 delete，delete 操作时，逆向为 insert 操作，更新则恢复到当时的版本数据。</p>
</li>
</ul>
<h2 id="redo-log-相关概念：writepos、checkpoint、prepare、commit"><a href="#redo-log-相关概念：writepos、checkpoint、prepare、commit" class="headerlink" title="redo log 相关概念：writepos、checkpoint、prepare、commit"></a>redo log 相关概念：writepos、checkpoint、prepare、commit</h2><p>redo log 是用来记录当前数据页的修改情况，由于性能问题，每次修改并不会实时同步到硬盘。而是先在内存中修改，然后将修改情况记录到 redo 里，再定时的去将 redo 刷新到硬盘里。因此，redo log 有 2 个位置，一个是 writepos，自己写日志的位置；另一个是 checkpoint，是定时的将数据页同步到硬盘的位置。</p>
<p>redo log 在写 binlog 日志前会先记录 redo log，记录完后标记为 prepare 状态。当 binlog 也写入完成后，才将 redo log 标记为 commit 状态。只有当 redo log 是 commit 状态时，事务才能真正的 commit。这样能防止主从节点根据 binlog 同步有可能事务不一致的情况。</p>
<h1 id="4-Mysql-里的锁"><a href="#4-Mysql-里的锁" class="headerlink" title="4. Mysql 里的锁"></a>4. Mysql 里的锁</h1><h2 id="Mysql-里的锁有哪些？"><a href="#Mysql-里的锁有哪些？" class="headerlink" title="Mysql 里的锁有哪些？"></a>Mysql 里的锁有哪些？</h2><h3 id="乐观-x2F-悲观锁"><a href="#乐观-x2F-悲观锁" class="headerlink" title="乐观&#x2F;悲观锁"></a>乐观&#x2F;悲观锁</h3><ul>
<li><p>乐观锁：在读取数据时会假设各个事务互不影响，它们会处理好属于自己的那部分数据。如果在更新数据时，发现有其他事务修改了属于自己的数据，则会回滚之前的一切操作。</p>
</li>
<li><p>悲观锁：采取了先获取锁再访问的保守策略，如果已经有其他事务获取了锁，则必须等待锁释放才能继续。</p>
</li>
</ul>
<h3 id="共享-x2F-排它锁"><a href="#共享-x2F-排它锁" class="headerlink" title="共享&#x2F;排它锁"></a>共享&#x2F;排它锁</h3><ul>
<li><p>共享锁：又称读锁，当前事务在读取时，允许其他事务并发读取，但不允许其他事务上排它锁，必须等自己释放了才能继续。</p>
</li>
<li><p>排它锁：又称写锁，在写锁占有时，如果其他事务想上读写锁，则得排队等待。</p>
</li>
</ul>
<h3 id="表锁-x2F-行锁"><a href="#表锁-x2F-行锁" class="headerlink" title="表锁&#x2F;行锁"></a>表锁&#x2F;行锁</h3><ul>
<li><p>表锁：在操作数据时，直接将整张表锁住，操作粒度很大，很容易让其他事务在等待，但不会产生死锁。</p>
</li>
<li><p>行锁：针对的是行记录的并发控制，锁粒度很细，能支持高并发，但是不排除会有死锁情况产生。在 mysql 里行锁依赖索引实现，如果没有索引存在，则会直接进行表锁！</p>
</li>
</ul>
<h4 id="行锁"><a href="#行锁" class="headerlink" title="行锁"></a>行锁</h4><ul>
<li><p>记录锁：只锁住某一条记录。当对唯一索引(包括主键)进行精确查询时，会使用记录锁。</p>
</li>
<li><p>间隙锁：当使用范围查询时，会对符合条件的区间数据上锁。在涉及到普通索引（即不是唯一索引）的查询时，都会使用间隙锁。</p>
</li>
<li><p>Next-key 锁：临建锁，可以理解为 记录锁 + 间隙锁。当对唯一索引进行范围查找或对唯一索引进行查找但结果不存在时（可以理解为锁住不存在的记录），会使用临建锁。</p>
</li>
</ul>
<p>上面的间隙锁、临建锁有效的防止了事务幻读情况产生，避免了在查找期间有数据新增或删除。</p>
<h3 id="意向锁"><a href="#意向锁" class="headerlink" title="意向锁"></a>意向锁</h3><p>表锁的一种，它仅仅表示一种操作意向。当我们使用粒度比较小的行锁时，在检测是否有锁时，需要一行一行的检查，效率较低。有了意向锁之后，则不需一行一行的排查，只需检测对应的意向锁即可。</p>
<h2 id="事务里锁的应用是怎么样的？"><a href="#事务里锁的应用是怎么样的？" class="headerlink" title="事务里锁的应用是怎么样的？"></a>事务里锁的应用是怎么样的？</h2><h3 id="可重复读"><a href="#可重复读" class="headerlink" title="可重复读"></a>可重复读</h3><p>可重复读使用的是 MVCC 快照，所以在读取数据时大多数时候不需要使用锁。</p>
<p>但使用了 <code>UPDATE</code>, <code>DELETE</code>，或 <code>SELECT with FOR UPDATE（排它锁） 或 FOR SHARE（共享锁）</code>，则会根据下面的情况来使用锁：</p>
<ul>
<li><p>在唯一索引上精确查找某条记录时，使用记录锁</p>
</li>
<li><p>对于其他的搜索，InnoDB 将会锁定扫描到的索引范围，使用间隙锁或临建锁来<strong>防止幻读</strong>的产生</p>
</li>
</ul>
<h3 id="读提交"><a href="#读提交" class="headerlink" title="读提交"></a>读提交</h3><p>也是使用 MVCC 机制来读取数据，不过在使用 <code>UPDATE</code>, <code>DELETE</code>，或 <code>SELECT with FOR UPDATE（排它锁） 或 FOR SHARE（共享锁）</code>时和上面的机制不一样，当存储引擎将筛选到的记录交给 mysql server 层后，会对不相干的数据进行解锁，所以不会涉及间隙锁或临建锁。它们只会在做外键约束检查和重复键检查时使用到。由于间隙锁的禁用，可能会<strong>出现幻读</strong>现象。</p>
<h3 id="未提交读"><a href="#未提交读" class="headerlink" title="未提交读"></a>未提交读</h3><p>在 mysql 的 innodb 存储引擎里做 <code>SELECT</code>操作不会做任何锁动作，如果是 myisam 存储引擎，则会上共享锁。如果使用<code>UPDATE</code>, <code>DELETE</code>，或 <code>SELECT with FOR UPDATE（排它锁） 或 FOR SHARE（共享锁）</code>则和读提交一样的原则。</p>
<h3 id="可序列化读"><a href="#可序列化读" class="headerlink" title="可序列化读"></a>可序列化读</h3><p>可序列化读在使用 select 时，一般会自动的转化为 SELECT … FOR SHARE（共享锁），以保证读写序列化。</p>
<h2 id="lock-in-share-mode-和-for-update-里间隙锁什么时候会应用？"><a href="#lock-in-share-mode-和-for-update-里间隙锁什么时候会应用？" class="headerlink" title="lock in share mode 和 for update 里间隙锁什么时候会应用？"></a>lock in share mode 和 for update 里间隙锁什么时候会应用？</h2><ul>
<li><p>lock in share mode, for update 如果 where 条件是非索引类的，则不会加间隙锁；</p>
</li>
<li><p>lock in share mode, for update 如果 where 条件是主键类的，并且找不到记录时会加间隙锁；如果找到记录了则会将间隙锁给释放了。比如 where 主键 &#x3D; 3 能找到记录时则不会加间隙锁，找不到时会在该数据的前后叶子节点间加间隙锁；此时假如记录里只有 1，8，9，则会在 1, 8 之间加间隙锁</p>
</li>
<li><p>lock in share mode, for update 如果 where 条件是非聚集索引类的，会加间隙锁，即使找不到记录。</p>
</li>
</ul>
<h2 id="锁超时的配置"><a href="#锁超时的配置" class="headerlink" title="锁超时的配置"></a>锁超时的配置</h2><p>当 mysql 获取锁超时时候，如果系统变量 innodb_rollback_on_timeout 为 off ,则当前事务只会回滚最后一条 sql, 所以建议设置 innodb_rollback_on_timeout 为 on, 这样在获取锁超时时可以回滚全部 sql。</p>
<h1 id="5-MVCC-是指什么？"><a href="#5-MVCC-是指什么？" class="headerlink" title="5. MVCC 是指什么？"></a>5. MVCC 是指什么？</h1><p>MVCC 即<strong>多版本并发控制</strong>，它利用了 undo log 会在数据修改时保留上一个修改记录指针的特点，使得每个事务对数据的修改能有自己的历史版本追溯，就像镜像备份一样。当进行读操作时，如果有其他写操作的事务并发进行，那么此时可以根据事务的隔离级别选择读取最新版本亦或自己之前版本的数据。MVCC 不需要加锁的，它能提高事务的并发处理能力。</p>
<h1 id="6-mysql-的复制技术"><a href="#6-mysql-的复制技术" class="headerlink" title="6. mysql 的复制技术"></a>6. mysql 的复制技术</h1><ul>
<li><p>全同步复制：只有等所有的 slave 节点将同步的日志写入 relay log，并且响应 ack 确认后，此次的事务才会提交。数据完整性高，但性能低</p>
</li>
<li><p>半同步复制：只要有一个 salve 节点响应 ack 后就可以认为同步成功，但细分为了两种，一种是 <code>AFTER_COMMIT</code>：先在主库提交事务, 然后同步从库, 等待从库的 ack 确认. 才告诉客户端是否 Ok。另一种是 <code>AFTER_SYNC</code>：主库先不提交事务, 只有从库 有 replay log ,回复了 ack 后才进行提交事务。后面一种数据一致性较高</p>
</li>
<li><p>异步复制：一旦有需要复制的就通知 slave, 但不会等待确认成功才进行后续操作。</p>
</li>
</ul>
<h1 id="7-存储引擎"><a href="#7-存储引擎" class="headerlink" title="7. 存储引擎"></a>7. 存储引擎</h1><h2 id="Mysql-存储引擎有哪些以及特点？"><a href="#Mysql-存储引擎有哪些以及特点？" class="headerlink" title="Mysql 存储引擎有哪些以及特点？"></a>Mysql 存储引擎有哪些以及特点？</h2><ul>
<li><p><strong>InnoDB：</strong> 它是 mysql 的默认存储引擎，能够实现 ACID 特性的事务，并且能提交、回滚、恢复数据，能很好的保障用户数据。同时支持了行级锁、聚集索引以及外键约束，是一个完善的存储引擎。</p>
</li>
<li><p><strong>MyISAM：</strong> 是 mysql 最开始的存储引擎，占用空间小，能快速存储，但不支持事务，提供了基于表级别的锁粒度，适用于配置或只读功能的应用程序。</p>
</li>
<li><p><strong>Memory：</strong> 数据都是存在内存里的，能提供快速访问，不过应该较少人使用，毕竟一旦断电数据也就丢失了。</p>
</li>
<li><p><strong>CSV：</strong> 带有逗号分隔值的文本文件，没有索引存在。但是兼容性很好，可以跟其他的程序交换数据。</p>
</li>
</ul>
<h2 id="myisam-存储引擎和-innodb-的区别"><a href="#myisam-存储引擎和-innodb-的区别" class="headerlink" title="myisam 存储引擎和 innodb 的区别"></a>myisam 存储引擎和 innodb 的区别</h2><ul>
<li><p>innoDB 支持事务，myisam 不支持</p>
</li>
<li><p>innoDB 支持行锁，myisam 不支持，只能到表锁</p>
</li>
<li><p>innoDB 支持外键，myisam 不支持</p>
</li>
<li><p>innoDB 不支持全文索引，myisam 支持</p>
</li>
<li><p>innoDB 支持聚集索引 和 非聚集索引；myISAM 只支持非聚集索引，该索引存的是数据域的记录指针，还得跳转查找。</p>
</li>
</ul>
<h1 id="8-Mysql-的三层架构"><a href="#8-Mysql-的三层架构" class="headerlink" title="8. Mysql 的三层架构"></a>8. Mysql 的三层架构</h1><ul>
<li><p><strong>连接层：</strong> 主要负责连接池、通信协议、认证授权等；</p>
</li>
<li><p><strong>SQL 层：</strong> 这一层是 mysql 的大脑，通过一系列组件得到数据操作的最优解。</p>
</li>
<li><p><strong>存储层：</strong> 负责数据的存储、检索。</p>
</li>
<li><p><img src="/img/loading.gif" data-original="https://static001.geekbang.org/infoq/7b/7b8895802bcf0c023f64a3ed741c1e46.pngc_center"></p>
</li>
</ul>
<h1 id="9-执行计划是什么？怎么看？"><a href="#9-执行计划是什么？怎么看？" class="headerlink" title="9. 执行计划是什么？怎么看？"></a>9. 执行计划是什么？怎么看？</h1><p>执行计划是 mysql 根据我们的查询语句进行一系列的分析后得到的优化方案。我们可以通过执行计划来获取执行过程。</p>
<p>执行计划的获取：</p>
<p><code>explain select 语句</code>  </p>
<p><img src="/img/loading.gif" data-original="https://static001.geekbang.org/infoq/da/da4a15afe4d3bf624e33a136db3eac93.png"></p>
<p>涉及的字段含义如下：</p>
<ul>
<li><p>id： 该 SELECT 标识符</p>
</li>
<li><p>select_type： 该 SELECT 类型</p>
</li>
<li><p>table： 输出行的表</p>
</li>
<li><p>partitions： 匹配的分区</p>
</li>
<li><p>type： 联接类型</p>
</li>
<li><p>possible_keys： 可供选择的可能索引</p>
</li>
<li><p>key： 实际选择的索引</p>
</li>
<li><p>key_len： 所选密钥的长度</p>
</li>
<li><p>ref： 与索引比较的列</p>
</li>
<li><p>rows： 估计要检查的行数</p>
</li>
<li><p>filtered： 按表条件过滤的行百分比</p>
</li>
<li><p>Extra： 附加信息</p>
</li>
</ul>
<p>其中，有个 type 字段，它的含义大概如下：</p>
<ul>
<li><p>eq_ref： 使用到了 UNIQUE 或 PRIMARY KEY 索引</p>
</li>
<li><p>ref： 显示索引的哪一列被使用了</p>
</li>
<li><p>ref_or_null： 对 Null 进行了索引优化</p>
</li>
<li><p>range： 索引范围检索</p>
</li>
<li><p>index： 索引扫描</p>
</li>
<li><p>unique_subquery： 使用了 in 子查询，里面涉及了主键字段</p>
</li>
<li><p>index_subquery： 使用了 in 子查询，里面涉及了非唯一索引</p>
</li>
<li><p>fulltext： 全文索引</p>
</li>
<li><p>all： 全表扫描数据</p>
</li>
</ul>
<p>从上面大概就能分析出索引的使用情况了，如果是 all，那就是没有用到索引了。</p>
<h1 id="10-SQL-注入的现象是？"><a href="#10-SQL-注入的现象是？" class="headerlink" title="10. SQL 注入的现象是？"></a>10. SQL 注入的现象是？</h1><p>在拼接 SQL 语句时，直接使用客户端传递过来的值拼接，如果客户端传来包含 <code>or 1=1</code> 类似的语句，那么就会筛选到非预期的结果，进而达到欺骗服务器的效果。</p>
<p>解决方案是使用现在数据库提供的预编译（prepare）和查询参数绑定功能，例如使用占位符 <code>?</code>，然后将带有占位符的 SQL 语句交给数据库编译，这样数据库就能知道要执行的是哪些语句，条件值又是哪些，而不会混杂在一起。</p>
<h1 id="11-UNION-和-UNION-ALL-的区别？"><a href="#11-UNION-和-UNION-ALL-的区别？" class="headerlink" title="11. UNION 和 UNION ALL 的区别？"></a>11. UNION 和 UNION ALL 的区别？</h1><ul>
<li><p>UNION ALL：将所有的数据联合起来，即使有重复数据</p>
</li>
<li><p>UNION：会合并重复数据</p>
</li>
</ul>
<h1 id="12-为什么尽量使用自增-ID，而不是-UUID？"><a href="#12-为什么尽量使用自增-ID，而不是-UUID？" class="headerlink" title="12. 为什么尽量使用自增 ID，而不是 UUID？"></a>12. 为什么尽量使用自增 ID，而不是 UUID？</h1><p>自增 ID 是由有序的，而 UUID 是无序的，如果该字段作为索引，那么就会很容易打破 B+ 树的平衡，进而不断的在进行磁盘数据页的调整，导致性能下降</p>
<h1 id="13-分库分表有哪些？有什么优缺点？"><a href="#13-分库分表有哪些？有什么优缺点？" class="headerlink" title="13. 分库分表有哪些？有什么优缺点？"></a>13. 分库分表有哪些？有什么优缺点？</h1><ul>
<li><p>分库：从业务角度进行切分</p>
</li>
<li><p>分表：将数据根据一定的规则落在多张表上。比如按时间范围来切分，或者通过对 ID 进行 Hash 来路由到对应的表上。</p>
</li>
</ul>
<p>分库分表后使得数据不再集中到一张表上，但也带来了维护以及其他处理问题。比如原来的事务变为分布式事务；原来的 join 操作将要变为在应用层序做过滤；还有数据的后续迁移、扩容规划等。</p>
<h1 id="14-内连接、外连接区别"><a href="#14-内连接、外连接区别" class="headerlink" title="14. 内连接、外连接区别"></a>14. 内连接、外连接区别</h1><ul>
<li><p>内连接：只有符合条件的记录才会出现在结果集里</p>
</li>
<li><p>外连接：其结果集中不仅包含符合连接条件的行，还会包括左表、右表或两个表中的所有数据行，这三种情况依次称之为左外连接，右外连接，和全外连接。</p>
</li>
</ul>
<h1 id="15-常见的数据库优化"><a href="#15-常见的数据库优化" class="headerlink" title="15. 常见的数据库优化"></a>15. 常见的数据库优化</h1><ul>
<li><p>对经常出现在 where 条件里，并且数据重复率不高的字段建立索引</p>
</li>
<li><p>使用 JOIN 来代替子查询；</p>
</li>
<li><p>能使用 in 就不使用 or，前者能命中索引，后者会让索引失效</p>
</li>
<li><p>避免在 where 字段上计算，例如 where a &#x2F; 3 &#x3D; 1，这样会让索引失效；避免在 where 字段上使用 NULL 值的判断</p>
</li>
<li><p>打开慢查询日志配置，有针对性的分析响应缓慢的语句。</p>
</li>
</ul>
<h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><h2 id="sql的执行顺序"><a href="#sql的执行顺序" class="headerlink" title="sql的执行顺序"></a>sql的执行顺序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from on where group by having select distinct order by limit</span><br></pre></td></tr></table></figure>


<h3 id="一条SQL更新语句执行顺序"><a href="#一条SQL更新语句执行顺序" class="headerlink" title="一条SQL更新语句执行顺序"></a>一条SQL更新语句执行顺序</h3><p>通过分析器分析，执行和查询语句一样。然后写redo log(是个循环日志文件。写完redo log同步到内存中，适当时机更新到磁盘中) 和 binary log，与redo log 采取二阶段事务提交</p>
<h3 id="事务隔离级别，怎么选择，为什么"><a href="#事务隔离级别，怎么选择，为什么" class="headerlink" title="事务隔离级别，怎么选择，为什么"></a>事务隔离级别，怎么选择，为什么</h3><h4 id="读未提交"><a href="#读未提交" class="headerlink" title="读未提交"></a>读未提交</h4><p>会读到未提交的事务，脏读，不可重复读，幻读</p>
<p>幻读：指的是一个事务在前后两次查询同一个范围的时候，后一次查询看到了前一次查询没有看到的数据行。</p>
<h4 id="不可重复读（rc）"><a href="#不可重复读（rc）" class="headerlink" title="不可重复读（rc）"></a>不可重复读（rc）</h4><p>别的事务提交，而能直接读到别的事务提交的结果，和别的事务提交之前的不一样，所以不可重复读</p>
<h4 id="可重复读-rr"><a href="#可重复读-rr" class="headerlink" title="可重复读(rr)"></a>可重复读(rr)</h4><p>读取是从快照中读取，即使别的事务提交仍读的是旧的</p>
<h4 id="串行化"><a href="#串行化" class="headerlink" title="串行化"></a>串行化</h4><p>锁表，别人读的时候，你不能干任何事情</p>
<h4 id="使用RC为默认隔离级别"><a href="#使用RC为默认隔离级别" class="headerlink" title="使用RC为默认隔离级别"></a>使用RC为默认隔离级别</h4><p>innodb默认为RR隔离级别，是由于历史原因binary log同步的原因，默认使用的是statement记录操作语句（是以commit的顺序为记录）。就会出现主从不一致的情况。</p>
<ol>
<li>在RR隔离级别下，存在间隙锁，导致出现死锁的几率比RC大的多！</li>
<li>在RR隔离级别下，条件列未命中索引会锁表！而在RC隔离级别下，只锁行</li>
<li>在RC隔离级别下，半一致性读(semi-consistent)特性增加了update操作的并发性！</li>
</ol>
<p>在RC级别下，不可重复读问题需要解决么？<br>不用解决，这个问题是可以接受的！毕竟你数据都已经提交了，读出来本身就没有太大问题！Oracle的默认隔离级别就是RC，你们改过Oracle的默认隔离级别么？</p>
<p>在RC级别下，主从复制用什么binlog格式？<br>OK,在该隔离级别下，用的binlog为row格式，是基于行的复制！Innodb的创始人也是建议binlog使用该格式！</p>
<h3 id="说说你了解的索引"><a href="#说说你了解的索引" class="headerlink" title="说说你了解的索引"></a>说说你了解的索引</h3><p>聚簇索引，使用的是B+ 树类型。</p>
<p>主键索引，存放的是value和索引</p>
<p>其余的只存放索引，需要回表查询。因为叶子节点只存放索引。</p>
<p>索引类型：</p>
<ol>
<li>主键索引</li>
<li>唯一索引</li>
<li>普通索引</li>
<li>联合索引</li>
</ol>
<p>explain中的字段</p>
<ul>
<li><p>id</p>
<ul>
<li>id 相同的情况下，执行顺序由上而下</li>
<li>如果是子查询，id 越大，越先执行</li>
<li>小表驱动大表</li>
</ul>
</li>
<li><p>select_type</p>
<ul>
<li>simple 简单的查询不包含子查询或者union</li>
<li>primary 主查询，最后加载</li>
<li>subquery 子查询</li>
<li>derived 衍生的临时表</li>
<li>union<ul>
<li>若第二个select出现在union之后，则标记为union</li>
<li>若union包含在from子句的子查询中，则外层select标记为derived</li>
</ul>
</li>
<li>union result 从union表获取结果的select<ul>
<li>两个union合并的select</li>
</ul>
</li>
</ul>
</li>
<li><p>table 哪张表</p>
</li>
<li><p>type</p>
<ul>
<li>从最好到最差依次<ul>
<li>system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;all</li>
<li>system 只有一条记录的单表，系统表</li>
<li>const 相当于primary key 或 unique 等于一个数值 where id &#x3D;1</li>
<li>eq_ref 唯一索引 t1.id&#x3D;t2.id</li>
<li>ref 普通索引，非唯一值</li>
<li>range 只检索给定范围的行，使用一个索引来选择行</li>
<li>index 遍历所有索引</li>
<li>all 全表扫描，需要优化</li>
</ul>
</li>
</ul>
</li>
<li><p>possible_keys，key</p>
<ul>
<li>可能用到的索引和实际用到的索引</li>
<li>覆盖索引不会显示在possible_keys上，只会显示在key中</li>
</ul>
</li>
<li><p>key_len</p>
<ul>
<li>表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度</li>
<li>同样的查询结果，长度越少越好</li>
</ul>
</li>
<li><p>ref</p>
<ul>
<li>显示索引的哪一列被使用,如果可能的话，是一个常量，哪些列或常量被用于查找索引列上的值</li>
<li>const 常量</li>
<li>test1.t1.id</li>
</ul>
</li>
<li><p>rows</p>
<ul>
<li>根据表统计信息及索引选用情况，大致估算出找到所需的记录所需要读取的行数</li>
<li>理论上影响了多少行</li>
</ul>
</li>
<li><p>extra</p>
<ul>
<li>不适合在其他列中显示但是十分重要的额外信息</li>
<li>using filesort<ul>
<li>mysql 无法利用索引完成的排序，文件排序</li>
</ul>
</li>
<li>using temporary<ul>
<li>对查询结果，使用了临时表 order by ,group by</li>
<li>最好使用覆盖索引，不要产生临时表</li>
</ul>
</li>
<li>using index<ul>
<li>表示相应的select 操作中使用了覆盖索引</li>
<li>同时出现using where ，表明索引被用来执行索引键值的查找</li>
<li>没出现using where，表明索引用来读取数据而非执行查找动作</li>
</ul>
</li>
<li>using where<ul>
<li>使用了 where</li>
</ul>
</li>
<li>using join buffer<ul>
<li>join 多，而使用了缓冲区</li>
</ul>
</li>
<li>impossible where<ul>
<li>where子句的值是false</li>
</ul>
</li>
</ul>
</li>
<li><p>两表加索引</p>
<ul>
<li>左连接<ul>
<li>加子表上，主表的数据全部都要，加了索引也没用，子表不一定都要，可以加索引优化</li>
<li>sql执行的顺序为 from on join 其中 on就是可以用到索引的地方</li>
</ul>
</li>
<li>右连接相反</li>
<li>join 语句的优化<ul>
<li>尽可能减少join语句的Nestedloop的循环总次数，永远用小结果集驱动大结果集</li>
<li>优先优化NestedLoop的内层循环</li>
<li>保证Join语句中被驱动表上Join条件字段已经被索引</li>
<li>当无法保证被驱动表的Join条件字段被索引且内存资源充足的前提下，不要太吝啬JoinBuffer的设置</li>
</ul>
</li>
</ul>
</li>
<li><p>索引失效的情况：</p>
<ul>
<li>全值匹配我最爱</li>
<li>违背最左前缀原则</li>
<li>跳过索引中的列</li>
<li>某列属于联合索引，对该列进行范围查询，值使用部分索引，该列右边的列无法使用索引</li>
<li>!&#x3D;,is null,is not null</li>
<li>like以通配符开头<ul>
<li>解决%like% 索引时不能失效的方法</li>
<li>使用覆盖索引可以解决</li>
</ul>
</li>
<li>用or连接条件</li>
<li>不在索引列上做任何操作（计算，函数，自动or手动类型转换，会导致索引失效而转向全表扫描）</li>
<li>尽量使用覆盖索引</li>
<li>字符串不加单引号索引失效</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Bishop</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://bishoptylaor.github.io/interview/db/mysql101/">https://bishoptylaor.github.io/interview/db/mysql101/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://bishoptylaor.github.io" target="_blank">Bishop</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9D%A2%E8%AF%95/">面试</a><a class="post-meta__tags" href="/tags/%E5%BF%85%E7%9C%8B%E5%BF%85%E4%BC%9A/">必看必会</a><a class="post-meta__tags" href="/tags/mysql/">mysql</a></div><div class="post_share"><div class="social-share" data-image="/img/index.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-original="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-original="/img/alipay.jpg" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/interview/db/mongodb101/"><img class="prev-cover" src="/img/loading.gif" data-original="/img/index.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">mongodb 面试必备</div></div></a></div><div class="next-post pull-right"><a href="/interview/db/redis101/"><img class="next-cover" src="/img/loading.gif" data-original="/img/index.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">redis面试必备</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/interview/http/" title="http 网络面试必备"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">http 网络面试必备</div></div></a></div><div><a href="/interview/db/mongodb101/" title="mongodb 面试必备"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">mongodb 面试必备</div></div></a></div><div><a href="/interview/db/redis101/" title="redis面试必备"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">redis面试必备</div></div></a></div><div><a href="/interview/inter-alg101/" title="面试算法题总结"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">面试算法题总结</div></div></a></div><div><a href="/interview/go/golang101-1/" title="Golang语言面试题 - 基础语法"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-21</div><div class="title">Golang语言面试题 - 基础语法</div></div></a></div><div><a href="/interview/go/golang101-2/" title="Golang语言面试题 - 基本原理"><img class="cover" src="/img/loading.gif" data-original="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-22</div><div class="title">Golang语言面试题 - 基本原理</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Gitalk</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Bishop</div><div class="author-info__description">Bishop的blog</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Bishoptylaor/Bishoptylaor.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a><a class="social-icon" href="https://github.com/Bishoptylaor" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/ayabishop@sina.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">早日成为老婆的 ATM 机 + 头号舔狗</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E4%BA%8B%E5%8A%A1"><span class="toc-text">1. 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ACID-%E7%89%B9%E6%80%A7"><span class="toc-text">ACID 特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">隔离级别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95"><span class="toc-text">2. 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E7%9A%84%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-text">Mysql 的索引分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E3%80%81%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E3%80%81%E4%B8%BB%E5%BB%BA%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">聚集索引、非聚集索引、主建的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E5%93%AA%E4%BA%9B%E6%83%85%E5%86%B5%E4%BC%9A%E8%AE%A9%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%9F"><span class="toc-text">有哪些情况会让索引失效？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99%E6%98%AF%E6%8C%87%EF%BC%9F"><span class="toc-text">最左匹配原则是指？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-B-%E6%A0%91%E6%98%AF%E6%80%8E%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F"><span class="toc-text">索引的底层数据结构 B+ 树是怎么样的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b-%E6%A0%91-b-%E6%A0%91-b-%E6%A0%91%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">b 树 b+树 b-树的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E5%9C%A8%E9%87%8D%E5%A4%8D%E7%8E%87%E9%AB%98%EF%BC%8C%E4%BE%8B%E5%A6%82%E6%80%A7%E5%88%AB%E5%AD%97%E6%AE%B5%E4%B8%8A%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95%EF%BC%9F"><span class="toc-text">为什么不能在重复率高，例如性别字段上建立索引？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E7%9A%84-hash-%E7%B4%A2%E5%BC%95%E6%98%AF%E6%80%8E%E4%B9%88%E6%A0%B7%EF%BC%8C%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%9F"><span class="toc-text">Mysql 的 hash 索引是怎么样，有什么优缺点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E7%9A%84%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95"><span class="toc-text">Mysql 的全文索引</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%97%A5%E5%BF%97"><span class="toc-text">3. 日志</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%B1%BB%E5%88%AB"><span class="toc-text">日志类别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redo-log-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%EF%BC%9Awritepos%E3%80%81checkpoint%E3%80%81prepare%E3%80%81commit"><span class="toc-text">redo log 相关概念：writepos、checkpoint、prepare、commit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-Mysql-%E9%87%8C%E7%9A%84%E9%94%81"><span class="toc-text">4. Mysql 里的锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E9%87%8C%E7%9A%84%E9%94%81%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">Mysql 里的锁有哪些？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%90%E8%A7%82-x2F-%E6%82%B2%E8%A7%82%E9%94%81"><span class="toc-text">乐观&#x2F;悲观锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB-x2F-%E6%8E%92%E5%AE%83%E9%94%81"><span class="toc-text">共享&#x2F;排它锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E9%94%81-x2F-%E8%A1%8C%E9%94%81"><span class="toc-text">表锁&#x2F;行锁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8C%E9%94%81"><span class="toc-text">行锁</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%90%91%E9%94%81"><span class="toc-text">意向锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%87%8C%E9%94%81%E7%9A%84%E5%BA%94%E7%94%A8%E6%98%AF%E6%80%8E%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F"><span class="toc-text">事务里锁的应用是怎么样的？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB"><span class="toc-text">可重复读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E6%8F%90%E4%BA%A4"><span class="toc-text">读提交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AA%E6%8F%90%E4%BA%A4%E8%AF%BB"><span class="toc-text">未提交读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%BA%8F%E5%88%97%E5%8C%96%E8%AF%BB"><span class="toc-text">可序列化读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lock-in-share-mode-%E5%92%8C-for-update-%E9%87%8C%E9%97%B4%E9%9A%99%E9%94%81%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BC%9A%E5%BA%94%E7%94%A8%EF%BC%9F"><span class="toc-text">lock in share mode 和 for update 里间隙锁什么时候会应用？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%81%E8%B6%85%E6%97%B6%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">锁超时的配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-MVCC-%E6%98%AF%E6%8C%87%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">5. MVCC 是指什么？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-mysql-%E7%9A%84%E5%A4%8D%E5%88%B6%E6%8A%80%E6%9C%AF"><span class="toc-text">6. mysql 的复制技术</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-text">7. 存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BB%A5%E5%8F%8A%E7%89%B9%E7%82%B9%EF%BC%9F"><span class="toc-text">Mysql 存储引擎有哪些以及特点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#myisam-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E5%92%8C-innodb-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">myisam 存储引擎和 innodb 的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Mysql-%E7%9A%84%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84"><span class="toc-text">8. Mysql 的三层架构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E6%80%8E%E4%B9%88%E7%9C%8B%EF%BC%9F"><span class="toc-text">9. 执行计划是什么？怎么看？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-SQL-%E6%B3%A8%E5%85%A5%E7%9A%84%E7%8E%B0%E8%B1%A1%E6%98%AF%EF%BC%9F"><span class="toc-text">10. SQL 注入的现象是？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-UNION-%E5%92%8C-UNION-ALL-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">11. UNION 和 UNION ALL 的区别？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8%E8%87%AA%E5%A2%9E-ID%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF-UUID%EF%BC%9F"><span class="toc-text">12. 为什么尽量使用自增 ID，而不是 UUID？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%9F"><span class="toc-text">13. 分库分表有哪些？有什么优缺点？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#14-%E5%86%85%E8%BF%9E%E6%8E%A5%E3%80%81%E5%A4%96%E8%BF%9E%E6%8E%A5%E5%8C%BA%E5%88%AB"><span class="toc-text">14. 内连接、外连接区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96"><span class="toc-text">15. 常见的数据库优化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql"><span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-text">sql的执行顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%9D%A1SQL%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-text">一条SQL更新语句执行顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%EF%BC%8C%E6%80%8E%E4%B9%88%E9%80%89%E6%8B%A9%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88"><span class="toc-text">事务隔离级别，怎么选择，为什么</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E6%9C%AA%E6%8F%90%E4%BA%A4"><span class="toc-text">读未提交</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%88rc%EF%BC%89"><span class="toc-text">不可重复读（rc）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB-rr"><span class="toc-text">可重复读(rr)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%B2%E8%A1%8C%E5%8C%96"><span class="toc-text">串行化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8RC%E4%B8%BA%E9%BB%98%E8%AE%A4%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">使用RC为默认隔离级别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E8%AF%B4%E4%BD%A0%E4%BA%86%E8%A7%A3%E7%9A%84%E7%B4%A2%E5%BC%95"><span class="toc-text">说说你了解的索引</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/single-numbers/" title="面试题-仅出现一次的元素"><img src="/img/loading.gif" data-original="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面试题-仅出现一次的元素"/></a><div class="content"><a class="title" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/single-numbers/" title="面试题-仅出现一次的元素">面试题-仅出现一次的元素</a><time datetime="2023-02-26T09:19:05.000Z" title="发表于 2023-02-26 17:19:05">2023-02-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/remove-the-k-digit/" title="面试题-移掉K位数字"><img src="/img/loading.gif" data-original="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面试题-移掉K位数字"/></a><div class="content"><a class="title" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/remove-the-k-digit/" title="面试题-移掉K位数字">面试题-移掉K位数字</a><time datetime="2023-02-26T09:19:05.000Z" title="发表于 2023-02-26 17:19:05">2023-02-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/interviewer101/" title="面试官101"><img src="/img/loading.gif" data-original="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面试官101"/></a><div class="content"><a class="title" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/interviewer101/" title="面试官101">面试官101</a><time datetime="2023-02-26T09:19:05.000Z" title="发表于 2023-02-26 17:19:05">2023-02-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/maximum-of-segments/" title="面试题-连续固定区间最大值"><img src="/img/loading.gif" data-original="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面试题-连续固定区间最大值"/></a><div class="content"><a class="title" href="/interview/%E9%9D%A2%E8%AF%95%E5%AE%98/maximum-of-segments/" title="面试题-连续固定区间最大值">面试题-连续固定区间最大值</a><time datetime="2023-02-26T09:19:05.000Z" title="发表于 2023-02-26 17:19:05">2023-02-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E8%BD%AF%E5%AE%9E%E5%8A%9B/1/" title="Hello World"><img src="/img/loading.gif" data-original="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/%E8%BD%AF%E5%AE%9E%E5%8A%9B/1/" title="Hello World">Hello World</a><time datetime="2022-04-21T11:14:05.167Z" title="发表于 2022-04-21 19:14:05">2022-04-21</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By Bishop</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      id: '64222bf2a4320b7a5567618352e5ec2f',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: {"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_親親":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再見":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_發怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_發財":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可愛":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_嘔吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_壞笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尷尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_驚嚇":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png"},
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Gitalk' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>