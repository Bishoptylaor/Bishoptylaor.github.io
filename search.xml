<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>leet212</title>
      <link href="/interview/juan/Blind75/leet212/"/>
      <url>/interview/juan/Blind75/leet212/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet211</title>
      <link href="/interview/juan/Blind75/leet211/"/>
      <url>/interview/juan/Blind75/leet211/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet208</title>
      <link href="/interview/juan/Blind75/leet208/"/>
      <url>/interview/juan/Blind75/leet208/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet235</title>
      <link href="/interview/juan/Blind75/leet235/"/>
      <url>/interview/juan/Blind75/leet235/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet230</title>
      <link href="/interview/juan/Blind75/leet230/"/>
      <url>/interview/juan/Blind75/leet230/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet98</title>
      <link href="/interview/juan/Blind75/leet98/"/>
      <url>/interview/juan/Blind75/leet98/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet105</title>
      <link href="/interview/juan/Blind75/leet105/"/>
      <url>/interview/juan/Blind75/leet105/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet572</title>
      <link href="/interview/juan/Blind75/leet572/"/>
      <url>/interview/juan/Blind75/leet572/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet297</title>
      <link href="/interview/juan/Blind75/leet297/"/>
      <url>/interview/juan/Blind75/leet297/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet102</title>
      <link href="/interview/juan/Blind75/leet102/"/>
      <url>/interview/juan/Blind75/leet102/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet124</title>
      <link href="/interview/juan/Blind75/leet124/"/>
      <url>/interview/juan/Blind75/leet124/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet226</title>
      <link href="/interview/juan/Blind75/leet226/"/>
      <url>/interview/juan/Blind75/leet226/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet100</title>
      <link href="/interview/juan/Blind75/leet100/"/>
      <url>/interview/juan/Blind75/leet100/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet104</title>
      <link href="/interview/juan/Blind75/leet104/"/>
      <url>/interview/juan/Blind75/leet104/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet295</title>
      <link href="/interview/juan/Blind75/leet295/"/>
      <url>/interview/juan/Blind75/leet295/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet347</title>
      <link href="/interview/juan/Blind75/leet347/"/>
      <url>/interview/juan/Blind75/leet347/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet23</title>
      <link href="/interview/juan/Blind75/leet23/"/>
      <url>/interview/juan/Blind75/leet23/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet647</title>
      <link href="/interview/juan/Blind75/leet647/"/>
      <url>/interview/juan/Blind75/leet647/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet5</title>
      <link href="/interview/juan/Blind75/leet5/"/>
      <url>/interview/juan/Blind75/leet5/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet125</title>
      <link href="/interview/juan/Blind75/leet125/"/>
      <url>/interview/juan/Blind75/leet125/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet20</title>
      <link href="/interview/juan/Blind75/leet20/"/>
      <url>/interview/juan/Blind75/leet20/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet49</title>
      <link href="/interview/juan/Blind75/leet49/"/>
      <url>/interview/juan/Blind75/leet49/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet242</title>
      <link href="/interview/juan/Blind75/leet242/"/>
      <url>/interview/juan/Blind75/leet242/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet76</title>
      <link href="/interview/juan/Blind75/leet76/"/>
      <url>/interview/juan/Blind75/leet76/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet424</title>
      <link href="/interview/juan/Blind75/leet424/"/>
      <url>/interview/juan/Blind75/leet424/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet3</title>
      <link href="/interview/juan/Blind75/leet3/"/>
      <url>/interview/juan/Blind75/leet3/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet79</title>
      <link href="/interview/juan/Blind75/leet79/"/>
      <url>/interview/juan/Blind75/leet79/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet48</title>
      <link href="/interview/juan/Blind75/leet48/"/>
      <url>/interview/juan/Blind75/leet48/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet54</title>
      <link href="/interview/juan/Blind75/leet54/"/>
      <url>/interview/juan/Blind75/leet54/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet73</title>
      <link href="/interview/juan/Blind75/leet73/"/>
      <url>/interview/juan/Blind75/leet73/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet143</title>
      <link href="/interview/juan/Blind75/leet143/"/>
      <url>/interview/juan/Blind75/leet143/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet19</title>
      <link href="/interview/juan/Blind75/leet19/"/>
      <url>/interview/juan/Blind75/leet19/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet23</title>
      <link href="/interview/juan/Blind75/leet23/"/>
      <url>/interview/juan/Blind75/leet23/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet21</title>
      <link href="/interview/juan/Blind75/leet21/"/>
      <url>/interview/juan/Blind75/leet21/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet141</title>
      <link href="/interview/juan/Blind75/leet141/"/>
      <url>/interview/juan/Blind75/leet141/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet206</title>
      <link href="/interview/juan/Blind75/leet206/"/>
      <url>/interview/juan/Blind75/leet206/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet435</title>
      <link href="/interview/juan/Blind75/leet435/"/>
      <url>/interview/juan/Blind75/leet435/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet57</title>
      <link href="/interview/juan/Blind75/leet57/"/>
      <url>/interview/juan/Blind75/leet57/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet56</title>
      <link href="/interview/juan/Blind75/leet56/"/>
      <url>/interview/juan/Blind75/leet56/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet128</title>
      <link href="/interview/juan/Blind75/leet128/"/>
      <url>/interview/juan/Blind75/leet128/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet200</title>
      <link href="/interview/juan/Blind75/leet200/"/>
      <url>/interview/juan/Blind75/leet200/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet417</title>
      <link href="/interview/juan/Blind75/leet417/"/>
      <url>/interview/juan/Blind75/leet417/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet207</title>
      <link href="/interview/juan/Blind75/leet207/"/>
      <url>/interview/juan/Blind75/leet207/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet133</title>
      <link href="/interview/juan/Blind75/leet133/"/>
      <url>/interview/juan/Blind75/leet133/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet55</title>
      <link href="/interview/juan/Blind75/leet55/"/>
      <url>/interview/juan/Blind75/leet55/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet62</title>
      <link href="/interview/juan/Blind75/leet62/"/>
      <url>/interview/juan/Blind75/leet62/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet91</title>
      <link href="/interview/juan/Blind75/leet91/"/>
      <url>/interview/juan/Blind75/leet91/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet213</title>
      <link href="/interview/juan/Blind75/leet213/"/>
      <url>/interview/juan/Blind75/leet213/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet198</title>
      <link href="/interview/juan/Blind75/leet198/"/>
      <url>/interview/juan/Blind75/leet198/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet39</title>
      <link href="/interview/juan/Blind75/leet39/"/>
      <url>/interview/juan/Blind75/leet39/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet139</title>
      <link href="/interview/juan/Blind75/leet139/"/>
      <url>/interview/juan/Blind75/leet139/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet1143</title>
      <link href="/interview/juan/Blind75/leet1143/"/>
      <url>/interview/juan/Blind75/leet1143/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet300</title>
      <link href="/interview/juan/Blind75/leet300/"/>
      <url>/interview/juan/Blind75/leet300/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet322</title>
      <link href="/interview/juan/Blind75/leet322/"/>
      <url>/interview/juan/Blind75/leet322/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet70</title>
      <link href="/interview/juan/Blind75/leet70/"/>
      <url>/interview/juan/Blind75/leet70/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet190</title>
      <link href="/interview/juan/Blind75/leet190/"/>
      <url>/interview/juan/Blind75/leet190/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet268</title>
      <link href="/interview/juan/Blind75/leet268/"/>
      <url>/interview/juan/Blind75/leet268/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet338</title>
      <link href="/interview/juan/Blind75/leet338/"/>
      <url>/interview/juan/Blind75/leet338/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leet191</title>
      <link href="/interview/juan/Blind75/leet191/"/>
      <url>/interview/juan/Blind75/leet191/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>math</title>
      <link href="/uncategorized/math/"/>
      <url>/uncategorized/math/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/jzj_c_love/article/details/122279703">https://blog.csdn.net/jzj_c_love/article/details/122279703</a></p><h1 id="åŸºæœ¬æ ¼å¼"><a href="#åŸºæœ¬æ ¼å¼" class="headerlink" title="åŸºæœ¬æ ¼å¼"></a>åŸºæœ¬æ ¼å¼</h1><h2 id="ä¸Šä¸‹æ ‡"><a href="#ä¸Šä¸‹æ ‡" class="headerlink" title="ä¸Šä¸‹æ ‡"></a>ä¸Šä¸‹æ ‡</h2><p>$$<br>A_1^2<br>\<br>B_{12}<br>\<br>2^{x^2+y}<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">A_1^2</span><br><span class="line">\\</span><br><span class="line">B_&#123;12&#125;</span><br><span class="line">\\</span><br><span class="line">2^&#123;x^2+y&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="åˆ†æ•°"><a href="#åˆ†æ•°" class="headerlink" title="åˆ†æ•°"></a>åˆ†æ•°</h2><p>$$<br>\frac{x}{1+x^2}<br>\<br>\frac{\frac{1}{2}+x}{y}<br>\<br>\tfrac{a}{b}<br>\frac{a}{b}<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\frac&#123;x&#125;&#123;1+x^2&#125;</span><br><span class="line">\\</span><br><span class="line">\frac&#123;\frac&#123;1&#125;&#123;2&#125;+x&#125;&#123;y&#125;</span><br><span class="line">\\</span><br><span class="line">\tfrac&#123;a&#125;&#123;b&#125;</span><br><span class="line">\frac&#123;a&#125;&#123;b&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="å¼€æ ¹"><a href="#å¼€æ ¹" class="headerlink" title="å¼€æ ¹"></a>å¼€æ ¹</h2><p>$$<br>\sqrt{x}<br>\sqrt[3]{x}<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\sqrt&#123;x&#125;</span><br><span class="line">\sqrt[3]&#123;x&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="ç»„åˆæ•°"><a href="#ç»„åˆæ•°" class="headerlink" title="ç»„åˆæ•°"></a>ç»„åˆæ•°</h2><p>$$<br>\binom{n}{k}<br>\tbinom{n}{k}<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\binom&#123;n&#125;&#123;k&#125;</span><br><span class="line">\tbinom&#123;n&#125;&#123;k&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¼æ•°"><a href="#å¯¼æ•°" class="headerlink" title="å¯¼æ•°"></a>å¯¼æ•°</h2><p>$$<br>aâ€²aâ€²â€²aâ€²<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">ğ‘â€²ğ‘â€³ğ‘â€²</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="åå¾®åˆ†"><a href="#åå¾®åˆ†" class="headerlink" title="åå¾®åˆ†"></a>åå¾®åˆ†</h2><p>$$<br>âˆ‚âˆ‡âˆ‚âˆ‡<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">a&#x27;</span><br><span class="line">a&#x27;&#x27;</span><br><span class="line">a^&#123;\prime&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="å–æ¨¡"><a href="#å–æ¨¡" class="headerlink" title="å–æ¨¡"></a>å–æ¨¡</h2><p>$$<br>x(moda)2modxğ‘¥(modğ‘)2modğ‘¥<br>$$</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">x \pmod a</span><br><span class="line">\\</span><br><span class="line">2\mod&#123;x&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h2 id="ç§¯åˆ†"><a href="#ç§¯åˆ†" class="headerlink" title="ç§¯åˆ†"></a>ç§¯åˆ†</h2><p>$$<br>âˆ«211âˆ«2âˆ®âˆ«âˆ¬âˆ¯âˆ­âˆ°âˆ«12âˆ«21âˆ®â¡âˆ«âˆ¬âˆ¯â¡âˆ­âˆ°<br>$$</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">$</span><span class="operator">$</span></span><br><span class="line">\<span class="keyword">int_</span>&#123;<span class="number">1</span>&#125;<span class="operator">^</span>&#123;<span class="number">2</span>&#125;</span><br><span class="line">\<span class="keyword">intop_</span>&#123;<span class="number">2</span>&#125;<span class="operator">^</span>&#123;<span class="number">1</span>&#125;</span><br><span class="line">\oint</span><br><span class="line">\smallint</span><br><span class="line">\\</span><br><span class="line">\iint</span><br><span class="line">\oiint</span><br><span class="line">\iiint</span><br><span class="line">\oiiint</span><br></pre></td></tr></table></figure><h2 id="ç´¯åŠ -x2F-ç´¯ä¹˜-x2F-æé™"><a href="#ç´¯åŠ -x2F-ç´¯ä¹˜-x2F-æé™" class="headerlink" title="ç´¯åŠ &#x2F;ç´¯ä¹˜&#x2F;æé™"></a>ç´¯åŠ &#x2F;ç´¯ä¹˜&#x2F;æé™</h2><p>kâˆ‘i&#x3D;1nâˆ‘i&#x3D;1âˆ‘ni&#x3D;1kâˆi&#x3D;1nâˆi&#x3D;1âˆni&#x3D;1limkâ†’âˆlimkâ†’âˆlimkâ†’âˆâˆ‘ğ‘–&#x3D;1ğ‘˜âˆ‘ğ‘–&#x3D;1ğ‘›âˆ‘ğ‘–&#x3D;1ğ‘›âˆğ‘–&#x3D;1ğ‘˜âˆğ‘–&#x3D;1ğ‘›âˆğ‘–&#x3D;1ğ‘›limğ‘˜â†’âˆlimğ‘˜â†’âˆlimğ‘˜â†’âˆ</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\<span class="keyword">sum_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="operator">^</span>&#123;k&#125;</span><br><span class="line">\displaystyle\<span class="keyword">sum_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="symbol">^n</span></span><br><span class="line">\textstyle\<span class="keyword">sum_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="symbol">^n</span></span><br><span class="line">\\</span><br><span class="line">\<span class="keyword">prod_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="operator">^</span>&#123;k&#125;</span><br><span class="line">\displaystyle\<span class="keyword">prod_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="symbol">^n</span></span><br><span class="line">\textstyle\<span class="keyword">prod_</span>&#123;i<span class="operator">=</span><span class="number">1</span>&#125;<span class="symbol">^n</span></span><br><span class="line">\\</span><br><span class="line">\<span class="keyword">lim_</span>&#123;k \<span class="keyword">to</span> \infty&#125;</span><br><span class="line">\lim\<span class="keyword">limits_</span>&#123;k \<span class="keyword">to</span> \infty&#125;</span><br><span class="line">\lim\<span class="keyword">nolimits_</span>&#123;k \<span class="keyword">to</span> \infty&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¿®é¥°ç¬¦å·"><a href="#ä¿®é¥°ç¬¦å·" class="headerlink" title="ä¿®é¥°ç¬¦å·"></a>ä¿®é¥°ç¬¦å·</h1><p><strong>ç®€å•çš„å¸½å­</strong></p><p>^Î¸Ë†ABÂ¯yÂ¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯AB<del>aËœacÂ¯aÂ´aË‡a&#96;aË™aÂ¨ağœƒ^ğ´ğµ^ğ‘¦Â¯ğ´ğµÂ¯ğ‘</del>ğ‘ğ‘~ğ‘Â¯ğ‘Â´ğ‘Ë‡ğ‘&#96;ğ‘Ë™ğ‘Â¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">\hat&#123;\theta&#125;</span><br><span class="line">\widehat&#123;AB&#125;</span><br><span class="line">\\</span><br><span class="line">\bar&#123;y&#125;</span><br><span class="line">\overline&#123;AB&#125;</span><br><span class="line">\\</span><br><span class="line">\tilde&#123;a&#125;</span><br><span class="line">\widetilde&#123;ac&#125;</span><br><span class="line">\\</span><br><span class="line">\bar&#123;a&#125;</span><br><span class="line">\acute&#123;a&#125;</span><br><span class="line">\check&#123;a&#125;</span><br><span class="line">\grave&#123;a&#125;</span><br><span class="line">\\</span><br><span class="line">\dot&#123;a&#125;</span><br><span class="line">\ddot&#123;a&#125;</span><br></pre></td></tr></table></figure><p><strong>å¸½å­å’Œè¢œå­</strong></p><p>â†âˆ’âˆ’ABâˆ’âˆ’â†’ABâ†â†’ABABâ†âˆ’âˆ’ABâˆ’âˆ’â†’ABâ†â†’î…î…“î…’î…‘ABABî…’î…‘î…î…“Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯ABABâ€“â€“â€“â€“ğ´ğµâ†ğ´ğµâ†’ğ´ğµâ†”ğ´ğµâ†ğ´ğµâ†’ğ´ğµâ†”ğ´ğµâğ´ğµâŸğ´ğµÂ¯ğ´ğµ_</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\overleftarrow&#123;AB&#125;</span><br><span class="line">\overrightarrow&#123;AB&#125;</span><br><span class="line">\overleftrightarrow&#123;AB&#125;</span><br><span class="line">\\</span><br><span class="line">\underleftarrow&#123;AB&#125;</span><br><span class="line">\underrightarrow&#123;AB&#125;</span><br><span class="line">\underleftrightarrow&#123;AB&#125;</span><br><span class="line">\\</span><br><span class="line">\overbrace&#123;AB&#125;</span><br><span class="line">\underbrace&#123;AB&#125;</span><br><span class="line">\\</span><br><span class="line">\overline&#123;AB&#125;</span><br><span class="line">\underline&#123;AB&#125;</span><br></pre></td></tr></table></figure><p><strong>ç›–å­å’Œç›’å­</strong></p><p>noteî…î…”î…”î…”î…”î…“î…’î…”î…”î…”î…”î…‘a+b+ca+b+cî…’î…”î…”î…”î…”î…‘î…î…”î…”î…”î…”î…“noteÏ€&#x3D;3.14ğ‘+ğ‘+ğ‘ânoteğ‘+ğ‘+ğ‘âŸnoteğœ‹&#x3D;3.14</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\<span class="keyword">overbrace</span>&#123;a<span class="operator">+</span>b<span class="operator">+</span>c&#125;<span class="operator">^</span>&#123;\<span class="keyword">text</span>&#123;note&#125;&#125;</span><br><span class="line">\\</span><br><span class="line">\<span class="keyword">underbrace</span>&#123;a<span class="operator">+</span>b<span class="operator">+</span>c&#125;<span class="keyword">_</span>&#123;\<span class="keyword">text</span>&#123;note&#125;&#125;</span><br><span class="line">\\</span><br><span class="line">\<span class="keyword">boxed</span>&#123;\pi<span class="operator">=</span><span class="number">3.14</span>&#125;</span><br></pre></td></tr></table></figure><h1 id="å„ç§æ‹¬å·"><a href="#å„ç§æ‹¬å·" class="headerlink" title="å„ç§æ‹¬å·"></a>å„ç§æ‹¬å·</h1><p>((((((((((</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line">\<span class="keyword">big(</span></span><br><span class="line"><span class="keyword"></span>\<span class="keyword">Big(</span></span><br><span class="line"><span class="keyword"></span>\<span class="keyword">bigg(</span></span><br><span class="line"><span class="keyword"></span>\<span class="keyword">Bigg(</span></span><br></pre></td></tr></table></figure><p>[]&lt;&gt;|âˆ’2|{}[]&lt;&gt;|âˆ’2|{}</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line"><span class="tag">&lt;&gt;</span></span><br><span class="line">|-2|</span><br><span class="line">\&#123;\&#125;</span><br></pre></td></tr></table></figure><p>âŸ®xâŸ¯âˆ¥aâˆ¥âŒˆ2.6âŒ‰âŒŠ1.2âŒ‹âŸ®ğ‘¥âŸ¯â€–ğ‘â€–âŒˆ2.6âŒ‰âŒŠ1.2âŒ‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\lgroup x \rgroup</span><br><span class="line">\lVert <span class="selector-tag">a</span> \rVert</span><br><span class="line">\lceil <span class="number">2.6</span> \rceil</span><br><span class="line">\lfloor <span class="number">1.2</span> \rfloor</span><br></pre></td></tr></table></figure><p>â”Œâ”â””â”˜âŒœâŒâŒâŒŸ</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\ulcorner</span><br><span class="line">\urcorner</span><br><span class="line">\<span class="keyword">llcorner</span></span><br><span class="line"><span class="keyword"></span>\lrcorner</span><br></pre></td></tr></table></figure><h1 id="å¸Œè…Šå­—æ¯"><a href="#å¸Œè…Šå­—æ¯" class="headerlink" title="å¸Œè…Šå­—æ¯"></a>å¸Œè…Šå­—æ¯</h1><p><img src="https://img2020.cnblogs.com/blog/2068113/202008/2068113-20200816212452725-1705310605.jpg" alt="å¸Œè…Šå­—æ¯"></p><h1 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h1><p>+âˆ’Ã—&#x2F;Ã·â‹…#%+âˆ’Ã—&#x2F;Ã·â‹…#%</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+</span><br><span class="line">-</span><br><span class="line">\<span class="built_in">times</span></span><br><span class="line">/</span><br><span class="line">\div</span><br><span class="line">\cdot</span><br><span class="line">\<span class="comment">#</span></span><br><span class="line">\%</span><br></pre></td></tr></table></figure><p>âˆ©âˆªâˆ§âˆ¨âŠ”âŠ“âˆ©âˆªâˆ§âˆ¨âŠ”âŠ“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\<span class="built_in">cap</span></span><br><span class="line">\cup</span><br><span class="line">\land</span><br><span class="line">\lor</span><br><span class="line">\sqcup</span><br><span class="line">\sqcap</span><br></pre></td></tr></table></figure><p>âˆ˜âˆ—â‹†âŠ—âŠ•âŠ™âˆ˜âˆ—â‹†âŠ—âŠ•âŠ™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\circ</span><br><span class="line">\ast</span><br><span class="line">\star</span><br><span class="line">\otimes</span><br><span class="line">\oplus</span><br><span class="line">\odot</span><br></pre></td></tr></table></figure><p>Â±âˆ“âˆ”â‹‡Â±âˆ“âˆ”â‹‡</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\pm</span><br><span class="line">\mp</span><br><span class="line">\dotplus</span><br><span class="line">\<span class="keyword">divideontimes</span></span><br></pre></td></tr></table></figure><h1 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h1><p>&#x3D;&#x3D;â‰¡Ì¸â‰ˆâ‰Šâ‰…âˆ¼&#x3D;&#x3D;â‰¢â‰ˆâ‰Šâ‰…âˆ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=</span><br><span class="line">= \not</span><br><span class="line">\equiv</span><br><span class="line">\approx</span><br><span class="line">\approxeq</span><br><span class="line">\cong</span><br><span class="line">\sim</span><br></pre></td></tr></table></figure><p>&lt;&gt;â‰¤â‰¥â‰«â‰ª&lt;&gt;â‰¤â‰¥â‰«â‰ª</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;</span><br><span class="line"><span class="quote">&gt;</span></span><br><span class="line"><span class="quote">\le</span></span><br><span class="line">\ge</span><br><span class="line">\gg</span><br><span class="line">\ll</span><br></pre></td></tr></table></figure><p>â‹â‹Ÿâ‰ºâ‰»âª¯âª°â‹â‹Ÿâ‰ºâ‰»âª¯âª°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\curlyeqprec</span><br><span class="line">\curlyeqsucc</span><br><span class="line">\prec</span><br><span class="line">\succ</span><br><span class="line">\preceq</span><br><span class="line">\succeq</span><br></pre></td></tr></table></figure><h1 id="é›†åˆ-x2F-é€»è¾‘ç›¸å…³"><a href="#é›†åˆ-x2F-é€»è¾‘ç›¸å…³" class="headerlink" title="é›†åˆ&#x2F;é€»è¾‘ç›¸å…³"></a>é›†åˆ&#x2F;é€»è¾‘ç›¸å…³</h1><p>âˆˆâˆ‹âŠ‚Ì¸âŠƒÌ¸âŠ†âŠ‡âˆ©âˆªâˆ§âˆ¨Â¬âˆ…âˆ…âˆµâˆ€âˆƒâˆ´âˆˆâˆ‹âŠ„âŠ…âŠ†âŠ‡âˆ©âˆªâˆ§âˆ¨Â¬âˆ…âˆ…âˆµâˆ€âˆƒâˆ´</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">\in</span><br><span class="line">\owns \not</span><br><span class="line">\<span class="keyword">subset </span>\not</span><br><span class="line">\supset</span><br><span class="line">\<span class="keyword">subseteq</span></span><br><span class="line"><span class="keyword"></span>\supseteq</span><br><span class="line">\\</span><br><span class="line">\cap</span><br><span class="line">\cup</span><br><span class="line">\land</span><br><span class="line">\lor</span><br><span class="line">\\</span><br><span class="line">\neg</span><br><span class="line">\emptyset</span><br><span class="line">\varnothing</span><br><span class="line">\\</span><br><span class="line">\<span class="keyword">because</span></span><br><span class="line"><span class="keyword"></span>\forall</span><br><span class="line">\exists</span><br><span class="line">\therefore</span><br></pre></td></tr></table></figure><h1 id="å„ç§ç®­å¤´"><a href="#å„ç§ç®­å¤´" class="headerlink" title="å„ç§ç®­å¤´"></a>å„ç§ç®­å¤´</h1><p><strong>ç»†ç®­å¤´</strong></p><p>â†â†â†’â†’â†”â†‘â†“â†•â†â†â†’â†’â†”â†‘â†“â†•</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\gets</span><br><span class="line">\leftarrow</span><br><span class="line">\<span class="selector-tag">to</span></span><br><span class="line">\rightarrow</span><br><span class="line">\leftrightarrow</span><br><span class="line">\\</span><br><span class="line">\uparrow</span><br><span class="line">\downarrow</span><br><span class="line">\updownarrow</span><br></pre></td></tr></table></figure><p><strong>ç²—ç®­å¤´</strong></p><p>â‡â‡’â‡”âŸºâ‡‘â‡“â‡•â‡â‡’â‡”âŸºâ‡‘â‡“â‡•</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\Leftarrow</span><br><span class="line">\Rightarrow</span><br><span class="line">\Leftrightarrow</span><br><span class="line">\<span class="keyword">iff</span></span><br><span class="line">\\</span><br><span class="line">\Uparrow</span><br><span class="line">\Downarrow</span><br><span class="line">\Updownarrow</span><br></pre></td></tr></table></figure><p><strong>æ–œç®­å¤´</strong></p><p>â†—â†˜â†™â†–â†—â†˜â†™â†–</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\nearrow</span><br><span class="line">\searrow</span><br><span class="line">\<span class="keyword">swarrow</span></span><br><span class="line"><span class="keyword"></span>\nwarrow</span><br></pre></td></tr></table></figure><p><strong>åŠè¾¹ç®­å¤´</strong></p><p>â†¼â†½â‡€â‡â‡Œâ†¼â†½â‡€â‡â‡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\leftharpoonup</span><br><span class="line">\leftharpoondown</span><br><span class="line">\rightharpoonup</span><br><span class="line">\rightharpoondown</span><br><span class="line">\rightleftharpoons</span><br></pre></td></tr></table></figure><p><strong>ç‰¹æ®Šç®­å¤´</strong></p><p>â†¦â‡â†©â†ªâ†¦â‡â†©â†ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\mapsto</span><br><span class="line">\leadsto</span><br><span class="line">\hookleftarrow</span><br><span class="line">\hookrightarrow</span><br></pre></td></tr></table></figure><p><strong>åŠ é•¿ç®­å¤´</strong></p><p>âŸµâŸ¶âŸ·âŸ¸âŸ¹âŸºâŸ¼âŸµâŸ¶âŸ·âŸ¸âŸ¹âŸºâŸ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\longleftarrow</span><br><span class="line">\longrightarrow</span><br><span class="line">\longleftrightarrow</span><br><span class="line">\Longleftarrow</span><br><span class="line">\Longrightarrow</span><br><span class="line">\Longleftrightarrow</span><br><span class="line">\longmapsto</span><br></pre></td></tr></table></figure><p><strong>å¸¦æ–‡æœ¬ç®­å¤´</strong></p><p>overâˆ’âˆ’â†’âˆ’âˆ’â†’overoverâˆ’âˆ’âˆ’â†’underoverâ†âˆ’âˆ’â†âˆ’âˆ’âˆ’underoverâ†âˆ’âˆ’âˆ’underâ†’ğ‘œğ‘£ğ‘’ğ‘Ÿâ†’ğ‘œğ‘£ğ‘’ğ‘Ÿâ†’ğ‘¢ğ‘›ğ‘‘ğ‘’ğ‘Ÿğ‘œğ‘£ğ‘’ğ‘Ÿâ†ğ‘œğ‘£ğ‘’ğ‘Ÿâ†ğ‘¢ğ‘›ğ‘‘ğ‘’ğ‘Ÿâ†ğ‘¢ğ‘›ğ‘‘ğ‘’ğ‘Ÿğ‘œğ‘£ğ‘’ğ‘Ÿ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\xrightarrow&#123;over&#125;</span><br><span class="line">\xrightarrow<span class="selector-attr">[over]</span>&#123;&#125;</span><br><span class="line">\xrightarrow<span class="selector-attr">[under]</span>&#123;over&#125;</span><br><span class="line">\xleftarrow<span class="selector-attr">[]</span>&#123;over&#125;</span><br><span class="line">\xleftarrow<span class="selector-attr">[under]</span>&#123;&#125;</span><br><span class="line">\xleftarrow<span class="selector-attr">[under]</span>&#123;over&#125;</span><br></pre></td></tr></table></figure><h1 id="ç©ºæ ¼é—´è·"><a href="#ç©ºæ ¼é—´è·" class="headerlink" title="ç©ºæ ¼é—´è·"></a>ç©ºæ ¼é—´è·</h1><p>ABABABABAÂ BABABABğ´ğµğ´ğµğ´ğµğ´ğµğ´Â ğµğ´ğµğ´ğµğ´ğµ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">A\!B</span><br><span class="line">\\</span><br><span class="line">AB</span><br><span class="line">\\</span><br><span class="line">A\thinspace B</span><br><span class="line">\\</span><br><span class="line">A\:B</span><br><span class="line">\\</span><br><span class="line">A\ B</span><br><span class="line">\\</span><br><span class="line">A \enspace B</span><br><span class="line">\\</span><br><span class="line">A\quad B</span><br><span class="line">\\</span><br><span class="line">A\qquad B</span><br></pre></td></tr></table></figure><h1 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h1><p>A&#x3D;abcdğ´&#x3D;ğ‘ğ‘ğ‘ğ‘‘</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A = \<span class="keyword">begin</span>&#123;matrix&#125;</span><br><span class="line">a &amp; b\\</span><br><span class="line">c &amp; d</span><br><span class="line">\<span class="keyword">end</span>&#123;matrix&#125;</span><br></pre></td></tr></table></figure><p>B&#x3D;(abcd)ğµ&#x3D;(ğ‘ğ‘ğ‘ğ‘‘)</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">B </span>= \<span class="keyword">begin&#123;pmatrix&#125;</span></span><br><span class="line"><span class="keyword"></span>a &amp; <span class="keyword">b\\</span></span><br><span class="line"><span class="keyword"></span>c &amp; d</span><br><span class="line">\end&#123;pmatrix&#125;</span><br></pre></td></tr></table></figure><p>C&#x3D;âˆ£âˆ£âˆ£abcdâˆ£âˆ£âˆ£ğ¶&#x3D;|ğ‘ğ‘ğ‘ğ‘‘|</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C = \<span class="keyword">begin</span>&#123;vmatrix&#125;</span><br><span class="line">a &amp; b\\</span><br><span class="line">c &amp; d</span><br><span class="line">\<span class="keyword">end</span>&#123;vmatrix&#125;</span><br></pre></td></tr></table></figure><p>D&#x3D;[abcd]ğ·&#x3D;[ğ‘ğ‘ğ‘ğ‘‘]</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D = \<span class="keyword">begin&#123;bmatrix&#125;</span></span><br><span class="line"><span class="keyword"></span>a &amp; <span class="keyword">b\\</span></span><br><span class="line"><span class="keyword"></span>c &amp; d</span><br><span class="line">\end&#123;<span class="keyword">bmatrix&#125;</span></span><br></pre></td></tr></table></figure><p>E&#x3D;âˆ¥âˆ¥âˆ¥abcdâˆ¥âˆ¥âˆ¥ğ¸&#x3D;â€–ğ‘ğ‘ğ‘ğ‘‘â€–</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">E = \<span class="keyword">begin</span>&#123;Vmatrix&#125;</span><br><span class="line">a &amp; b\\</span><br><span class="line">c &amp; d</span><br><span class="line">\<span class="keyword">end</span>&#123;Vmatrix&#125;</span><br></pre></td></tr></table></figure><p>F&#x3D;{abcd}ğ¹&#x3D;{ğ‘ğ‘ğ‘ğ‘‘}</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F = \<span class="keyword">begin&#123;Bmatrix&#125;</span></span><br><span class="line"><span class="keyword"></span>a &amp; <span class="keyword">b\\</span></span><br><span class="line"><span class="keyword"></span>c &amp; d</span><br><span class="line">\end&#123;<span class="keyword">Bmatrix&#125;</span></span><br></pre></td></tr></table></figure><p>[AÂ b]&#x3D;â¡â¢ â¢â£a11a12a13b1a21a22a23b2a31a32a33b3â¤â¥ â¥â¦[ğ´Â ğ‘]&#x3D;[ğ‘11ğ‘12ğ‘13ğ‘1ğ‘21ğ‘22ğ‘23ğ‘2ğ‘31ğ‘32ğ‘33ğ‘3]</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[A\ b] <span class="operator">=</span> </span><br><span class="line">\<span class="keyword">begin</span>&#123;bmatrix&#125;</span><br><span class="line">\<span class="keyword">begin</span>&#123;array&#125;&#123;c c c<span class="operator">|</span>c&#125;</span><br><span class="line"><span class="keyword">a_</span>&#123;<span class="number">11</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">12</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">13</span>&#125; <span class="operator">&amp;</span> b_1\\</span><br><span class="line"><span class="keyword">a_</span>&#123;<span class="number">21</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">22</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">23</span>&#125; <span class="operator">&amp;</span> b_2\\</span><br><span class="line"><span class="keyword">a_</span>&#123;<span class="number">31</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">32</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">33</span>&#125; <span class="operator">&amp;</span> b_3\\</span><br><span class="line">\<span class="keyword">end</span>&#123;array&#125;</span><br><span class="line">\<span class="keyword">end</span>&#123;bmatrix&#125;</span><br></pre></td></tr></table></figure><p>abcdefghiğ‘ğ‘ğ‘ğ‘‘ğ‘’ğ‘“ğ‘”â„ğ‘–</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\begin&#123;array&#125;&#123;c:c:c&#125;</span><br><span class="line"><span class="selector-tag">a</span> &amp; <span class="selector-tag">b</span> &amp; c \\ </span><br><span class="line">\hline</span><br><span class="line">d &amp; e &amp; f \\</span><br><span class="line">\hdashline</span><br><span class="line"> g &amp; h &amp; <span class="selector-tag">i</span></span><br><span class="line">\end&#123;array&#125;</span><br></pre></td></tr></table></figure><p>LnÃ—n&#x3D;â¡â¢ â¢ â¢ â¢ â¢â£a11a12â‹¯a1na21a22â‹¯a2nâ‹®â‹®â‹±â‹®an1an2â‹¯annâ¤â¥ â¥ â¥ â¥ â¥â¦ğ¿ğ‘›Ã—ğ‘›&#x3D;[ğ‘11ğ‘12â‹¯ğ‘1ğ‘›ğ‘21ğ‘22â‹¯ğ‘2ğ‘›â‹®â‹®â‹±â‹®ğ‘ğ‘›1ğ‘ğ‘›2â‹¯ğ‘ğ‘›ğ‘›]</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">L_&#123;n\times n&#125; <span class="operator">=</span> \<span class="keyword">begin</span>&#123;bmatrix&#125;</span><br><span class="line"><span class="keyword">a_</span>&#123;<span class="number">11</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">12</span>&#125; <span class="operator">&amp;</span> \cdots <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">1</span>n&#125; \\ </span><br><span class="line"><span class="keyword">a_</span>&#123;<span class="number">21</span>&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">22</span>&#125; <span class="operator">&amp;</span> \cdots <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;<span class="number">2</span>n&#125; \\ </span><br><span class="line">\vdots <span class="operator">&amp;</span> \vdots <span class="operator">&amp;</span>\ddots <span class="operator">&amp;</span> \vdots\\</span><br><span class="line"><span class="keyword">a_</span>&#123;n1&#125; <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;n2&#125; <span class="operator">&amp;</span> \cdots <span class="operator">&amp;</span> <span class="keyword">a_</span>&#123;nn&#125; \\ </span><br><span class="line">\<span class="keyword">end</span>&#123;bmatrix&#125;</span><br></pre></td></tr></table></figure><h1 id="åˆ—å¼-x2F-æ–¹ç¨‹ç»„"><a href="#åˆ—å¼-x2F-æ–¹ç¨‹ç»„" class="headerlink" title="åˆ—å¼&#x2F;æ–¹ç¨‹ç»„"></a>åˆ—å¼&#x2F;æ–¹ç¨‹ç»„</h1><p>f(x)&#x3D;(x+1)2&#x3D;x2+2x+1ğ‘“(ğ‘¥)&#x3D;(ğ‘¥+1)2&#x3D;ğ‘¥2+2ğ‘¥+1</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\<span class="keyword">begin</span>&#123;aligned&#125;</span><br><span class="line">f(x) &amp;= (x+<span class="number">1</span>)^<span class="number">2</span>\\</span><br><span class="line">&amp;= x^<span class="number">2</span> + 2x + <span class="number">1</span></span><br><span class="line">\<span class="keyword">end</span>&#123;aligned&#125;</span><br></pre></td></tr></table></figure><p>f(x)&#x3D;{aif bbif ağ‘“(ğ‘¥)&#x3D;{ğ‘if bğ‘if a</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f(x) <span class="operator">=</span> \<span class="keyword">begin</span>&#123;cases&#125;</span><br><span class="line">a <span class="operator">&amp;</span>\<span class="keyword">text</span>&#123;<span class="keyword">if</span> b&#125;\\</span><br><span class="line">b <span class="operator">&amp;</span>\<span class="keyword">text</span>&#123;<span class="keyword">if</span> a&#125;\\</span><br><span class="line">\<span class="keyword">end</span>&#123;cases&#125;</span><br></pre></td></tr></table></figure><p>{x+2y&#x3D;13xâˆ’y&#x3D;5{ğ‘¥+2ğ‘¦&#x3D;13ğ‘¥âˆ’ğ‘¦&#x3D;5</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\<span class="keyword">begin</span>&#123;cases&#125;</span><br><span class="line">\<span class="keyword">begin</span>&#123;aligned&#125;</span><br><span class="line">x + 2y &amp;= <span class="number">1</span>\\</span><br><span class="line">3x - y &amp;= <span class="number">5</span></span><br><span class="line">\<span class="keyword">end</span>&#123;aligned&#125;</span><br><span class="line">\<span class="keyword">end</span>&#123;cases&#125;</span><br></pre></td></tr></table></figure><h1 id="å­—ä½“æ“ä½œ"><a href="#å­—ä½“æ“ä½œ" class="headerlink" title="å­—ä½“æ“ä½œ"></a>å­—ä½“æ“ä½œ</h1><h2 id="ä¿®æ”¹å­—ä½“"><a href="#ä¿®æ”¹å­—ä½“" class="headerlink" title="ä¿®æ”¹å­—ä½“"></a>ä¿®æ”¹å­—ä½“</h2><p><img src="https://img2020.cnblogs.com/blog/2068113/202008/2068113-20200816212537331-1196114732.jpg"></p><h2 id="ä¿®æ”¹å¤§å°"><a href="#ä¿®æ”¹å¤§å°" class="headerlink" title="ä¿®æ”¹å¤§å°"></a>ä¿®æ”¹å¤§å°</h2><p>dABddABğ‘‘ğ´ğµğ‘‘ğ‘‘ğ´ğµ</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\Huge AB</span><br><span class="line">d</span><br><span class="line">\\</span><br><span class="line">d</span><br><span class="line">\<span class="keyword">normalsize </span>AB</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å­—ä½“çš„æ“ä½œå½±å“æ•ˆæœåˆ°è¡Œæœ«ã€‚</p><p>ABABABABABABABABABABğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµğ´ğµ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AB</span><br><span class="line">\Huge AB</span><br><span class="line">\huge AB</span><br><span class="line">\\</span><br><span class="line">AB</span><br><span class="line">\<span class="keyword">LARGE</span> AB</span><br><span class="line">\<span class="keyword">Large</span> AB</span><br><span class="line">\<span class="keyword">large</span> AB</span><br><span class="line">\\</span><br><span class="line">AB</span><br><span class="line">\small AB</span><br><span class="line">\tiny AB</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹é¢œè‰²"><a href="#ä¿®æ”¹é¢œè‰²" class="headerlink" title="ä¿®æ”¹é¢œè‰²"></a>ä¿®æ”¹é¢œè‰²</h2><p>\textcolor{blue}{F&#x3D;ma}<br>\<br>\textcolor</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶é—´</title>
      <link href="/interview/juan/Blind75/leet121/"/>
      <url>/interview/juan/Blind75/leet121/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/description/">Leetcode121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶é—´</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„Â <code>prices</code>Â ï¼Œå®ƒçš„ç¬¬Â <code>i</code>Â ä¸ªå…ƒç´ Â <code>prices[i]</code>Â è¡¨ç¤ºä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬Â <code>i</code>Â å¤©çš„ä»·æ ¼ã€‚</p><p>ä½ åªèƒ½é€‰æ‹©Â <strong>æŸä¸€å¤©</strong>Â ä¹°å…¥è¿™åªè‚¡ç¥¨ï¼Œå¹¶é€‰æ‹©åœ¨Â <strong>æœªæ¥çš„æŸä¸€ä¸ªä¸åŒçš„æ—¥å­</strong>Â å–å‡ºè¯¥è‚¡ç¥¨ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚</p><p>è¿”å›ä½ å¯ä»¥ä»è¿™ç¬”äº¤æ˜“ä¸­è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚å¦‚æœä½ ä¸èƒ½è·å–ä»»ä½•åˆ©æ¶¦ï¼Œè¿”å›Â <code>0</code>Â ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼š[7,1,5,3,6,4]è¾“å‡ºï¼š5è§£é‡Šï¼šåœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = 6-1 = 5 ã€‚ æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ 7-1 = 6, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ï¼›åŒæ—¶ï¼Œä½ ä¸èƒ½åœ¨ä¹°å…¥å‰å–å‡ºè‚¡ç¥¨ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šprices = [7,6,4,3,1]è¾“å‡ºï¼š0è§£é‡Šï¼šåœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= prices.length &lt;= 105</code></li><li><code>0 &lt;= prices[i] &lt;= 104</code></li></ul><p>éå†çš„è¿‡ç¨‹å½“ä¸­æ‰¾åˆ° cost æœ€å°çš„é‚£ä¸€å¤© or é‚£ä¸€å¤©çš„æˆæœ¬ï¼Œç”¨å½“å‰çš„ price å‡å» costï¼Œå°±æ˜¯åœ¨è¿™ä¸€å¤©æ‰€èƒ½è¾¾åˆ°çš„æœ€å¤§æ”¶ç›Š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxProfit</span><span class="params">(prices []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">cost, profit := prices[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, n := <span class="number">0</span>, <span class="built_in">len</span>(prices); i&lt;n; i++ &#123;</span><br><span class="line">cost = min(cost, prices[i])</span><br><span class="line">profit = max(profit, prices[i] - cost)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> profit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span>&#123;</span><br><span class="line"><span class="keyword">if</span> a &lt;= b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"><span class="keyword">if</span> a &gt;= b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.217 å­˜åœ¨é‡å¤å…ƒç´ </title>
      <link href="/interview/juan/Blind75/leet217/"/>
      <url>/interview/juan/Blind75/leet217/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/contains-duplicate/description/">Leetcode.217 å­˜åœ¨é‡å¤å…ƒç´ </a></p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â ã€‚å¦‚æœä»»ä¸€å€¼åœ¨æ•°ç»„ä¸­å‡ºç°Â <strong>è‡³å°‘ä¸¤æ¬¡</strong>Â ï¼Œè¿”å›Â <code>true</code>Â ï¼›å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ äº’ä¸ç›¸åŒï¼Œè¿”å›Â <code>false</code>Â ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [1,2,3,1]è¾“å‡ºï¼štrue</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [1,2,3,4]è¾“å‡ºï¼šfalse</code></pre><p><strong>ç¤ºä¾‹Â 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [1,1,1,3,3,4,3,2,4,2]è¾“å‡ºï¼štrue</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 105</code></li><li><code>-109 &lt;= nums[i] &lt;= 109</code></li></ul><p>å“ˆå¸Œè¡¨ï¼Œç§’äº†ï¼<br>ç›´æ¥æ’åºï¼Œç§’äº†ï¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">containsDuplicate</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123; </span><br><span class="line">sort.Ints(nums) </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(nums); i++ &#123; </span><br><span class="line"><span class="keyword">if</span> nums[i] == nums[i<span class="number">-1</span>] &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">containsDuplicate</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123; </span><br><span class="line">set := <span class="keyword">map</span>[<span class="type">int</span>]<span class="keyword">struct</span>&#123;&#125;&#123;&#125; </span><br><span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> nums &#123; </span><br><span class="line"><span class="keyword">if</span> _, has := set[v]; has &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">&#125; </span><br><span class="line">set[v] = <span class="keyword">struct</span>&#123;&#125;&#123;&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.238 é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</title>
      <link href="/interview/juan/Blind75/leet238/"/>
      <url>/interview/juan/Blind75/leet238/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/product-of-array-except-self/description/">Leetcode.238 é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</a></p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>ï¼Œè¿”å›Â <em>æ•°ç»„Â <code>answer</code>Â ï¼Œå…¶ä¸­Â <code>answer[i]</code>Â ç­‰äºÂ <code>nums</code>Â ä¸­é™¤Â <code>nums[i]</code>Â ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯</em>Â ã€‚</p><p>é¢˜ç›®æ•°æ®Â <strong>ä¿è¯</strong>Â æ•°ç»„Â <code>nums</code>ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€çš„ä¹˜ç§¯éƒ½åœ¨Â Â <strong>32 ä½</strong>Â æ•´æ•°èŒƒå›´å†…ã€‚</p><p>è¯·Â <strong>ä¸è¦ä½¿ç”¨é™¤æ³•ï¼Œ</strong>ä¸”åœ¨Â <code>O(_n_)</code>Â æ—¶é—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code>è¾“å…¥: nums = `[1,2,3,4]`è¾“å‡º: `[24,12,8,6]`</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code>è¾“å…¥: nums = [-1,1,0,-3,3]è¾“å‡º: [0,0,9,0,0]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>2 &lt;= nums.length &lt;= 105</code></li><li><code>-30 &lt;= nums[i] &lt;= 30</code></li><li><strong>ä¿è¯</strong>Â æ•°ç»„Â <code>nums</code>ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€çš„ä¹˜ç§¯éƒ½åœ¨Â Â <strong>32 ä½</strong>Â æ•´æ•°èŒƒå›´å†…</li></ul><p><strong>è¿›é˜¶ï¼š</strong>ä½ å¯ä»¥åœ¨Â <code>O(1)</code>Â çš„é¢å¤–ç©ºé—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸ªé¢˜ç›®å—ï¼Ÿï¼ˆ å‡ºäºå¯¹ç©ºé—´å¤æ‚åº¦åˆ†æçš„ç›®çš„ï¼Œè¾“å‡ºæ•°ç»„Â <strong>ä¸è¢«è§†ä¸º</strong>Â é¢å¤–ç©ºé—´ã€‚ï¼‰</p><p>ä¸»è¦æ€è·¯æ˜¯æƒ³åŠæ³•è®¡ç®—å½“å‰ä½ç½®çš„å‰ç¼€å’Œåç¼€ä¹˜ç§¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">productExceptSelf</span><span class="params">(nums []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">length := <span class="built_in">len</span>(nums)</span><br><span class="line">ans := <span class="built_in">make</span>([]<span class="type">int</span>, length)</span><br><span class="line"><span class="keyword">var</span> x <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ans[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å› ä¸ºç´¢å¼•ä¸º &#x27;0&#x27; çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ ans[0] = 1</span></span><br><span class="line">ans[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">1</span>; i&lt;<span class="built_in">len</span>(nums); i++ &#123;</span><br><span class="line">ans[i] = nums[i<span class="number">-1</span>] * ans[i<span class="number">-1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// x ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line"><span class="comment">// åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ x = 1</span></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> j:=length<span class="number">-1</span>; j &gt;=<span class="number">0</span>; j-- &#123;</span><br><span class="line"><span class="comment">// å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º ans[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º x</span></span><br><span class="line">ans[j] = ans[j] * x</span><br><span class="line"><span class="comment">// x éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° x ä¸Š</span></span><br><span class="line">x = nums[j] * x</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode53. æœ€å¤§å­æ•°ç»„å’Œ</title>
      <link href="/interview/juan/Blind75/leet53/"/>
      <url>/interview/juan/Blind75/leet53/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/maximum-subarray/description/">Leetcode53. æœ€å¤§å­æ•°ç»„å’Œ</a></p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â ï¼Œè¯·ä½ æ‰¾å‡ºä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚</p><p><strong>å­æ•°ç»„</strong></p><p>æ˜¯æ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­éƒ¨åˆ†ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [-2,1,-3,4,-1,2,1,-5,4]è¾“å‡ºï¼š6è§£é‡Šï¼šè¿ç»­å­æ•°ç»„Â [4,-1,2,1] çš„å’Œæœ€å¤§ï¼Œä¸ºÂ 6 ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [1]è¾“å‡ºï¼š1</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [5,4,-1,7,8]è¾“å‡ºï¼š23</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 105</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li></ul><p>æ€è·¯å’Œç®—æ³•</p><p>å‡è®¾ nums æ•°ç»„çš„é•¿åº¦æ˜¯ nï¼Œä¸‹æ ‡ä» 0 åˆ° nâˆ’1ã€‚</p><p>æˆ‘ä»¬ç”¨ f(i) ä»£è¡¨ä»¥ç¬¬ i ä¸ªæ•°ç»“å°¾çš„ã€Œè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œã€ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶æˆ‘ä»¬è¦æ±‚çš„ç­”æ¡ˆå°±æ˜¯ï¼š</p><p>$$max0â‰¤iâ‰¤nâˆ’1â€‹{f(i)}$$</p><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦æ±‚å‡ºæ¯ä¸ªä½ç½®çš„ f(i)ï¼Œç„¶åè¿”å› f æ•°ç»„ä¸­çš„æœ€å¤§å€¼å³å¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ±‚ f(i)f(i)f(i) å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è€ƒè™‘ nums[i] å•ç‹¬æˆä¸ºä¸€æ®µè¿˜æ˜¯åŠ å…¥ f(iâˆ’1) å¯¹åº”çš„é‚£ä¸€æ®µï¼Œè¿™å–å†³äº nums[i] å’Œ f(iâˆ’1)+nums[i] çš„å¤§å°ï¼Œæˆ‘ä»¬å¸Œæœ›è·å¾—ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ï¼Œäºæ˜¯å¯ä»¥å†™å‡ºè¿™æ ·çš„åŠ¨æ€è§„åˆ’è½¬ç§»æ–¹ç¨‹ï¼š</p><p>$$f(i)&#x3D;max{f(iâˆ’1)+nums[i],nums[i]}$$</p><p>ä¸éš¾ç»™å‡ºä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ O(n)ã€ç©ºé—´å¤æ‚åº¦ O(n) çš„å®ç°ï¼Œå³ç”¨ä¸€ä¸ª f æ•°ç»„æ¥ä¿å­˜ f(i) çš„å€¼ï¼Œç”¨ä¸€ä¸ªå¾ªç¯æ±‚å‡ºæ‰€æœ‰ f(i)ã€‚è€ƒè™‘åˆ° f(i) åªå’Œ f(iâˆ’1) ç›¸å…³ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åªç”¨ä¸€ä¸ªå˜é‡ pre æ¥ç»´æŠ¤å¯¹äºå½“å‰ f(i) çš„ f(iâˆ’1) çš„å€¼æ˜¯å¤šå°‘ï¼Œä»è€Œè®©ç©ºé—´å¤æ‚åº¦é™ä½åˆ° O(1)ï¼Œè¿™æœ‰ç‚¹ç±»ä¼¼ã€Œæ»šåŠ¨æ•°ç»„ã€çš„æ€æƒ³ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxSubArray</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123; </span><br><span class="line">max := nums[<span class="number">0</span>] </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(nums); i++ &#123; </span><br><span class="line"><span class="keyword">if</span> nums[i] + nums[i<span class="number">-1</span>] &gt; nums[i] &#123; </span><br><span class="line">nums[i] += nums[i<span class="number">-1</span>] </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span> nums[i] &gt; max &#123; </span><br><span class="line">max = nums[i] </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> max </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// -2,1,-3,4,-1,2,1,-5,4</span></span><br><span class="line"><span class="comment">// -2,1,-2,4,3,5,6,1,5</span></span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´å°±æ˜¯çœ‹å‰ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¤§äº 0 ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶ï¼Œé‚£ä¹ˆå°±åŠ åˆ°å½“å‰ä½ç½®ä¸Š</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.152 ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</title>
      <link href="/interview/juan/Blind75/leet152/"/>
      <url>/interview/juan/Blind75/leet152/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/maximum-product-subarray/description/">Leetcode.152 ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</a></p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â ï¼Œè¯·ä½ æ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯æœ€å¤§çš„éç©ºè¿ç»­å­æ•°ç»„ï¼ˆè¯¥å­æ•°ç»„ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œå¹¶è¿”å›è¯¥å­æ•°ç»„æ‰€å¯¹åº”çš„ä¹˜ç§¯ã€‚</p><p>æµ‹è¯•ç”¨ä¾‹çš„ç­”æ¡ˆæ˜¯ä¸€ä¸ªÂ <strong>32-ä½</strong>Â æ•´æ•°ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code>è¾“å…¥: nums = [2,3,-2,4]è¾“å‡º: 6è§£é‡Š:Â å­æ•°ç»„ [2,3] æœ‰æœ€å¤§ä¹˜ç§¯ 6ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code>è¾“å…¥: nums = [-2,0,-1]è¾“å‡º: 0è§£é‡Š:Â ç»“æœä¸èƒ½ä¸º 2, å› ä¸º [-2,-1] ä¸æ˜¯å­æ•°ç»„ã€‚</code></pre><p><strong>æç¤º:</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 2 * 104</code></li><li><code>-10 &lt;= nums[i] &lt;= 10</code></li><li><code>nums</code>Â çš„ä»»ä½•å‰ç¼€æˆ–åç¼€çš„ä¹˜ç§¯éƒ½Â <strong>ä¿è¯</strong>Â æ˜¯ä¸€ä¸ªÂ <strong>32-ä½</strong>Â æ•´æ•°</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.153 å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</title>
      <link href="/interview/juan/Blind75/leet153/"/>
      <url>/interview/juan/Blind75/leet153/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/find-minimum-in-rotated-sorted-array/">Leetcode.153 å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</a></p><p>å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸ºÂ <code>n</code>Â çš„æ•°ç»„ï¼Œé¢„å…ˆæŒ‰ç…§å‡åºæ’åˆ—ï¼Œç»ç”±Â <code>1</code>Â åˆ°Â <code>n</code>Â æ¬¡Â <strong>æ—‹è½¬</strong>Â åï¼Œå¾—åˆ°è¾“å…¥æ•°ç»„ã€‚ä¾‹å¦‚ï¼ŒåŸæ•°ç»„Â <code>nums = [0,1,2,4,5,6,7]</code>Â åœ¨å˜åŒ–åå¯èƒ½å¾—åˆ°ï¼š</p><ul><li>è‹¥æ—‹è½¬Â <code>4</code>Â æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ°Â <code>[4,5,6,7,0,1,2]</code></li><li>è‹¥æ—‹è½¬Â <code>7</code>Â æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ°Â <code>[0,1,2,4,5,6,7]</code></li></ul><p>æ³¨æ„ï¼Œæ•°ç»„Â <code>[a[0], a[1], a[2], ..., a[n-1]]</code>Â <strong>æ—‹è½¬ä¸€æ¬¡</strong>Â çš„ç»“æœä¸ºæ•°ç»„Â <code>[a[n-1], a[0], a[1], a[2], ..., a[n-2]]</code>Â ã€‚</p><p>ç»™ä½ ä¸€ä¸ªå…ƒç´ å€¼Â <strong>äº’ä¸ç›¸åŒ</strong>Â çš„æ•°ç»„Â <code>nums</code>Â ï¼Œå®ƒåŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•°ç»„ï¼Œå¹¶æŒ‰ä¸Šè¿°æƒ…å½¢è¿›è¡Œäº†å¤šæ¬¡æ—‹è½¬ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ•°ç»„ä¸­çš„Â <strong>æœ€å°å…ƒç´ </strong>Â ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸ºÂ <code>O(log n)</code>Â çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [3,4,5,1,2]è¾“å‡ºï¼š1è§£é‡Šï¼šåŸæ•°ç»„ä¸º [1,2,3,4,5] ï¼Œæ—‹è½¬ 3 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2]è¾“å‡ºï¼š0è§£é‡Šï¼šåŸæ•°ç»„ä¸º [0,1,2,4,5,6,7] ï¼Œæ—‹è½¬ 3 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [11,13,15,17]è¾“å‡ºï¼š11è§£é‡Šï¼šåŸæ•°ç»„ä¸º [11,13,15,17] ï¼Œæ—‹è½¬ 4 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>n == nums.length</code></li><li><code>1 &lt;= n &lt;= 5000</code></li><li><code>-5000 &lt;= nums[i] &lt;= 5000</code></li><li><code>nums</code>Â ä¸­çš„æ‰€æœ‰æ•´æ•°Â <strong>äº’ä¸ç›¸åŒ</strong></li><li><code>nums</code>Â åŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åºçš„æ•°ç»„ï¼Œå¹¶è¿›è¡Œäº†Â <code>1</code>Â è‡³Â <code>n</code>Â æ¬¡æ—‹è½¬</li></ul><p>ç±»æ¯” <a href="https://leetcode.cn/problems/search-in-rotated-sorted-array/description/">Leetcode.33 æœç´¢æ—‹è½¬æ’åºæ•°ç»„</a> ä¹Ÿå¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ€è·¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findMin</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">low, high := <span class="number">0</span>, <span class="built_in">len</span>(nums) - <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> low &lt; high &#123;</span><br><span class="line">pivot := low + (high - low) / <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> nums[pivot] &lt; nums[high] &#123;</span><br><span class="line">high = pivot</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">low = pivot + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> nums[low]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.33 æœç´¢æ—‹è½¬æ’åºæ•°ç»„</title>
      <link href="/interview/juan/Blind75/leet33/"/>
      <url>/interview/juan/Blind75/leet33/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/search-in-rotated-sorted-array/description/">Leetcode.33 æœç´¢æ—‹è½¬æ’åºæ•°ç»„</a></p><p>æ•´æ•°æ•°ç»„Â <code>nums</code>Â æŒ‰å‡åºæ’åˆ—ï¼Œæ•°ç»„ä¸­çš„å€¼Â <strong>äº’ä¸ç›¸åŒ</strong>Â ã€‚</p><p>åœ¨ä¼ é€’ç»™å‡½æ•°ä¹‹å‰ï¼Œ<code>nums</code>Â åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡Â <code>k</code>ï¼ˆ<code>0 &lt;= k &lt; nums.length</code>ï¼‰ä¸Šè¿›è¡Œäº†Â <strong>æ—‹è½¬</strong>ï¼Œä½¿æ•°ç»„å˜ä¸ºÂ <code>[nums[k], nums[k+1], ..., nums[n-1], nums[0], nums[1], ..., nums[k-1]]</code>ï¼ˆä¸‹æ ‡Â <strong>ä» 0 å¼€å§‹</strong>Â è®¡æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼ŒÂ <code>[0,1,2,4,5,6,7]</code>Â åœ¨ä¸‹æ ‡Â <code>3</code>Â å¤„ç»æ—‹è½¬åå¯èƒ½å˜ä¸ºÂ <code>[4,5,6,7,0,1,2]</code>Â ã€‚</p><p>ç»™ä½ Â <strong>æ—‹è½¬å</strong>Â çš„æ•°ç»„Â <code>nums</code>Â å’Œä¸€ä¸ªæ•´æ•°Â <code>target</code>Â ï¼Œå¦‚æœÂ <code>nums</code>Â ä¸­å­˜åœ¨è¿™ä¸ªç›®æ ‡å€¼Â <code>target</code>Â ï¼Œåˆ™è¿”å›å®ƒçš„ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å›Â <code>-1</code>Â ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸ºÂ <code>O(log n)</code>Â çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [`4,5,6,7,0,1,2]`, target = 0è¾“å‡ºï¼š4</code></pre><p><strong>ç¤ºä¾‹Â 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [`4,5,6,7,0,1,2]`, target = 3è¾“å‡ºï¼š-1</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [1], target = 0è¾“å‡ºï¼š-1</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 5000</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li><li><code>nums</code>Â ä¸­çš„æ¯ä¸ªå€¼éƒ½Â <strong>ç‹¬ä¸€æ— äºŒ</strong></li><li>é¢˜ç›®æ•°æ®ä¿è¯Â <code>nums</code>Â åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡ä¸Šè¿›è¡Œäº†æ—‹è½¬</li><li><code>-104 &lt;= target &lt;= 104</code></li></ul><p>äºŒåˆ†æŸ¥æ‰¾å—·</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">search</span><span class="params">(nums []<span class="type">int</span>, target <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(nums) == <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line">l, r := <span class="number">0</span>, <span class="built_in">len</span>(nums)<span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> l&lt;=r &#123;</span><br><span class="line">mid=(l+r)/<span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> nums[mid] == target &#123;</span><br><span class="line"><span class="keyword">return</span> mid</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> nums[<span class="number">0</span>] &lt;= target &lt; nums[mid] &#123;</span><br><span class="line"><span class="keyword">if</span> nums[<span class="number">0</span>] &lt;= nums[mid] &#123;</span><br><span class="line">r = mid - <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">l = mid + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> nums[mid] &lt; target &lt;= nums[<span class="built_in">len</span>(nums) - <span class="number">1</span>] &#123;</span><br><span class="line">l = mid + <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">r = mid - <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€è·¯å’Œç®—æ³•</p><p>å¯¹äºæœ‰åºæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•æŸ¥æ‰¾å…ƒç´ ã€‚</p><p>ä½†æ˜¯è¿™é“é¢˜ä¸­ï¼Œæ•°ç»„æœ¬èº«ä¸æ˜¯æœ‰åºçš„ï¼Œè¿›è¡Œæ—‹è½¬ååªä¿è¯äº†æ•°ç»„çš„å±€éƒ¨æ˜¯æœ‰åºçš„ï¼Œè¿™è¿˜èƒ½è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾å—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚</p><p>å¯ä»¥å‘ç°çš„æ˜¯ï¼Œæˆ‘ä»¬å°†æ•°ç»„ä»ä¸­é—´åˆ†å¼€æˆå·¦å³ä¸¤éƒ¨åˆ†çš„æ—¶å€™ï¼Œä¸€å®šæœ‰ä¸€éƒ¨åˆ†çš„æ•°ç»„æ˜¯æœ‰åºçš„ã€‚æ‹¿ç¤ºä¾‹æ¥çœ‹ï¼Œæˆ‘ä»¬ä» 6 è¿™ä¸ªä½ç½®åˆ†å¼€ä»¥åæ•°ç»„å˜æˆäº† [4, 5, 6] å’Œ [7, 0, 1, 2] ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­å·¦è¾¹ [4, 5, 6] è¿™ä¸ªéƒ¨åˆ†çš„æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œå…¶ä»–ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>è¿™å¯ç¤ºæˆ‘ä»¬å¯ä»¥åœ¨å¸¸è§„äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™æŸ¥çœ‹å½“å‰ mid ä¸ºåˆ†å‰²ä½ç½®åˆ†å‰²å‡ºæ¥çš„ä¸¤ä¸ªéƒ¨åˆ† [l, mid] å’Œ [mid + 1, r] å“ªä¸ªéƒ¨åˆ†æ˜¯æœ‰åºçš„ï¼Œå¹¶æ ¹æ®æœ‰åºçš„é‚£ä¸ªéƒ¨åˆ†ç¡®å®šæˆ‘ä»¬è¯¥å¦‚ä½•æ”¹å˜äºŒåˆ†æŸ¥æ‰¾çš„ä¸Šä¸‹ç•Œï¼Œå› ä¸ºæˆ‘ä»¬èƒ½å¤Ÿæ ¹æ®æœ‰åºçš„é‚£éƒ¨åˆ†åˆ¤æ–­å‡º target åœ¨ä¸åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼š</p><p>å¦‚æœ [l, mid - 1] æ˜¯æœ‰åºæ•°ç»„ï¼Œä¸” target çš„å¤§å°æ»¡è¶³ [nums[l],nums[mid])[\textit{nums}[l],\textit{nums}[mid])[nums[l],nums[mid])ï¼Œåˆ™æˆ‘ä»¬åº”è¯¥å°†æœç´¢èŒƒå›´ç¼©å°è‡³ [l, mid - 1]ï¼Œå¦åˆ™åœ¨ [mid + 1, r] ä¸­å¯»æ‰¾ã€‚<br>å¦‚æœ [mid, r] æ˜¯æœ‰åºæ•°ç»„ï¼Œä¸” target çš„å¤§å°æ»¡è¶³ (nums[mid+1],nums[r]](\textit{nums}[mid+1],\textit{nums}[r]](nums[mid+1],nums[r]]ï¼Œåˆ™æˆ‘ä»¬åº”è¯¥å°†æœç´¢èŒƒå›´ç¼©å°è‡³ [mid + 1, r]ï¼Œå¦åˆ™åœ¨ [l, mid - 1] ä¸­å¯»æ‰¾ã€‚</p><p><img src="https://assets.leetcode-cn.com/solution-static/33/33_fig1.png"></p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.15 ä¸‰æ•°ä¹‹å’Œ</title>
      <link href="/interview/juan/Blind75/leet15/"/>
      <url>/interview/juan/Blind75/leet15/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/3sum/description/">Leetcode.15 ä¸‰æ•°ä¹‹å’Œ</a></p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„Â <code>[nums[i], nums[j], nums[k]]</code>Â æ»¡è¶³Â <code>i != j</code>ã€<code>i != k</code>Â ä¸”Â <code>j != k</code>Â ï¼ŒåŒæ—¶è¿˜æ»¡è¶³Â <code>nums[i] + nums[j] + nums[k] == 0</code>Â ã€‚è¯·</p><p>ä½ è¿”å›æ‰€æœ‰å’Œä¸ºÂ <code>0</code>Â ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [-1,0,1,2,-1,-4]è¾“å‡ºï¼š[[-1,-1,2],[-1,0,1]]è§£é‡Šï¼šnums[0] + nums[1] + nums[2] = (-1) + 0 + 1 = 0 ã€‚nums[1] + nums[2] + nums[4] = 0 + 1 + (-1) = 0 ã€‚nums[0] + nums[3] + nums[4] = (-1) + 2 + (-1) = 0 ã€‚ä¸åŒçš„ä¸‰å…ƒç»„æ˜¯ [-1,0,1] å’Œ [-1,-1,2] ã€‚æ³¨æ„ï¼Œè¾“å‡ºçš„é¡ºåºå’Œä¸‰å…ƒç»„çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [0,1,1]è¾“å‡ºï¼š[]è§£é‡Šï¼šå”¯ä¸€å¯èƒ½çš„ä¸‰å…ƒç»„å’Œä¸ä¸º 0 ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [0,0,0]è¾“å‡ºï¼š[[0,0,0]]è§£é‡Šï¼šå”¯ä¸€å¯èƒ½çš„ä¸‰å…ƒç»„å’Œä¸º 0 ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>3 &lt;= nums.length &lt;= 3000</code></li><li><code>-105 &lt;= nums[i] &lt;= 105</code></li></ul><h3 id="æ€è·¯è§£æ"><a href="#æ€è·¯è§£æ" class="headerlink" title="æ€è·¯è§£æ"></a>æ€è·¯è§£æ</h3><p>æµç¨‹å¯ä»¥å‚è€ƒ <a href="https://leetcode.cn/problems/two-sum/">ä¸¤æ•°ä¹‹å’Œ</a> å’Œ <a href="https://leetcode.cn/problems/two-sum-ii-input-array-is-sorted/description/">ä¸¤æ•°ä¹‹å’Œ II</a></p><p>è®¾ç½® aï¼Œbï¼Œc ä¸‰ä¸ªæŒ‡é’ˆï¼Œé¦–å…ˆå›ºå®š a æŒ‡é’ˆï¼Œå¯ä»¥ç¡®å®šå½“å‰ç›®æ ‡æ±‚å’Œä¸º - nums[a]<br>åœ¨ a æŒ‡é’ˆåç»­çš„ä½ç½®è®¾ç½® b æŒ‡é’ˆï¼Œé€šè¿‡ c æŒ‡é’ˆéå† b åé¢çš„ä½ç½®ï¼Œç¡®å®šç¬¦åˆçš„ä¸‰å…ƒç»„<br>c æŒ‡é’ˆéå†ä¸€è½®ä¹‹åï¼Œå¯ä»¥å°† b æŒ‡é’ˆå‘åç§»åŠ¨ï¼Œç›´åˆ°å½“å‰ä» a æŒ‡é’ˆå‡ºå‘çš„æ‰€æœ‰ä¸‰å…ƒç»„éƒ½è¢«æ‰¾åˆ°<br>ç„¶åå†ç§»åŠ¨ a æŒ‡é’ˆ</p><p>æ¯”è¾ƒå…³é”®çš„ç‚¹æ˜¯ï¼Œç»“æœä¸­çš„ä¸‰å…ƒç»„ä¸èƒ½é‡å¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å…ˆæ’åºçš„æ–¹æ³•ï¼Œåœ¨æ±‚è§£è¿‡ç¨‹ä¸­æå‰å°†é‡å¤ç»“æœè¿‡æ»¤æ‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">threeSum</span><span class="params">(nums []<span class="type">int</span>)</span></span> [][]<span class="type">int</span> &#123; </span><br><span class="line">n := <span class="built_in">len</span>(nums) </span><br><span class="line">sort.Ints(nums) </span><br><span class="line">ans := <span class="built_in">make</span>([][]<span class="type">int</span>, <span class="number">0</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">// æšä¸¾ a </span></span><br><span class="line"><span class="keyword">for</span> first := <span class="number">0</span>; first &lt; n; first++ &#123; </span><br><span class="line"><span class="comment">// éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ </span></span><br><span class="line"><span class="keyword">if</span> first &gt; <span class="number">0</span> &amp;&amp; nums[first] == nums[first - <span class="number">1</span>] &#123; </span><br><span class="line"><span class="keyword">continue</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// c å¯¹åº”çš„æŒ‡é’ˆåˆå§‹æŒ‡å‘æ•°ç»„çš„æœ€å³ç«¯ </span></span><br><span class="line">third := n - <span class="number">1</span> </span><br><span class="line">target := <span class="number">-1</span> * nums[first] </span><br><span class="line"><span class="comment">// æšä¸¾ b </span></span><br><span class="line"><span class="keyword">for</span> second := first + <span class="number">1</span>; second &lt; n; second++ &#123; </span><br><span class="line"><span class="comment">// éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ </span></span><br><span class="line"><span class="keyword">if</span> second &gt; first + <span class="number">1</span> &amp;&amp; nums[second] == nums[second - <span class="number">1</span>] &#123; </span><br><span class="line"><span class="keyword">continue</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// éœ€è¦ä¿è¯ b çš„æŒ‡é’ˆåœ¨ c çš„æŒ‡é’ˆçš„å·¦ä¾§ </span></span><br><span class="line"><span class="keyword">for</span> second &lt; third &amp;&amp; nums[second] + nums[third] &gt; target &#123; </span><br><span class="line">third-- </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// å¦‚æœæŒ‡é’ˆé‡åˆï¼Œéšç€ b åç»­çš„å¢åŠ  </span></span><br><span class="line"><span class="comment">// å°±ä¸ä¼šæœ‰æ»¡è¶³ a+b+c=0 å¹¶ä¸” b&lt;c çš„ c äº†ï¼Œå¯ä»¥é€€å‡ºå¾ªç¯ </span></span><br><span class="line"><span class="keyword">if</span> second == third &#123; </span><br><span class="line"><span class="keyword">break</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span> nums[second] + nums[third] == target &#123; </span><br><span class="line">ans = <span class="built_in">append</span>(ans, []<span class="type">int</span>&#123;nums[first], nums[second], nums[third]&#125;) </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> ans </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.11 ç››æœ€å¤šæ°´çš„å®¹å™¨</title>
      <link href="/interview/juan/Blind75/leet11/"/>
      <url>/interview/juan/Blind75/leet11/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/container-with-most-water/description/">Leetcode.11 ç››æœ€å¤šæ°´çš„å®¹å™¨</a></p><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºÂ <code>n</code>Â çš„æ•´æ•°æ•°ç»„Â <code>height</code>Â ã€‚æœ‰Â <code>n</code>Â æ¡å‚çº¿ï¼Œç¬¬Â <code>i</code>Â æ¡çº¿çš„ä¸¤ä¸ªç«¯ç‚¹æ˜¯Â <code>(i, 0)</code>Â å’ŒÂ <code>(i, height[i])</code>Â ã€‚</p><p>æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸Â <code>x</code>Â è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p><p>è¿”å›å®¹å™¨å¯ä»¥å‚¨å­˜çš„æœ€å¤§æ°´é‡ã€‚</p><p><strong>è¯´æ˜ï¼š</strong>ä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg"></p><pre><code>è¾“å…¥ï¼š[1,8,6,2,5,4,8,3,7]è¾“å‡ºï¼š49 è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸ºÂ 49ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šheight = [1,1]è¾“å‡ºï¼š1</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>n == height.length</code></li><li><code>2 &lt;= n &lt;= 105</code></li><li><code>0 &lt;= height[i] &lt;= 104</code></li></ul><p>é‡‡ç”¨åŒæŒ‡é’ˆæ–¹å¼ï¼Œæ¯æ¬¡ç§»åŠ¨çŸ­è¾¹<br>ç§»åŠ¨çŸ­è¾¹å¯èƒ½å˜å¾—æ›´å¥½ï¼Œä¸€å®šä¸ä¼šå˜å¾—æ›´å</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxArea</span><span class="params">(height []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">l, r := <span class="number">0</span>, <span class="built_in">len</span>(height)<span class="number">-1</span></span><br><span class="line">ans := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> l&lt;r &#123;</span><br><span class="line">area := min(height[l], height[r]) * (r-l)</span><br><span class="line">ans = max(area, ans)</span><br><span class="line"><span class="keyword">if</span> height[l] &lt;= height[r] &#123;</span><br><span class="line">l += <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">r -= <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode.1 ä¸¤æ•°ä¹‹å’Œ</title>
      <link href="/interview/juan/Blind75/leet1/"/>
      <url>/interview/juan/Blind75/leet1/</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/two-sum/description/">Leetcode.1 ä¸¤æ•°ä¹‹å’Œ</a></p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼Â <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºÂ <strong>å’Œä¸ºç›®æ ‡å€¼</strong>Â <em><code>target</code></em>Â  çš„é‚£Â <strong>ä¸¤ä¸ª</strong>Â æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚<br>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚<br>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [2,7,11,15], target = 9è¾“å‡ºï¼š[0,1]è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] == 9 ï¼Œè¿”å› [0, 1] ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [3,2,4], target = 6è¾“å‡ºï¼š[1,2]</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code>è¾“å…¥ï¼šnums = [3,3], target = 6è¾“å‡ºï¼š[0,1]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>2 &lt;= nums.length &lt;= 104</code></li><li><code>-109 &lt;= nums[i] &lt;= 109</code></li><li><code>-109 &lt;= target &lt;= 109</code></li></ul><p>æš´åŠ›æ³• O(N^2)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">twoSum</span><span class="params">(nums []<span class="type">int</span>, target <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line"><span class="keyword">for</span> first:=<span class="number">0</span>; first&lt;<span class="built_in">len</span>(nums)<span class="number">-1</span>; first++ &#123;</span><br><span class="line"><span class="keyword">for</span> second := first + <span class="number">1</span>; second&lt;<span class="built_in">len</span>(nums); second ++ &#123;</span><br><span class="line"><span class="keyword">if</span> nums[first] + nums[second] == target &#123;</span><br><span class="line"><span class="keyword">return</span> []<span class="type">int</span>&#123;first, second&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> []<span class="type">int</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“ˆå¸Œæ³• O(N)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">twoSum</span><span class="params">(nums []<span class="type">int</span>, target <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">hashTable := <span class="keyword">map</span>[<span class="type">int</span>]<span class="type">int</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i, x := <span class="keyword">range</span> nums &#123;</span><br><span class="line">        <span class="keyword">if</span> p, ok := hashTable[target-x]; ok &#123;</span><br><span class="line">            <span class="keyword">return</span> []<span class="type">int</span>&#123;p, i&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        hashTable[x] = i</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> []<span class="type">int</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> Blind75 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>go å…«è‚¡</title>
      <link href="/interview/go/go-EightPartFrame/"/>
      <url>/interview/go/go-EightPartFrame/</url>
      
        <content type="html"><![CDATA[<h2 id="Sync-map"><a href="#Sync-map" class="headerlink" title="Sync.map"></a>Sync.map</h2><h4 id="golang-ä¸­åŸç”Ÿçš„-map-æœ¬èº«æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹æ–¹é¢ï¼š"><a href="#golang-ä¸­åŸç”Ÿçš„-map-æœ¬èº«æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹æ–¹é¢ï¼š" class="headerlink" title="golang ä¸­åŸç”Ÿçš„ map æœ¬èº«æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹æ–¹é¢ï¼š"></a>golang ä¸­åŸç”Ÿçš„ map æœ¬èº«æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹æ–¹é¢ï¼š</h4><ol><li>å¯¹äº map ç»“æ„çš„å¹¶å‘è®¿é—®ï¼Œä¼šæŠ¥é”™ panicã€‚</li><li>å³ä½¿é€šè¿‡æŸç§æ–¹å¼ä¸åŒæ—¶å†™ä¸€ä¸ª keyï¼Œåœ¨ map æ‰©å®¹çš„æ—¶å€™ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œå› ä¸º map çš„æ‰©å®¹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</li></ol><h4 id="sync-Map-ç›¸å¯¹-map-çš„ä¼˜åŠ¿ï¼š"><a href="#sync-Map-ç›¸å¯¹-map-çš„ä¼˜åŠ¿ï¼š" class="headerlink" title="sync.Map ç›¸å¯¹ map çš„ä¼˜åŠ¿ï¼š"></a>sync.Map ç›¸å¯¹ map çš„ä¼˜åŠ¿ï¼š</h4><ol><li>ä¸€å†™å¤šè¯»</li><li>ç©ºé—´æ¢æ—¶é—´ &#x3D; read å’Œ dirty</li><li>double-checking</li><li>ç¼“å­˜æ€è·¯</li><li>å»¶æ—¶åˆ é™¤</li></ol><h4 id="å…³äº-dirty-çš„æå‡"><a href="#å…³äº-dirty-çš„æå‡" class="headerlink" title="å…³äº dirty çš„æå‡"></a>å…³äº dirty çš„æå‡</h4><p>Map ä¸­ç»´æŒäº†ä¸€ä¸ª int ç±»å‹çš„ <code>misses</code> æ¯å½“ Map æœªå‘½ä¸­ read æ—¶ï¼Œä¼šå°†è¯¥å€¼è‡ªå¢ 1ï¼Œ å½“è¯¥å€¼å¤§äº dirty çš„é•¿åº¦åï¼Œdirty å°±ä¼šè¢«æå‡ä¸º readï¼Œæå‡ä¹‹åï¼Œdirty å’Œ misses ä¼šè¢«é‡ç½®ï¼Œç­‰ä¸‹ä¸€æ¬¡æ’å…¥æ–°å€¼æ—¶ï¼Œä¼šå°† read ä¸­æœªåˆ é™¤çš„æ•°æ®å¤åˆ¶åˆ° dirty ä¸­ã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼Œæ‰§è¡Œ <code>Range</code> æ—¶ï¼Œä¹Ÿä¼šå…ˆè¿›è¡Œä¸€æ¬¡æå‡ã€‚</p><h4 id="å…³äºå»¶è¿Ÿåˆ é™¤"><a href="#å…³äºå»¶è¿Ÿåˆ é™¤" class="headerlink" title="å…³äºå»¶è¿Ÿåˆ é™¤"></a>å…³äºå»¶è¿Ÿåˆ é™¤</h4><p>å½“æ‰§è¡Œ <code>Delete</code> æ—¶ï¼Œå¦‚æœ read æ²¡æœ‰å‡»ä¸­ï¼Œ å°±ä¼šç›´æ¥ä» dirty ä¸­åˆ é™¤ï¼Œå¦åˆ™å¦‚æœé”®å€¼åœ¨ read ä¸­ï¼Œä¼šå…ˆå°†å…¶ Value çš„æŒ‡é’ˆï¼ˆenter.pï¼‰æ ‡è®°ä¸º nil, ç­‰ä¸‹ä¸€æ¬¡æ‰§è¡Œå¤åˆ¶æ—¶ï¼Œè¿™äº›è¢«æ ‡è®°ä¸º nil çš„é”®å€¼ä¼šè¢«é‡æ–°æ ‡è®°ä¸º expungedï¼Œå³ enter.p æœ‰ä¸‰ç§å¯èƒ½çš„å€¼ï¼š</p><ol><li>nil: è¡¨ç¤º é”®å€¼å·²ç»è¢«åˆ é™¤ï¼Œä½†è¿™ä¸€ç‰ˆçš„ read è¿˜æ²¡æœ‰è¢«å¤åˆ¶åˆ° dirty ä¸­ï¼Œæ‰€ä»¥ dirty æ­¤æ—¶ä¸º nil, é‡åˆ°è¦é‡æ–°æ’å…¥è¿™ä¸ªkeyæ—¶ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ readï¼Œä¹‹åè¿›è¡Œå¤åˆ¶æ—¶ï¼Œè¿™ä¸ªæœ€æ–°çš„å€¼ä¼šè¢«åŒæ­¥å› dirtyã€‚</li><li>expunged: è¡¨ç¤ºè¯¥é”®å€¼å·²ç»è¢«åˆ é™¤å¹¶ä¸”ç»å†äº†å¤åˆ¶ï¼Œ dirty ä¸ä¸º nilï¼Œ è¿™æ—¶éœ€è¦åŒæ—¶ä¿®æ”¹ read å’Œ dirtyï¼Œ é¿å… read çš„æ•°æ®æ¯” dirty ä¸­çš„æ•°æ®æ–°ï¼Œå¯¼è‡´ä¸‹ä¸€æ¬¡æå‡æ—¶ä¸¢å¤±æ–°æ•°æ®ã€‚</li><li><code>!= nil</code>: è¡¨ç¤ºå­˜å‚¨çš„æ˜¯å…·ä½“çš„ value çš„æŒ‡é’ˆã€‚</li></ol><p>sync.Map å…·æœ‰ä»¥ä¸‹ç»“æ„å’Œæ–¹æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Map <span class="keyword">struct</span> &#123; </span><br><span class="line">mu sync.Mutex <span class="comment">// äº’æ–¥é”</span></span><br><span class="line">read atomic.Value <span class="comment">// åŸå­åŒ–åªè¯»æ“ä½œ</span></span><br><span class="line">dirty <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*entry <span class="comment">// æ–°å¢çš„ kv ä¼šå­˜å‚¨åˆ°è¿™é‡Œ</span></span><br><span class="line">misses <span class="type">int</span> <span class="comment">// å½“ read ä¸­æŸ¥è¯¢å¤±è´¥æ—¶ï¼Œmisses+=1ï¼Œå½“ miss çš„æ•°é‡è¶…è¿‡ dirty æ—¶ï¼Œä¼šè§¦å‘å°† dirty è½¬åŒ–åˆ° read</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä» Map ä¸­å–å‡ºä¸€ä¸ª value </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> Load(key <span class="keyword">interface</span>&#123;&#125;) (value <span class="keyword">interface</span>&#123;&#125;, ok <span class="type">bool</span>) &#123; </span><br><span class="line">read, _ := m.read.Load().(readOnly) </span><br><span class="line"><span class="comment">// ä¼˜å…ˆä» read ä¸­è¯»å–</span></span><br><span class="line">e, ok := read.m[key] </span><br><span class="line"><span class="comment">// å½“è¯»ä¸åˆ°ä¸” amended = true æ—¶ï¼Œå†äº’æ–¥çš„ä» dirty ä¸­æŸ¥æ‰¾</span></span><br><span class="line"><span class="keyword">if</span> !ok &amp;&amp; read.amended &#123; </span><br><span class="line">m.mu.Lock() </span><br><span class="line"><span class="comment">// double-checkingï¼Œ é¿å…åœ¨åŠ é”è¿‡ç¨‹ä¸­æœ‰å…¶ä»– goroutine å°† dirty æå‡ä¸º read çš„æƒ…å†µ</span></span><br><span class="line">read, _ = m.read.Load().(readOnly) e, ok = read.m[key] </span><br><span class="line"><span class="comment">// åŒé‡æŸ¥æ‰¾åè¿˜æ‰¾ä¸åˆ°ï¼Œå†å» dirty ä¸­æŸ¥æ‰¾ï¼ŒåŒæ—¶ misses += 1</span></span><br><span class="line"><span class="keyword">if</span> !ok &amp;&amp; read.amended &#123; </span><br><span class="line">e, ok = m.dirty[key] <span class="comment">// ä¿®æ”¹ missesï¼Œå°è¯•æå‡ dirty </span></span><br><span class="line">m.missLocked() </span><br><span class="line">&#125; </span><br><span class="line">m.mu.Unlock()</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">if</span> !ok &#123; <span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">false</span> &#125; </span><br><span class="line"><span class="comment">// éœ€è¦æ³¨æ„è¿™é‡Œå–åˆ°çš„æ˜¯æŒ‡å‘çœŸå® value çš„æŒ‡é’ˆï¼Œè¿˜éœ€è¦è¯»å–å‡ºçœŸæ­£çš„ value</span></span><br><span class="line"><span class="keyword">return</span> e.load() </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> missLocked() &#123; </span><br><span class="line">m.misses++ </span><br><span class="line"><span class="keyword">if</span> m.misses &lt; <span class="built_in">len</span>(m.dirty) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// å°† dirty æå‡ä¸º read </span></span><br><span class="line">m.read.Store(readOnly&#123;m: m.dirty&#125;) </span><br><span class="line"><span class="comment">// é‡ç½®ç›¸å…³å­—æ®µ </span></span><br><span class="line">m.dirty = <span class="literal">nil</span> </span><br><span class="line">m.misses = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘ Map ä¸­ å­˜å…¥ä¸€ä¸ª KV å¯¹ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> Store(key, value <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line"><span class="comment">// ä¼˜å…ˆä» read ä¸­è¯»å–</span></span><br><span class="line"><span class="comment">// å¦‚æœ read ä¸­æ‰¾åˆ°äº†ï¼Œåˆ©ç”¨ entry çš„ tryStore æ–¹æ³•æ›´æ–° value</span></span><br><span class="line">read, _ := m.read.Load().(readOnly) </span><br><span class="line"><span class="keyword">if</span> e, ok := read.m[key]; ok &amp;&amp; e.tryStore(&amp;value) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ é”ï¼Œ äºŒæ¬¡æ£€æŸ¥</span></span><br><span class="line">m.mu.Lock() </span><br><span class="line">read, _ = m.read.Load().(readOnly) </span><br><span class="line"><span class="keyword">if</span> e, ok := read.m[key]; ok &#123;</span><br><span class="line"><span class="comment">// å½“å¯¹å·²ç»å­˜åœ¨äº `read` ä¸­çš„é”®å€¼å¯¹æ‰§è¡Œåˆ é™¤æ“ä½œæ—¶ï¼Œè€Œæ˜¯ä¼šæŠŠå…¶æš‚æ—¶æ ‡è®°ä¸º `nil`,</span></span><br><span class="line"><span class="comment">// ç­‰ dirty å‡çº§ä¸º read åå†æ’å…¥æ–°å€¼æ—¶ä¼šæŠŠ read ä¸­æ ‡è®°ä¸º `nil` çš„å€¼æ ‡è®°ä¸º `expunged`, </span></span><br><span class="line"><span class="comment">// è€Œå…¶ä»–çš„å€¼ä¼šè¢«é‡æ–°å¤åˆ¶åˆ° dirty ä¸­ï¼Œå½“è¿™æ—¶æ’å…¥åˆšè¢«åˆ é™¤çš„é”®åï¼Œå°±ä¼šç›´æ¥æŠŠä¹‹å‰æ ‡è®°ä¸º `expunged` çš„é”®çš„å€¼èµ‹ä¸ºæ–°å€¼</span></span><br><span class="line"><span class="keyword">if</span> e.unexpungeLocked() &#123; </span><br><span class="line">m.dirty[key] = e </span><br><span class="line">&#125; </span><br><span class="line">e.storeLocked(&amp;value) </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> e, ok := m.dirty[key]; ok &#123;</span><br><span class="line"><span class="comment">// å¦‚æœ dirty ä¸­æ‰¾åˆ°äº†ï¼Œé€šè¿‡ storeLocked ä¿®æ”¹ dirty ä¸­çš„ entry</span></span><br><span class="line">e.storeLocked(&amp;value) </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line"><span class="comment">// dirty ä¸­ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ’å…¥åˆ° dirty ä¸­</span></span><br><span class="line"><span class="keyword">if</span> !read.amended &#123; </span><br><span class="line"><span class="comment">// æ­¤æ—¶å¦‚æœ amended == falseï¼Œå¯¹åº”ä¸¤ç§æƒ…å†µ</span></span><br><span class="line"><span class="comment">// 1. ç¬¬ä¸€æ¬¡æ’å…¥æ•°æ®ï¼Œread å’Œ dirty éƒ½ä¸ºç©ºï¼Œæ­¤æ—¶éœ€è¦å¯¹ read è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">// 2. ä¹‹å‰çš„ dirty åˆšåˆšå‡çº§æˆä¸º readï¼Œæ­¤æ—¶ dirty ä¸ºç©ºï¼Œéœ€è¦å°†ä¹‹å‰æœ‰å¯èƒ½å­˜åœ¨çš„å·²æ ‡è®°åˆ é™¤çš„è¿›è¡Œæƒ°æ€§åˆ é™¤</span></span><br><span class="line">m.dirtyLocked() </span><br><span class="line">m.read.Store(readOnly&#123;m: read.m, amended: <span class="literal">true</span>&#125;) </span><br><span class="line">&#125; </span><br><span class="line">m.dirty[key] = newEntry(value) </span><br><span class="line">&#125; </span><br><span class="line">m.mu.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœ Map ä¸­å­˜åœ¨ key,è¦†ç›–å¹¶è¿”å› (æ—§å€¼, true), å¦åˆ™è¿”å› (æ–°å€¼, false) </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> LoadOrStore(key, value <span class="keyword">interface</span>&#123;&#125;) (actual <span class="keyword">interface</span>&#123;&#125;, loaded <span class="type">bool</span>) </span><br><span class="line"><span class="comment">// ä» Map ä¸­åˆ é™¤ä¸€ä¸ª KV å¯¹ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> Delete(key <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line"><span class="comment">// äºŒæ¬¡æ£€æŸ¥ read</span></span><br><span class="line">read, _ := m.read.Load().(readOnly) </span><br><span class="line">e, ok := read.m[key] </span><br><span class="line"><span class="keyword">if</span> !ok &amp;&amp; read.amended &#123; </span><br><span class="line">m.mu.Lock() </span><br><span class="line">read, _ = m.read.Load().(readOnly) </span><br><span class="line">e, ok = read.m[key] </span><br><span class="line"><span class="comment">// ä¸å­˜åœ¨ï¼Œå°±ä» dirty ä¸­åˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span> !ok &amp;&amp; read.amended &#123; </span><br><span class="line"><span class="built_in">delete</span>(m.dirty, key) </span><br><span class="line">&#125;</span><br><span class="line">m.mu.Unlock() </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// å­˜åœ¨çš„è¯å°±è°ƒç”¨ entry çš„ delete() ä» read ä¸­åˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span> ok &#123; e.<span class="built_in">delete</span>() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹ Map ä¸­çš„æ‰€æœ‰ KV æ‰§è¡Œ f, ç›´åˆ° f è¿”å› false </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> Range(f <span class="function"><span class="keyword">func</span><span class="params">(key, value <span class="keyword">interface</span>&#123;&#125;)</span></span> <span class="type">bool</span>) &#123; </span><br><span class="line">read, _ := m.read.Load().(readOnly) </span><br><span class="line"><span class="keyword">if</span> read.amended &#123; </span><br><span class="line"><span class="comment">// double-checking</span></span><br><span class="line">m.mu.Lock() </span><br><span class="line">read, _ = m.read.Load().(readOnly) </span><br><span class="line"><span class="keyword">if</span> read.amended &#123; </span><br><span class="line"><span class="comment">// æå‡ dirty</span></span><br><span class="line">read = readOnly&#123;m: m.dirty&#125; </span><br><span class="line">m.read.Store(read) </span><br><span class="line">m.dirty = <span class="literal">nil</span> </span><br><span class="line">m.misses = <span class="number">0</span> </span><br><span class="line">&#125; </span><br><span class="line">m.mu.Unlock() </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span> k, e := <span class="keyword">range</span> read.m &#123; </span><br><span class="line">v, ok := e.load() </span><br><span class="line"><span class="keyword">if</span> !ok &#123; </span><br><span class="line"><span class="keyword">continue</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span> !f(k, v) &#123; </span><br><span class="line"><span class="keyword">break</span> </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Map)</span></span> dirtyLocked() &#123; </span><br><span class="line"><span class="comment">// å¯¹åº”æƒ…å†µ 1 </span></span><br><span class="line"><span class="keyword">if</span> m.dirty != <span class="literal">nil</span> &#123; <span class="keyword">return</span> &#125; </span><br><span class="line"><span class="comment">// æƒ…å†µ 2 </span></span><br><span class="line">read, _ := m.read.Load().(readOnly) </span><br><span class="line">m.dirty = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*entry, <span class="built_in">len</span>(read.m)) </span><br><span class="line"><span class="keyword">for</span> k, e := <span class="keyword">range</span> read.m &#123;</span><br><span class="line"><span class="comment">// æ²¡æœ‰è¢«åˆ é™¤ï¼Œå¤åˆ¶åˆ° dirty ä¸­ </span></span><br><span class="line"><span class="keyword">if</span> !e.tryExpungeLocked() &#123; m.dirty[k] = e &#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> readOnly <span class="keyword">struct</span> &#123; </span><br><span class="line"><span class="comment">// m å’Œ dirty ä¸­çš„ value æ˜¯åŒä¸€å—å†…å­˜ </span></span><br><span class="line">m <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]*entry </span><br><span class="line"><span class="comment">// å¦‚æœ dirty å’Œ read ä¸­çš„æ•°æ®ä¸ä¸€è‡´æ—¶ï¼Œamended ä¸º trueã€‚è‹¥æ­¤æ—¶ read ä¸­è¯»ä¸åˆ°ï¼Œå°±è¦å» dirty ä¸­æŸ¥è¯¢</span></span><br><span class="line">amended <span class="type">bool</span> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// read å’Œ dirty ä¸­çš„ entry æŒ‡å‘çš„æ˜¯åŒä¸€åœ°å€ï¼Œä¿®æ”¹ä¼šåŒæ—¶ç”Ÿæ•ˆï¼›å‡å°‘ç©ºé—´æµªè´¹</span></span><br><span class="line"><span class="keyword">type</span> entry <span class="keyword">struct</span> &#123;</span><br><span class="line">p unsafe.Pointer <span class="comment">// *interface&#123;&#125; </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *entry)</span></span> load() (value <span class="keyword">interface</span>&#123;&#125;, ok <span class="type">bool</span>) &#123; </span><br><span class="line">p := atomic.LoadPointer(&amp;e.p) </span><br><span class="line"><span class="keyword">if</span> p == <span class="literal">nil</span> || p == expunged &#123; <span class="comment">// ç”±äº Map çš„å»¶æ—¶åˆ é™¤ç­–ç•¥ï¼Œå‡ºç°è¿™ä¸¤ç§æƒ…å†µå‡ä»£è¡¨ kv å·²ç»ä¸å­˜åœ¨äº†</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">false</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> *(*<span class="keyword">interface</span>&#123;&#125;)(p), <span class="literal">true</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *entry)</span></span> <span class="built_in">delete</span>() (hadValue <span class="type">bool</span>) &#123; </span><br><span class="line"><span class="comment">// è¿™é‡Œä¸æ˜¯çœŸçš„åˆ é™¤å—·ï¼Œåªæ˜¯å°†å¯¹åº” value çš„ p æŒ‡å‘äº† nilã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ dirty å‡çº§æ—¶æ‰ä¼šçœŸæ­£çš„åˆ é™¤ï¼Œaka Map çš„å»¶æ—¶åˆ é™¤ç­–ç•¥</span></span><br><span class="line"><span class="keyword">for</span> &#123; p := atomic.LoadPointer(&amp;e.p) </span><br><span class="line"><span class="comment">// ä¸å­˜åœ¨æˆ–è¢«åˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span> p == <span class="literal">nil</span> || p == expunged &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125; </span><br><span class="line"><span class="comment">// CAS å°† enter.p æŒ‡å‘ nil </span></span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapPointer(&amp;e.p, p, <span class="literal">nil</span>) &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *entry)</span></span> tryStore(i *<span class="keyword">interface</span>&#123;&#125;) <span class="type">bool</span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123; </span><br><span class="line">p := atomic.LoadPointer(&amp;e.p) <span class="comment">// è¢«åˆ é™¤ </span></span><br><span class="line"><span class="keyword">if</span> p == expunged &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125; <span class="comment">// æ¯”è¾ƒ e.p ä¸ p, ç›¸ç­‰èµ‹æ–°å€¼ï¼Œå¦åˆ™è‡ªæ—‹æ¯”è¾ƒ </span></span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapPointer(&amp;e.p, p, unsafe.Pointer(i)) &#123; <span class="keyword">return</span> <span class="literal">true</span> &#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *entry)</span></span> storeLocked(i *<span class="keyword">interface</span>&#123;&#125;) &#123; </span><br><span class="line">atomic.StorePointer(&amp;e.p, unsafe.Pointer(i)) </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”¨æ¥åˆ¤æ–­ `entry` æ˜¯å¦è¢«åˆ é™¤ï¼Œå½“ `entry.p == nil` æ—¶ï¼Œè¯´æ˜è¿™ä¸ª value è¢«æ ‡è®°ä¸ºåˆ é™¤ï¼Œè¿™æ—¶ä¼šæŠŠå®ƒé‡æ–°æ ‡è®°ä¸º `expunged` è¿”å› trueï¼Œ å¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *entry)</span></span> tryExpungeLocked() (isExpunged <span class="type">bool</span>) &#123; </span><br><span class="line">p := atomic.LoadPointer(&amp;e.p) </span><br><span class="line"><span class="keyword">for</span> p == <span class="literal">nil</span> &#123; </span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapPointer(&amp;e.p, <span class="literal">nil</span>, expunged) &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">&#125; </span><br><span class="line">p = atomic.LoadPointer(&amp;e.p) </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> p == expunged </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Slice"><a href="#Slice" class="headerlink" title="Slice"></a>Slice</h2><p>æ¯”è¾ƒå¸¸è§çš„é—®é¢˜æ˜¯ slice å’Œæ™®é€š array çš„åŒºåˆ«ï¼šarray æ˜¯å€¼ç±»å‹ï¼›slice æ˜¯å¼•ç”¨ç±»å‹ï¼ŒæŒ‡å‘åº•å±‚çš„æ•°ç»„åœ°å€<br>å­åˆ‡ç‰‡ï¼šå¼•ç”¨çš„åº•å±‚æ•°ç»„æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ slice æœ¬èº«å¯¹åº”çš„å†…å­˜åœ°å€ä¸ä¸€è‡´ï¼›å½“å­åˆ‡ç‰‡é•¿åº¦è¶…è¿‡åŸåˆ‡ç‰‡çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿæ‰©å®¹ï¼Œæ›¿æ¢æ‰åŸæ¥çš„åº•å±‚æ•°ç»„</p><h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2><ol><li>Channelæœ¬è´¨ä¸Šæ˜¯ç”±ä¸‰ä¸ªFIFOï¼ˆFirst In FirstOutï¼Œå…ˆè¿›å…ˆå‡ºï¼‰é˜Ÿåˆ—ç»„æˆçš„ç”¨äºåç¨‹ä¹‹é—´ä¼ è¾“æ•°æ®çš„åç¨‹å®‰å…¨çš„é€šé“ï¼›FIFOçš„è®¾è®¡æ˜¯ä¸ºäº†ä¿éšœå…¬å¹³ï¼Œè®©äº‹æƒ…å˜å¾—ç®€å•ï¼ŒåŸåˆ™æ˜¯è®©ç­‰å¾…æ—¶é—´æœ€é•¿çš„åç¨‹æœ€æœ‰èµ„æ ¼å…ˆä»channelå‘é€æˆ–æ¥æ”¶æ•°æ®ï¼›</li><li>ä¸‰ä¸ªFIFOé˜Ÿåˆ—ä¾æ¬¡æ˜¯bufå¾ªç¯é˜Ÿåˆ—ï¼Œsendqå¾…å‘é€è€…é˜Ÿåˆ—ï¼Œrecvqå¾…æ¥æ”¶è€…é˜Ÿåˆ—ã€‚bufå¾ªç¯é˜Ÿåˆ—æ˜¯å¤§å°å›ºå®šçš„ç”¨æ¥å­˜æ”¾channelæ¥æ”¶çš„æ•°æ®çš„é˜Ÿåˆ—ï¼›sendqå¾…å‘é€è€…é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜æ”¾ç­‰å¾…å‘é€æ•°æ®åˆ°channelçš„goroutineçš„åŒå‘é“¾è¡¨ï¼Œrecvqå¾…æ¥æ”¶è€…é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜æ”¾ç­‰å¾…ä»channelè¯»å–æ•°æ®çš„goroutineçš„åŒå‘é“¾è¡¨ï¼›sendqå’Œrecvqå¯ä»¥è®¤ä¸ºä¸é™å¤§å°ï¼›</li><li>è·Ÿå‡½æ•°è°ƒç”¨ä¼ å‚æœ¬è´¨éƒ½æ˜¯ä¼ å€¼ä¸€æ ·ï¼Œchannelä¼ é€’æ•°æ®çš„æœ¬è´¨å°±æ˜¯å€¼æ‹·è´ï¼Œå¼•ç”¨ç±»å‹æ•°æ®çš„ä¼ é€’ä¹Ÿæ˜¯åœ°å€æ‹·è´ï¼›æœ‰ä»ç¼“å†²åŒºbufåœ°å€æ‹·è´æ•°æ®åˆ°æ¥æ”¶è€…receiveræ ˆå†…å­˜åœ°å€ï¼Œä¹Ÿæœ‰ä»å‘é€è€…senderæ ˆå†…å­˜åœ°å€æ‹·è´æ•°æ®åˆ°ç¼“å†²åŒºbufï¼›</li><li>Channelé‡Œé¢å‚æ•°çš„ä¿®æ”¹ä¸æ˜¯å¹¶å‘å®‰å…¨çš„ï¼ŒåŒ…æ‹¬å¯¹ä¸‰ä¸ªé˜Ÿåˆ—åŠå…¶ä»–å‚æ•°çš„è®¿é—®ï¼Œå› æ­¤éœ€è¦åŠ é”ï¼Œæœ¬è´¨ä¸Šï¼Œchannelå°±æ˜¯ä¸€ä¸ªæœ‰é”é˜Ÿåˆ—ï¼›</li><li>Channel çš„æ€§èƒ½è·Ÿ sync.Mutex å·®ä¸å¤šï¼Œæ²¡æœ‰è°æ¯”è°å¼ºã€‚Goå®˜æ–¹ä¹‹æ‰€ä»¥æ¨èä½¿ç”¨Channelè¿›è¡Œå¹¶å‘åç¨‹çš„æ•°æ®äº¤äº’ï¼Œæ˜¯å› ä¸ºchannelçš„è®¾è®¡ç†å¿µèƒ½è®©ç¨‹åºå˜å¾—ç®€å•ï¼Œåœ¨å¤§å‹ç¨‹åºã€é«˜å¹¶å‘å¤æ‚çš„è¿è¡ŒçŠ¶å†µä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li></ol><p>å…³æ³¨ä¸‹æ–¹ä»£ç  <code>makechan</code> ä¸­ <code>switch-case</code> ç›¸å…³è¯­å¥ï¼Œå¯ä»¥å‘ç°å½“å­˜å‚¨åœ¨ buf ä¸­çš„å…ƒç´ ä¸åŒ…å«æŒ‡é’ˆæ—¶ï¼Œhchan ä¸­ä¹Ÿä¸åŒ…å« GC å…³å¿ƒçš„æŒ‡é’ˆã€‚buf æŒ‡å‘ä¸€æ®µç›¸åŒå…ƒç´ ç±»å‹çš„å†…å­˜ï¼Œelemtype å›ºå®šä¸å˜ã€‚å—åˆ°åƒåœ¾å›æ”¶å™¨çš„é™åˆ¶ï¼ŒæŒ‡é’ˆç±»å‹çš„ç¼“å†² buf éœ€è¦å•ç‹¬åˆ†é…å†…å­˜ã€‚<br>channel æœ¬èº«æ˜¯å¼•ç”¨ç±»å‹ï¼Œå…¶åˆ›å»ºå…¨éƒ¨è°ƒç”¨çš„æ˜¯ mallocgc()ï¼Œåœ¨<em>å †</em>ä¸Šå¼€è¾Ÿçš„å†…å­˜ç©ºé—´ï¼Œè¯´æ˜ channel æœ¬èº«ä¼šè¢« GC è‡ªåŠ¨å›æ”¶ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123; </span><br><span class="line">qcount <span class="type">uint</span> <span class="comment">// é˜Ÿåˆ—ä¸­æ‰€æœ‰æ•°æ®æ€»æ•° </span></span><br><span class="line">dataqsiz <span class="type">uint</span> <span class="comment">// å¾ªç¯é˜Ÿåˆ—å¤§å° </span></span><br><span class="line">buf unsafe.Pointer <span class="comment">// æŒ‡å‘å¾ªç¯é˜Ÿåˆ—çš„æŒ‡é’ˆ </span></span><br><span class="line">elemsize <span class="type">uint16</span> <span class="comment">// å¾ªç¯é˜Ÿåˆ—ä¸­å…ƒç´ çš„å¤§å° </span></span><br><span class="line">closed <span class="type">uint32</span> <span class="comment">// chanæ˜¯å¦å…³é—­çš„æ ‡è¯† </span></span><br><span class="line">elemtype *_type <span class="comment">// å¾ªç¯é˜Ÿåˆ—ä¸­å…ƒç´ çš„ç±»å‹ </span></span><br><span class="line">sendx <span class="type">uint</span> <span class="comment">// å·²å‘é€å…ƒç´ åœ¨å¾ªç¯é˜Ÿåˆ—ä¸­çš„ä½ç½® </span></span><br><span class="line">recvx <span class="type">uint</span> <span class="comment">// å·²æ¥æ”¶å…ƒç´ åœ¨å¾ªç¯é˜Ÿåˆ—ä¸­çš„ä½ç½® </span></span><br><span class="line">recvq waitq <span class="comment">// ç­‰å¾…æ¥æ”¶çš„goroutineçš„ç­‰å¾…é˜Ÿåˆ— </span></span><br><span class="line">sendq waitq <span class="comment">// ç­‰å¾…å‘é€çš„goroutineçš„ç­‰å¾…é˜Ÿåˆ— </span></span><br><span class="line">lock mutex <span class="comment">// æ§åˆ¶chanå¹¶å‘è®¿é—®çš„äº’æ–¥é” </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makechan</span><span class="params">(t *chantype, size <span class="type">int</span>)</span></span> *hchan &#123; </span><br><span class="line">elem := t.elem </span><br><span class="line"><span class="comment">// æ£€æŸ¥æ•°æ®é¡¹å¤§å°ä¸èƒ½è¶…è¿‡ 64KB </span></span><br><span class="line"><span class="keyword">if</span> elem.size &gt;= <span class="number">1</span>&lt;&lt;<span class="number">16</span> &#123; throw(<span class="string">&quot;makechan: invalid channel element type&quot;</span>) &#125; <span class="comment">// æ£€æŸ¥å†…å­˜å¯¹é½æ˜¯å¦æ­£ç¡® </span></span><br><span class="line"><span class="keyword">if</span> hchanSize%maxAlign != <span class="number">0</span> || elem.align &gt; maxAlign &#123; </span><br><span class="line">throw(<span class="string">&quot;makechan: bad alignment&quot;</span>) </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// ç¼“å†²åŒºå¤§å°æ£€æŸ¥ï¼Œåˆ¤æ–­æ˜¯å¦æº¢å‡º </span></span><br><span class="line">mem, overflow := math.MulUintptr(elem.size, <span class="type">uintptr</span>(size)) </span><br><span class="line"><span class="keyword">if</span> overflow || mem &gt; maxAlloc-hchanSize || size &lt; <span class="number">0</span> &#123; </span><br><span class="line"><span class="built_in">panic</span>(plainError(<span class="string">&quot;makechan: size out of range&quot;</span>)) </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">var</span> c *hchan </span><br><span class="line"><span class="keyword">switch</span> &#123; </span><br><span class="line"><span class="comment">// å½“é˜Ÿåˆ—æˆ–è€…å…ƒç´ å¤§å°ä¸º 0 æ—¶ï¼Œè°ƒç”¨ mallocgc() åœ¨å †ä¸Šä¸º channel å¼€è¾Ÿä¸€æ®µå¤§å°ä¸º hchanSize çš„å†…å­˜ç©ºé—´ï¼›</span></span><br><span class="line"><span class="keyword">case</span> mem == <span class="number">0</span>: </span><br><span class="line">c = (*hchan)(mallocgc(hchanSize, <span class="literal">nil</span>, <span class="literal">true</span>)) </span><br><span class="line"><span class="comment">// ç«æ€æ£€æŸ¥ï¼Œåˆ©ç”¨è¿™ä¸ªåœ°å€è¿›è¡ŒåŒæ­¥æ“ä½œ. </span></span><br><span class="line">c.buf = c.raceaddr() </span><br><span class="line"><span class="comment">// å½“å…ƒç´ ç±»å‹ä¸æ˜¯æŒ‡é’ˆç±»å‹æ—¶ï¼Œè°ƒç”¨ mallocgc() åœ¨å †ä¸Šä¸º channel å’Œåº•å±‚ buf ç¼“å†²åŒºæ•°ç»„å¼€è¾Ÿä¸€æ®µå¤§å°ä¸º hchanSize + mem è¿ç»­çš„å†…å­˜ç©ºé—´ï¼›</span></span><br><span class="line"><span class="keyword">case</span> elem.ptrdata == <span class="number">0</span>: </span><br><span class="line">c = (*hchan)(mallocgc(hchanSize+mem, <span class="literal">nil</span>, <span class="literal">true</span>)) </span><br><span class="line"><span class="comment">// è¡¨ç¤ºhchanåé¢åœ¨å†…å­˜é‡Œç´§è·Ÿç€å°±æ˜¯bufç¯å½¢é˜Ÿåˆ— </span></span><br><span class="line">c.buf = add(unsafe.Pointer(c), hchanSize) </span><br><span class="line"><span class="comment">// é»˜è®¤æƒ…å†µå…ƒç´ ç±»å‹ä¸­æœ‰æŒ‡é’ˆç±»å‹ï¼Œè°ƒç”¨ mallocgc() åœ¨å †ä¸Šåˆ†åˆ«ä¸º channel å’Œ buf ç¼“å†²åŒºåˆ†é…å†…å­˜ã€‚</span></span><br><span class="line"><span class="keyword">default</span>:  </span><br><span class="line">c = <span class="built_in">new</span>(hchan) c.buf = mallocgc(mem, elem, <span class="literal">true</span>) </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// è®¾ç½®å…ƒç´ ä¸ªæ•°ã€å…ƒç´ ç±»å‹ç»™åˆ›å»ºçš„chan </span></span><br><span class="line">c.elemsize = <span class="type">uint16</span>(elem.size) </span><br><span class="line">c.elemtype = elem </span><br><span class="line">c.dataqsiz = <span class="type">uint</span>(size) </span><br><span class="line">lockInit(&amp;c.lock, lockRankHchan) </span><br><span class="line"><span class="keyword">if</span> debugChan &#123; </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;makechan: chan=&quot;</span>, c, <span class="string">&quot;; elemsize=&quot;</span>, elem.size, <span class="string">&quot;; dataqsiz=&quot;</span>, size, <span class="string">&quot;\n&quot;</span>) </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> c </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‘é€æ•°æ®"><a href="#å‘é€æ•°æ®" class="headerlink" title="å‘é€æ•°æ®"></a>å‘é€æ•°æ®</h4><ol><li>é¦–å…ˆ select éé˜»å¡çš„å‘é€ï¼Œéœ€è¦åˆ¤æ–­ä¸¤ç§æƒ…å†µï¼›</li><li>ä¸€èˆ¬çš„é˜»å¡è°ƒç”¨ï¼Œå…ˆåˆ¤æ–­ recvq ç­‰å¾…æ¥æ”¶é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè¯´æ˜ç¼“å†²åŒºä¸ºç©º or æ— ç¼“å†² Channelï¼›</li><li>å¦‚æœ recvq æœ‰æ¥æ”¶è€…ï¼Œåˆ™å±äºç¼“å†²åŒºç©ºï¼Œä» recvq ä¸­å–å‡ºä¸€ä¸ª goroutineï¼Œç„¶åå†™å…¥æ•°æ®ï¼Œæ¥ç€å”¤é†’ goroutineï¼Œç»“æŸå‘é€è¿‡ç¨‹ï¼›</li><li>å¦‚æœç¼“å†²åŒºæœ‰ç©ºä½ï¼Œå†™å…¥æ•°æ®åˆ°ç¼“å†²åŒºï¼Œå®Œæˆå‘é€ï¼›</li><li>å¦‚æœç¼“å†²åŒºæ»¡ï¼Œå°†å‘é€æ•°æ®çš„ goroutine æ”¾åˆ° sendq ä¸­ï¼Œè¿›å…¥ç¡çœ ï¼Œç­‰å¾…å”¤é†’ã€‚<h4 id="æ¥æ”¶æ•°æ®"><a href="#æ¥æ”¶æ•°æ®" class="headerlink" title="æ¥æ”¶æ•°æ®"></a>æ¥æ”¶æ•°æ®</h4></li><li>ä¹Ÿæ˜¯å…ˆåˆ¤æ–­selectè¿™ç§éé˜»å¡æ¥æ”¶çš„ä¸¤ç§æƒ…å†µï¼ˆblockä¸ºfalseï¼‰ï¼›ç„¶åæ˜¯åŠ é”è¿›è¡Œé˜»å¡è°ƒç”¨çš„é€»è¾‘ï¼›</li><li>åŒæ­¥æ¥æ”¶ï¼šå¦‚æœå‘é€è€…é˜Ÿåˆ— sendq ä¸ä¸ºç©ºï¼Œä¸”æ²¡æœ‰ç¼“å†²åŒºï¼Œç›´æ¥ä» sendq ä¸­å–å‡ºä¸€ä¸ª goroutineï¼Œè¯»å–æ¶ˆæ¯ï¼Œå”¤é†’è¯¥ goroutineï¼Œç»“æŸè¯»å–ï¼›</li><li>åŒæ­¥æ¥æ”¶ï¼šå¦‚æœå‘é€è€…é˜Ÿåˆ— sendq ä¸ä¸ºç©ºï¼Œæœ‰ç¼“å†²åŒºï¼Œè¯´æ˜ç¼“å†²åŒºå·²ç»æ»¡äº†ï¼Œç§»åŠ¨ recvx æŒ‡é’ˆçš„ä½ç½®ï¼Œå–å‡ºä¸€ä¸ªæ•°æ®ï¼ŒåŒæ—¶ä» sendq ä¸­å–å‡ºä¸€ä¸ª goroutineï¼Œæ‹·è´é‡Œé¢çš„æ•°æ®åˆ° buf ä¸­ï¼Œç»“æŸè¯»å–ï¼›</li><li>å¼‚æ­¥æ¥æ”¶ï¼šå¦‚æœå‘é€è€…é˜Ÿåˆ— sendq ä¸ºç©ºï¼Œä¸”ç¼“å†²åŒºæœ‰æ•°æ®ï¼ˆæœ‰ç¼“å†² channelï¼‰ï¼Œç›´æ¥ä»ç¼“å†²åŒºå–å‡ºæ•°æ®ï¼Œç»“æŸè¯»å–ï¼›</li><li>é˜»å¡æ¥æ”¶ï¼šå¦‚æœå‘é€è€…é˜Ÿåˆ— sendq ä¸ºç©ºï¼Œä¸”ç¼“å†²åŒºæ— æ•°æ®ï¼ˆæ— ç¼“å†² channelï¼‰ï¼Œå°±å°†å½“å‰çš„ goroutine åŠ å…¥ recvqï¼Œè¿›å…¥ç¡çœ ç­‰å¾…å”¤é†’ã€‚</li></ol><h4 id="å…³é—­-Chan"><a href="#å…³é—­-Chan" class="headerlink" title="å…³é—­ Chan"></a>å…³é—­ Chan</h4><ol><li>åˆ¤æ–­ channel å½“å‰çŠ¶æ€ï¼Œå¦‚æœ channel &#x3D;&#x3D; nil || channel å·²ç»å…³é—­ï¼Œä¼šç›´æ¥ panicï¼›</li><li>å…³é—­çš„ä¸»è¦å·¥ä½œæ˜¯é‡Šæ”¾æ‰€æœ‰çš„æ¥æ”¶è€…å’Œå‘é€è€…ï¼šå…ˆå›æ”¶æ¥æ”¶è€…ï¼Œå› ä¸ºä»ä¸€ä¸ªå…³é—­çš„ channel ä¸­è¯»æ•°æ®ï¼Œä¸ä¼šå‘ç”Ÿ panicï¼Œé¡¶å¤šè¯»åˆ°ä¸€ä¸ªé»˜è®¤é›¶å€¼ã€‚å†å›æ”¶å‘é€è€…ã€‚æ³¨æ„è¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿ panicï¼Œå› ä¸ºå¾€ä¸€ä¸ªå…³é—­çš„ channel ä¸­å‘é€æ•°æ®ï¼Œä¼šäº§ç”Ÿ panicã€‚</li></ol><h2 id="Sync-Mutex"><a href="#Sync-Mutex" class="headerlink" title="Sync.Mutex"></a>Sync.Mutex</h2><h4 id="æ­£å¸¸æ¨¡å¼"><a href="#æ­£å¸¸æ¨¡å¼" class="headerlink" title="æ­£å¸¸æ¨¡å¼"></a>æ­£å¸¸æ¨¡å¼</h4><p>å½“ä¸€ä¸ª goroutine æŒæœ‰é”æ—¶ï¼Œåç»­çš„ goroutine ä¼šä»¥å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼æ’é˜Ÿç­‰å¾…ï¼Œå½“é”è¢«é‡Šæ”¾æ—¶ï¼Œé˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ª goroutine ä¼šè¢«å”¤é†’ã€‚ä½†æ˜¯å®ƒéœ€è¦å’Œæ–°åˆ°æ¥çš„ goroutine äº‰å¤ºé”ï¼Œç”±äºæ–°æ¥çš„ goroutine å·²ç»åœ¨ CPU ä¸­ï¼Œåˆšåˆšå”¤é†’çš„å¤§æ¦‚ç‡ä¼šç«äº‰å¤±è´¥ï¼Œé‡æ–°è¢«æ”¾åˆ°é˜Ÿé¦–ã€‚è¿™ç§æƒ…å†µæœ‰å¯èƒ½å¯¼è‡´ goroutine è¿Ÿè¿Ÿä¸èƒ½è¢«æ‰§è¡Œè€Œè¢«â€œé¥¿æ­»â€</p><h4 id="é¥¥é¥¿æ¨¡å¼"><a href="#é¥¥é¥¿æ¨¡å¼" class="headerlink" title="é¥¥é¥¿æ¨¡å¼"></a>é¥¥é¥¿æ¨¡å¼</h4><p>ä¸ºäº†è§£å†³â€œé¥¿æ­»â€çš„é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªç­‰å¾…çš„ goroutine è¶…è¿‡ 1 ms (starvationThresholdNs) æ²¡æœ‰å¾—åˆ°é”ï¼Œè¿™ä¸ªé”å°±ä¼šè¢«è½¬æ¢ä¸ºé¥¥é¥¿æ¨¡å¼ã€‚é¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œé”ä¼šç›´æ¥äº¤ç»™é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ª goroutineï¼Œè€Œæ–°æ¥çš„ goroutine ä¼šæ”¾åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚æ­£å¸¸çŠ¶æ€ä¸‹çš„æ€§èƒ½æ˜¯é«˜äºé¥¥é¥¿æ¨¡å¼çš„ï¼Œæ‰€ä»¥åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯åº”è¯¥å›åˆ°æ­£å¸¸æ¨¡å¼å»çš„ã€‚<br>å½“é˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ª goroutine è¢«æ‰§è¡Œæˆ–è€…å®ƒçš„ç­‰å¾…æ—¶é—´ä½äº 1 ms æ—¶ï¼Œä¼šå°†è¯¥é”çš„çŠ¶æ€åˆ‡æ¢å›æ­£å¸¸æ¨¡å¼ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Mutex <span class="keyword">struct</span> &#123; </span><br><span class="line"><span class="comment">// +---------------------------------+-----------+</span></span><br><span class="line"><span class="comment">// |        WaitersCount             |  status   | </span></span><br><span class="line"><span class="comment">// +---------------------------------+-----------+ </span></span><br><span class="line"><span class="comment">// &lt;-----------+ 29 +---------------&gt; &lt;--+ 3 +---&gt;</span></span><br><span class="line">state <span class="type">int32</span> <span class="comment">// é”çŠ¶æ€ï¼Œå…¶ä¸­ä½ä¸‰ä½ç”¨æ¥è¡¨ç¤ºé”çŠ¶æ€ï¼Œé«˜ 29 ä½ç”¨æ¥è®°å½•ç­‰å¾…å½“å‰äº’æ–¥é”çš„ goroutine ä¸ªæ•°</span></span><br><span class="line">sema <span class="type">uint32</span> <span class="comment">// æ§åˆ¶é”çŠ¶æ€çš„ä¿¡å·é‡</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> ( </span><br><span class="line">mutexLocked = <span class="number">1</span> &lt;&lt; <span class="literal">iota</span> <span class="comment">// 0001 è¡¨ç¤ºäº’æ–¥é”å¤„äºé”å®šçŠ¶æ€ </span></span><br><span class="line">mutexWoken <span class="comment">// 0010 è¡¨ç¤ºä»æ­£å¸¸æ¨¡å¼è¢«å”¤é†’ </span></span><br><span class="line">mutexStarving <span class="comment">// 0100 é¥¥é¥¿æ¨¡å¼ </span></span><br><span class="line">mutexWaiterShift = <span class="literal">iota</span> <span class="comment">// 3 è¡¨ç¤ºé™¤ WaitersCount å¤–ï¼ŒçŠ¶æ€å ç”¨äº†ä¸‰ä¸ª bite </span></span><br><span class="line">starvationThresholdNs = <span class="number">1e6</span> <span class="comment">// é¥¥é¥¿çš„é˜ˆå€¼ï¼Œ 1ms </span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h4><p>é€šè¿‡ CAS åˆ¤æ–­ <code>m.state == 0</code> æ—¶ï¼Œæ„å‘³ç€å½“å‰é”å¤„äºæ­£å¸¸çš„è§£é”çŠ¶æ€ï¼Œåªéœ€è¦å°†é”è®¾ç½®ä¸º <code>mutexLocked</code> å³å¯ï¼Œå¦åˆ™å°±éœ€è¦è¿›å…¥ <code>lockSlow</code> é€šè¿‡è‡ªæ—‹ç­‰æ–¹å¼ç­‰å¾…é”é‡Šæ”¾ã€‚<code>lockslow</code> å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>åˆ¤æ–­æ˜¯å¦å¯ä»¥è‡ªæ—‹ï¼šè‡ªæ—‹éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š<ul><li>å¤„äºæ­£å¸¸æ¨¡å¼ï¼Œä¸”é”å·²ç»è¢«é”å®š</li><li><code>runtime_canSpin</code> è¿”å› true:<ul><li>è¿è¡Œåœ¨å¤š CPU çš„æœºå™¨ä¸Šï¼›</li><li>å½“å‰ Goroutine ä¸ºäº†è·å–è¯¥é”è¿›å…¥è‡ªæ—‹çš„æ¬¡æ•°å°äºå››æ¬¡ï¼›</li><li>å½“å‰æœºå™¨ä¸Šè‡³å°‘å­˜åœ¨ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å¤„ç†å™¨ P å¹¶ä¸”å¤„ç†çš„è¿è¡Œé˜Ÿåˆ—ä¸ºç©ºï¼›</li></ul></li></ul></li><li>ä¸€æ—¦è¿›å…¥è‡ªæ—‹ï¼Œä¼šé€šè¿‡ <code>runtime_doSpin</code> ,å»æ‰§è¡Œ 30 æ¬¡çš„ <code>PAUSE</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤åªä¼šå ç”¨ CPU å¹¶æ¶ˆè€— CPU æ—¶é—´ï¼Œä¸€æ—¦ä¸æ»¡è¶³ä¸Šé¢çš„ä¸¤ä¸ªæ¡ä»¶äº†ï¼Œå°±ä¼šå»è®¡ç®—å½“å‰é”çš„æœ€æ–°çŠ¶æ€ï¼Œå¯¼è‡´å…¶ä¸æ»¡è¶³çš„åŸå› æœ‰å¾ˆå¤šï¼Œå¦‚ï¼š<ul><li>å…¶ä»– goroutine å·²ç»é‡Šæ”¾é”</li><li>å…¶ä»– goroutine å¯¼è‡´è¯¥é”è¿›å…¥é¥¥é¥¿æ¨¡å¼</li><li>è‡ªæ—‹æ¬¡æ•°è¶…è¿‡ 4 æ¬¡</li></ul></li><li>è®¡ç®—å’Œæ›´æ–°çŠ¶æ€å…¶å®å°±æ˜¯å»æ›´æ–° <code>state</code> ä¸­çš„å››ä¸ªå€¼ï¼›ä¸€æ—¦è®¡ç®—å®Œæ¯•åï¼Œé€šè¿‡ CAS å°è¯•æ›´æ–°<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span></span> Lock() &#123; </span><br><span class="line"><span class="comment">// Fast path: grab unlocked mutex. </span></span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;m.state, <span class="number">0</span>, mutexLocked) &#123; </span><br><span class="line"><span class="keyword">if</span> race.Enabled &#123; </span><br><span class="line">race.Acquire(unsafe.Pointer(m)) </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// Slow path (outlined so that the fast path can be inlined) </span></span><br><span class="line">m.lockSlow() </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="Unlock"><a href="#Unlock" class="headerlink" title="Unlock"></a>Unlock</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span></span> Unlock() &#123; </span><br><span class="line"><span class="keyword">if</span> race.Enabled &#123; </span><br><span class="line">_ = m.state race.Release(unsafe.Pointer(m)) </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// å¦‚æœ m.state - mutexLocked == 0 è¯´æ˜æ²¡äººç­‰å¾…è¯¥é”ï¼ŒåŒæ—¶è¯¥é”å¤„äºæ­£å¸¸çŠ¶æ€ </span></span><br><span class="line"><span class="comment">// è¿™æ—¶å¯ä»¥å¿«é€Ÿè§£é”ï¼Œå³é”çŠ¶æ€ä¼šç›´æ¥èµ‹æˆ 0 </span></span><br><span class="line"><span class="built_in">new</span> := atomic.AddInt32(&amp;m.state, -mutexLocked) </span><br><span class="line"><span class="keyword">if</span> <span class="built_in">new</span> != <span class="number">0</span> &#123; </span><br><span class="line"><span class="comment">// å¦åˆ™åˆ™éœ€è¦æ…¢é€Ÿè§£é” </span></span><br><span class="line">m.unlockSlow(<span class="built_in">new</span>) </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span></span> unlockSlow(<span class="built_in">new</span> <span class="type">int32</span>) &#123; </span><br><span class="line"><span class="comment">// å¦‚æœé”æ²¡é”å®šï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ </span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">new</span>+mutexLocked)&amp;mutexLocked == <span class="number">0</span> &#123; </span><br><span class="line">throw(<span class="string">&quot;sync: unlock of unlocked mutex&quot;</span>) </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// æ­£å¸¸æ¨¡å¼ä¸‹ </span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">new</span>&amp;mutexStarving == <span class="number">0</span> &#123; </span><br><span class="line">old := <span class="built_in">new</span> </span><br><span class="line"><span class="keyword">for</span> &#123; </span><br><span class="line"><span class="comment">// å¦‚æœæ²¡æœ‰å…¶ä»–ç­‰å¾…è€…æˆ–è€…é”ä¸å¤„äºç©ºé—²çŠ¶æ€ï¼Œç›´æ¥è¿”å›ï¼Œä¸éœ€è¦å”¤é†’å…¶ä»–ç­‰å¾…ç€ </span></span><br><span class="line"><span class="keyword">if</span> old&gt;&gt;mutexWaiterShift == <span class="number">0</span> || old&amp;(mutexLocked|mutexWoken|mutexStarving) != <span class="number">0</span> &#123; </span><br><span class="line"><span class="keyword">return</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// å”¤é†’æ–°çš„ç­‰å¾…è€… </span></span><br><span class="line"><span class="comment">// ç­‰å¾…è€…å‡ä¸€ï¼Œè®¾ç½®å”¤é†’æ ‡å¿— woken </span></span><br><span class="line"><span class="built_in">new</span> = (old - <span class="number">1</span>&lt;&lt;mutexWaiterShift) | mutexWoken </span><br><span class="line"><span class="comment">// è®¾ç½® state, å”¤é†’ä¸€ä¸ªé˜»å¡ç€çš„ goroutine </span></span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;m.state, old, <span class="built_in">new</span>) &#123; </span><br><span class="line">runtime_Semrelease(&amp;m.sema, <span class="literal">false</span>, <span class="number">1</span>) </span><br><span class="line"><span class="keyword">return</span> </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// è®¾ç½®å¤±è´¥ï¼Œé‡æ–°è·å–çŠ¶æ€è®¾ç½® </span></span><br><span class="line">old = m.state </span><br><span class="line">&#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// é¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œç›´æ¥å”¤é†’é˜Ÿé¦–çš„ goroutineï¼Œè¿™æ—¶ mutexLocked ä½ä¾ç„¶æ˜¯ 0 </span></span><br><span class="line"><span class="comment">// ä½†ç”±äºå¤„åœ¨é¥¥é¥¿çŠ¶æ€ä¸‹ï¼Œé”ä¸ä¼šè¢«å…¶ä»–æ–°æ¥çš„ goroutine æŠ¢å  </span></span><br><span class="line">runtime_Semrelease(&amp;m.sema, <span class="literal">true</span>, <span class="number">1</span>) </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><h2 id="æ‹·è´"><a href="#æ‹·è´" class="headerlink" title="æ‹·è´"></a>æ‹·è´</h2><h4 id="1ã€æµ…æ‹·è´"><a href="#1ã€æµ…æ‹·è´" class="headerlink" title="1ã€æµ…æ‹·è´"></a>1ã€æµ…æ‹·è´</h4><p>æµ…æ‹·è´æ˜¯æŒ‡å¯¹åœ°å€çš„æ‹·è´<br>æµ…æ‹·è´çš„æ˜¯æ•°æ®åœ°å€ï¼Œåªå¤åˆ¶æŒ‡å‘çš„å¯¹è±¡çš„æŒ‡é’ˆï¼Œæ­¤æ—¶æ–°å¯¹è±¡å’Œè€å¯¹è±¡æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œæ–°å¯¹è±¡å€¼ä¿®æ”¹æ—¶è€å¯¹è±¡ä¹Ÿä¼šå˜åŒ–ï¼Œé‡Šæ”¾å†…å­˜åœ°å€æ—¶ï¼ŒåŒæ—¶é‡Šæ”¾å†…å­˜åœ°å€<br>å¼•ç”¨ç±»å‹çš„éƒ½æ˜¯æµ…æ‹·è´ï¼š<code>slice</code>ã€<code>map</code>ã€<code>function</code><br>æµ…æ‹·è´çš„ç‰¹ç‚¹ï¼š</p><ul><li>æ‹·è´çš„æ—¶å€™ä»…ä»…æ‹·è´åœ°å€ï¼Œåœ°å€æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ä¸ªå€¼</li><li>åœ¨<code>a</code>ä¸­ä¿®æ”¹ï¼Œåˆ™<code>b</code>ä¸­ä¹Ÿè·Ÿç€å˜åŒ–</li><li>å†…å­˜é”€æ¯æ˜¯ä¸€è‡´çš„</li></ul><h4 id="2ã€æ·±æ‹·è´"><a href="#2ã€æ·±æ‹·è´" class="headerlink" title="2ã€æ·±æ‹·è´"></a>2ã€æ·±æ‹·è´</h4><p>æ·±æ‹·è´æ˜¯æŒ‡å°†åœ°å€æŒ‡å‘çš„å€¼è¿›è¡Œæ‹·è´<br>æ·±æ‹·è´çš„æ˜¯æ•°æ®æœ¬èº«ï¼Œåˆ›é€ ä¸€ä¸ªä¸€æ ·çš„æ–°å¯¹è±¡ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡ä¸åŸå¯¹è±¡ä¸å…±äº«å†…å­˜ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„å†…å­˜åœ°å€ï¼Œæ–°å¯¹è±¡å€¼ä¿®æ”¹æ—¶ä¸ä¼šå½±å“åŸå¯¹è±¡å€¼ã€‚æ—¢ç„¶å†…å­˜åœ°å€ä¸åŒï¼Œé‡Šæ”¾å†…å­˜åœ°å€æ—¶ï¼Œå¯åˆ†åˆ«é‡Šæ”¾<br>å€¼ç±»ä¼¼çš„éƒ½æ˜¯æ·±æ‹·è´ï¼š<code>int</code>ã€<code>float</code>ã€<code>bool</code>ã€<code>array</code>ã€<code>struct</code><br>æ·±æ‹·è´çš„ç‰¹ç‚¹ï¼š</p><ul><li>å¤åˆ¶çš„æ—¶å€™ä¼šæ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡</li><li>æŒ‡å‘å®Œå…¨ä¸åŒçš„å†…å­˜åœ°å€</li><li>ä¿®æ”¹æ˜¯äº’ä¸å½±å“çš„<br>é€šè¿‡æŒ‡é’ˆæ±‚å€¼ï¼Œå°†å€¼æ‹·è´å®ç°ï¼Œä¿®æ”¹æ‹·è´çš„å€¼ä¸å½±å“åŸæ¥çš„å€¼<h4 id="3ã€ç»“æ„ä½“çš„æ·±æ‹·è´"><a href="#3ã€ç»“æ„ä½“çš„æ·±æ‹·è´" class="headerlink" title="3ã€ç»“æ„ä½“çš„æ·±æ‹·è´"></a>3ã€ç»“æ„ä½“çš„æ·±æ‹·è´</h4>é»˜è®¤æƒ…å†µä¸‹ï¼Œç»“æ„ä½“ç±»å‹ä¸­çš„å­—æ®µæ˜¯å€¼ç±»å‹ï¼Œæ‹·è´æ—¶éƒ½æ˜¯æ·±æ‹·è´<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Per <span class="keyword">struct</span> &#123; </span><br><span class="line">Name <span class="type">string</span> </span><br><span class="line">Age <span class="type">int</span> </span><br><span class="line">HouseIds [<span class="number">2</span>]<span class="type">int</span> </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123; </span><br><span class="line">p1 := Per&#123; Name: <span class="string">&quot;ssgeek&quot;</span>, Age: <span class="number">24</span>, HouseIds: [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">22</span>, <span class="number">33</span>&#125;, &#125; </span><br><span class="line">p2 := p1 </span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p1, &amp;p1) <span class="comment">// &#123;ssgeek 24 [22 33]&#125; 0xc000180030 </span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p2, &amp;p2) <span class="comment">// &#123;ssgeek 24 [22 33]&#125; 0xc000180060 </span></span><br><span class="line">p2.Age = <span class="number">19</span> </span><br><span class="line">p2.Name = <span class="string">&quot;likui&quot;</span> </span><br><span class="line">p2.HouseIds[<span class="number">1</span>] = <span class="number">44</span> </span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p1, &amp;p1) <span class="comment">// &#123;ssgeek 24 [22 33]&#125; 0xc000098180 </span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p2, &amp;p2) <span class="comment">// &#123;likui 19 [22 44]&#125; 0xc0000981b0 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4ã€ç»“æ„ä½“çš„æµ…æ‹·è´"><a href="#4ã€ç»“æ„ä½“çš„æµ…æ‹·è´" class="headerlink" title="4ã€ç»“æ„ä½“çš„æµ…æ‹·è´"></a>4ã€ç»“æ„ä½“çš„æµ…æ‹·è´</h4>ä½¿ç”¨æŒ‡é’ˆè¿›è¡Œæµ…æ‹·è´ï¼Œæµ…æ‹·è´ä¸­ï¼Œå¯ä»¥çœ‹åˆ°<code>p1</code>å’Œ<code>p2</code>çš„å†…å­˜åœ°å€æ˜¯ç›¸åŒçš„ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦ä¸€ä¸ªä¹Ÿä¼šäº§ç”Ÿå˜åŒ–<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span> </span><br><span class="line"><span class="keyword">type</span> Per <span class="keyword">struct</span> &#123; </span><br><span class="line">Name <span class="type">string</span> </span><br><span class="line">Age <span class="type">int</span> </span><br><span class="line">HouseIds [<span class="number">2</span>]<span class="type">int</span> </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123; </span><br><span class="line">p1 := Per&#123; Name: <span class="string">&quot;ssgeek&quot;</span>, Age: <span class="number">24</span>, HouseIds: [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">22</span>, <span class="number">33</span>&#125;, &#125; </span><br><span class="line">p2 := &amp;p1 </span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p1, &amp;p1) <span class="comment">// &#123;ssgeek 24 [22 33]&#125; 0xc000076180 </span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p2, p2) <span class="comment">// &amp;&#123;ssgeek 24 [22 33]&#125; 0xc000076180 </span></span><br><span class="line">p2.Age = <span class="number">19</span> </span><br><span class="line">p2.Name = <span class="string">&quot;likui&quot;</span> </span><br><span class="line">p2.HouseIds[<span class="number">1</span>] = <span class="number">44</span> </span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p1, &amp;p1) <span class="comment">// &#123;likui 19 [22 44]&#125; 0xc000076180 </span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%v %p \n&quot;</span>, p2, p2) <span class="comment">// &amp;&#123;likui 19 [22 44]&#125; 0xc000076180 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="5ã€ç»“æ„ä½“å€¼ç±»å‹çš„æµ…æ‹·è´"><a href="#5ã€ç»“æ„ä½“å€¼ç±»å‹çš„æµ…æ‹·è´" class="headerlink" title="5ã€ç»“æ„ä½“å€¼ç±»å‹çš„æµ…æ‹·è´"></a>5ã€ç»“æ„ä½“å€¼ç±»å‹çš„æµ…æ‹·è´</h4><p>ä½¿ç”¨<code>new</code>å‡½æ•°å®ç°å€¼ç±»å‹çš„æµ…æ‹·è´<br>å€¼ç±»å‹çš„é»˜è®¤æ˜¯æ·±æ‹·è´ï¼Œæƒ³è¦å®ç°å€¼ç±»å‹çš„æµ…æ‹·è´ï¼Œä¸€èˆ¬æ˜¯ä¸¤ç§æ–¹æ³•</p><ul><li>ä½¿ç”¨æŒ‡é’ˆ</li><li>ä½¿ç”¨newå‡½æ•°ï¼ˆnewå‡½æ•°è¿”å›çš„æ˜¯æŒ‡é’ˆï¼‰</li></ul><h4 id="6ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æµ…æ‹·è´"><a href="#6ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æµ…æ‹·è´" class="headerlink" title="6ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æµ…æ‹·è´"></a>6ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æµ…æ‹·è´</h4><p>ç»“æ„ä½“é»˜è®¤æ˜¯æ·±æ‹·è´ï¼Œä½†å¦‚æœç»“æ„ä½“ä¸­åŒ…å«mapã€sliceç­‰è¿™äº›å¼•ç”¨ç±»å‹ï¼Œé»˜è®¤ä¹Ÿè¿˜æ˜¯æµ…æ‹·è´<br>mapæ˜¯å¼•ç”¨ç±»å‹ï¼Œå¼•ç”¨ç±»å‹æµ…æ‹·è´æ˜¯é»˜è®¤çš„æƒ…å†µ</p><h4 id="7ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æ·±æ‹·è´"><a href="#7ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æ·±æ‹·è´" class="headerlink" title="7ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æ·±æ‹·è´"></a>7ã€ç»“æ„ä½“å¼•ç”¨ç±»å‹çš„æ·±æ‹·è´</h4><p>ç»“æ„ä½“ä¸­å«æœ‰å¼•ç”¨ç±»å‹çš„å­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸ªå­—æ®µå°±æ˜¯æµ…æ‹·è´ï¼Œä½†æ˜¯å¾€å¾€å¸Œæœ›çš„æ˜¯æ·±æ‹·è´ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹</p><ul><li>æ–¹æ³•ä¸€ï¼šæŒ¨ä¸ªæŠŠå¯å¯¼è‡´æµ…æ‹·è´çš„å¼•ç”¨ç±»å‹å­—æ®µè‡ªè¡Œèµ‹å€¼ã€‚èµ‹å€¼åï¼Œä¿®æ”¹å€¼å°±ç›¸äº’ä¸å½±å“äº†</li><li>æ–¹æ³•äºŒï¼šä½¿ç”¨<code>json</code>æˆ–åå°„ã€‚ç®€å•æ¥è¯´ï¼š<code>json</code>å°†å¼•ç”¨ç±»å‹çš„æ•°æ®è¿›è¡Œ<code>dump</code>ï¼Œ<code>dump</code>åå°±å’ŒåŸæ¥çš„å¼•ç”¨ç±»å‹æ²¡æœ‰å…³ç³»äº†</li></ul><h2 id="GMP"><a href="#GMP" class="headerlink" title="GMP"></a>GMP</h2><h4 id="Go-åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ"><a href="#Go-åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="Go åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ"></a>Go åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h4><p>è¿™å°±è¦ä»è¿›ç¨‹ï¼Œçº¿ç¨‹ï¼Œåç¨‹ä¸‰è€…çš„å…³ç³»è®²èµ·ã€‚<br>æœ€æ—©çš„è¿›ç¨‹æ—¶ä»£ï¼Œæ˜¯å• CPU å•è¿›ç¨‹ï¼Œä¸€åˆ‡çš†æ˜¯ä¸²è¡Œæ‰§è¡Œï¼›åˆ°äº†å¤šè¿›ç¨‹&#x2F;çº¿ç¨‹æ—¶ä»£ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹é˜»å¡æ—¶ï¼Œåˆ‡æ¢åˆ°å¦å¤–ç­‰å€™çš„è¿›ç¨‹ï¼Œæ—¶é—´ç‰‡è½®è½¬æ³•ä¿è¯äº†ç­‰å¾…çš„è¿›ç¨‹éƒ½èƒ½å¤Ÿè¢«è¿è¡Œï¼Œä½†æ˜¯è¿›ç¨‹é—´çš„è°ƒåº¦ä¼šå ç”¨CPUå¤§éƒ¨åˆ†æ—¶é—´ï¼›è€Œåˆ°äº†é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œä¸ºæ¯ä¸ªä»»åŠ¡éƒ½å»åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œé‚£ä¹ˆï¼Œgolang å°†åŸæ¥çš„çº¿ç¨‹åˆ†ä¸ºäº†ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ç”¨æˆ·çº§åˆ«çš„çº¿ç¨‹ï¼ˆè½»é‡çº§çš„çº¿ç¨‹ï¼Œè¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œå³ goroutineï¼‰ï¼Œä¸€ä¸ªæ˜¯å†…æ ¸çº§çš„çº¿ç¨‹ï¼ˆå³ä¸€èˆ¬æ„ä¹‰ä¸Šçš„çº¿ç¨‹ï¼Œè¿è¡Œåœ¨å†…æ ¸æ€ï¼‰ï¼Œè¿™æ ·ï¼Œå¯¹äºåç¨‹çš„åˆ‡æ¢å’Œè°ƒåº¦éƒ½æ˜¯åœ¨ç”¨æˆ·æ€è¿›è¡Œï¼Œä¸æ¶‰åŠå†…æ ¸çº§åˆ«çš„è°ƒåº¦ï¼Œå› æ­¤è¿™æ˜¯ goroutine èƒ½å¤Ÿå¾ˆå¥½åœ°æ”¯æŒé«˜å¹¶å‘çš„åœºæ™¯çš„åŸºç¡€ã€‚</p><ul><li>è¿›ç¨‹: è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ã€‚ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡é‡ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ã€‚</li><li>çº¿ç¨‹: çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,çº¿ç¨‹æ˜¯å†…æ ¸æ€,è€Œä¸”æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚</li><li>ç¨‹: åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåç¨‹çš„è°ƒåº¦å®Œå…¨æ˜¯ç”±ç”¨æˆ·æ¥æ§åˆ¶çš„ã€‚åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆã€‚åç¨‹è°ƒåº¦åˆ‡æ¢æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡å›æ¥çš„æ—¶å€™ï¼Œæ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œç›´æ¥æ“ä½œæ ˆåˆ™åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œå¯ä»¥ä¸åŠ é”çš„è®¿é—®å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çš„åˆ‡æ¢éå¸¸å¿«ã€‚</li></ul><h4 id="è°ƒåº¦å™¨çš„ä¸‰ä¸ªåŸºæœ¬å¯¹è±¡ï¼š"><a href="#è°ƒåº¦å™¨çš„ä¸‰ä¸ªåŸºæœ¬å¯¹è±¡ï¼š" class="headerlink" title="è°ƒåº¦å™¨çš„ä¸‰ä¸ªåŸºæœ¬å¯¹è±¡ï¼š"></a>è°ƒåº¦å™¨çš„ä¸‰ä¸ªåŸºæœ¬å¯¹è±¡ï¼š</h4><ul><li><p>Gï¼ˆGoroutineï¼‰ï¼Œä»£è¡¨åç¨‹ï¼Œgoå…³é”®å­—åˆ›å»ºçš„å¯¹è±¡</p></li><li><p>Mï¼ˆWork Threadï¼‰ï¼Œå·¥ä½œçº¿ç¨‹ï¼Œä¸€ä¸ª M å…³è”ä¸€ä¸ªå†…æ ¸çº§çº¿ç¨‹</p></li><li><p>Pï¼ˆProcessorï¼‰ï¼Œä»£è¡¨ä¸€ä¸ª å¤„ç†å™¨ï¼Œåˆç§°ä¸Šä¸‹æ–‡</p><h4 id="G-M-Pä¸‰è€…çš„å…³ç³»ä¸ç‰¹ç‚¹ï¼š"><a href="#G-M-Pä¸‰è€…çš„å…³ç³»ä¸ç‰¹ç‚¹ï¼š" class="headerlink" title="G-M-Pä¸‰è€…çš„å…³ç³»ä¸ç‰¹ç‚¹ï¼š"></a>G-M-Pä¸‰è€…çš„å…³ç³»ä¸ç‰¹ç‚¹ï¼š</h4></li><li><p>æ¯ä¸€ä¸ªè¿è¡Œçš„ M å¿…é¡»ç»‘å®šä¸€ä¸ª Pï¼Œçº¿ç¨‹ M åˆ›å»ºåä¼šæ£€æŸ¥å¹¶æ‰§è¡ŒGï¼ˆgoroutineï¼‰å¯¹è±¡ã€‚</p></li><li><p>æ¯ä¸€ä¸ª P ä¿å­˜ç€ä¸€ä¸ªåç¨‹ G çš„é˜Ÿåˆ—ã€‚</p></li><li><p>é™¤äº†æ¯ä¸ª P è‡ªèº«ä¿å­˜çš„Gçš„é˜Ÿåˆ—å¤–ï¼Œè°ƒåº¦å™¨è¿˜æœ‰ä¸€ä¸ªå…¨å±€çš„Gé˜Ÿåˆ—</p></li><li><p>M ä»é˜Ÿåˆ—ä¸­æå– Gï¼Œå¹¶æ‰§è¡Œ</p></li><li><p>P çš„ä¸ªæ•°å°±æ˜¯ GOMAXPROCSï¼ˆæœ€å¤§256ï¼‰ï¼Œå¯åŠ¨æ—¶å›ºå®šï¼Œä¸€èˆ¬ä¸ä¿®æ”¹</p></li><li><p>M çš„ä¸ªæ•°å’Œ P çš„ä¸ªæ•°ä¸ä¸€å®šä¸€æ ·å¤šï¼ˆä¼šæœ‰sleepçš„Mæˆ–è€…Pä¸ç»‘å®šMï¼‰(æœ€å¤§10000)</p></li><li><p>P æ˜¯ç”¨ä¸€ä¸ªå…¨å±€æ•°ç»„(255)æ¥ä¿å­˜çš„ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªå…¨å±€çš„ P çš„ç©ºé—²é“¾è¡¨</p></li></ul><h4 id="å±€éƒ¨Gé˜Ÿåˆ—ä¸å…¨å±€Gé˜Ÿåˆ—çš„å…³ç³»"><a href="#å±€éƒ¨Gé˜Ÿåˆ—ä¸å…¨å±€Gé˜Ÿåˆ—çš„å…³ç³»" class="headerlink" title="å±€éƒ¨Gé˜Ÿåˆ—ä¸å…¨å±€Gé˜Ÿåˆ—çš„å…³ç³»"></a>å±€éƒ¨Gé˜Ÿåˆ—ä¸å…¨å±€Gé˜Ÿåˆ—çš„å…³ç³»</h4><ul><li>å…¨å±€Gä»»åŠ¡é˜Ÿåˆ—ä¼šå’Œæœ¬åœ°Gä»»åŠ¡é˜Ÿåˆ—æŒ‰ç…§ä¸€å®šç­–ç•¥äº’ç›¸äº¤æ¢ã€‚</li><li>Gçš„æ‰§è¡Œé¡ºåºï¼Œå…ˆä»æœ¬åœ°é˜Ÿåˆ—æ‰¾ï¼Œæœ¬åœ°æ²¡æœ‰åˆ™ä»å…¨å±€é˜Ÿåˆ—æ‰¾</li><li>è½¬ç§»Â  Â  å±€éƒ¨ä¸å…¨å±€ï¼Œå…¨å±€Gä¸ªæ•°&#x2F;Pä¸ªæ•°Â  Â å±€éƒ¨ä¸å±€éƒ¨ï¼Œä¸€æ¬¡æ€§è½¬ç§»ä¸€åŠ</li></ul><h4 id="Gorutine-ä»å…¥é˜Ÿåˆ°æ‰§è¡Œ"><a href="#Gorutine-ä»å…¥é˜Ÿåˆ°æ‰§è¡Œ" class="headerlink" title="Gorutine ä»å…¥é˜Ÿåˆ°æ‰§è¡Œ"></a>Gorutine ä»å…¥é˜Ÿåˆ°æ‰§è¡Œ</h4><ol><li>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªGå¯¹è±¡ï¼Œå°±æ˜¯Â gorutineï¼Œå®ƒä¼šåŠ å…¥åˆ°æœ¬åœ°é˜Ÿåˆ—æˆ–è€…å…¨å±€é˜Ÿåˆ—</li><li>å¦‚æœè¿˜æœ‰ç©ºé—²çš„Pï¼Œåˆ™åˆ›å»ºä¸€ä¸ªM ç»‘å®šè¯¥ P ï¼Œæ³¨æ„ï¼è¿™é‡Œï¼ŒP æ­¤å‰å¿…é¡»è¿˜æ²¡ç»‘å®šè¿‡M çš„ï¼Œå¦åˆ™ä¸æ»¡è¶³ç©ºé—²çš„æ¡ä»¶<ol><li>å…ˆæ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„Pï¼Œå¦‚æœæ²¡æœ‰åˆ™ç›´æ¥è¿”å›</li><li>P ä¸ªæ•°ä¸ä¼šå ç”¨è¶…è¿‡è‡ªå·±è®¾å®šçš„cpuä¸ªæ•°</li><li>P åœ¨è¢« M ç»‘å®šåï¼Œå°±ä¼šåˆå§‹åŒ–è‡ªå·±çš„ G é˜Ÿåˆ—ï¼Œæ­¤æ—¶æ˜¯ä¸€ä¸ªç©ºé˜Ÿåˆ—</li></ol></li><li>M ä¼šå¯åŠ¨ä¸€ä¸ªåº•å±‚çº¿ç¨‹ï¼Œå¾ªç¯æ‰§è¡Œèƒ½æ‰¾åˆ°çš„ G ä»»åŠ¡ã€‚è¿™é‡Œçš„å¯»æ‰¾çš„ G ä»ä¸‹é¢å‡ æ–¹é¢æ‰¾ï¼š<ol><li>å½“å‰ M æ‰€ç»‘çš„ P é˜Ÿåˆ—ä¸­æ‰¾</li><li>å»åˆ«çš„ P çš„é˜Ÿåˆ—ä¸­æ‰¾</li><li>å»å…¨å±€ G é˜Ÿåˆ—ä¸­æ‰¾</li></ol></li><li>Gä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼Œå…ˆä»æœ¬åœ°é˜Ÿåˆ—æ‰¾ï¼Œæœ¬åœ°æ²¡æœ‰åˆ™ä»å…¨å±€é˜Ÿåˆ—æ‰¾</li><li>ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œé¦–å…ˆè·‘çš„æ˜¯ä¸»çº¿ç¨‹ï¼Œç„¶åè¿™ä¸ªä¸»çº¿ç¨‹ä¼šç»‘å®šç¬¬ä¸€ä¸ª P</li><li>å…¥å£ main å‡½æ•°ï¼Œå…¶å®æ˜¯ä½œä¸ºä¸€ä¸ª goroutine æ¥æ‰§è¡Œ</li></ol><p>1ã€runtimeåˆ›å»ºç¬¬ä¸€ä¸ªçº¿ç¨‹M0ï¼šM0æ˜¯å¯åŠ¨è¿›ç¨‹åçš„ç¼–å·ä¸º0çš„ä¸»çº¿ç¨‹ï¼Œè¿™ä¸ªMå¯¹åº”çš„å®ä¾‹ä¼šåœ¨å…¨å±€å˜é‡runtime.m0ä¸­ï¼Œä¸éœ€è¦åœ¨heapä¸Šåˆ†é…ï¼ŒM0è´Ÿè´£æ‰§è¡Œåˆå§‹åŒ–æ“ä½œå’Œå¯åŠ¨ç¬¬ä¸€ä¸ªGï¼Œåœ¨ä¹‹åM0å°±å’Œå…¶ä»–çš„Mä¸€æ ·äº†ã€‚<br>2ã€runtimeåˆ›å»ºç¬¬ä¸€ä¸ªGoåç¨‹G0ï¼šG0æ˜¯æ¯æ¬¡å¯åŠ¨ä¸€ä¸ªMéƒ½ä¼šç¬¬ä¸€ä¸ªåˆ›å»ºçš„goroutineï¼ŒG0ä»…ç”¨äºè´Ÿè´£è°ƒåº¦Gï¼ŒG0ä¸æŒ‡å‘ä»»ä½•å¯æ‰§è¡Œå‡½æ•°ï¼Œæ¯ä¸ªMéƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„G0ã€‚åœ¨è°ƒåº¦æˆ–ç³»ç»Ÿè°ƒç”¨æ—¶ä¼šä½¿ç”¨G0çš„æ ˆç©ºé—´ï¼Œå…¨å±€å˜é‡çš„G0æ˜¯M0çš„G0ã€‚ä¸€èˆ¬çš„G0æ”¾åœ¨æœ¬åœ°é˜Ÿåˆ—ä¸­ã€‚<br>3ã€å…³è”M0å’ŒG0ã€‚<br>4ã€è°ƒåº¦åˆå§‹åŒ–åˆå§‹åŒ–M0ã€æ ˆã€åƒåœ¾å›æ”¶ï¼Œä»¥åŠåˆ›å»ºå’Œåˆå§‹åŒ–ç”±GOMAXPROCSä¸ªPæ„æˆçš„Påˆ—è¡¨ã€‚<br>5ã€åˆ›å»ºmain()ä¸­çš„goroutineï¼Œå³runtime.mainåˆ›å»ºgoroutineã€‚<br>6ã€å¯åŠ¨M0ï¼Œæ­¤æ—¶M0å·²ç»ç»‘å®šäº†Pï¼Œä»Pçš„æœ¬åœ°é˜Ÿåˆ—ä¸­è·å–Gï¼Œè·å–åˆ°main goroutineã€‚<br>7ã€Mç»‘å®šPã€‚<br>8ã€å¾ªç¯åˆ¤æ–­Mé€šè¿‡Pæ˜¯å¦èƒ½å¤Ÿè·å–åˆ°Gã€‚<br>9ã€è·å–ä¸åˆ°åˆ™Mè¿›å…¥ä¼‘çœ é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’åå†é‡æ–°ä¸Pç»‘å®šã€‚<br>10ã€èƒ½å¤Ÿè·å–åˆ°Gï¼Œåˆ™Mæ ¹æ®Gä¸­çš„æ ˆä¿¡æ¯å’Œè°ƒåº¦ä¿¡æ¯è®¾ç½®è¿è¡Œç¯å¢ƒã€‚<br>11ã€Mæ‰§è¡ŒGã€‚<br>12ã€Gé€€å‡ºï¼Œruntime.mainæ‰§è¡ŒDeferå’ŒPanicå¤„ç†ï¼Œæˆ–è°ƒç”¨runtime.exité€€å‡ºç¨‹åºã€‚</p><h4 id="ä¸­æ–­æŒ‚èµ·ä¸æ¢å¤"><a href="#ä¸­æ–­æŒ‚èµ·ä¸æ¢å¤" class="headerlink" title="ä¸­æ–­æŒ‚èµ·ä¸æ¢å¤"></a>ä¸­æ–­æŒ‚èµ·ä¸æ¢å¤</h4><p>goroutineåç¨‹çš„ä¸­æ–­æŒ‚èµ·ä¸æ¢å¤ ï¼šåç¨‹çš„åˆ‡æ¢æ—¶é—´ç‰‡æ˜¯10msï¼Œä¹Ÿå°±æ˜¯è¯´ goroutine æœ€å¤šæ‰§è¡Œ10mså°±ä¼šè¢« M åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª Gã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œåˆè¢«ç§°ä¸º ä¸­æ–­ï¼ŒæŒ‚èµ·<br>goç¨‹åºå¯åŠ¨æ—¶ä¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„å†…æ ¸çº¿ç¨‹ sysmonï¼Œç”¨æ¥ç›‘æ§å’Œç®¡ç†ï¼Œå…¶å†…éƒ¨æ˜¯ä¸€ä¸ªå¾ªç¯ï¼š</p><ol><li>è®°å½•æ‰€æœ‰ P çš„ G ä»»åŠ¡çš„è®¡æ•° schedtickï¼Œschedtickä¼šåœ¨æ¯æ‰§è¡Œä¸€ä¸ªGä»»åŠ¡åé€’å¢</li><li>å¦‚æœæ£€æŸ¥åˆ° schedtick ä¸€ç›´æ²¡æœ‰é€’å¢ï¼Œè¯´æ˜è¿™ä¸ª P ä¸€ç›´åœ¨æ‰§è¡ŒåŒä¸€ä¸ª G ä»»åŠ¡ï¼Œå¦‚æœè¶…è¿‡10msï¼Œå°±åœ¨è¿™ä¸ªGä»»åŠ¡çš„æ ˆä¿¡æ¯é‡Œé¢åŠ ä¸€ä¸ª tag æ ‡è®°</li><li>ç„¶åè¿™ä¸ª G ä»»åŠ¡åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°éå†…è”å‡½æ•°è°ƒç”¨ï¼Œå°±ä¼šæ£€æŸ¥ä¸€æ¬¡è¿™ä¸ªæ ‡è®°ï¼Œç„¶åä¸­æ–­è‡ªå·±ï¼ŒæŠŠè‡ªå·±åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªG</li><li>å¦‚æœæ²¡æœ‰é‡åˆ°éå†…è”å‡½æ•° è°ƒç”¨ï¼ˆæœ‰æ—¶å€™æ­£å¸¸çš„å°å‡½æ•°ä¼šè¢«ä¼˜åŒ–æˆå†…è”å‡½æ•°ï¼‰çš„è¯ï¼Œé‚£å°±ä¼šä¸€ç›´æ‰§è¡Œè¿™ä¸ªGä»»åŠ¡ï¼Œç›´åˆ°å®ƒè‡ªå·±ç»“æŸï¼›å¦‚æœæ˜¯ä¸ªæ­»å¾ªç¯ï¼Œå¹¶ä¸” GOMAXPROCS&#x3D;1 çš„è¯ã€‚é‚£ä¹ˆä¸€ç›´åªä¼šåªæœ‰ä¸€ä¸ª P ä¸ä¸€ä¸ª Mï¼Œä¸”é˜Ÿåˆ—ä¸­çš„å…¶ä»– G ä¸ä¼šè¢«æ‰§è¡Œï¼</li></ol><p>ä¸­æ–­åçš„æ¢å¤</p><ol><li>ä¸­æ–­çš„æ—¶å€™å°†å¯„å­˜å™¨é‡Œçš„æ ˆä¿¡æ¯ï¼Œä¿å­˜åˆ°è‡ªå·±çš„ G å¯¹è±¡é‡Œé¢</li><li>å½“å†æ¬¡è½®åˆ°è‡ªå·±æ‰§è¡Œæ—¶ï¼Œå°†è‡ªå·±ä¿å­˜çš„æ ˆä¿¡æ¯å¤åˆ¶åˆ°å¯„å­˜å™¨é‡Œé¢ï¼Œè¿™æ ·å°±æ¥ç€ä¸Šæ¬¡ä¹‹åè¿è¡Œ</li></ol><h2 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h2><h2 id="ä¸€äº›ç»†ç¢çŸ¥è¯†ç‚¹"><a href="#ä¸€äº›ç»†ç¢çŸ¥è¯†ç‚¹" class="headerlink" title="ä¸€äº›ç»†ç¢çŸ¥è¯†ç‚¹"></a>ä¸€äº›ç»†ç¢çŸ¥è¯†ç‚¹</h2><h4 id="Golang-ä¼ å‚"><a href="#Golang-ä¼ å‚" class="headerlink" title="Golang ä¼ å‚"></a>Golang ä¼ å‚</h4><ol><li>ç†è®ºä¸Šæ¥è¯´ï¼ŒGolang åªæœ‰å€¼ä¼ é€’ï¼Œæ‰€æœ‰åç¨‹çš„å…¥å‚éƒ½æ˜¯å€¼æ‹·è´ï¼Œåç¨‹å†…éƒ¨çš„ä¿®æ”¹ï¼Œæ— æ³•å½±å“åŸå‚æ•°</li><li>å¯¹äºæŒ‡é’ˆç±»å‹çš„å‚æ•°ï¼Œæ˜¯å¯¹å…¶æŒ‡å‘åœ°å€çš„æ‹·è´ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åœ°å€æ¥ä¿®æ”¹åŸå‚æ•°</li><li>Slice åº•å±‚æ˜¯å¼•ç”¨æ•°ç»„ï¼Œå› æ­¤å¯¹äº Slice çš„ä¿®æ”¹å¯ä»¥åæ˜ åˆ°åŸæ•°ç»„ï¼›æ³¨æ„ æ‰©å®¹ç›¸å…³å†…å®¹</li><li></li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> go </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>todo</title>
      <link href="/uncategorized/todo/"/>
      <url>/uncategorized/todo/</url>
      
        <content type="html"><![CDATA[<p>raft<br><a href="https://cloud.tencent.com/developer/article/2168468">https://cloud.tencent.com/developer/article/2168468</a></p><p>sync.map<br><a href="https://cloud.tencent.com/developer/article/2140224">https://cloud.tencent.com/developer/article/2140224</a><br><a href="https://cloud.tencent.com/developer/article/2140226">https://cloud.tencent.com/developer/article/2140226</a><br>go.map<br><a href="https://blog.csdn.net/lp15929801907/article/details/130229409?utm_source=miniapp_weixin">https://blog.csdn.net/lp15929801907/article/details/130229409?utm_source=miniapp_weixin</a></p><p>sync.Mutex<br><a href="https://cloud.tencent.com/developer/article/2140227">https://cloud.tencent.com/developer/article/2140227</a></p><p>defer<br><a href="https://cloud.tencent.com/developer/article/1410243">https://cloud.tencent.com/developer/article/1410243</a></p><p>gmp<br><a href="https://cloud.tencent.com/developer/article/2191347">https://cloud.tencent.com/developer/article/2191347</a><br><a href="https://cloud.tencent.com/developer/article/1680164">https://cloud.tencent.com/developer/article/1680164</a></p><p>redis<br><a href="https://blog.csdn.net/qq1515312832/article/details/113880849">https://blog.csdn.net/qq1515312832/article/details/113880849</a></p><p>channel<br><a href="https://cloud.tencent.com/developer/article/1651356">https://cloud.tencent.com/developer/article/1651356</a></p><p>æ‹·è´<br><a href="https://cloud.tencent.com/developer/article/1870553">https://cloud.tencent.com/developer/article/1870553</a></p><p>åˆ·é¢˜ Leetcode<br>152</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/interview/simulation/%E8%AF%9D%E6%9C%AF/"/>
      <url>/interview/simulation/%E8%AF%9D%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<h3 id="è‡ªæˆ‘ä»‹ç»ï¼š"><a href="#è‡ªæˆ‘ä»‹ç»ï¼š" class="headerlink" title="è‡ªæˆ‘ä»‹ç»ï¼š"></a>è‡ªæˆ‘ä»‹ç»ï¼š</h3><p>æ‚¨å¥½ï¼Œæˆ‘æ˜¯ç‹é‘«å®‡ï¼Œéå¸¸æ„Ÿè°¢ç»™æˆ‘çš„è¿™æ¬¡é¢è¯•æœºä¼šï¼Œæ‹¥æœ‰å‡ å¹´k12æ•™è‚²å…¬å¸è´Ÿè´£å¢é•¿ä¸šåŠ¡ç›¸å…³çš„ç³»ç»Ÿå’Œæ¨¡å‹è®¾è®¡ï¼Œå…¶ä¸­ä¸»è¦åŒ…æ‹¬æ´»åŠ¨è¥é”€å¹³å°çš„å¼€å‘ï¼Œä»¥åŠç›¸å…³ç³»ç»Ÿçš„é‡æ„ä¸å‡çº§ï¼Œæœ‰è¿‡å¤šæ¬¡å¤§å‹ç³»ç»Ÿç ”å‘ç»éªŒï¼Œæœ‰è¿‡å¤šæ¬¡è·¨éƒ¨é—¨ç³»ç»Ÿç ”å‘ç»éªŒã€‚æœ‰è¿‡5äººå°ç»„çš„ç®¡ç†ç»éªŒã€‚</p><h3 id="æ‚¨åœ¨å‰ä¸€å®¶å…¬å¸çš„ç¦»èŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ‚¨åœ¨å‰ä¸€å®¶å…¬å¸çš„ç¦»èŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ‚¨åœ¨å‰ä¸€å®¶å…¬å¸çš„ç¦»èŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ‚¨åœ¨å‰ä¸€å®¶å…¬å¸çš„ç¦»èŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>æ”¿ç­–é™åˆ¶åï¼Œå…¬å¸å°è¯•äº†å¤šç§æ–¹å‘ï¼Œæ¯”å¦‚æµ·å¤–ä¸šåŠ¡ã€å¤šå­¦ç§‘ç­‰æ¢ç´¢ï¼Œåˆæ­¥æ˜¯æœ‰ä¸€äº›æˆæœçš„ã€‚æˆ‘è‡ªèº«æ¥è¯´è¿˜æ˜¯æƒ³è¦å’Œå…¬å¸ä¸€åŒå‘å±•çš„ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå„æ–¹å‘ä¸šåŠ¡æ”¶ç¼©ï¼Œç ”å‘å·¥ä½œä»¥ç»´æŠ¤ä¸ºä¸»ï¼Œå¯¹äºç³»ç»Ÿå±‚é¢çš„è¿­ä»£å®é™…ä¸Šæ˜¯åœ¨ä¸æ–­åœ°åšå‡æ³•ã€‚å¹¶ä¸”å®¶äººç”Ÿç—…ï¼Œéœ€è¦äººæ‰‹ç…§é¡¾ï¼Œç»¼åˆè€ƒè™‘ä¸‹å°±å‡ºæ¥äº†</p><p>ä½¿ç”¨ etcd æ¥å®Œæˆå¾®æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Œä½¿ç”¨ thrift å’Œ grpc ä½œä¸ºå¾®æœåŠ¡çš„æ¡†æ¶ã€‚<br>rpcè®¿é—®é‡ã€è€—æ—¶ï¼Œsqlè€—æ—¶ç­‰å…³é”®æŒ‡æ ‡æš´éœ²ç»™ Prometheusï¼Œå¹¶é€šè¿‡ Grafana å±•ç¤ºï¼Œä¾¿äºç›‘æ§æœåŠ¡è´¨é‡ï¼Œä»¥åŠå‡ºç°é—®é¢˜æ—¶å¯ä»¥å¸®åŠ©å¿«é€Ÿå®šä½å¼‚å¸¸æ¥å£</p><p>contextå¤šæ•°ç”¨æ¥è¿›è¡Œä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¼šè®°å½•æ•´æ¡è°ƒç”¨é“¾è·¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¶…æ—¶æœºåˆ¶ï¼›contextåªèƒ½è‡ªé¡¶å‘ä¸‹ä¼ å€¼ï¼›contextä¸€å®šä¸èƒ½ä¸ºnilï¼Œåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ context.TODO() æˆ–è€… context.Background()</p><p>etcdä¸­çš„åˆ†å¸ƒå¼é”ä¸€èˆ¬ç”¨æ¥åœ¨é›†ç¾¤ç³»ç»Ÿå¯åŠ¨æ—¶ç¡®å®šç”±å“ªä¸€ä¸ªç³»ç»Ÿæ¥å…¨å±€å•ä¾‹ä¸šåŠ¡æ“ä½œï¼Œæ¯”å¦‚æ•°æ®åˆ·æ–°ã€ä¸šåŠ¡æ•°æ®æ¸…æ´—ç­‰<br>ä¾æ®å½“å‰æ¥å£çš„å”¯ä¸€æ ‡è¯†æ•°æ®æ¥å®ç°å¹‚ç­‰<br>ä¸åŒç³»ç»Ÿé—´è°ƒç”¨é¡ºåºå¯ä»¥ç”¨æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯<br>åˆ†å¸ƒå¼çš„CAPç†è®ºå‘Šè¯‰æˆ‘ä»¬â€œä»»ä½•ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿéƒ½æ— æ³•åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸¤é¡¹ã€‚â€æ‰€ä»¥ï¼Œå¾ˆå¤šç³»ç»Ÿåœ¨è®¾è®¡ä¹‹åˆå°±è¦å¯¹è¿™ä¸‰è€…åšå‡ºå–èˆã€‚åœ¨äº’è”ç½‘é¢†åŸŸçš„ç»å¤§å¤šæ•°çš„åœºæ™¯ä¸­ï¼Œéƒ½éœ€è¦ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥æ¢å–ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ï¼Œç³»ç»Ÿå¾€å¾€åªéœ€è¦ä¿è¯â€œæœ€ç»ˆä¸€è‡´æ€§â€ï¼Œåªè¦è¿™ä¸ªæœ€ç»ˆæ—¶é—´æ˜¯åœ¨ç”¨æˆ·å¯ä»¥æ¥å—çš„èŒƒå›´å†…å³å¯ã€‚</p><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸€èˆ¬ä½¿ç”¨ redis æ¥åšåˆ†å¸ƒå¼é”ï¼ˆç¼ºç‚¹ï¼šredisä¸»ä»åˆ‡æ¢æ—¶å¯èƒ½ä¸¢å¤±æ•°æ®ï¼‰<br>redisåˆ†å¸ƒå¼é”ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ä¸šåŠ¡åœºæ™¯ï¼ŒåŠ é”æ—¶é—´ä¸€èˆ¬ä¸º1s-3sï¼Œæ ¹æ®åœºæ™¯æµ®åŠ¨ï¼Œå…¶ä¸­3sæ˜¯æˆ‘ä»¬è®¾å®šçš„æœ€é•¿å“åº”æ—¶é—´ã€‚</p><p>å¦‚æœåŠ é”åï¼Œè¿‡æœŸæ—¶é—´å†…ä¸šåŠ¡ç”±äºæŸç§åŸå› è¿˜æ²¡æ‰§è¡Œå®Œï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚å†æ¬¡åŠ é”åæ‰“è¿›æ¥ï¼Œè€Œæ­¤æ—¶ä¸Šä¸€æ¬¡çš„è¯·æ±‚è¿˜æœªæ‰§è¡Œå®Œæ¯•ï¼Œè¿™æ—¶å€™éœ€è¦å¯¹é”è¿›è¡Œå»¶æœŸã€‚å¯ä»¥é‡‡ç”¨åç¨‹çš„æ–¹æ³•æ¥è®¾ç½®ä¸€ä¸ªtickerï¼Œåœ¨æ‰§è¡Œå®Œæ¯•çš„channelä¸­å¦‚æœæ²¡æœ‰æ”¶åˆ°é€šçŸ¥ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹è¿™ä¸ªé”è¿›è¡Œæœ‰é™æ¬¡çš„ç»­æœŸï¼Œæ¥ä¿è¯ä¸ä¼šå‡ºç°è¶…å–è¿™ç±»æƒ…å†µã€‚</p><p>å¦ä¸€ç§æƒ…å†µæ˜¯å¦‚æœå½“å‰é”æ˜¯å…¨å±€çš„ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°é”è¢«å…¶ä»–é›†ç¾¤çš„è¿›ç¨‹è§£é”çš„æƒ…å†µï¼Œè¿™ç§ä¸€èˆ¬é’ˆå¯¹åŠ é”çš„keyè¿›è¡Œå¤„ç†å³å¯</p><p>å¹¿å‘Šç³»ç»Ÿï¼Œä¸»è¦æ˜¯é’ˆå¯¹å…¬å¸å†…éƒ¨å„ä¸ªappçš„å¤šç§å±•ç¤ºä¸ºè¿›è¡Œç»Ÿä¸€æŠ•æ”¾å’Œæ•°æ®æ”¶é›†ã€‚ä¸ºäº†ä¿è¯è®¿é—®è´¨é‡å’Œç¨³å®šæ€§ï¼Œä½¿ç”¨äº†å†…å­˜-redis-tidbä¸‰å±‚ç¼“å­˜ç»“æ„ï¼Œç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œä¼šä¼˜å…ˆå°†æ´»è·ƒçŠ¶æ€çš„å¹¿å‘Šå†…å®¹åŠ è½½åˆ°å„ä¸ªå®ä¾‹çš„å†…å­˜ä¸­ã€‚ç„¶åæ ¹æ®å®é™…è®¿é—®çš„è¿‡ç¨‹ï¼Œä¼šåœ¨redisä¸­æ·»åŠ ç¬¬äºŒå±‚ç¼“å­˜ï¼Œç±»ä¼¼äºç»´æŠ¤äº†ä¸€å±‚çƒ­ç‚¹æ•°æ®ã€‚æœ€åä¸€å±‚æ˜¯tidbä¹Ÿå°±æ˜¯æ‰€æœ‰çš„å¹¿å‘Šé…ç½®ä¿¡æ¯ã€‚å†…å­˜æ•°æ®ä¼šå®šæ—¶åˆ·æ–°ï¼Œå¯¹äºé…ç½®å˜åŒ–çš„æ„ŸçŸ¥åœ¨åˆ·æ–°å‘¨æœŸä¹‹å¤–ï¼›å¯¹äºé…ç½®å˜åŒ–æ•æ„Ÿçš„å…¶ä»–ç³»ç»Ÿï¼Œåœ¨é…ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¹Ÿä¼šæœ‰æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šçŸ¥ã€‚</p><p>æœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœæ˜¯èƒ½å¤Ÿæ”¯æŒé™é»˜æœŸã€æŒ‰æ¬¡æŠ•æ”¾ã€æŒ‰å‘¨æœŸæŠ•æ”¾ã€è½®æ’­ç­‰å¤šæ ·åŒ–å¯ç»„åˆçš„æŠ•æ”¾ç­–ç•¥ã€‚è¿™é‡Œçš„è½®æ’­æ˜¯ç”±åç«¯æ¥å®ç°çš„ï¼Œç”¨æˆ·æœ‰ä¸€ä¸ªå¯è§å¹¿å‘Šçš„é›†åˆï¼Œæ¯æ¬¡æ“ä½œåˆ°æŸä¸ªé¡µé¢ä¼šåœ¨è¿™ä¸ªé›†åˆé‡Œé¢ç»™ç”¨æˆ·è¿”å›å¹¿å‘Šå†…å®¹ï¼Œå¯ä»¥è¾¾åˆ°çš„æ•ˆæœæ˜¯æ¯æ¬¡è®¿é—®åˆ°çš„å†…å®¹éƒ½æ˜¯ä¸ç›¸åŒçš„ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ æ›å…‰ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™æ ·çš„æ›å…‰æ–¹å¼å¯¹äºç”¨æˆ·çš„ä½¿ç”¨æµç¨‹æ˜¯ä¾µå…¥æ¯”è¾ƒä¸¥é‡çš„ï¼Œå› æ­¤ä¸å¤ªæ¨èä¸šåŠ¡æ–¹å°†è¿™ç§é…ç½®åŠ è½½åˆ°ç”¨æˆ·ä½¿ç”¨æµç¨‹ä¸­ã€‚</p><p>è½®æ’­çš„å®ç°æ–¹å¼æ˜¯åˆ©ç”¨äº†redisä¸­zsetçš„ç»“æ„ï¼Œä¸ºè½®æ’­æ¡ä»¶ä¸‹ ç”¨æˆ·-å¹¿å‘Šä½å½¢æˆä¸€ä¸ªæ¡¶ï¼Œè®¿é—®æ¬¡æ•°ä½œä¸ºåˆ†æ•°åŠ å…¥zsetä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨zscoreæ¥è¿›è¡Œå¯è®¿é—®æ€§åˆ¤æ–­ï¼›è®¿é—®ä¸€è½®ä¹‹åæ•´ä¸ªæ¸…é™¤zsetä¸­çš„æ•°æ®ï¼ˆå®é™…ä½¿ç”¨çš„è¯æ˜¯å‰100åï¼Œç”¨æˆ·-å¹¿å‘Šä½ä¸‹å¸¸è§„é…ç½®ä¸å¯èƒ½è¾¾åˆ°è¿™ä¸ªé‡ï¼‰ã€‚åŒæ—¶ä¹Ÿä¼šä¸ºè¿™ä¸ªæ¡¶å¢åŠ è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢æ— æ•ˆå ç”¨ã€‚</p><p>å½“ç„¶è¿™é‡Œå¯ä»¥ç”¨ZRevRangeæ¥æ”¯æŒä¹±åºè¿”å›ä½†è¿™æ ·å°±ä¸æ˜¯è½®æ’­çš„æ¦‚å¿µäº†ï¼Œæˆ‘ä»ç„¶ä¿ç•™äº†è¿™ä¸€åŠŸèƒ½ã€‚</p><p>æ•°æ®æ”¶é›†çš„è¯ï¼Œæ˜¯ç»“åˆäº†å…¬å¸å†…éƒ¨çš„æ‰“ç‚¹ç³»ç»Ÿï¼Œç›´æ¥ä¸ŠæŠ¥åˆ°æ—¥å¿—ï¼Œç„¶åç”±å¤§æ•°æ®çš„åŒå­¦æ¶ˆè´¹æ—¥å¿—é˜Ÿåˆ—è¿›è¡Œæ”¶é›†æ•´ç†ã€‚åŒæ—¶æ¯ä¸ªå¹¿å‘Šéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä¼šä»å±•ç¤ºåˆ°è®¿é—®åˆ°è½åœ°é¡µå†åˆ°å¯èƒ½äº§ç”Ÿçš„å”®å–æ¥ç”Ÿæˆæ•°æ®æ¼æ–—ï¼Œæ¥è¯„ä¼°æŠ•æ”¾æ•ˆç‡ã€ç‰©æ–™ç­‰ï¼Œä¹Ÿæœ‰ç”¨æ¥ä¼˜åŒ–ç”¨æˆ·æµå¤±çš„é—®é¢˜ã€‚è¿™éƒ¨åˆ†å…·ä½“ç»†èŠ‚æˆ‘å°±ä¸å¤ªäº†è§£äº†ï¼Œæˆ‘ç ”å‘åæ¨è¿›åˆ°å„æ–¹ä½¿ç”¨åï¼Œç”±äºæˆ‘æœ¬èº«è´Ÿè´£çš„æ˜¯ä¸€å¯¹ä¸€ä¸šåŠ¡çº¿çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æœ¬èº«çš„å”®å–æ¨¡å‹æ˜¯æ¯”è¾ƒé•¿çº¿çš„ï¼Œä¸­é—´å¯èƒ½è¿˜ä¼šæœ‰é”€å”®ç­‰äººä¸ºå› ç´ å½±å“æ‰¿æ‹…ï¼Œäºæ˜¯ç”±å¦ä¸€ä¸ªæ›´å¤§çš„æµé‡æ± appç»˜æœ¬ä¸šåŠ¡æ¥è¿›è¡Œåç»­çš„ç»´æŠ¤å’Œæ›´æ–°äº†ã€‚</p><p>å¯¹äºæ´»åŠ¨å‘¢ï¼Œç”±äºè¿è¥æå‡ºçš„æ´»åŠ¨å½¢å¼æœ‰å¾ˆå¤šï¼Œä¸”å¯¹äºä¸Šçº¿æ—¶é—´æœ‰å¼ºè¦æ±‚ï¼Œæ‰€ä»¥ä¸€èˆ¬åˆæ¬¡å‡ºç°çš„æ´»åŠ¨å½¢å¼ï¼Œä¼šé‡‡å–æ•æ·å¼€å‘çš„æ–¹å¼ï¼Œä»¥è¾¾åˆ°æœ€å¿«ä¸”ç¨³å®šä¸Šçº¿çš„ç›®çš„</p><p>ä»»åŠ¡ç³»ç»Ÿï¼ŒåˆæœŸè®¾è®¡å‘¢æ˜¯å¾ˆæ­»æ¿çš„ï¼Œæ ¹æ®è¿è¥è®¾è®¡çš„ä»»åŠ¡åŠ¨ä½œä»æ¶‰åŠåˆ°çš„å¤šä¸ªæ–¹å‘æ‹‰å–æˆ–è€…ç­‰å¾…ä¿¡æ¯æ¨é€ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆå¯¹äºå…¶ä»–ä¸šåŠ¡çš„ä¾µå…¥æ€§å¤ªé«˜ï¼Œé£é™©æé«˜ã€‚é’ˆå¯¹è¿™ä¸€ç‚¹ï¼Œæˆ‘å°†æ‰€æœ‰çš„ä¸šåŠ¡åŠ¨ä½œå…¨éƒ¨è½¬ç§»åˆ°æ¶ˆæ¯é˜Ÿåˆ—æ¥è·å–ï¼Œè¿™æ ·å¯¹äºå…¶ä»–ä¸šåŠ¡çº¿æˆ–è€…ç³»ç»Ÿæ¥è¯´ï¼Œå¤§éƒ¨åˆ†æ˜¯å·²ç»æ”¯æŒçš„</p><p>æŠ½å¥–ç³»ç»Ÿï¼Œå¯ä»¥è®²è®²åˆ†å¸ƒå¼é”ç›¸å…³ï¼Œ</p><p>sliceåº•å±‚å®ç°æ–¹æ³•ï¼Œmapåº•å±‚å®ç°æ–¹æ³•</p><p>redis è·³è¡¨</p><p>golang è¯­è¨€çš„ä¼˜åŠ¿ï¼šé™æ€è¯­è¨€ï¼Œç¼–è¯‘é˜¶æ®µå¯ä»¥å‘ç°ä¸€äº›é—®é¢˜ï¼›å¹¶å‘æ”¯æŒå¥½ï¼Œè€—æ—¶éšå¹¶å‘æ•°çº¿æ€§å¢åŠ ï¼›åƒåœ¾å›æ”¶å¤„ç†å¥½</p><p>golang æ–‡ä»¶æ“ä½œä½¿ç”¨æ¯”è¾ƒå°‘ï¼Œäº†è§£ä¸å¤š</p><p>golang channel åˆ©ç”¨åç¨‹é€šä¿¡æ¥å…±äº«å†…å­˜</p><p>å¸¸è§æ’åºï¼šå¿«æ’ï¼Œå †æ’ï¼Œå½’å¹¶</p><p>å†…æ ¸çº¿ç¨‹æ‰æ˜¯å¹¶è¡Œçš„åŸºæœ¬å•ä½</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> å®å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ’åº</title>
      <link href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/elementary-sort/"/>
      <url>/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/elementary-sort/</url>
      
        <content type="html"><![CDATA[<p>![[source&#x2F;images&#x2F;elementary-sort.png]]</p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¶é—´å¤æ‚åº¦</title>
      <link href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/elementary-time-complixty/"/>
      <url>/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/elementary-time-complixty/</url>
      
        <content type="html"><![CDATA[<h2 id="æ—¶é—´å¤æ‚åº¦-å¤§-O"><a href="#æ—¶é—´å¤æ‚åº¦-å¤§-O" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ (å¤§ O)"></a>æ—¶é—´å¤æ‚åº¦ (å¤§ O)</h2><p>![[Pasted image 20240429194251.png]]</p><p>![[Pasted image 20240429194302.png]]</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆå¸¸ç”¨æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ï¼ŒæŒ‰æ•°æ®ç»“æ„&#x2F;ç®—æ³•åˆ’åˆ†ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è®¨è®ºç»™å®šè¾“å…¥å¤§å°çš„åˆç†å¤æ‚æ€§ã€‚</p><h4 id="æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„-x2F-åˆ—è¡¨ï¼‰"><a href="#æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„-x2F-åˆ—è¡¨ï¼‰" class="headerlink" title="æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„&#x2F;åˆ—è¡¨ï¼‰"></a>æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„&#x2F;åˆ—è¡¨ï¼‰</h4><p>è§„å®š <em>n &#x3D; arr.length</em>,</p><ul><li>ç»“å°¾æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(1)</li><li>ä»ä»»æ„ç´¢å¼•ä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(ğ‘›)</li><li>è®¿é—®æˆ–ä¿®æ”¹ä»»æ„ç´¢å¼•å¤„çš„å…ƒç´ : ğ‘‚(1)</li><li>æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)</li><li>åŒæŒ‡é’ˆ: ğ‘‚(ğ‘›â‹…ğ‘˜), ğ‘˜ æ˜¯æ¯æ¬¡è¿­ä»£æ‰€åšçš„å·¥ä½œï¼ŒåŒ…æ‹¬æ»‘åŠ¨çª—å£</li><li>æ„å»ºå‰ç¼€å’Œ: ğ‘‚(ğ‘›)</li><li>æ±‚ç»™å®šå‰ç¼€å’Œçš„å­æ•°ç»„çš„å’Œï¼šğ‘‚(1)</li></ul><h4 id="å­—ç¬¦ä¸²-ä¸å¯å˜"><a href="#å­—ç¬¦ä¸²-ä¸å¯å˜" class="headerlink" title="å­—ç¬¦ä¸² (ä¸å¯å˜)"></a>å­—ç¬¦ä¸² (ä¸å¯å˜)</h4><p>è§„å®š <em>n &#x3D; s.length</em>,</p><ul><li>æ·»åŠ æˆ–åˆ é™¤å­—ç¬¦: ğ‘‚(ğ‘›)</li><li>ä»»æ„ç´¢å¼•å¤„çš„è®¿é—®å…ƒç´ : ğ‘‚(1)</li><li>ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„è¿æ¥: ğ‘‚(ğ‘›+ğ‘š), ğ‘š æ˜¯å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦</li><li>åˆ›å»ºå­å­—ç¬¦ä¸²: ğ‘‚(ğ‘š), ğ‘š æ˜¯å­å­—ç¬¦ä¸²çš„é•¿åº¦</li><li>åŒæŒ‡é’ˆ: ğ‘‚(ğ‘›â‹…ğ‘˜), ğ‘˜ æ˜¯æ¯æ¬¡è¿­ä»£æ‰€åšçš„å·¥ä½œï¼ŒåŒ…æ‹¬æ»‘åŠ¨çª—å£</li><li>é€šè¿‡è¿æ¥æ•°ç»„ã€stringbuilder ç­‰æ„å»ºå­—ç¬¦ä¸²ï¼šğ‘‚(ğ‘›)</li></ul><h4 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h4><p>ç»™å®š ğ‘›n ä½œä¸ºé“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ï¼Œ</p><ul><li>ç»™å®šæŒ‡é’ˆä½ç½®çš„åé¢æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(1)</li><li>å¦‚æœæ˜¯åŒå‘é“¾è¡¨ï¼Œç»™å®šæŒ‡é’ˆä½ç½®æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(1)</li><li>åœ¨æ²¡æœ‰æŒ‡é’ˆçš„ä»»æ„ä½ç½®æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(ğ‘›)</li><li>æ— æŒ‡é’ˆä»»æ„ä½ç½®çš„è®¿é—®å…ƒç´ : ğ‘‚(ğ‘›)</li><li>æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)</li><li>åœ¨ä½ç½® i å’Œ j ä¹‹é—´åè½¬: ğ‘‚(ğ‘—âˆ’ğ‘–)</li><li>ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæˆ–å“ˆå¸Œæ˜ å°„å®Œæˆä¸€æ¬¡éå†: ğ‘‚(ğ‘›)</li></ul><h4 id="å“ˆå¸Œè¡¨-x2F-å­—å…¸"><a href="#å“ˆå¸Œè¡¨-x2F-å­—å…¸" class="headerlink" title="å“ˆå¸Œè¡¨&#x2F;å­—å…¸"></a>å“ˆå¸Œè¡¨&#x2F;å­—å…¸</h4><p>ç»™å®š <em>n &#x3D; dic.length</em>,</p><ul><li>æ·»åŠ æˆ–åˆ é™¤é”®å€¼å¯¹: ğ‘‚(1)</li><li>æ£€æŸ¥ key æ˜¯å¦å­˜åœ¨: ğ‘‚(1)</li><li>æ£€æŸ¥å€¼æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)</li><li>è®¿é—®æˆ–ä¿®æ”¹ä¸ key ç›¸å…³çš„å€¼: ğ‘‚(1)</li><li>éå†æ‰€æœ‰é”®å€¼: ğ‘‚(ğ‘›)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„: ğ‘‚(1)O(1) æ“ä½œç›¸å¯¹äº n æ˜¯å¸¸æ•°.å®é™…ä¸Šï¼Œå“ˆå¸Œç®—æ³•å¯èƒ½ä»£ä»·å¾ˆé«˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„é”®æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒå°†èŠ±è´¹ ğ‘‚(ğ‘š)O(m)ï¼Œå…¶ä¸­ ğ‘šm æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ è¿™äº›æ“ä½œåªéœ€è¦ç›¸å¯¹äºå“ˆå¸Œæ˜ å°„å¤§å°çš„å¸¸æ•°æ—¶é—´ã€‚</span><br></pre></td></tr></table></figure></li></ul><h4 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h4><p>ç»™å®š <em>n &#x3D; set.length</em>,</p><ul><li>æ·»åŠ æˆ–åˆ é™¤å…ƒç´ : ğ‘‚(1)</li><li>æ£€æµ‹å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(1)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šé¢çš„è¯´æ˜ä¹Ÿé€‚ç”¨äºè¿™é‡Œã€‚</span><br></pre></td></tr></table></figure></li></ul><h4 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h4><p>æ ˆæ“ä½œä¾èµ–äºå®ƒä»¬çš„å®ç°ã€‚æ ˆåªéœ€è¦æ”¯æŒå¼¹å‡ºå’Œæ¨å…¥ã€‚å¦‚æœä½¿ç”¨åŠ¨æ€æ•°ç»„å®ç°:ç»™å®š <em>n &#x3D; stack.length</em>,</p><ul><li>æ¨å…¥å…ƒç´ : ğ‘‚(1)</li><li>å¼¹å‡ºå…ƒç´ : ğ‘‚(1)</li><li>æŸ¥çœ‹ (æŸ¥çœ‹æ ˆé¡¶å…ƒç´ ): ğ‘‚(1)</li><li>è®¿é—®æˆ–ä¿®æ”¹ä»»æ„ç´¢å¼•å¤„çš„å…ƒç´ : ğ‘‚(1)</li><li>æ£€æµ‹å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)</li></ul><h4 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h4><p>é˜Ÿåˆ—æ“ä½œä¾èµ–äºå®ƒä»¬çš„å®ç°ã€‚é˜Ÿåˆ—åªéœ€è¦æ”¯æŒå‡ºé˜Ÿåˆ—å’Œå…¥é˜Ÿåˆ—ã€‚å¦‚æœä½¿ç”¨åŒé“¾è¡¨å®ç°:ç»™å®š <em>n &#x3D; queue.length</em>,</p><ul><li>å…¥é˜Ÿçš„å…ƒç´ : ğ‘‚(1)</li><li>å‡ºé˜Ÿçš„å…ƒç´ : ğ‘‚(1)</li><li>æŸ¥çœ‹ (æŸ¥çœ‹é˜Ÿåˆ—å‰é¢çš„å…ƒç´ ): ğ‘‚(1)</li><li>è®¿é—®æˆ–ä¿®æ”¹ä»»æ„ç´¢å¼•å¤„çš„å…ƒç´ : ğ‘‚(ğ‘›)</li><li>æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„:å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€å®ç°é˜Ÿåˆ—çš„æ–¹å¼æ¯”ç®€å•çš„åŒé“¾è¡¨æ›´å¤æ‚ã€‚æ ¹æ®å®ç°çš„ä¸åŒï¼Œé€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ å¯èƒ½æ¯” ğ‘‚(ğ‘›)O(n) å¿«ï¼Œä½†æœ‰ä¸€ä¸ªé‡è¦çš„å¸¸é‡é™¤æ•°ã€‚</span><br></pre></td></tr></table></figure></li></ul><h4 id="äºŒå‰æ ‘é—®é¢˜-DFS-x2F-BFS"><a href="#äºŒå‰æ ‘é—®é¢˜-DFS-x2F-BFS" class="headerlink" title="äºŒå‰æ ‘é—®é¢˜ (DFS&#x2F;BFS)"></a>äºŒå‰æ ‘é—®é¢˜ (DFS&#x2F;BFS)</h4><p>ç»™å®š  ğ‘› ä½œä¸ºæ ‘çš„èŠ‚ç‚¹æ•°ï¼Œå¤§å¤šæ•°ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(ğ‘›â‹…ğ‘˜), ğ‘˜ æ˜¯åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåšçš„æ“ä½œæ•°, é€šå¸¸æ˜¯ ğ‘‚(1)ã€‚è¿™åªæ˜¯ä¸€ä¸ªæ™®éè§„å¾‹ï¼Œå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå‡è®¾ BFS æ˜¯ç”¨é«˜æ•ˆé˜Ÿåˆ—å®ç°çš„ã€‚</p><h4 id="äºŒå‰æœç´¢æ ‘"><a href="#äºŒå‰æœç´¢æ ‘" class="headerlink" title="äºŒå‰æœç´¢æ ‘"></a>äºŒå‰æœç´¢æ ‘</h4><p>ç»™å®š ğ‘› ä½œä¸ºæ ‘ä¸­çš„èŠ‚ç‚¹æ•°ï¼Œ</p><ul><li>æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼šæœ€åçš„æƒ…å†µä¸‹ ğ‘‚(ğ‘›),å¹³å‡æƒ…å†µ ğ‘‚(logâ¡ğ‘›)</li><li>æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼šæœ€åçš„æƒ…å†µä¸‹ ğ‘‚(ğ‘›), å¹³å‡æƒ…å†µ ğ‘‚(logâ¡ğ‘›)<br>å¹³å‡æƒ…å†µæ˜¯å½“æ ‘å¾ˆå¹³è¡¡æ—¶ â€”â€” æ¯ä¸ªæ·±åº¦éƒ½æ¥è¿‘æ»¡ã€‚æœ€åçš„æƒ…å†µæ˜¯æ ‘åªæ˜¯ä¸€æ¡ç›´çº¿ã€‚</li></ul><h4 id="å †-x2F-ä¼˜å…ˆé˜Ÿåˆ—"><a href="#å †-x2F-ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="å †&#x2F;ä¼˜å…ˆé˜Ÿåˆ—"></a>å †&#x2F;ä¼˜å…ˆé˜Ÿåˆ—</h4><p>ç»™å®š <em>n &#x3D; heap.length</em> å¹¶è®¨è®ºæœ€å°å †,</p><ul><li>æ·»åŠ ä¸€ä¸ªå…ƒç´ : ğ‘‚(logâ¡ğ‘›)</li><li>åˆ é™¤æœ€å°çš„å…ƒç´ : ğ‘‚(logâ¡ğ‘›)</li><li>æ‰¾åˆ°æœ€å°çš„å…ƒç´ : ğ‘‚(1)</li><li>æŸ¥çœ‹å…ƒç´ æ˜¯å¦å­˜åœ¨: ğ‘‚(ğ‘›)</li></ul><h4 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h4><p>åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼ŒäºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(logâ¡ğ‘›)ï¼Œå…¶ä¸­ ğ‘› æ˜¯åˆå§‹æœç´¢ç©ºé—´çš„å¤§å°ã€‚</p><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ul><li>æ’åº: ğ‘‚(ğ‘›â‹…logâ¡ğ‘›), å…¶ä¸­ ğ‘› æ˜¯è¦æ’åºçš„æ•°æ®çš„å¤§å°</li><li>å›¾ä¸Šçš„ DFS å’Œ BFSï¼šğ‘‚(ğ‘›â‹…ğ‘˜+ğ‘’)ï¼Œå…¶ä¸­ ğ‘› æ˜¯èŠ‚ç‚¹æ•°ï¼Œğ‘’ æ˜¯è¾¹æ•°ï¼Œå‰ææ˜¯æ¯ä¸ªèŠ‚ç‚¹å¤„ç†èŠ±è´¹éƒ½æ˜¯ ğ‘‚(1)ï¼Œä¸éœ€è¦é‡å¤éå†ã€‚</li><li>DFS å’Œ BFS ç©ºé—´å¤æ‚åº¦ï¼šé€šå¸¸ä¸º ğ‘‚(ğ‘›)ï¼Œä½†å¦‚æœå®ƒåœ¨å›¾å½¢ä¸­ï¼Œåˆ™å¯èƒ½ä¸º ğ‘‚(ğ‘›+ğ‘’) æ¥å­˜å‚¨å›¾å½¢</li><li>åŠ¨æ€è§„åˆ’æ—¶é—´å¤æ‚åº¦ï¼šğ‘‚(ğ‘›â‹…ğ‘˜)ï¼Œå…¶ä¸­ ğ‘› æ˜¯çŠ¶æ€æ•°ï¼Œğ‘˜ æ˜¯æ¯ä¸ªçŠ¶æ€æ‰€éœ€è¦çš„æ“ä½œæ•°</li><li>åŠ¨æ€è§„åˆ’ç©ºé—´å¤æ‚åº¦ï¼šğ‘‚(ğ‘›)ï¼Œå…¶ä¸­ ğ‘› æ˜¯çŠ¶æ€æ•°</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Raft é¢è¯•å¿…å¤‡</title>
      <link href="/interview/distribution/raft/"/>
      <url>/interview/distribution/raft/</url>
      
        <content type="html"><![CDATA[<p>Raft<br>Raftåè®®å‘¢ï¼Œä¸€èˆ¬åŒ…æ‹¬è¿™ä¸‰ç§èŠ‚ç‚¹ï¼šFollowerã€Candidateã€Leaderï¼›å…¶ä¸­ï¼Œå€™é€‰äººæ˜¯åªæœ‰åœ¨é€‰ä¸¾æœŸé—´æ‰å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œä¸€æ—¦é€‰ä¸¾ç»“æŸï¼Œé‚£ä¹ˆé›†ç¾¤ä¸­å°±åªæœ‰ Leaderï¼ŒFollower</p><p>èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨ rpc æ¥é€šä¿¡ï¼ŒåŒ…æ‹¬ æŠ•ç¥¨rpcï¼Œå¤åˆ¶æ—¥å¿—å¿ƒè·³rpcï¼Œå¿«ç…§rpc</p><p>é€‰ä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>é€‰ä¸¾æ—¶æœºï¼šå½“ç½‘ç»œåˆšåˆšå¯åŠ¨æˆ–è€…é›†ç¾¤èŠ‚ç‚¹å˜æ›´ï¼Œæˆ–è€…ä¸Šä¸€ä»»æœŸç»“æŸåã€‚æ‰€æœ‰èŠ‚ç‚¹è¿›å…¥é€‰ä¸¾é˜¶æ®µï¼Œæ¯ä¸ªäººæŒæœ‰ä¸€ä¸ªéšæœºçš„é€‰ä¸¾æ—¶é’Ÿï¼Œæ—¶é’Ÿç»“æŸåï¼ŒèŠ‚ç‚¹ä¼˜å…ˆç»™è‡ªå·±æŠ•ç¥¨ï¼Œç„¶åå¹¿æ’­æŠ•ç¥¨rpcã€‚ä¼šæœ‰ä¸‰ç§ç»“æœï¼šèµ¢å¾—å¤šæ•°é€‰ç¥¨æˆä¸º Leaderï¼› å…¶ä»–äººå½“é€‰ï¼Œè‡ªå·±æˆä¸º followerï¼›æ²¡æœ‰äººå½“é€‰ï¼Œå¼€å¯ä¸‹ä¸€è½®æŠ•ç¥¨ã€‚<br>ç”±äºraftçš„æœºåˆ¶ï¼Œå¯ä»¥è®¤ä¸ºèƒ½å¤Ÿæˆä¸º Leader çš„èŠ‚ç‚¹ï¼Œä¸€å®šæ˜¯åŒ…å«æ‰€æœ‰æ—¥å¿—çš„èŠ‚ç‚¹<br>leaderé€‰ä¸¾çš„è¿‡ç¨‹æ˜¯ï¼š1ã€å¢åŠ termå·ï¼›2ã€ç»™è‡ªå·±æŠ•ç¥¨ï¼›3ã€é‡ç½®é€‰ä¸¾è¶…æ—¶è®¡æ—¶å™¨ï¼›4ã€å‘é€è¯·æ±‚æŠ•ç¥¨çš„RPCç»™å…¶å®ƒèŠ‚ç‚¹</p><p>Leader è¢«é€‰ä¸¾å‡ºæ¥ä»¥åï¼Œå°±å¼€å§‹æ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯ã€‚Leader ä¼šå°†è¿™ä¸€æ¡æ¶ˆæ¯ä½œä¸ºæ—¥å¿—è®°å½•ä¸‹æ¥ï¼Œå¹¶å°†å…¶é€šè¿‡å¿ƒè·³åŒ…åŒæ­¥ç»™é›†ç¾¤ä¸­çš„ followerï¼Œå½“å¤§éƒ¨åˆ†èŠ‚ç‚¹éƒ½åŒæ­¥è¿™æ¡æ—¥å¿—ä»¥åï¼ŒLeader å°†è¿™ä¸ªè¯·æ±‚åº”ç”¨åˆ°è‡ªèº«çš„çŠ¶æ€æœºå¹¶å›å¤å®¢æˆ·ç«¯ã€‚follower å¦‚æœå‘ç”Ÿå®•æœºæˆ–è€…ä¸¢åŒ…ï¼ŒLeader ä¼šä¸æ–­å°è¯•ç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½åŒæ­¥äº†è¿™æ¡æ—¥å¿—ã€‚<br>æ—¥å¿—ç”±æœ‰åºç¼–å·ï¼ˆlog indexï¼‰çš„æ—¥å¿—æ¡ç›®ç»„æˆã€‚æ¯ä¸ªæ—¥å¿—æ¡ç›®åŒ…å«å®ƒè¢«åˆ›å»ºæ—¶çš„ä»»æœŸå·ï¼ˆtermï¼‰å’Œç”¨äºçŠ¶æ€æœºæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>æ—¥å¿—å¤åˆ¶çš„è¿‡ç¨‹æœ‰ä¸¤æ¡ä¿è¯ï¼š</p><ol><li>å¦‚æœä¸åŒèŠ‚ç‚¹çš„ä¸¤æ¡æ—¥å¿—æœ‰ç›¸åŒçš„ç´¢å¼•å’Œä»»æœŸï¼Œé‚£ä¹ˆä»–ä»¬å­˜å‚¨çš„å‘½ä»¤æ˜¯ä¸€è‡´çš„ï¼ˆç”±äºä¸»ä»åŒæ­¥çš„ç‰¹æ€§ï¼ŒLeader èŠ‚ç‚¹ä¸Šçš„æ—¥å¿—å’Œå‘½ä»¤è½åº“åå°±ä¸ä¼šæ›´æ”¹ï¼‰</li><li>å¦‚æœä¸åŒèŠ‚ç‚¹çš„ä¸¤æ¡æ—¥å¿—æœ‰ç›¸åŒçš„ç´¢å¼•å’Œä»»æœŸï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹å‰å­˜å‚¨çš„æ—¥å¿—ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼ˆç”±äºæ—¥å¿—çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå½“ follower æ”¶åˆ°æ¥è‡ª Leader çš„å¿ƒè·³åŒ…ä»¥åï¼Œä¼šä¸æœ¬åœ°çš„æ—¥å¿—ç´¢å¼•å’Œä»»æœŸåšåŒ¹é…ï¼Œå¦‚æœæœ‰ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆä¼šæ‹’ç»æ‰è¿™ä¸ªå¿ƒè·³åŒ…ï¼‰</li></ol><p>æ—¥å¿—å¤åˆ¶çš„å¼‚å¸¸æƒ…å†µåŒ…æ‹¬ï¼š<br>Leader å®•æœºæˆ–è€…å´©æºƒï¼Œæ—§ Leader æ²¡æœ‰å¤åˆ¶å®Œæ‰€æœ‰çš„æ—¥å¿—ã€‚å¯èƒ½å¤šï¼Œå¯èƒ½å°‘ï¼Œå¯èƒ½ä¸ä¸€è‡´</p><p>æ—¥å¿—å¤åˆ¶çš„è¿‡ç¨‹ï¼Œéœ€è¦é€šè¿‡ä¸ Leader ä¿è¯å¼ºä¸€è‡´æ€§æ¥ä¿è¯å®‰å…¨å¤åˆ¶ã€‚å½“æ—¥å¿—äº§ç”Ÿä¸ä¸€è‡´æ—¶ï¼ŒLeader ä¼šä»åå¾€å‰å°è¯•åŒæ­¥æ—¥å¿—å¿ƒè·³åŒ…ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåŒæ–¹éƒ½ç¬¦åˆçš„æ—¥å¿—ï¼Œç„¶å Leader ä¼šæŠŠä»è¿™æ¡æ—¥å¿—ä»¥åçš„æ‰€æœ‰å†…å®¹åŒæ­¥ç»™è¯¥èŠ‚ç‚¹ï¼Œå°†ä¸ä¸€è‡´çš„éƒ¨åˆ†è¦†ç›–æ‰ï¼Œç›´åˆ°ä¸ Leader ä¿æŒå®Œå…¨ä¸€è‡´<br><strong>å½“ leader å’Œ follower æ—¥å¿—å†²çªçš„æ—¶å€™</strong>ï¼Œleader å°†<strong>æ ¡éªŒ follower æœ€åä¸€æ¡æ—¥å¿—æ˜¯å¦å’Œ leader åŒ¹é…</strong>ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œ<strong>å°†é€’å‡æŸ¥è¯¢ï¼Œç›´åˆ°åŒ¹é…ï¼ŒåŒ¹é…åï¼Œåˆ é™¤å†²çªçš„æ—¥å¿—</strong></p><p>é‚£ä¹ˆåƒä¹‹å‰æåˆ° Leader ä¸­çš„æ—¥å¿—å¯èƒ½ä¹Ÿä¸æ˜¯æœ€æ–°çš„ï¼Œä¼šä¸ä¼šåŒæ­¥å‡ºå»çš„æ—¥å¿—æœ¬èº«å°±æ˜¯å¼‚å¸¸çš„å‘¢ï¼Ÿ<br>è¿™ä¸ªå°±æ˜¯ raft é€šè¿‡ä¸¤æ¡é™åˆ¶æ¥ä¿è¯äº†æ—¥å¿—å¤åˆ¶çš„å®‰å…¨æ€§ï¼š</p><ol><li>åªæœ‰logç´¢å¼•å’Œä»»æœŸæ˜¯æœ€æ–°çš„èŠ‚ç‚¹æ‰æœ‰å¯èƒ½æˆä¸º Leaderï¼Œè¿™ä¸ªåœ¨é€‰ä¸¾æŠ•ç¥¨æœŸé—´æ˜¯å¯ä»¥åˆ¤æ–­çš„ï¼Œéæœ€æ–°çš„å°±ä¸ç»™ä»–æŠ•ç¥¨</li><li>Leader åªèƒ½æ¨è¿›æ—¥å¿—çš„ç´¢å¼•è¿›è¡Œæäº¤ï¼Œä»¥å‰ä»»æœŸçš„è¦åœ¨æ£€æŸ¥ä¸€è‡´æ€§çš„è¿‡ç¨‹ä¸­åŒæ­¥è¿‡å»ã€‚</li></ol><p>é‚£ä¹ˆåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†ä¿è¯æ—¥å¿—ä¸ä¼šæ— é™å¢é•¿ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹çš„è¿›è¡Œå¿«ç…§ï¼Œå°†æŸä¸ªæ—¶é—´ç‚¹ä»¥å‰çš„æ—¥å¿—è½åº“åä¸¢å¼ƒã€‚<br>å½“ Leader åœ¨åŒæ­¥æ—¥å¿—çš„è¿‡ç¨‹ä¸­å‘ç°æŸä¸ªèŠ‚ç‚¹çš„æ—¥å¿—ç‰¹åˆ«è€ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ï¼ŒLeader ä¼šå‘é€å¿«ç…§rpcæ¥å°†æ—¥å¿—æ‰“åŒ…å¤åˆ¶ã€‚<br>å½“ç„¶å®é™…ä½¿ç”¨ä¸­ï¼Œéœ€è¦æ§åˆ¶é—´éš”çš„æ—¶é—´ï¼Œå’Œå¿«ç…§çš„é¢‘ç‡ï¼ˆé˜²æ­¢å‘ç”Ÿ io é˜»å¡ï¼‰ï¼Œä¸€èˆ¬è¾¾åˆ°å›ºå®šå¤§å°å‘ç”Ÿä¸€æ¬¡ã€‚<br>åŒæ—¶å¯ä»¥ä½¿ç”¨ copy-on-write æŠ€æœ¯æ¥ä¿è¯æ­£å¸¸çš„æ—¥å¿—åŒæ­¥</p><p>è„‘è£‚é—®é¢˜æ˜¯è¯´ä¸€æ¬¡æ€§åœ¨é›†ç¾¤ä¸­å¢åŠ äº†å¤ªå¤šçš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚è¶…è¿‡äº†åŸæ¥èŠ‚ç‚¹æ•°é‡çš„ä¸€åŠï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½äº§ç”ŸåŒä¸»çš„ç°è±¡ï¼Œå³ä¸€ä¸ªé›†ç¾¤ä¸­æœ‰ä¸¤ä¸ª Leaderï¼Œå½¼æ­¤æˆå‘˜ä¹‹é—´æ²¡æœ‰äº¤é›†ã€‚è§£å†³åŠæ³•æ˜¯ä¸€æ¬¡å˜æ›´ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°‘é‡å¤šæ¬¡çš„æ¥å®Œæˆã€‚<br>å¦å¤–è¿˜æœ‰ä¸€ä¸ªæƒ…å†µæ˜¯ï¼Œå¦‚æœå‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœæˆ–è€…å¼‚å¸¸ï¼Œå¯¼è‡´è€ Leader å¤±è”äº†ï¼Œå‰©ä¸‹çš„èŠ‚ç‚¹ä¼šé‡æ–°é€‰ä¸¾å‡ºä¸€ä¸ªæ–° Leaderï¼Œå¹¶ä¸å®¢æˆ·ç«¯ç»§ç»­äº¤æµã€‚å½“è€ Leader æ¢å¤è¿æ¥ä»¥åï¼Œä»–ä¸Šé¢çš„ commit éƒ½ä¼šè¢«è§†ä½œå¤±æ•ˆï¼Œæœ¬èº«ä¼šè½¬åŒ–ä¸º follower æ¥æ”¶ä»æ–° Leader æ¥çš„æ—¥å¿—ã€‚</p><p>å¦å¤–ä¸€ç§è¿˜æœ‰ä¸€ä¸ª <strong>Prevote</strong> æœºåˆ¶<br>å½“æœ‰ä¸€ä¸ª follower ä¸é›†ç¾¤éš”ç¦»åï¼Œä»–ä¼šè‡ªå·±è¿›å…¥å€™é€‰é˜¶æ®µï¼Œå¹¶ç”±äºæ— æ³•è·å¾—æŠ•ç¥¨æˆä¸º Leader è€Œä¸€ç›´åˆ·æ–°ä»»æœŸï¼Œå¯¼è‡´è¯¥èŠ‚ç‚¹ä»»æœŸéå¸¸å¤§ã€‚å½“è¯¥èŠ‚ç‚¹é‡è¿›é›†ç¾¤ä»¥åï¼Œä¼šç”±äºä»»æœŸå¯¼è‡´é€‰ä¸¾æ··ä¹±ï¼Œå› æ­¤ raft é‡‡ç”¨ prevote æœºåˆ¶ï¼Œæ˜¯ä¸€ä¸ªç±»ä¼¼äºä¸¤é˜¶æ®µæäº¤çš„åè®®ï¼Œç¬¬ä¸€é˜¶æ®µå…ˆå¾æ±‚å…¶ä»–èŠ‚ç‚¹æ˜¯å¦åŒæ„é€‰ä¸¾ï¼Œå¦‚æœåŒæ„é€‰ä¸¾åˆ™å‘èµ·çœŸæ­£çš„é€‰ä¸¾æ“ä½œï¼Œå¦åˆ™é™ä¸ºFollowerè§’è‰²ã€‚è¿™æ ·å°±é¿å…äº†ç½‘ç»œåˆ†åŒºèŠ‚ç‚¹é‡æ–°åŠ å…¥é›†ç¾¤ï¼Œè§¦å‘ä¸å¿…è¦çš„é€‰ä¸¾æ“ä½œ</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>simulation02</title>
      <link href="/interview/simulation/simulation02/"/>
      <url>/interview/simulation/simulation02/</url>
      
        <content type="html"><![CDATA[<p>æ·±ç»´ï¼š<br>ä¸€é¢ï¼š</p><h4 id="1-ç”¨è¿‡å“ªäº›åˆ†å¸ƒå¼é”-redis-keyç”¨ä»€ä¹ˆç±»å‹-ç”¨stringæœ‰ä»€ä¹ˆåå¤„-ï¼Ÿæ²¡æŠ¢åˆ°çš„éƒ½åœ¨å¹²ç­‰ç€ï¼Œæµªè´¹cpuï¼Ÿå¦‚ä½•è§„é¿ã€‚-etcdå¦‚ä½•åˆ†å¸ƒå¼é”"><a href="#1-ç”¨è¿‡å“ªäº›åˆ†å¸ƒå¼é”-redis-keyç”¨ä»€ä¹ˆç±»å‹-ç”¨stringæœ‰ä»€ä¹ˆåå¤„-ï¼Ÿæ²¡æŠ¢åˆ°çš„éƒ½åœ¨å¹²ç­‰ç€ï¼Œæµªè´¹cpuï¼Ÿå¦‚ä½•è§„é¿ã€‚-etcdå¦‚ä½•åˆ†å¸ƒå¼é”" class="headerlink" title="1.ç”¨è¿‡å“ªäº›åˆ†å¸ƒå¼é” redis keyç”¨ä»€ä¹ˆç±»å‹ ç”¨stringæœ‰ä»€ä¹ˆåå¤„ ï¼Ÿæ²¡æŠ¢åˆ°çš„éƒ½åœ¨å¹²ç­‰ç€ï¼Œæµªè´¹cpuï¼Ÿå¦‚ä½•è§„é¿ã€‚ etcdå¦‚ä½•åˆ†å¸ƒå¼é”"></a>1.ç”¨è¿‡å“ªäº›åˆ†å¸ƒå¼é” redis keyç”¨ä»€ä¹ˆç±»å‹ ç”¨stringæœ‰ä»€ä¹ˆåå¤„ ï¼Ÿæ²¡æŠ¢åˆ°çš„éƒ½åœ¨å¹²ç­‰ç€ï¼Œæµªè´¹cpuï¼Ÿå¦‚ä½•è§„é¿ã€‚ etcdå¦‚ä½•åˆ†å¸ƒå¼é”</h4><p>redis é” å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼š</p><ul><li>ä¸šåŠ¡è¶…æ—¶ï¼Œå¯¼è‡´é”å¤±æ•ˆï¼Œé€ æˆå¤šå®ä¾‹æŒæœ‰é”ï¼šå»¶é•¿è¿‡æœŸæ—¶é—´ï¼ˆä¸æ¨èï¼‰ï¼›ç±»ä¼¼ java çš„çœ‹é—¨ç‹—æœºåˆ¶ï¼Œå¦å¤–å¯ç”¨ä¸€ä¸ªåç¨‹å¯¹é”ç»­çº¦ã€‚</li><li>redis ä¸»ä»åˆ‡æ¢æ—¶å¯èƒ½é€ æˆå¤šå®ä¾‹æŒæœ‰é”ï¼Œè¿™ä¸ªæ˜¯ç”¨çš„ redlock æ¥è§£å†³çš„ï¼Œä¸è¿‡å…·ä½“çš„æ–¹æ¡ˆæˆ‘å°±æ²¡æœ‰çœ‹è¿‡äº†<br>ç”¨è¿‡redisé”ï¼Œ setnxå±äºåŸå­æ“ä½œï¼Œä¸Šé”å¤±è´¥ä¸€èˆ¬è®¤ä¸ºæ˜¯é”å·²ç»å­˜åœ¨äº†ã€‚ä¸€èˆ¬ä½¿ç”¨stringç±»å‹ä½œä¸ºkeyï¼Œstringç±»å‹æœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯ä¼šå ç”¨æ¯”è¾ƒå¤§çš„ç©ºé—´ï¼Œ<br>å¯ä»¥æ ¹æ®ä¸šåŠ¡å…·ä½“æƒ…å†µä½¿ç”¨ hset ï¼Œä½†æ˜¯éœ€è¦ä¿è¯å•ä¸ªé›†åˆä¸­çš„ kv æ•°é‡ï¼Œå¦‚æœè¶…è¿‡æŸä¸ªç•Œé™ï¼Œredis å°±ä¸ä¼šç”¨ ziplist æ¥å­˜å‚¨è¿™ä¸ªé›†åˆäº†</li></ul><p>etcd<br>prefix<br>etcdæ”¯æŒå‰ç¼€æŸ¥æ‰¾ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå‰ç¼€è¡¨ç¤ºé”èµ„æºï¼Œå‰ç¼€ + å”¯ä¸€idçš„æ–¹å¼è¡¨ç¤ºé”èµ„æºçš„æŒæœ‰è€…ã€‚</p><p>leaseæœºåˆ¶<br>ç§Ÿçº¦æœºåˆ¶å¯ä»¥ä¿è¯é”çš„æ´»æ€§ï¼ŒæŒæœ‰é”çš„å®¢æˆ·ç«¯å®•æœºï¼Œkeyè‡ªåŠ¨è¿‡æœŸï¼Œé¿å…å®•æœºã€‚etcdå®¢æˆ·ç«¯æä¾›çš„leaseç»­ç§Ÿæœºåˆ¶è§£å†³å®¢æˆ·ç«¯é•¿æ—¶é—´é˜»å¡å¯¼è‡´é”å¤±æ•ˆé—®é¢˜ã€‚</p><p>watchæœºåˆ¶<br>redisé‡‡ç”¨å¿™è½®è¯¢çš„æ–¹å¼æ¥è·å–é”ï¼Œetcdå¯ä»¥ä½¿ç”¨watchæœºåˆ¶ç›‘å¬é”çš„åˆ é™¤äº‹ä»¶ï¼Œæ›´åŠ é«˜æ•ˆã€‚</p><h4 id="2-æ•°æ®åº“-éš”ç¦»çº§åˆ«-æ²¡æœ‰è§£å†³ä»€ä¹ˆé—®é¢˜-å¹»è¯»æ˜¯ä»€ä¹ˆ"><a href="#2-æ•°æ®åº“-éš”ç¦»çº§åˆ«-æ²¡æœ‰è§£å†³ä»€ä¹ˆé—®é¢˜-å¹»è¯»æ˜¯ä»€ä¹ˆ" class="headerlink" title="2.æ•°æ®åº“ éš”ç¦»çº§åˆ« æ²¡æœ‰è§£å†³ä»€ä¹ˆé—®é¢˜ å¹»è¯»æ˜¯ä»€ä¹ˆ"></a>2.æ•°æ®åº“ éš”ç¦»çº§åˆ« æ²¡æœ‰è§£å†³ä»€ä¹ˆé—®é¢˜ å¹»è¯»æ˜¯ä»€ä¹ˆ</h4><p>ä¸€å…±æœ‰äº”ç§ï¼š<br>ä¸ä½¿ç”¨äº‹åŠ¡<br>read uncommitted å…è®¸è„è¯»<br>read committed é˜²æ­¢è„è¯» æœ€å¸¸ç”¨<br>repeatable read é˜²æ­¢è„è¯»ï¼Œä¸å¯é‡å¤è¯» mysql é»˜è®¤<br>serilized ä¸²è¡Œäº‹åŠ¡ï¼Œé˜²æ­¢å¹»è¯»ï¼Œè„è¯»ï¼Œä¸å¯é‡å¤è¯»<br>çº§åˆ«è¶Šé«˜ï¼Œå®‰å…¨æ€§è¶Šå¥½ï¼Œå¹¶å‘æ€§èƒ½çº¦ä½</p><p>å¹»è¯»å°±æ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡è¿‡ç¨‹ä¸­ç”¨ç›¸åŒæ¡ä»¶æŸ¥è¯¢æ—¶ï¼Œè·å–çš„ç»“æœä¸ä¸€è‡´<br>äº‹åŠ¡Aè·å–çš„ç»“æœé›†ï¼Œäº‹åŠ¡Bå¯¹å…¶ä¸­çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹å¹¶æäº¤ï¼Œäº‹åŠ¡Aåœ¨é‡æ–°æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä¼šå‘ç°åŸæœ¬ä¸å­˜åœ¨çš„æ•°æ®è¡Œï¼ˆå¹»å½±ï¼‰ï¼Œæˆ–è€…åŸæœ¬å­˜åœ¨çš„æ•°æ®è¡Œæ¶ˆå¤±äº†</p><h4 id="3-å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†"><a href="#3-å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†" class="headerlink" title="3.å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†"></a>3.å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†</h4><p>åˆ©ç”¨ä½æ•°ç»„å’Œå“ˆå¸Œå‡½æ•°æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­<br>å¸ƒéš†è¿‡æ»¤å™¨åŸºäºä¸€ä¸ªä½æ•°ç»„å’Œè‹¥å¹²ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå…¶ä¸­ä½æ•°ç»„æ˜¯ä¸€ä¸ªç”±0å’Œ1ç»„æˆçš„æ•°ç»„ï¼Œåˆå§‹å€¼å…¨éƒ¨ä¸º0ã€‚å½“ä¸€ä¸ªå…ƒç´ åŠ å…¥åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­æ—¶ï¼Œä¼šé€šè¿‡å¤šä¸ªå“ˆå¸Œå‡½æ•°ç”Ÿæˆå¤šä¸ªå“ˆå¸Œå€¼ï¼Œç„¶åå°†è¿™äº›å“ˆå¸Œå€¼å¯¹åº”çš„ä½æ•°ç»„ä½ç½®è®¾ç½®ä¸º1ã€‚å½“ä¸€ä¸ªå…ƒç´ è¦æŸ¥è¯¢æ˜¯å¦å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­æ—¶ï¼Œä¹Ÿä¼šé€šè¿‡å¤šä¸ªå“ˆå¸Œå‡½æ•°ç”Ÿæˆå¤šä¸ªå“ˆå¸Œå€¼ï¼Œç„¶åæŸ¥è¯¢è¿™äº›å“ˆå¸Œå€¼å¯¹åº”çš„ä½æ•°ç»„ä½ç½®æ˜¯å¦éƒ½ä¸º1ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªä½æ•°ç»„ä½ç½®ä¸ä¸º1ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ è‚¯å®šä¸å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å¦‚æœæ‰€æœ‰ä½æ•°ç»„ä½ç½®éƒ½ä¸º1ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ å¯èƒ½å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚å› ä¸ºå¤šä¸ªå…ƒç´ å¯èƒ½ä¼šè¢«å“ˆå¸Œåˆ°åŒä¸€ä¸ªä½æ•°ç»„ä½ç½®ä¸Šï¼Œæ‰€ä»¥å­˜åœ¨è¯¯åˆ¤çš„æƒ…å†µï¼Œä½†æ˜¯ä¸ä¼šæ¼æ‰ä»»ä½•ä¸€ä¸ªå…ƒç´ ã€‚<br>å“ˆå¸Œå‡½æ•°æ•°é‡ä¸ä½æ•°ç»„é•¿åº¦æ— å…³ï¼Œä½æ•°ç»„å­˜å‚¨çš„æ˜¯å…ƒç´ å“ˆå¸Œä»¥åçš„ç»“æœ</p><p>ä¼˜ç‚¹æ˜¯æŸ¥è¯¢å¿«ï¼Œä¸éœ€è¦çœŸæ­£æŸ¥è¯¢æ•°æ®ï¼›ä½æ•°ç»„æ‰©å±•æ€§å¼ºï¼›å ç”¨å†…å­˜å°<br>ç¼ºç‚¹æ˜¯æ— æ³•åˆ é™¤ï¼Œä¸”æœ‰ä¸€å®šç¨‹åº¦è¯¯åˆ¤çš„æ¦‚ç‡</p><p>redisä¸­æä¾›äº†å¸ƒéš†è¿‡æ»¤å™¨çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰å®é™…ä½¿ç”¨è¿‡</p><h4 id="4-channelç›¸å…³-1-æœ‰ç¼“å­˜-æ²¡æœ‰ç¼“å­˜-sendä»€ä¹ˆæƒ…å†µä¸‹ä¼šé˜»å¡2-å·²ç»å…³é—­çš„channelå–æ•°æ®-è¿”å›ä»€ä¹ˆ3-å¾€æ²¡æœ‰åˆå§‹åŒ–çš„channelé‡Œsendä¼šè¿”å›ä»€ä¹ˆ"><a href="#4-channelç›¸å…³-1-æœ‰ç¼“å­˜-æ²¡æœ‰ç¼“å­˜-sendä»€ä¹ˆæƒ…å†µä¸‹ä¼šé˜»å¡2-å·²ç»å…³é—­çš„channelå–æ•°æ®-è¿”å›ä»€ä¹ˆ3-å¾€æ²¡æœ‰åˆå§‹åŒ–çš„channelé‡Œsendä¼šè¿”å›ä»€ä¹ˆ" class="headerlink" title="4.channelç›¸å…³ 1.æœ‰ç¼“å­˜ æ²¡æœ‰ç¼“å­˜ sendä»€ä¹ˆæƒ…å†µä¸‹ä¼šé˜»å¡2.å·²ç»å…³é—­çš„channelå–æ•°æ® è¿”å›ä»€ä¹ˆ3.å¾€æ²¡æœ‰åˆå§‹åŒ–çš„channelé‡Œsendä¼šè¿”å›ä»€ä¹ˆ"></a>4.channelç›¸å…³ 1.æœ‰ç¼“å­˜ æ²¡æœ‰ç¼“å­˜ sendä»€ä¹ˆæƒ…å†µä¸‹ä¼šé˜»å¡2.å·²ç»å…³é—­çš„channelå–æ•°æ® è¿”å›ä»€ä¹ˆ3.å¾€æ²¡æœ‰åˆå§‹åŒ–çš„channelé‡Œsendä¼šè¿”å›ä»€ä¹ˆ</h4><h4 id="5-sliceå’Œæ•°ç»„çš„åŒºåˆ«-å„è‡ªçš„å¥½å¤„-åœ°å€å¼•ç”¨å’Œå€¼å¼•ç”¨çš„å¥½å¤„"><a href="#5-sliceå’Œæ•°ç»„çš„åŒºåˆ«-å„è‡ªçš„å¥½å¤„-åœ°å€å¼•ç”¨å’Œå€¼å¼•ç”¨çš„å¥½å¤„" class="headerlink" title="5.sliceå’Œæ•°ç»„çš„åŒºåˆ« å„è‡ªçš„å¥½å¤„ åœ°å€å¼•ç”¨å’Œå€¼å¼•ç”¨çš„å¥½å¤„"></a>5.sliceå’Œæ•°ç»„çš„åŒºåˆ« å„è‡ªçš„å¥½å¤„ åœ°å€å¼•ç”¨å’Œå€¼å¼•ç”¨çš„å¥½å¤„</h4><p>åŒºåˆ«ä»…åœ¨äºæ•°æ®åœ¨å£°æ˜æ—¶å®šé•¿ï¼Œåˆ‡ç‰‡å¯æ‹“å±•é•¿åº¦<br>å€¼å¼•ç”¨æ˜¯å¯¹åŸæ•°æ®è¿›è¡Œäº†ä¸€ä»½æ‹·è´åä¼ å…¥å‡½æ•°ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°æ”¹å€¼ä¸å½±å“åŸæ•°æ®çš„åœºæ™¯ï¼›åœ°å€å¼•ç”¨æ˜¯å¯¹åŸæ•°æ®åœ°å€æŒ‡é’ˆçš„å¼•ç”¨ï¼Œä¸€èˆ¬å‡½æ•°ä¸­å¯¹äºè¿™ä¸ªå¼•ç”¨çš„æ”¹åŠ¨ä¼šåæ˜ åˆ°åŸæ•°æ®ä¸Š</p><h4 id="6-mysqlçš„ç´¢å¼•å¦‚ä½•å®ç°çš„ï¼ŒäºŒçº§ç´¢å¼•å¦‚ä½•å®ç°çš„"><a href="#6-mysqlçš„ç´¢å¼•å¦‚ä½•å®ç°çš„ï¼ŒäºŒçº§ç´¢å¼•å¦‚ä½•å®ç°çš„" class="headerlink" title="6.mysqlçš„ç´¢å¼•å¦‚ä½•å®ç°çš„ï¼ŒäºŒçº§ç´¢å¼•å¦‚ä½•å®ç°çš„"></a>6.mysqlçš„ç´¢å¼•å¦‚ä½•å®ç°çš„ï¼ŒäºŒçº§ç´¢å¼•å¦‚ä½•å®ç°çš„</h4><p>ç”±äºèšé›†ç´¢å¼•æ˜¯åˆ©ç”¨è¡¨çš„ä¸»é”®æ„å»ºçš„ï¼Œæ‰€ä»¥æ¯å¼ è¡¨åªèƒ½æ‹¥æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚</p><p>èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±æ˜¯æ•°æ®é¡µã€‚æ¢å¥è¯è¯´ï¼Œæ•°æ®é¡µä¸Šå­˜æ”¾çš„æ˜¯å®Œæ•´çš„æ¯è¡Œè®°å½•ã€‚å› æ­¤èšé›†ç´¢å¼•çš„ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯ï¼šé€šè¿‡è¿‡èšé›†ç´¢å¼•èƒ½è·å–å®Œæ•´çš„æ•´è¡Œæ•°æ®ã€‚å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼šå¯¹äºä¸»é”®çš„æ’åºæŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥æ‰¾é€Ÿåº¦éå¸¸å¿«ã€‚<br>ä½¿ç”¨B+æ ‘ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå…¶ä¸­èšé›†ç´¢å¼•ï¼ˆPrimary Indexï¼‰çš„å¶å­èŠ‚ç‚¹åŒ…å«è¡Œæ•°æ®ï¼Œè€Œéèšé›†ç´¢å¼•ï¼ˆSecondary Indexï¼‰çš„å¶å­èŠ‚ç‚¹åŒ…å«ä¸»é”®å€¼ã€‚<br>äºŒçº§ç´¢å¼•ï¼ˆä¹Ÿç§°ä¸ºè¾…åŠ©ç´¢å¼•ï¼‰å®ç°æ–¹å¼ä¸ä¸»ç´¢å¼•ç±»ä¼¼ï¼Œåªæ˜¯å®ƒä¸æ˜¯ä¸»é”®ã€‚åœ¨InnoDBä¸­ï¼ŒäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åŒ…å«æŒ‡å‘ä¸»é”®çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆç”¨äºå›è¡¨æŸ¥è¯¢è·å–å®Œæ•´çš„æ•°æ®è¡Œã€‚</p><h4 id="7-mapçš„åº•å±‚å¦‚ä½•å®ç°çš„-ä»€ä¹ˆç±»å‹ä¸èƒ½ç”¨åšmapçš„key"><a href="#7-mapçš„åº•å±‚å¦‚ä½•å®ç°çš„-ä»€ä¹ˆç±»å‹ä¸èƒ½ç”¨åšmapçš„key" class="headerlink" title="7.mapçš„åº•å±‚å¦‚ä½•å®ç°çš„ ä»€ä¹ˆç±»å‹ä¸èƒ½ç”¨åšmapçš„key"></a>7.mapçš„åº•å±‚å¦‚ä½•å®ç°çš„ ä»€ä¹ˆç±»å‹ä¸èƒ½ç”¨åšmapçš„key</h4><h4 id="9-å¦‚ä½•å®ç°LRU"><a href="#9-å¦‚ä½•å®ç°LRU" class="headerlink" title="9.å¦‚ä½•å®ç°LRU"></a>9.å¦‚ä½•å®ç°LRU</h4><p>åŒå‘é“¾è¡¨ + å“ˆå¸Œè¡¨<br>åŒå‘é“¾è¡¨å­˜å‚¨èŠ‚ç‚¹ï¼Œå“ˆå¸Œè¡¨å­˜å‚¨èŠ‚ç‚¹å€¼åˆ°èŠ‚ç‚¹åœ°å€çš„æ˜ å°„</p><h4 id="10-ç´¢å¼•ï¼ˆa-b-c-a-x3D-b-x3D-c-x3D-c-x3D-b-x3D-a-x3D-a-x3D-b-gt-c-x3D-å‘½ä¸­ç´¢å¼•çš„å“ªä¸€æ®µ"><a href="#10-ç´¢å¼•ï¼ˆa-b-c-a-x3D-b-x3D-c-x3D-c-x3D-b-x3D-a-x3D-a-x3D-b-gt-c-x3D-å‘½ä¸­ç´¢å¼•çš„å“ªä¸€æ®µ" class="headerlink" title="10.ç´¢å¼•ï¼ˆa,b,c) a&#x3D; b&#x3D; c&#x3D;, c&#x3D; b&#x3D; a&#x3D;, a&#x3D; b&gt; c&#x3D;å‘½ä¸­ç´¢å¼•çš„å“ªä¸€æ®µ"></a>10.ç´¢å¼•ï¼ˆa,b,c) a&#x3D; b&#x3D; c&#x3D;, c&#x3D; b&#x3D; a&#x3D;, a&#x3D; b&gt; c&#x3D;å‘½ä¸­ç´¢å¼•çš„å“ªä¸€æ®µ</h4><h4 id="11-æ•°æ®åº“é—´éš™é”æ˜¯ä»€ä¹ˆ"><a href="#11-æ•°æ®åº“é—´éš™é”æ˜¯ä»€ä¹ˆ" class="headerlink" title="11.æ•°æ®åº“é—´éš™é”æ˜¯ä»€ä¹ˆ"></a>11.æ•°æ®åº“é—´éš™é”æ˜¯ä»€ä¹ˆ</h4><p>MySQL InnoDBæ”¯æŒä¸‰ç§è¡Œé”å®šæ–¹å¼ï¼š</p><p>è¡Œé”ï¼ˆRecord Lockï¼‰ï¼šé”ç›´æ¥åŠ åœ¨ç´¢å¼•è®°å½•ä¸Šé¢ã€‚<br>é—´éš™é”ï¼ˆGap Lockï¼‰ï¼šé”åŠ åœ¨ä¸å­˜åœ¨çš„ç©ºé—²ç©ºé—´ï¼Œå¯ä»¥æ˜¯ä¸¤ä¸ªç´¢å¼•è®°å½•ä¹‹é—´ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•ä¹‹å‰æˆ–æœ€åä¸€ä¸ªç´¢å¼•ä¹‹åçš„ç©ºé—´ã€‚<br>Next-Key Lockï¼šè¡Œé”ä¸é—´éš™é”ç»„åˆèµ·æ¥ç”¨å°±å«åšNext-Key Lockã€‚</p><p>åœ¨ä¸€èˆ¬èŒƒå›´åŒºé—´æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä¼šå¯¹å‘½ä¸­çš„è¡ŒåŠ è¡Œé”ï¼Œä½†æ˜¯å¯¹äºæ¡ä»¶èŒƒå›´å†…ä½†æ˜¯è¿˜ä¸å­˜åœ¨çš„è¡Œä¹Ÿä¼šåŠ é—´éš™é”ã€‚å¦‚æœä¸Šä¸€æ¬¡åŒºé—´æŸ¥è¯¢æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œé‚£ä¹ˆé’ˆå¯¹è¯¥è¡¨åŒºé—´å†…çš„insertæ“ä½œä¼šå› ä¸ºé—´éš™é”è€Œé˜»å¡ï¼Œç›´åˆ°æŸ¥è¯¢æ‰§è¡Œå®Œæ¯•æ‰ä¼šç»§ç»­æ‰§è¡Œ<br>å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜</p><p>å¯ä»¥é˜²æ­¢æ•°æ®è¯¯åˆ æ”¹</p><table><thead><tr><th>æ—¶é—´</th><th>äº‹åŠ¡A</th><th>äº‹åŠ¡B</th></tr></thead><tbody><tr><td>T0</td><td>BEGIN;</td><td>BEGIN;</td></tr><tr><td>T1</td><td>delete from t_student where id &lt; 4;</td><td></td></tr><tr><td>T2</td><td></td><td>insert into t_student VALUES(2,â€˜æˆå­111â€™,1,â€œæ­å·â€);</td></tr><tr><td>T3</td><td></td><td>commit;</td></tr><tr><td>T4</td><td>commit;</td><td></td></tr><tr><td>ä¼šå¯¹æ’å…¥æ€§èƒ½æœ‰ä¸€å®šå½±å“</td><td></td><td></td></tr></tbody></table><h4 id="12-åˆ†å¸ƒå¼äº‹åŠ¡äº†è§£è¿‡å“ªäº›-å¦‚ä½•å®ç°"><a href="#12-åˆ†å¸ƒå¼äº‹åŠ¡äº†è§£è¿‡å“ªäº›-å¦‚ä½•å®ç°" class="headerlink" title="12.åˆ†å¸ƒå¼äº‹åŠ¡äº†è§£è¿‡å“ªäº› å¦‚ä½•å®ç°"></a>12.åˆ†å¸ƒå¼äº‹åŠ¡äº†è§£è¿‡å“ªäº› å¦‚ä½•å®ç°</h4><h4 id="13-ç”µå•†ç³»ç»Ÿå¦‚ä½•é˜²æ­¢è¶…ä¹°è¶…å–"><a href="#13-ç”µå•†ç³»ç»Ÿå¦‚ä½•é˜²æ­¢è¶…ä¹°è¶…å–" class="headerlink" title="13.ç”µå•†ç³»ç»Ÿå¦‚ä½•é˜²æ­¢è¶…ä¹°è¶…å–"></a>13.ç”µå•†ç³»ç»Ÿå¦‚ä½•é˜²æ­¢è¶…ä¹°è¶…å–</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¶…ä¹°è¶…å–å‘ç”Ÿåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ã€‚é‚£ä¹ˆé’ˆå¯¹é«˜å¹¶å‘çš„æƒ…å†µï¼Œå¯ä»¥é€šè¿‡åŠ å¹¶å‘é”æ§åˆ¶å¹¶å‘ï¼›é‡‡ç”¨é˜Ÿåˆ—æ–¹å¼æ”¹ä¸ºé¡ºåºæ‰§è¡Œï¼›åˆ©ç”¨æ•°æ®åº“çš„åŸå­è¯­å¥ï¼ˆä¸æ¨èï¼‰<br>ä¸€èˆ¬å‡åº“å­˜åŒºåˆ† ä¸‹å•ã€ä»˜æ¬¾ã€é¢„æ‰£ï¼ˆä¾‹å¦‚ä¸‹å•åä¿ç•™10åˆ†é’Ÿï¼‰è¿™å‡ ä¸ªèŠ‚ç‚¹</p><h4 id="14-æ‚²è§‚é”å’Œä¹è§‚é”åˆ†åˆ«é€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯"><a href="#14-æ‚²è§‚é”å’Œä¹è§‚é”åˆ†åˆ«é€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯" class="headerlink" title="14.æ‚²è§‚é”å’Œä¹è§‚é”åˆ†åˆ«é€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯"></a>14.æ‚²è§‚é”å’Œä¹è§‚é”åˆ†åˆ«é€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯</h4><p>æ‚²è§‚é”ï¼šæ‹…å¿ƒæ•°æ®è¢«ä»–äººä¿®æ”¹ï¼Œå› æ­¤æ¯æ¬¡ä¿®æ”¹éƒ½æœŸæœ›åŠ é”ï¼Œé€‚åˆå†™å¤§äºè¯»çš„æƒ…å†µã€‚ä¸»è¦åˆ©ç”¨æ•°æ®åº“ä¸­çš„è¯»é”ï¼Œè¡Œé”ï¼Œå†™é”<br>ä¹è§‚é”å› ä¸ºä¸æ‹…å¿ƒæ•°æ®ä¿®æ”¹é—®é¢˜ï¼Œæ›´å¤šé€‚åˆè¯»å¤§äºå†™çš„åœºæ™¯ï¼Œä½¿ç”¨ç‰ˆæœ¬å·æˆ–è€…æ—¶é—´æˆ³ï¼ˆupdatetimeï¼‰</p><h4 id="15-è´Ÿè½½å‡è¡¡-etcdå¦‚ä½•åš-NGINXå¦‚ä½•åš-k8så¦‚ä½•åš"><a href="#15-è´Ÿè½½å‡è¡¡-etcdå¦‚ä½•åš-NGINXå¦‚ä½•åš-k8så¦‚ä½•åš" class="headerlink" title="15.è´Ÿè½½å‡è¡¡ etcdå¦‚ä½•åš NGINXå¦‚ä½•åš k8så¦‚ä½•åš"></a>15.è´Ÿè½½å‡è¡¡ etcdå¦‚ä½•åš NGINXå¦‚ä½•åš k8så¦‚ä½•åš</h4><p>è½®è¯¢å’ŒåŠ æƒè½®è¯¢ï¼›æƒé‡å¯ä»¥æ ¹æ®èŠ‚ç‚¹çš„çŠ¶æ€æ¥åŠ¨æ€è°ƒæ•´ã€‚è¦æ³¨æ„æƒé‡çš„ä¸Šä¸‹é™<br>ä¸€è‡´æ€§å“ˆå¸Œï¼š å“ˆå¸Œç¯ï¼ŒæœåŠ¡ç«¯èŠ‚ç‚¹åœ¨ç¯ä¸Šï¼Œè·ç¦»å“ˆå¸Œç»“æœæœ€è¿‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹<br>æœ€å°‘è¿æ¥æ•°<br>æœ€å¿«å“åº”ç­‰</p><h4 id="16-æ™®ç½—ç±³ä¿®æ–¯"><a href="#16-æ™®ç½—ç±³ä¿®æ–¯" class="headerlink" title="16.æ™®ç½—ç±³ä¿®æ–¯"></a>16.æ™®ç½—ç±³ä¿®æ–¯</h4><h4 id="17-traceidç³»ç»Ÿæ€ä¹ˆåšçš„-å¦‚ä½•ä»å‰ç«¯ä¼ åˆ°åç«¯å„ä¸ªæœåŠ¡"><a href="#17-traceidç³»ç»Ÿæ€ä¹ˆåšçš„-å¦‚ä½•ä»å‰ç«¯ä¼ åˆ°åç«¯å„ä¸ªæœåŠ¡" class="headerlink" title="17.traceidç³»ç»Ÿæ€ä¹ˆåšçš„ å¦‚ä½•ä»å‰ç«¯ä¼ åˆ°åç«¯å„ä¸ªæœåŠ¡"></a>17.traceidç³»ç»Ÿæ€ä¹ˆåšçš„ å¦‚ä½•ä»å‰ç«¯ä¼ åˆ°åç«¯å„ä¸ªæœåŠ¡</h4><p>ä¼´é±¼ä½¿ç”¨çš„æ˜¯jagerï¼Œæœ€åˆçš„é‡‡é›†æ–¹å¼æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´é‡‡é›†ä¸€æ¬¡ã€‚ä¸»è¦ç”¨æ¥æ’æŸ¥å¼‚å¸¸ï¼Œè§£å†³ä¸šåŠ¡é—®é¢˜ï¼Œä½†æ˜¯æœ‰é—´éš”çš„é‡‡æ ·å‘½ä¸­ç›¸å…³å¼‚å¸¸çš„æ¦‚ç‡å¾ˆå°ï¼Œç»å¸¸æ˜¯é‡åˆ°äº†é—®é¢˜ä½†æ˜¯é‡‡é›†ä¸åˆ°ã€‚åæœŸç»“åˆç¤¾åŒºå†…çš„ä¸€äº›ç»„ä»¶ï¼Œæ›´æ–°äº†é‡‡é›†æ–¹å¼ï¼Œ</p><p>äºŒé¢ï¼š<br>1.æŒ‘ä¸€ä¸ªé¡¹ç›®èƒ½ä»£è¡¨ä½ çš„æ¶æ„è®¾è®¡æˆ–è€…è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼ˆéœ€è¦åæŠ€æœ¯è€Œä¸æ˜¯ä¸šåŠ¡ï¼‰</p><p>2.å¦‚ä½•åšæœåŠ¡æ²»ç†</p><p>3.etcdæ˜¯apç³»ç»Ÿè¿˜æ˜¯cpç³»ç»Ÿ<br>&#x3D;&#x3D;<strong>etcdæ˜¯CPå®ç°</strong>&#x3D;&#x3D;,å®ƒä¿è¯ä¸€è‡´æ€§ä¸åˆ†åŒºå®¹é”™æ€§,ä¸€å®šç¨‹åº¦ä¸Šç‰ºç‰²äº†å¯ç”¨æ€§ã€‚</p><p>4.etcdå¦‚ä½•åšè´Ÿè½½å‡è¡¡</p><p>5.K8S+docker AæœåŠ¡è°ƒç”¨BæœåŠ¡æ˜¯æ€ä¹ˆçŸ¥é“BæœåŠ¡çš„åœ°å€çš„ </p><p>6.é™çº§é™æµç†”æ–­æ€ä¹ˆåšçš„ ç†”æ–­çš„åŸç†æ˜¯ä»€ä¹ˆ</p><ol><li>é™çº§ï¼ˆDegradationï¼‰<br>æ¦‚å¿µï¼šé™çº§æ˜¯æŒ‡åœ¨ç³»ç»Ÿé‡åˆ°å¼‚å¸¸æˆ–é«˜è´Ÿè½½ç­‰æƒ…å†µä¸‹ï¼Œæš‚æ—¶å…³é—­æˆ–è€…åˆ‡æ¢åˆ°ä¸€äº›åŠŸèƒ½ç®€åŒ–çš„æ¨¡å¼ï¼Œä»¥ä¿è¯æ ¸å¿ƒæµç¨‹çš„å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚<br>ä½œç”¨ï¼šé€šè¿‡èˆå¼ƒä¸€äº›éæ ¸å¿ƒæˆ–ä¸é‡è¦çš„åŠŸèƒ½ï¼Œä¿æŠ¤æ ¸å¿ƒåŠŸèƒ½çš„æ­£å¸¸è¿è¡Œã€‚<br>ç¤ºä¾‹ï¼šåœ¨é«˜è´Ÿè½½æƒ…å†µä¸‹ï¼Œå…³é—­ä¸€äº›æ¶ˆè€—è¾ƒå¤§çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œåªæä¾›åŸºæœ¬çš„è¯»å†™æ“ä½œã€‚</li><li>ç†”æ–­ï¼ˆCircuit Breakerï¼‰<br>æ¦‚å¿µï¼šç†”æ–­æ˜¯æŒ‡åœ¨æœåŠ¡è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå½“æŸä¸ªæœåŠ¡å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼Œæš‚æ—¶åœæ­¢è°ƒç”¨è¯¥æœåŠ¡ï¼Œç›´åˆ°æœåŠ¡æ¢å¤æ­£å¸¸ã€‚<br>ä½œç”¨ï¼šé€šè¿‡ç†”æ–­æœºåˆ¶ï¼Œä¿æŠ¤ç³»ç»Ÿå…å—æ•…éšœæœåŠ¡çš„å½±å“ï¼Œé¿å…é›ªå´©æ•ˆåº”ã€‚<br>ç¤ºä¾‹ï¼šç›‘æ§æœåŠ¡è°ƒç”¨çš„å¤±è´¥ç‡æˆ–é”™è¯¯ç‡ï¼Œå½“è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œæ‰“å¼€ç†”æ–­å™¨ï¼Œåœæ­¢å¯¹è¯¥æœåŠ¡çš„è°ƒç”¨ã€‚ä¸€æ®µæ—¶é—´åï¼Œå†è¿›è¡Œå°è¯•ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸï¼Œåˆ™å…³é—­ç†”æ–­å™¨ï¼Œç»§ç»­æ­£å¸¸è°ƒç”¨ã€‚</li><li>é™æµï¼ˆRate Limitingï¼‰<br>æ¦‚å¿µï¼šé™æµæ˜¯æŒ‡åœ¨ç³»ç»Ÿçš„è¯·æ±‚æµé‡è¿‡å¤§æ—¶ï¼Œå¯¹è¯·æ±‚è¿›è¡Œæ§åˆ¶å’Œé™åˆ¶ï¼Œä½¿å¾—ç³»ç»Ÿåœ¨å¯æ¥å—çš„èŒƒå›´å†…è¿›è¡Œå¤„ç†ï¼Œé¿å…ç³»ç»Ÿè¶…å‡ºå¤„ç†èƒ½åŠ›è€Œå´©æºƒã€‚<br>ä½œç”¨ï¼šé€šè¿‡é™åˆ¶è¯·æ±‚çš„æ•°é‡æˆ–é€Ÿåº¦ï¼Œä¿æŠ¤ç³»ç»Ÿå…å—è¿‡è½½çš„å½±å“ã€‚<br>ç¤ºä¾‹ï¼šè®¾ç½®æ¯ç§’æœ€å¤§è¯·æ±‚æ•°æˆ–æœ€å¤§å¹¶å‘æ•°ï¼Œå½“è¯·æ±‚æ•°æˆ–å¹¶å‘æ•°è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œæ‹’ç»é¢å¤–çš„è¯·æ±‚æˆ–è€…å°†å…¶æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ°ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†ã€‚</li></ol><p>7.postæŠ¥æ–‡ç”±ä»€ä¹ˆç»„æˆ</p><p>8.tcpå¦‚ä½•å®šä½åŒæ–¹ ä¸‰æ¬¡æ¡æ‰‹</p><p>9.å¦‚æœæœ‰Mä¸ªä¸œè¥¿ï¼Œæ¯8ä¸ªä¸ºä¸€ç»„ï¼Œæ¯ä¸¤ç»„ä¹‹é—´æœ‰ä¸¤ä¸ªé‡å ï¼Œä¼šåˆ†æˆå¤šå°‘ç»„</p><p>10.äººæ‰ç®¡ç†</p><p>11.é€ƒé€¸åˆ†æ</p><p>12.è®¾è®¡æ¨¡å¼</p><p>ä¸€é¢<br>epollã€selectã€poll åŒºåˆ«<br>epoll çš„æ°´å¹³è§¦å‘å’Œè¾¹ç¼˜è§¦å‘çš„åŒºåˆ«<br>TCP çš„æµé‡æ§åˆ¶<br>ä¸ºä»€ä¹ˆæœ‰äº†æµé‡æ§åˆ¶è¿˜è¦æœ‰æ‹¥å¡æ§åˆ¶?<br>TCP ä¸æ˜¯å¯é ä¼ è¾“å—ï¼Ÿä¸ºä»€ä¹ˆä¼šä¸¢åŒ…å‘¢ï¼Ÿ<br>é‚£ä½ ä»‹ç»ä¸€ä¸‹æ‹¥å¡æ§åˆ¶çš„ç®—æ³•ï¼Ÿ<br>è¿›ç¨‹ã€çº¿ç¨‹çš„åŒºåˆ«<br>Goé‡Œé¢GMPæ¨¡å‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ<br>ç®—æ³•ï¼šæ—‹è½¬çŸ©é˜µï¼Œç‰›å®¢ä¸Šå†™è¿‡ï¼Œeasyï¼Œç§’<br>äºŒé¢<br>å¦‚ä½•ç”¨æ ˆå®ç°é˜Ÿåˆ—<br>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé“¾è¡¨æœ‰æ²¡æœ‰ç¯ï¼Ÿ<br>é‚£ä¸ºä»€ä¹ˆå¿«æ…¢æŒ‡é’ˆä¸€å®šèƒ½å¤Ÿç›¸é‡ï¼Ÿ<br>ä½ ç”¨çš„æ˜¯ mysql æ˜¯å§ï¼Œé‚£ Bæ ‘ å’Œ B+æ ‘ çš„åŒºåˆ«æ˜¯ï¼Ÿ<br>ä»‹ç»ä¸€ä¸‹æ­»é”äº§ç”Ÿçš„å¿…è¦æ¡ä»¶<br>å¦‚ä½•å®ç°äº’æ–¥é”ï¼Ÿ<br>å¦‚ä½•å®ç°è‡ªæ—‹é”ï¼Ÿ<br>ç®—æ³•ï¼šä¸‰æ•°ä¹‹å’Œã€‚ç§’<br>ä¸‰é¢<br>kafka å’Œ å…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯”å¦‚ rocketmqï¼Œrabbitmq ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ<br>kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ<br>httpsä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„ï¼Ÿ<br>ssl&#x2F;tls æ˜¯æ€ä¹ˆä¿è¯å®‰å…¨çš„ï¼Ÿç»è¿‡å‡ æ¬¡æ¡æ‰‹ï¼Ÿ<br>äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼Ÿ<br>ç”¨è¿‡å“ªäº›æ’åºï¼Ÿ<br>å¿«æ’ä¸€å®šæœ€å¿«å—ï¼Ÿ<br>åœºæ™¯é¢˜ï¼šå¦‚æœæˆ‘æœ‰100Gæ–‡ä»¶ï¼Œä½†æ˜¯åªæœ‰ 500 M çš„å†…å­˜ï¼Œè¿™äº›æ–‡ä»¶å­˜ç€ä¸€è¡Œè¡Œçš„æ•°å­—ï¼Œå¦‚ä½•è·å–æœ€å°çš„10ä¸ªï¼Ÿ<br>ç®—æ³•ï¼šæœ€é•¿æœ‰åºæ‹¬å·ï¼Œå¸¸è§é¢˜ï¼Œç§’</p><h4 id="grpc-å’Œ-http-çš„åŒºåˆ«"><a href="#grpc-å’Œ-http-çš„åŒºåˆ«" class="headerlink" title="grpc å’Œ http çš„åŒºåˆ«"></a>grpc å’Œ http çš„åŒºåˆ«</h4><p>grpcçš„è¯æ˜¯ä½¿ç”¨ http&#x2F;2 åè®®è¿›è¡Œé€šä¿¡ï¼Œä¼ è¾“å†…å®¹ä¸ºäºŒè¿›åˆ¶å†…å®¹ï¼Œå› æ­¤grpcçš„å…³é”®ç®—æ³•æ˜¯ payload çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä¸€èˆ¬ä½¿ç”¨ protocol buffer åºåˆ—åŒ–åº“ã€‚æœåŠ¡ä¹‹é—´ä½¿ç”¨ rpc è°ƒç”¨</p><h5 id="æ•°æ®åºåˆ—åŒ–ï¼š"><a href="#æ•°æ®åºåˆ—åŒ–ï¼š" class="headerlink" title="æ•°æ®åºåˆ—åŒ–ï¼š"></a>æ•°æ®åºåˆ—åŒ–ï¼š</h5><p>gRPCä½¿ç”¨Protocol Bufferså¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå®ç°è·¨è¯­è¨€ã€è·¨å¹³å°çš„æ•°æ®äº¤æ¢ã€‚Protocol Buffersçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è¡¨ç¤ºï¼š</p><ul><li>åºåˆ—åŒ–(M)&#x3D;Encode(M)</li><li>ååºåˆ—åŒ–(M)&#x3D;Decode(M)<br>å…¶ä¸­ï¼Œ$M$ æ˜¯æ•°æ®ç»“æ„ï¼Œ$Encode$ å’Œ $Decode$ åˆ†åˆ«è¡¨ç¤ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œã€‚</li></ul><h5 id="RPCè°ƒç”¨ï¼š"><a href="#RPCè°ƒç”¨ï¼š" class="headerlink" title="RPCè°ƒç”¨ï¼š"></a>RPCè°ƒç”¨ï¼š</h5><p>gRPCçš„RPCè°ƒç”¨è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>å®¢æˆ·ç«¯é€šè¿‡Protocol Buffersåºåˆ—åŒ–è¯·æ±‚æ•°æ®ï¼Œå¹¶ä½¿ç”¨HTTP&#x2F;2å‘é€è¯·æ±‚ã€‚</li><li>æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼Œä½¿ç”¨Protocol Buffersååºåˆ—åŒ–è¯·æ±‚æ•°æ®ã€‚</li><li>æœåŠ¡å™¨æ‰§è¡ŒRPCæ–¹æ³•ï¼Œå¹¶å°†ç»“æœåºåˆ—åŒ–ä¸ºProtocol Buffersæ ¼å¼ã€‚</li><li>æœåŠ¡å™¨ä½¿ç”¨HTTP&#x2F;2å‘é€å“åº”ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯ä½¿ç”¨Protocol Buffersååºåˆ—åŒ–å“åº”æ•°æ®ï¼Œå¹¶å¤„ç†ç»“æœã€‚</li></ul><ol><li>é€šä¿¡æ–¹å¼</li></ol><ul><li>RPC:è¿œç¨‹è¿‡ç¨‹è°ƒç”¨,æ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚åŒæ–¹å»ºç«‹é“¾æ¥å,ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç›´æ¥è°ƒç”¨å¦ä¸€ä¸ªè¿›ç¨‹çš„å‡½æ•°ã€‚</li><li>HTTP:è¶…æ–‡æœ¬ä¼ è¾“åè®®,æ˜¯ä¸€ç§å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚-å“åº”æ¨¡å¼ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚,æœåŠ¡å™¨è¿”å›å“åº”,ä¸¤è€…è¿æ¥åç«‹å³æ–­å¼€ã€‚</li></ul><ol start="2"><li>ä¼ è¾“åè®®</li></ol><ul><li>RPC:å¯ä»¥ä½¿ç”¨TCPæˆ–UDPä½œä¸ºä¼ è¾“åè®®ã€‚</li><li>HTTP:ä½¿ç”¨TCPä½œä¸ºä¼ è¾“åè®®ã€‚</li></ul><ol start="3"><li>æ•°æ®æ ¼å¼</li></ol><ul><li>RPC:é€šå¸¸ä½¿ç”¨è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼,æ¯”å¦‚XMLã€JSONç­‰ã€‚</li><li>HTTP:ä½¿ç”¨æ ‡å‡†çš„MIMEç±»å‹,å¦‚HTMLã€XMLã€JSONã€å›¾ç‰‡ç­‰å¤šç§æ ¼å¼ã€‚</li></ul><ol start="4"><li>è¿æ¥æ–¹å¼</li></ol><ul><li>RPC:åŒæ–¹åœ¨é€šä¿¡æœŸé—´ä¼šæŒç»­è¿æ¥ã€‚</li><li>HTTP:é‡‡ç”¨æ— è¿æ¥çš„ä¼ è¾“åè®®,æ¯æ¬¡è¿æ¥åç«‹å³æ–­å¼€,ä¸‹æ¬¡é€šä¿¡éœ€è¦é‡æ–°å»ºç«‹è¿æ¥ã€‚</li></ul><ol start="5"><li>åº”ç”¨åœºæ™¯</li></ol><ul><li>RPC:é€‚ç”¨äºå†…éƒ¨ç³»ç»Ÿé›†æˆ,æä¾›æœåŠ¡çš„è°ƒç”¨å’Œå“åº”ã€‚</li><li>HTTP:é€‚ç”¨äºWebåº”ç”¨,ç½‘é¡µè®¿é—®å’Œæ–‡ä»¶ä¼ è¾“ã€‚</li></ul><p>æ€»ç»“ä¸€ä¸‹</p><ul><li>RPCæ˜¯ä¸€ç§è¿›ç¨‹å†…é€šä¿¡æœºåˆ¶,HTTPæ˜¯ä¸€ç§ç½‘ç»œåº”ç”¨åè®®ã€‚</li><li>RPCä½¿ç”¨TCPæˆ–UDP,HTTPåªä½¿ç”¨TCPã€‚ </li><li>RPCä½¿ç”¨è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼,HTTPä½¿ç”¨æ ‡å‡†MIMEç±»å‹ã€‚</li><li>RPCæ˜¯æŒç»­è¿æ¥,HTTPæ˜¯çŸ­è¿æ¥ã€‚</li><li>RPCç”¨äºå†…éƒ¨é›†æˆ,HTTPç”¨äºWebåº”ç”¨ã€‚</li></ul><p>ä¼Šå¯¹</p><ol><li>é¡¹ç›®ï¼Œæ´»åŠ¨è¥é”€å¹³å°ï¼Œæ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯éš¾ç‚¹ã€‚ã€‚ã€‚</li><li>slice åº•å±‚å®ç°æ˜¯ä»€ä¹ˆï¼Œæºä»£ç é‡Œé¢æœ‰å“ªäº›ç»“æ„ï¼Œæ˜¯å¦æ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>sync.map æ€ä¹ˆå®ç°çš„ï¼Ÿä¸ºä»€ä¹ˆä»–æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåšäº†å“ªäº›å¤„ç†</li><li>redis zsetï¼Œæ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Œredisæ€ä¹ˆå­˜çš„</li><li>redis å¤§keyé—®é¢˜ï¼Ÿ</li><li>mysql æ…¢æŸ¥è¯¢æ€ä¹ˆè§£å†³ï¼Ÿé™¤äº†ç´¢å¼•ï¼ˆåˆ›å»ºåˆé€‚çš„ç´¢å¼•å’Œä¿®æ”¹è¯­å¥ï¼‰+æ•°æ®é‡ è¿˜æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</li><li>go å†…å­˜æ³„æ¼ï¼Ÿ å“ªäº›æƒ…å†µä¼šäº§ç”Ÿå†…å­˜æ³„æ¼<ol><li>å†…å­˜æ³„æ¼å¯èƒ½æ˜¯å› ä¸ºé•¿æœŸè¿è¡Œçš„åå°æœåŠ¡ï¼Œæˆ–è€…æ˜¯å› ä¸ºå¯¹è±¡æ²¡æœ‰è¢«é€‚å½“åœ°æ¸…ç†ã€‚</li><li>æ¯”å¦‚å†™å…¥è¶…è¿‡channelç¼“å†²åŒºé—´çš„ goroutineï¼Œä½†æ˜¯æ²¡æœ‰äººæ¶ˆè´¹ï¼Œåç»­å†™å…¥å…¨éƒ¨é˜»å¡</li><li>æ¯”å¦‚è¯»å–channelæ•°æ®æ—¶ï¼Œç”±äºå†™å…¥ç«¯å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œé€ æˆé¥¥é¥¿é˜»å¡</li><li>å¤šä¸ªåç¨‹ç”±äºé€šä¿¡é—®é¢˜é€ æˆæ­»é”</li><li>æŸäº›é“¾æ¥å¥æŸ„é‡‡ç”¨äº†æ— é™å¾ªç¯çš„æ–¹å¼æ¥ä¿è¯é“¾æ¥æˆåŠŸ<br> è§£å†³æ–¹æ³•ï¼š</li><li>æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦æœ‰å…¨å±€å˜é‡æˆ–é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æŒæœ‰å°å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯¼è‡´å°å¯¹è±¡ä¸èƒ½è¢«åƒåœ¾å›æ”¶ã€‚  </li><li>ç¡®ä¿ä½¿ç”¨äº†æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚<code>sync.Pool</code>ï¼‰æ¥ç®¡ç†å…±äº«èµ„æºçš„ç”Ÿå‘½å‘¨æœŸã€‚</li><li>ä½¿ç”¨å·¥å…·å¦‚<code>go tool pprof</code>åˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œæ‰¾å‡ºå†…å­˜æ³„æ¼çš„ä½ç½®ã€‚</li><li>å®šæœŸé‡å¯æœåŠ¡ä»¥æ¸…ç†å†…å­˜ä¸­çš„æ— ç”¨æ•°æ®ã€‚</li><li>å¦‚æœä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼Œç¡®ä¿å®ƒä»¬åœ¨ä½¿ç”¨åé‡Šæ”¾æ‰€æœ‰èµ„æºã€‚</li><li>åœ¨ä»£ç ä¸­ä½¿ç”¨<code>defer</code>è¯­å¥é‡Šæ”¾èµ„æºï¼Œå¦‚æ–‡ä»¶å¥æŸ„ã€æ•°æ®åº“è¿æ¥ç­‰ã€‚</li><li>å¦‚æœå¯èƒ½ï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ç®¡ç†å’Œå–æ¶ˆé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼Œä»¥ä¾¿åœ¨æ“ä½œå®Œæˆå‰å–æ¶ˆï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol></li></ol><p>é¢˜ï¼š283 ç§»åŠ¨0 æ”¹ä¸º ç§»åŠ¨targetï¼›ç§»åŠ¨è‡³æœ«å°¾æ”¹ä¸ºç§»åŠ¨è‡³å‰é¢</p><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²strï¼Œè¿”å›å­—ç¬¦ä¸²ä¸­å­—æ¯é¡ºåºæœ€å¤§çš„è€Œä¸”åŒæ—¶åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°å¤§å†™å’Œå°å†™çš„å­—æ¯ã€‚ å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å­—æ¯ï¼Œè¿”å›â€˜~â€˜ã€‚<br>è¯·è¿”å›å¤§å†™å­—æ¯<br>|str|&lt;&#x3D;1000<br>â€˜aAbBcDâ€™ è¿”å› B</p><p>leetcode 931</p><p>éœ€è¦è‡ªå·±å†™è¾“å…¥è¾“å‡º</p><h3 id="æ˜†ä»‘ä¸‡ç»´"><a href="#æ˜†ä»‘ä¸‡ç»´" class="headerlink" title="æ˜†ä»‘ä¸‡ç»´"></a>æ˜†ä»‘ä¸‡ç»´</h3><ol><li>gcæµç¨‹ï¼Ÿgcè§¦å‘æ—¶æœºï¼Ÿ</li><li>channelåº•å±‚å®ç°ï¼Ÿ</li><li>mutexåº•å±‚å®ç°ï¼Ÿ è‡ªæ—‹ï¼Ÿ</li><li>mysql å¤šä¸»å¤šä»ï¼Ÿ</li><li>raftåè®®ï¼Œæ€ä¹ˆåŒæ­¥æ—¥å¿—ï¼Ÿè„‘è£‚ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</li><li>Kafka ä¸ºä»€ä¹ˆä¸æ”¯æŒè¯»å†™åˆ†ç¦»ï¼Ÿ</li></ol><p>leet 71<br>leet ä¸‰æ•°ä¹‹å’Œ</p><p>Go channel mutex map slice æºç è§£æ check<br>Go gc gmp check<br>mysql B+æ ‘<br>redis raft<br>kafka<br>elasticsearch<br>etcd<br>grpc<br>zookeeper</p><p>å¾®æœåŠ¡æ‹†åˆ†ã€‚æœåŠ¡æ²»ç†ï¼ˆæœåŠ¡å‘ç°ï¼Œç®¡ç†é…ç½®ï¼Ÿæµé‡æ§åˆ¶ï¼Œæ—¥å¿—ç›‘æ§ï¼Ÿå®¹é”™å®¹ç¾ï¼Ÿï¼‰<br>ç½‘ç»œåè®®ï¼štcp&#x2F;ipï¼Œhttpï¼Œ<br>é«˜å¹¶å‘ï¼Œé«˜å¯ç”¨ï¼Œæ•°æ®ä¸€è‡´æ€§</p><p>dau 1-2w ä¸Šè¯¾äººæ•°ï¼Œç»˜æœ¬ 20w+<br>å¹¿å‘Šä½ï¼šåå‡ ä¸ªä½ç½® ä¹˜ dau å·®ä¸å¤š ç™¾ä¸‡çº§åˆ« qpsï¼›æ´»åŠ¨é«˜å³°æœŸæ€»å‚ä¸å·®ä¸å¤šç™¾ä¸‡ï¼Œæ—¥å‡å¤§æ¦‚èƒ½æœ‰10-20wï¼Œä»»åŠ¡æ¥å£å¤§æ¦‚10-20ä¸ªï¼Œç»¼åˆèµ·æ¥å·®ä¸å¤šå¤§å‡ ç™¾ä¸‡qps<br>ç›¸å…³ç³»ç»Ÿ å·®ä¸å¤š 4æ ¸8gï¼Œ4å®ä¾‹</p><p>åŒºå—é“¾<br>1.æ¥å£åŠ å¯†æ€ä¹ˆåš<br>2.httpsæ˜¯å®‰å…¨çš„ä¹ˆï¼Ÿ<br>3.mapä¸ºä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ·»åŠ kvçš„æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ<br>4.channelåŒºæ»¡ï¼Œå‰©ä¸‹é˜»å¡çŠ¶æ€çš„ routine æ˜¯æ€ä¹ˆè°ƒåº¦çš„ï¼Ÿ<br>5.redis å¤§key<br>6.goå†…å­˜å¯¹é½<br>7.mysql B+æ ‘<br>8.é›ªå´©ï¼Œç©¿é€ï¼ˆäº’æ–¥é” + ç©ºç¼“å­˜ï¼›å¸ƒéš†ï¼Œä½†æ˜¯æ€ä¹ˆç»™æ‰€æœ‰æ¥å£åŠ ï¼Ÿï¼‰æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ<br>9.kafkaä¸ºä»€ä¹ˆè¯»å–æ¯”è¾ƒå¿«ï¼Ÿ<br>10.10ä¸ªGçš„æ‰‹æœºå·ï¼Œå†…å­˜1Gï¼Œæ€ä¹ˆæ’åºï¼Ÿ</p><p>newstart åšä¼ä¸šerpçš„ï¼Œè¯´æ˜¯tobä½†æ˜¯æœ‰ç‚¹åƒå¤–åŒ…äº†<br>1.go for å’Œ for range æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå“ªä¸ªå¥½ï¼Ÿ<br>2.go context è¿‡æœŸã€å¤åˆ¶<br>3.go sliceåº•å±‚æœ‰å“ªäº›ç»“æ„ï¼Ÿ æ‰©å®¹æ€ä¹ˆæ‰©çš„<br>4.åšå·¥èµ„æŠ¥è¡¨ï¼Œæœ‰ä¸€æ‰¹äººå‘˜ï¼Œæœ‰ä¸€æ‰¹ç¬¬ä¸‰æ–¹è€ƒå‹¤æ•°æ®ï¼Œæœ‰ä¸€æ‰¹å†å²å·¥èµ„æ•°æ®ã€‚ä½ ä¼šæ€ä¹ˆè®¾è®¡æ•°æ®åº“ï¼Ÿ</p><p>åŒºå—é“¾<br>æ¥å£æ€ä¹ˆåŠ å¯†ï¼Ÿå¯ä»¥ç”¨ç±»ä¼¼ sign ï¼Œå¯¹æ¥å£å‚æ•°å‰åç«¯åŒæ—¶åŠ å¯†å¯¹æ¯”<br>https å®‰å…¨ä¹ˆï¼ŸæŠ“åŒ…ï¼Ÿ<br>k8s å´©æºƒäº† æœ‰ä»€ä¹ˆæ¢å¤æ‰‹æ®µï¼Ÿè‡ªåŠ¨é‡å¯é ä»€ä¹ˆï¼Ÿ<br>map ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Ÿ æ‰©å®¹ä¸æ˜¯åŸå­æ€§<br>channel 10ç¼“å†²åŒºï¼Œ100 åç¨‹ï¼Œå†™æ»¡äº†ä»¥åï¼Œé˜»å¡çš„åç¨‹ä¼šè¢«è°ƒåº¦åˆ°å“ªé‡Œï¼Ÿå½’è°ç®¡ï¼Ÿ<br>redis å¤§key é—®é¢˜ã€‚kv ä¸­çš„ v å¤§ï¼Œä¸»å› è¿˜æ˜¯åœ¨äº redis ä¸­ string ç±»å‹æ˜¯ç”¨ sds ç»“æ„å­˜å‚¨ï¼Œæœ€å¤§ä¸€å—å†…å­˜åŒºæ˜¯ 128kï¼Œæ›´å¤§çš„ value ä¼šé€ æˆä¸è¿ç»­çš„ç£ç›˜å­˜å‚¨ï¼Œå½±å“å–å€¼é€Ÿåº¦ï¼›å¦ä¸€ä¸ªä¼šå½±å“ioï¼Œä½†ç›¸å¯¹ä¸æ˜¯ä¸»è¦åŸå› <br>kafka ä¸ºä»€ä¹ˆä¼šå¿«å‘¢ï¼Ÿå› ä¸ºä»–çš„å­˜å‚¨æ˜¯åœ¨ä¸€æ®µè¿ç»­çš„åŒºåŸŸ<br>go å†…å­˜å¯¹é½<br>tidb ç”¨çš„åº•å±‚æ˜¯å•¥ï¼Ÿ<br>mysql b+æ ‘ï¼Œå¶å­èŠ‚ç‚¹å­˜åœ¨å“ªé‡Œ<br>ç¼“å­˜é›ªå´©ï¼Ÿ<br>å‡»ç©¿æ€ä¹ˆè§£å†³ï¼Ÿ<br>10ä¸ªGçš„æ‰‹æœºå·æ–‡ä»¶ï¼Œå†…å­˜1ä¸ªGï¼Œæ€ä¹ˆæ’åºï¼Ÿï¼šæ‹†æ–‡ä»¶ï¼Œç„¶åå¯ä»¥æ ¹æ®æ‰‹æœºå·ç‰¹æ€§ï¼Œæ’åºç¬¬ä¸€ä½ç¬¬äºŒä½ï¼Œåˆ†åˆ«æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶å†…</p><p>é˜¿é‡Œï¼š<br>1.æœåŠ¡æ‹†åˆ† åŸåˆ™ ä¸ºä»€ä¹ˆè¦æ‹† æ–¹æ³•è®º  é¢—ç²’åº¦çš„ç²—ç»† æ•°æ®ä¸€è‡´æ€§ ä¸Šçº¿ä¹‹åé‡åˆ°çš„é—®é¢˜<br>2.mongo mysql tidb æœ‰ä»€ä¹ˆä¼˜åŠ£<br>3.kafka pulsuar æœ‰ä»€ä¹ˆä¼˜åŠ£<br>4.æ•°æ®åº“è¿ç§»é‡åˆ°è¿‡å“ªäº›é—®é¢˜ æ€ä¹ˆè§£å†³çš„<br>5.å¹‚ç­‰ å¦‚ä½•è®¾è®¡<br>6.ç»™ä¸€ä¸ªè§†é¢‘è¯„è®ºé¡µé¢ï¼Œæ•°æ®åº“å¦‚ä½•è®¾è®¡ ç´¢å¼• ç¼“å­˜<br>7.äºŒåˆ†æŸ¥æ‰¾ä¸€ä¸ªå°äºXçš„æœ€å¤§æ•°<br>8.ESçš„åŸç†</p><p>conviva:<br>1.ç½‘å€æ•²äº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆ<br>2.ä¸ºä»€ä¹ˆç”¨tidb<br>3.æ•°æ®ç»Ÿè®¡æ€ä¹ˆåšçš„<br>4.ç®—æ³•é¢˜ æœ‰å‘æ— ç¯å›¾æ±‚ç»è¿‡ä¸‰ä¸ªç‚¹çš„è·¯å¾„æ€»æ•°</p><p>æ—·è§†ï¼š<br>1.å†™ä¸€ä¸ªç»“æ„ä½“çš„å¿«æ’<br>2.appendçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»€ä¹ˆ<br>3.appendäº†ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆ<br>3.ç”¨var åˆå§‹åŒ–ä¸€ä¸ªslice å®¹é‡æœ‰å¤šå¤§ å å¤šå°‘å­—èŠ‚<br>4.éšæœºå†™ä¸€ä¸ªleetcodeä¸­ç­‰éš¾åº¦çš„é¢˜</p><p>ä½œä¸šå¸®<br>1.è®²é¡¹ç›®ï¼Œé—®äº†é—®æ´»åŠ¨æ•°æ®<br>2.å‹åŠ›æµ‹è¯•æ€ä¹ˆåšçš„<br>3.æ€ä¹ˆé¿å…é«˜å¹¶å‘çš„è¯·æ±‚åˆ°æ•°æ®åº“ï¼ˆæˆ‘è®²äº†ç¼“å­˜ï¼‰<br>4.æ•°æ®è¿ç§»æ€ä¹ˆåšçš„ï¼Ÿ<br>5.ç®—æ³•é¢˜ï¼šä¸é‡å çš„åŒºé—´<br>6.go interface èƒ½ä¸èƒ½æ¯”è¾ƒï¼Ÿ<br>7.go åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</p><p>æµ·çº³AI<br>1.æ‰“å¼€æ–‡ä»¶ åº”è¯¥æ˜¯æ‰“å¼€äº†æ‰å…³ï¼Œæ²¡æ‰“å¼€ä¸ç”¨å…³<br>2.for range æ˜¯å¤åˆ¶å‡ºæ¥çš„<br>3.åç¨‹ä¼ å‚<br>4.ä½ å†™ä»£ç çš„å±‚çº§æ¶æ„æ˜¯ä»€ä¹ˆæ ·<br>5.update where å¦‚æœæ²¡æœ‰ç´¢å¼•ä¼šå‘ç”Ÿä»€ä¹ˆ è·Ÿéš”ç¦»çº§åˆ«æœ‰å…³ç³»å—<br>6.å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„ä¸€è‡´æ€§ï¼š<br>    è¯»ç¼“å­˜å¤±è´¥è¯»sqlçš„æ—¶å€™åŒæ—¶æ›´æ–°ç¼“å­˜<br>    å¯¹äºæ›´æ–°é¢‘ç¹ä¸”ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼šæ›´æ–°æ—¶å…ˆæ›´æ–°ç¼“å­˜ï¼Œå†åŒæ­¥æ›´æ–°sql<br>    æ›´æ–°é¢‘ç¹ä½†æ˜¯ä¸€è‡´æ€§è¦æ±‚ä½ï¼šä¼˜å…ˆæ›´æ–°ç¼“å­˜ï¼Œå¼‚æ­¥æ›´æ–°sql<br>    äº‹åŠ¡æ–¹å¼åŒå†™<br>    ä½¿ç”¨ä¹è§‚é” + ç‰ˆæœ¬æ§åˆ¶<br>7.ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•<br>8.é™æµæ˜¯æ€ä¹ˆåšçš„ ä»¤ç‰Œæ¡¶ç®—æ³• æœ‰ä»€ä¹ˆç‰¹ç‚¹<br>    æ§åˆ¶è¯·æ±‚é€Ÿç‡<br>    å®šæ—¶ç”Ÿæˆä»¤ç‰Œï¼Œè¯·æ±‚éœ€è¦æ‹¿å–ä»¤ç‰Œæ¥æ‰§è¡Œ<br>    æ¼æ¡¶ç®—æ³•ï¼šæœªæ»¡å…¥æ¡¶ï¼Œå®šé€Ÿæ¼å‡ºæ¥æ‰§è¡Œ<br>9.å‡è®¾æœ‰ä¸€åœºå‡ åä¸‡äººçš„åœ¨çº¿è€ƒè¯•ï¼Œå¦‚ä½•åšåˆ°æ•°æ®æŒä¹…åŒ–æ•°æ®ä¸€è‡´æ€§å’Œé«˜å¯ç”¨<br>10.ä»€ä¹ˆæ˜¯k8sçš„hpa<br>11.è¿™ç§åœºæ™¯ä¸‹rediså’Œæ•°æ®åº“çš„ä¸€è‡´æ€§<br>12.å‡å¦‚æœ‰ä¸€ä¸ªè¡¨æœ‰å‡ ç™¾ä¸ªå­—æ®µ è¿™æ—¶å€™æ€ä¹ˆåŠ</p><p>è¿›ç¨‹ï¼Œçº¿ç¨‹ï¼Œåç¨‹çš„åŒºåˆ«<br>è¿›ç¨‹é—´æ€ä¹ˆé€šä¿¡<br>httpï¼Œsocketï¼Œrpc æ¦‚å¿µå’ŒåŒºåˆ«ï¼Ÿä¼˜ç¼ºç‚¹<br>å¾®æœåŠ¡æ€ä¹ˆåˆ†çš„</p><p>nä¸ªæ•°ï¼Œä»»å– 0-k ä¸ªæ±‚å’Œï¼Œæ±‚æœ‰å¤šå°‘ç§å¯èƒ½çš„ç»“æœ</p><p>ä¸çˆ±ä¸ºèˆ<br>é¡¹ç›®<br>å¾®æœåŠ¡<br>æ•°æ®åº“<br>redis<br>es<br>kafka</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> å®å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ETCD é¢è¯•å¿…å¤‡</title>
      <link href="/interview/distribution/etcd/"/>
      <url>/interview/distribution/etcd/</url>
      
        <content type="html"><![CDATA[<p>etcdåˆ†å¸ƒå¼é”çš„å®ç°æµç¨‹</p><ol><li><p>å»ºç«‹è¿æ¥<br>å®¢æˆ·ç«¯è¿æ¥ etcdï¼Œä»¥ &#x2F;etcd&#x2F;lock ä¸ºå‰ç¼€åˆ›å»ºå…¨å±€å”¯ä¸€çš„ keyï¼Œ å‡è®¾ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯å¯¹åº”çš„ key&#x3D;â€œ&#x2F;etcd&#x2F;lock&#x2F;UUID1â€ï¼Œç¬¬äºŒä¸ªä¸º key&#x3D;â€œ&#x2F;etcd&#x2F;lock&#x2F;UUID2â€ï¼› å®¢æˆ·ç«¯åˆ†åˆ«ä¸ºè‡ªå·±çš„ key åˆ›å»ºç§Ÿçº¦ - Leaseï¼Œç§Ÿçº¦çš„é•¿åº¦æ ¹æ®ä¸šåŠ¡è€—æ—¶ç¡®å®šï¼›</p></li><li><p>åˆ›å»ºå®šæ—¶ä»»åŠ¡ä½œä¸ºç§Ÿçº¦çš„â€œå¿ƒè·³â€<br>å½“ä¸€ä¸ªå®¢æˆ·ç«¯æŒæœ‰é”æœŸé—´ï¼Œå…¶å®ƒå®¢æˆ·ç«¯åªèƒ½ç­‰å¾…ï¼Œä¸ºäº†é¿å…ç­‰å¾…æœŸé—´ç§Ÿçº¦å¤±æ•ˆï¼Œ å®¢æˆ·ç«¯éœ€åˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡ä½œä¸ºâ€œå¿ƒè·³â€è¿›è¡Œç»­çº¦ã€‚æ­¤å¤–ï¼Œå¦‚æœæŒæœ‰é”æœŸé—´å®¢æˆ·ç«¯å´©æºƒï¼Œ å¿ƒè·³åœæ­¢ï¼Œkey å°†å› ç§Ÿçº¦åˆ°æœŸè€Œè¢«åˆ é™¤ï¼Œä»è€Œé”é‡Šæ”¾ï¼Œé¿å…æ­»é”ï¼›</p></li><li><p>å®¢æˆ·ç«¯å°†è‡ªå·±å…¨å±€å”¯ä¸€çš„ key å†™å…¥ etcd<br>æ‰§è¡Œ put æ“ä½œï¼Œå°†æ­¥éª¤ 1 ä¸­åˆ›å»ºçš„ key ç»‘å®šç§Ÿçº¦å†™å…¥ Etcdï¼Œæ ¹æ® Etcd çš„ Revision æœºåˆ¶ï¼Œ å‡è®¾ä¸¤ä¸ªå®¢æˆ·ç«¯ put æ“ä½œè¿”å›çš„ Revision åˆ†åˆ«ä¸º 1ã€2ï¼Œå®¢æˆ·ç«¯éœ€è®°å½• Revision ç”¨ä»¥ æ¥ä¸‹æ¥åˆ¤æ–­è‡ªå·±æ˜¯å¦è·å¾—é”ï¼›</p></li><li><p>å®¢æˆ·ç«¯åˆ¤æ–­æ˜¯å¦è·å¾—é”<br>å®¢æˆ·ç«¯ä»¥å‰ç¼€ &#x2F;etcd&#x2F;lock&#x2F; è¯»å– key-Value åˆ—è¡¨ï¼Œåˆ¤æ–­è‡ªå·± key çš„ Revision æ˜¯å¦ä¸ºå½“å‰åˆ—è¡¨ä¸­ æœ€å°çš„ï¼Œå¦‚æœæ˜¯åˆ™è®¤ä¸ºè·å¾—é”ï¼›å¦åˆ™ç›‘å¬åˆ—è¡¨ä¸­å‰ä¸€ä¸ª Revision æ¯”è‡ªå·±å°çš„ key çš„åˆ é™¤äº‹ä»¶ï¼Œä¸€æ—¦ç›‘å¬åˆ°åˆ é™¤äº‹ä»¶æˆ–è€…å› ç§Ÿçº¦å¤±æ•ˆè€Œåˆ é™¤çš„äº‹ä»¶ï¼Œåˆ™è‡ªå·±è·å¾—é”ï¼›</p></li><li><p>æ‰§è¡Œä¸šåŠ¡<br>è·å¾—é”åï¼Œæ“ä½œå…±äº«èµ„æºï¼Œæ‰§è¡Œä¸šåŠ¡ä»£ç </p></li><li><p>é‡Šæ”¾é”<br>å®Œæˆä¸šåŠ¡æµç¨‹åï¼Œåˆ é™¤å¯¹åº”çš„keyé‡Šæ”¾é”</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> etcd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kafka é¢è¯•å¿…å¤‡</title>
      <link href="/interview/distribution/kafka/"/>
      <url>/interview/distribution/kafka/</url>
      
        <content type="html"><![CDATA[<h5 id="Kafka-çº¿ä¸Šæ¶ˆæ¯ç§¯å‹æ€ä¹ˆè§£å†³"><a href="#Kafka-çº¿ä¸Šæ¶ˆæ¯ç§¯å‹æ€ä¹ˆè§£å†³" class="headerlink" title="Kafka çº¿ä¸Šæ¶ˆæ¯ç§¯å‹æ€ä¹ˆè§£å†³"></a>Kafka çº¿ä¸Šæ¶ˆæ¯ç§¯å‹æ€ä¹ˆè§£å†³</h5><ol><li>æ¶ˆè´¹ç«¯æ‹¿åˆ°çš„æ¶ˆæ¯å¹¶å‘æ¶ˆè€—æ‰</li><li>è½¬å‘åˆ°ä¸€ä¸ªæ–°çš„é˜Ÿåˆ—</li></ol><h5 id="kafka-æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ"><a href="#kafka-æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ" class="headerlink" title="kafka æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ"></a>kafka æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</h5><ol><li>å¦‚æœå‘é€ç«¯ä½¿ç”¨äº†é‡è¯•æœºåˆ¶ï¼Œç”±äºç½‘ç»œåŸå› æ²¡æœ‰æ”¶åˆ°å‘é€æˆåŠŸçš„ ACK</li><li>æ¶ˆè´¹è€…æ‰‹åŠ¨æäº¤ offsetï¼Œæ‹‰å–ä¸€æ‰¹æ•°æ®ï¼Œæ²¡æœ‰æ‰§è¡Œå®Œä½†æ˜¯æœåŠ¡å®•æœºï¼Œè¿™éƒ¨åˆ†ä¼šå†æ¬¡æ‹‰å‡ºæ¥æ‰§è¡Œ<br>è§£å†³æ–¹æ³•ï¼šå¹‚ç­‰å¤„ç†ï¼Œè‡ªåŠ¨æäº¤</li></ol><h5 id="Kafka-æ¶ˆæ¯ä¸¢å¤±ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ"><a href="#Kafka-æ¶ˆæ¯ä¸¢å¤±ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ" class="headerlink" title="Kafka æ¶ˆæ¯ä¸¢å¤±ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ"></a>Kafka æ¶ˆæ¯ä¸¢å¤±ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</h5><p>å­¦ä¹  kafka å‘¢éœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µ<br>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ° broker ä¸­æŸä¸€ä¸ª topic çš„å…·ä½“åˆ†åŒºé‡Œï¼Œæ¶ˆè´¹è€…ä»ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒºä¸­æ‹‰å–æ•°æ®è¿›è¡Œæ¶ˆè´¹</p><p>è¿™é‡Œæ•´ç†äº† Kafka çš„ä¸€äº›å…³é”®æœ¯è¯­ï¼š</p><ul><li>Producerï¼šç”Ÿäº§è€…ï¼Œæ¶ˆæ¯äº§ç”Ÿå’Œå‘é€ç«¯ã€‚</li><li>Brokerï¼šKafka å®ä¾‹ï¼Œå¤šä¸ª broker ç»„æˆä¸€ä¸ª Kafka é›†ç¾¤ï¼Œé€šå¸¸ä¸€å°æœºå™¨éƒ¨ç½²ä¸€ä¸ª Kafka å®ä¾‹ï¼Œä¸€ä¸ªå®ä¾‹æŒ‚äº†ä¸å½±å“å…¶ä»–å®ä¾‹ã€‚</li><li>Consumerï¼šæ¶ˆè´¹è€…ï¼Œæ‹‰å–æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ã€‚ ä¸€ä¸ª topic å¯ä»¥è®©è‹¥å¹²ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œè‹¥å¹²ä¸ªæ¶ˆè´¹è€…ç»„æˆä¸€ä¸ª Consumer Group å³æ¶ˆè´¹ç»„ï¼Œä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«æ¶ˆè´¹ç»„ä¸­ä¸€ä¸ª Consumer æ¶ˆè´¹ã€‚</li><li>Topicï¼šä¸»é¢˜ï¼ŒæœåŠ¡ç«¯æ¶ˆæ¯çš„é€»è¾‘å­˜å‚¨å•å…ƒã€‚ä¸€ä¸ª topic é€šå¸¸åŒ…å«è‹¥å¹²ä¸ª Partition åˆ†åŒºã€‚</li><li>Partitionï¼štopic çš„åˆ†åŒºï¼Œåˆ†å¸ƒå¼å­˜å‚¨åœ¨å„ä¸ª broker ä¸­ï¼Œ å®ç°å‘å¸ƒä¸è®¢é˜…çš„è´Ÿè½½å‡è¡¡ã€‚è‹¥å¹²ä¸ªåˆ†åŒºå¯ä»¥è¢«è‹¥å¹²ä¸ª Consumer åŒæ—¶æ¶ˆè´¹ï¼Œè¾¾åˆ°æ¶ˆè´¹è€…é«˜ååé‡ã€‚ä¸€ä¸ªåˆ†åŒºæ‹¥æœ‰å¤šä¸ªå‰¯æœ¬ï¼ˆReplicaï¼‰ï¼Œè¿™æ˜¯Kafkaåœ¨å¯é æ€§å’Œå¯ç”¨æ€§æ–¹é¢çš„è®¾è®¡ï¼Œåé¢ä¼šé‡ç‚¹ä»‹ç»ã€‚</li><li>messageï¼šæ¶ˆæ¯ï¼Œæˆ–ç§°æ—¥å¿—æ¶ˆæ¯ï¼Œæ˜¯ Kafka æœåŠ¡ç«¯å®é™…å­˜å‚¨çš„æ•°æ®ï¼Œæ¯ä¸€æ¡æ¶ˆæ¯éƒ½ç”±ä¸€ä¸ª keyã€ä¸€ä¸ª value ä»¥åŠæ¶ˆæ¯æ—¶é—´æˆ³ timestamp ç»„æˆã€‚</li><li>offsetï¼šåç§»é‡ï¼Œåˆ†åŒºä¸­çš„æ¶ˆæ¯ä½ç½®ï¼Œç”± Kafka è‡ªèº«ç»´æŠ¤ï¼ŒConsumer æ¶ˆè´¹æ—¶ä¹Ÿè¦ä¿å­˜ä¸€ä»½ offset ä»¥ç»´æŠ¤æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯ä½ç½®ã€‚</li></ul><p>æ¶ˆè´¹é˜Ÿåˆ—å‘¢ä¸€èˆ¬ç”¨æ¥å®ç° åŒæ­¥åˆ°å¼‚æ­¥çš„è½¬æ¢ï¼Œå‰Šå³°ï¼Œè§£è€¦ ç­‰ç›®æ ‡</p><h5 id="kafka-è®¾è®¡ç‰¹æ€§"><a href="#kafka-è®¾è®¡ç‰¹æ€§" class="headerlink" title="kafka è®¾è®¡ç‰¹æ€§"></a>kafka è®¾è®¡ç‰¹æ€§</h5><ul><li>é«˜ååã€ä½å»¶è¿Ÿï¼škakfa æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ”¶å‘æ¶ˆæ¯éå¸¸å¿«ï¼Œkafka æ¯ç§’å¯ä»¥å¤„ç†å‡ åä¸‡æ¡æ¶ˆæ¯ï¼Œå®ƒçš„æœ€ä½å»¶è¿Ÿåªæœ‰å‡ æ¯«ç§’ã€‚</li><li>é«˜ä¼¸ç¼©æ€§ï¼š æ¯ä¸ªä¸»é¢˜(topic) åŒ…å«å¤šä¸ªåˆ†åŒº(partition)ï¼Œä¸»é¢˜ä¸­çš„åˆ†åŒºå¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„ä¸»æœº(broker)ä¸­ã€‚</li><li>æŒä¹…æ€§ã€å¯é æ€§ï¼š Kafka èƒ½å¤Ÿå…è®¸æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œæ¶ˆæ¯è¢«æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå¹¶æ”¯æŒæ•°æ®å¤‡ä»½é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼ŒKafka åº•å±‚çš„æ•°æ®å­˜å‚¨æ˜¯åŸºäº Zookeeper å­˜å‚¨çš„ï¼ŒZookeeper æˆ‘ä»¬çŸ¥é“å®ƒçš„æ•°æ®èƒ½å¤ŸæŒä¹…å­˜å‚¨ã€‚</li><li>å®¹é”™æ€§ï¼š å…è®¸é›†ç¾¤ä¸­çš„èŠ‚ç‚¹å¤±è´¥ï¼ŒæŸä¸ªèŠ‚ç‚¹å®•æœºï¼ŒKafka é›†ç¾¤èƒ½å¤Ÿæ­£å¸¸å·¥ä½œ</li><li>é«˜å¹¶å‘ï¼š æ”¯æŒæ•°åƒä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯»å†™</li></ul><h2 id="Kafka-æ–¹æ¡ˆåŠå…¶ç—›ç‚¹"><a href="#Kafka-æ–¹æ¡ˆåŠå…¶ç—›ç‚¹" class="headerlink" title="Kafka æ–¹æ¡ˆåŠå…¶ç—›ç‚¹"></a>Kafka æ–¹æ¡ˆåŠå…¶ç—›ç‚¹</h2><p>ä¹‹å‰ï¼Œæˆ‘ä»¬é‡‡ç”¨ Apache Kafka ä½œä¸ºæ¶ˆæ¯å¹³å°ï¼Œ ä¸ºäº†è®©ä¸šåŠ¡åœ¨é«˜å³°æœŸï¼ˆæ™šä¸Šå…«ç‚¹åˆ°åç‚¹ï¼‰ä¸å—å½±å“ï¼Œæˆ‘ä»¬æ ¹æ®æ¶ˆæ¯ä¸šåŠ¡é‡çš„å¤§å°ï¼Œ åˆ†åˆ«æ­å»ºäº†ä¸åŒçš„é›†ç¾¤ã€‚å¯¹äºä¸€äº›ä¸šåŠ¡åœºæ™¯çš„éœ€æ±‚ï¼Œ æ¯”å¦‚éœ€è¦é‡ç½® offset æ¥æ¶ˆè´¹è¿‡å»å‡ å¤©çš„æ¶ˆæ¯ï¼Œä½¿ç”¨ Kafka éœ€è¦åœæ‰æ¶ˆè´¹è€…æ‰å¯ä»¥è¿›è¡Œï¼Œ è¿™ç§æ–¹å¼å¯¹å¤§é‡åœ¨çº¿ä¸šåŠ¡éå¸¸ä¸åˆ©ï¼Œåªèƒ½é‡‡ç”¨é‡å†™æ¶ˆæ¯æˆ–è€…ä¸€äº›ä¸å¤ªçµæ´»çš„æ–¹å¼æ¥å®ç°ï¼Œ æå¤§é™ä½äº†ä½¿ç”¨ä½“éªŒã€‚</p><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ Kafka é›†ç¾¤è¿‡ç¨‹ä¸­ï¼Œä¸»è¦é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š  </p><ol><li>Kafka æ²¡æœ‰ç§Ÿæˆ·æ¦‚å¿µï¼Œéœ€è¦æ‰‹åŠ¨ç»´æŠ¤å¤šä¸ªé›†ç¾¤ï¼Œä¸æ–¹ä¾¿è¿ç»´ã€‚</li><li>Kafka é›†ç¾¤æ‰©å®¹åéœ€è¦åš Reassign Partitionsï¼ŒIO æ¶ˆè€—å¤§ã€‚</li><li>Kafka ç›‘æ§ä½“ç³»ä¸å®Œå–„ï¼Œæ’æŸ¥é—®é¢˜è¾ƒä¸ºç¹çã€‚</li><li>åœ¨çº¿ä¸šåŠ¡æ¶ˆæ¯é‡ç½®ä¸æ–¹ä¾¿ï¼Œå®ç°èµ·æ¥è¾ƒä¸ºéº»çƒ¦ï¼Œéœ€è¦åœæ‰æ¶ˆè´¹ç»„ã€‚</li><li>Kafka ä¸æ”¯æŒæ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—ã€‚</li><li>Kafka æ²¡æœ‰å®˜æ–¹ç»´æŠ¤å’Œæ”¯æŒçš„ Go è¯­è¨€å®¢æˆ·ç«¯ã€‚</li><li>åœ¨ Kafka ä¸­æ”¯æŒ schemaï¼Œéœ€è¦å¼•å…¥é¢å¤–ç»„ä»¶ï¼Œä¸æ–¹ä¾¿ç»´æŠ¤ã€‚</li></ol><h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©-Pulsar"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©-Pulsar" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹© Pulsar"></a>ä¸ºä»€ä¹ˆé€‰æ‹© Pulsar</h2><ul><li>Pulsar é‡‡ç”¨äº‘åŸç”Ÿçš„æ¶æ„ï¼Œå­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»ã€‚</li><li>Pulsar æ”¯æŒå¤šç§Ÿæˆ·ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸åŒçš„ä¸šåŠ¡çº¿ã€ä¸šåŠ¡å°ç»„å’Œå¯¹åº”çš„æœåŠ¡çº§åˆ«æ¥ç®¡ç†æ¶ˆæ¯ä¿å­˜æ—¶é—´ã€æŒä¹…åŒ–ã€å †ç§¯æ¸…é™¤ç­–ç•¥ç­‰ï¼Œç»Ÿä¸€ç»´æŠ¤ä¸€å¥— Pulsar é›†ç¾¤ã€‚</li><li>Pulsar æ”¯æŒçµæ´»çš„æ°´å¹³æ‰©å®¹ã€‚å½“å­˜å‚¨ä¸å¤Ÿæ—¶ï¼Œç›´æ¥å¢åŠ  bookie è¿›è¡Œæ‰©å®¹ï¼Œä¸ä¼šå¯¹ç”¨æˆ·äº§ç”Ÿä»»ä½•å½±å“ã€‚</li><li>Pulsar è‡ªå¸¦ç›‘æ§ä½“ç³»ï¼Œbrokerï¼Œbookie ç›¸å…³æŒ‡æ ‡æ¸…æ™°ï¼Œæ–¹ä¾¿å¿«é€Ÿå®šä½é—®é¢˜ï¼Œç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚</li><li>Pulsar cursor æ–¹ä¾¿é‡ç½®æ¶ˆæ¯ï¼Œç»™ä¸šåŠ¡å¸¦æ¥å¾ˆå¥½çš„ä½“éªŒã€‚</li><li>Pulsar æ”¯æŒæ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—ã€‚</li><li>Pulsar schema é›†æˆåœ¨ broker ä¸­ï¼Œä¸éœ€è¦å¼•å…¥å•ç‹¬çš„ç»„ä»¶ã€‚Golang client æ”¯æŒ schemaï¼Œå‡å°‘äº†ç»´æŠ¤æˆæœ¬ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> kafka </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golangè¯­è¨€é¢è¯•é¢˜ - Grpc</title>
      <link href="/interview/go/go-grpc/"/>
      <url>/interview/go/go-grpc/</url>
      
        <content type="html"><![CDATA[<h3 id="grpcå’ŒhttpåŒºåˆ«"><a href="#grpcå’ŒhttpåŒºåˆ«" class="headerlink" title="grpcå’ŒhttpåŒºåˆ«"></a>grpcå’ŒhttpåŒºåˆ«</h3><p>gRPCå’ŒHTTPçš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬çš„ä¼ è¾“åè®®ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹æ³•ã€æ€§èƒ½ç‰¹æ€§ä»¥åŠä½¿ç”¨åœºæ™¯ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>ä¼ è¾“åè®®ä¸åŒã€‚gRPCä½¿ç”¨åŸºäºäºŒè¿›åˆ¶çš„HTTP&#x2F;2ä½œä¸ºä¼ è¾“åè®®ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨ã€å¤´éƒ¨å‹ç¼©å’ŒæœåŠ¡å™¨æ¨é€ç­‰åŠŸèƒ½ï¼Œæé«˜äº†æ€§èƒ½å’Œæ•ˆç‡ï¼Œè€ŒHTTPé€šå¸¸ä½¿ç”¨æ–‡æœ¬åè®®ï¼ŒåŸºäºHTTP&#x2F;1.1æˆ–HTTP&#x2F;2ï¼ŒHTTP&#x2F;1.1æ˜¯åŸºäºè¯·æ±‚-å“åº”æ¨¡å¼çš„åè®®ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å»ºç«‹æ–°çš„è¿æ¥ï¼ŒHTTP&#x2F;2å¼•å…¥äº†å¤šè·¯å¤ç”¨å’Œå¤´éƒ¨å‹ç¼©ç­‰åŠŸèƒ½ã€‚</li><li>åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹æ³•ä¸åŒã€‚gRPCä½¿ç”¨Protocol Buffersï¼ˆprotobufï¼‰ä½œä¸ºé»˜è®¤çš„æ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰ï¼Œç”¨äºæè¿°æ•°æ®ç»“æ„å’ŒæœåŠ¡æ¥å£ï¼Œprotobufæ˜¯ä¸€ç§é«˜æ•ˆçš„äºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼ï¼Œå¯ä»¥æä¾›æ›´å°çš„æ•°æ®åŒ…å¤§å°å’Œæ›´å¿«çš„åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–é€Ÿåº¦ï¼Œè€ŒHTTPä½¿ç”¨æ™®é€šæ–‡æœ¬æ ¼å¼è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œé€šå¸¸ä½¿ç”¨JSONæˆ–XMLä½œä¸ºæ•°æ®çš„è¡¨ç¤ºæ ¼å¼ã€‚</li><li>æ€§èƒ½ç‰¹æ€§ä¸åŒã€‚gRPCåœ¨æ€§èƒ½æ–¹é¢ä¼˜äºHTTPï¼Œç”±äºä½¿ç”¨äº†äºŒè¿›åˆ¶æ ¼å¼ï¼Œå› æ­¤ä¼ è¾“é€Ÿåº¦æ›´å¿«ã€æ›´ç¨³å®šï¼Œè€Œä¸”gRPCé€šè¿‡ä½¿ç”¨è¿æ¥æ± ï¼Œå®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„é•¿è¿æ¥æœºåˆ¶ï¼Œä½¿å¾—å»¶è¿Ÿè¾ƒä½ï¼Œåœ¨é«˜ç½‘ç»œå¸¦å®½æ—¶è¡¨ç°æ›´å¥½ï¼Œè€ŒHTTPè®¾è®¡ç›®æ ‡æ˜¯ä½œä¸ºä¸€ç§é€šç”¨çš„ã€å¯æ‰©å±•çš„åè®®ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“è¶…æ–‡æœ¬æ•°æ®ï¼Œå¹¿æ³›ç”¨äºWebåº”ç”¨ç¨‹åºå’Œæµè§ˆå™¨ä¹‹é—´çš„é€šä¿¡ã€‚</li><li>ä½¿ç”¨åœºæ™¯ä¸åŒã€‚gRPCé€šå¸¸ç”¨äºæœåŠ¡ä¹‹é—´çš„é€šä¿¡ï¼Œç‰¹åˆ«æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¾‹å¦‚å¾®æœåŠ¡æ¡†æ¶ç­‰ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿã€æ˜“æ‰©å±•ç­‰ç‰¹ç‚¹ï¼Œæ˜¯ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒå¼ç³»ç»Ÿé€šä¿¡åè®®ï¼Œè€ŒHTTPä¸»è¦ç”¨äºWebä¸­æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’ï¼Œåœ¨Webåº”ç”¨ç¨‹åºä¸­éå¸¸å¸¸è§ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> go </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Goè¯­è¨€ Slice ç»“æ„çš„åº•å±‚å®ç°</title>
      <link href="/golang/advanced-tutorial/go-slice/"/>
      <url>/golang/advanced-tutorial/go-slice/</url>
      
        <content type="html"><![CDATA[<h4 id="append-æ€§èƒ½æŸè€—"><a href="#append-æ€§èƒ½æŸè€—" class="headerlink" title="append æ€§èƒ½æŸè€—"></a>append æ€§èƒ½æŸè€—</h4><p>æœªæŒ‡å®šé•¿åº¦æˆ–è€…é•¿åº¦ä¸è¶³æ—¶ï¼ŒåŒå€æ‰©å®¹ï¼ˆcap &lt; 1024ï¼‰; 1.25å€æ‰©å®¹(cap &gt; 1024)ã€‚æŠŠå…ƒå†…å­˜ç©ºé—´çš„æ•°æ®æ‹·è´è¿‡æ¥ï¼Œç„¶ååœ¨æ–°çš„å†…å­˜ç©ºé—´ç»§ç»­appendæ•°æ®</p><p>åœ¨ Go 1.18 ä»¥åï¼Œæ‰©å®¹ä½¿ç”¨thresholdä¸ºä¸´ç•Œç‚¹ï¼ˆæºç ä¸­è®¾ç½®ä¸º256ï¼‰<br>å½“sliceå®¹é‡ &lt; 256æ—¶ï¼Œ æ¯æ¬¡æ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€ã€‚å½“sliceå®¹é‡ &gt; 256æ—¶ï¼Œ æ¯æ¬¡å¢åŠ (oldcap + 3*threshold) 3&#x2F;4</p><h4 id="æ¯å­åˆ‡ç‰‡å…±äº«å†…å­˜é—®é¢˜"><a href="#æ¯å­åˆ‡ç‰‡å…±äº«å†…å­˜é—®é¢˜" class="headerlink" title="æ¯å­åˆ‡ç‰‡å…±äº«å†…å­˜é—®é¢˜"></a>æ¯å­åˆ‡ç‰‡å…±äº«å†…å­˜é—®é¢˜</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slicem := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">3</span>, <span class="number">5</span>) <span class="comment">// len = 3, cap = 5 åˆ†é…äº†5ä¸ªç©ºé—´ï¼Œç½®å…¥äº†3ä¸ªæ•°æ®</span></span><br><span class="line">slices := slicem[<span class="number">1</span>:<span class="number">3</span>] <span class="comment">// len = 2, cap = 4</span></span><br></pre></td></tr></table></figure><p>æœ€å¼€å§‹æ—¶ï¼Œå­åˆ‡ç‰‡å’Œæ¯åˆ‡ç‰‡å…±äº«æ¯åˆ‡ç‰‡çš„å†…å­˜ç©ºé—´ï¼Œå¯¹å­åˆ‡ç‰‡çš„ä¿®æ”¹ä¼šåæ˜ åˆ°æ¯åˆ‡ç‰‡ä¸Šï¼Œå¯¹å­åˆ‡ç‰‡çš„ append æ“ä½œï¼Œä¼šå°†æ•°æ®æ·»åŠ åˆ°æ¯åˆ‡ç‰‡é¢„ç•™çš„å†…å­˜ç©ºé—´å†…ã€‚<br>å¦‚æŒç»­è¿›è¡Œ append æ“ä½œï¼Œç›´åˆ°å°†æ¯åˆ‡ç‰‡é¢„ç•™çš„å†…å­˜ç©ºé—´å®Œå…¨æ¶ˆè€—å®Œæ¯•åï¼ŒäºŒè€…å°±ä¼šå‘ç”Ÿå†…å­˜åˆ†ç¦»ï¼Œä»æ­¤å†æ— å…³ç³»</p><h4 id="åˆ‡ç‰‡å¯¼è‡´å†…å­˜æ³„æ¼"><a href="#åˆ‡ç‰‡å¯¼è‡´å†…å­˜æ³„æ¼" class="headerlink" title="åˆ‡ç‰‡å¯¼è‡´å†…å­˜æ³„æ¼"></a>åˆ‡ç‰‡å¯¼è‡´å†…å­˜æ³„æ¼</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Leak</span><span class="params">()</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">parent := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">son := parent[<span class="number">10</span>:<span class="number">20</span>]</span><br><span class="line"><span class="keyword">return</span> son</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>func è¿”å›å­åˆ‡ç‰‡ï¼Œåªè¦è¿™ä¸ªå­åˆ‡ç‰‡æ²¡æœ‰è¢« GC å›æ”¶ï¼Œå­åˆ‡ç‰‡æŒæœ‰çš„æ¯åˆ‡ç‰‡çš„å†…å­˜ç©ºé—´å°±å¾—ä¸åˆ°é‡Šæ”¾ï¼Œå¯¼è‡´æ³„æ¼</p><h4 id="å‡½æ•°å‚æ•°éœ€è¦ç”¨åˆ‡ç‰‡æŒ‡é’ˆä¹ˆ"><a href="#å‡½æ•°å‚æ•°éœ€è¦ç”¨åˆ‡ç‰‡æŒ‡é’ˆä¹ˆ" class="headerlink" title="å‡½æ•°å‚æ•°éœ€è¦ç”¨åˆ‡ç‰‡æŒ‡é’ˆä¹ˆ"></a>å‡½æ•°å‚æ•°éœ€è¦ç”¨åˆ‡ç‰‡æŒ‡é’ˆä¹ˆ</h4><p>å¦‚æœå‡½æ•°å†…éƒ¨éœ€è¦å¯¹åˆ‡ç‰‡çš„ len å’Œ cap è¿›è¡Œä¿®æ”¹ï¼Œä¸”ä¿®æ”¹è¦åæ˜ åœ¨å‡½æ•°å¤–éƒ¨ï¼Œé‚£ä¹ˆéœ€è¦ä¼ å…¥åˆ‡ç‰‡çš„æŒ‡é’ˆ</p><h4 id="ä¸€è¾¹éå†ä¸€è¾¹ä¿®æ”¹åˆ‡ç‰‡"><a href="#ä¸€è¾¹éå†ä¸€è¾¹ä¿®æ”¹åˆ‡ç‰‡" class="headerlink" title="ä¸€è¾¹éå†ä¸€è¾¹ä¿®æ”¹åˆ‡ç‰‡"></a>ä¸€è¾¹éå†ä¸€è¾¹ä¿®æ”¹åˆ‡ç‰‡</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">arr := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line"><span class="comment">// go ä¸­ for-range éå†çš„æ˜¯åŸé›†åˆçš„æ‹·è´</span></span><br><span class="line"><span class="keyword">for</span> i, m := <span class="keyword">range</span> arr &#123;</span><br><span class="line">m += <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹æ–¹è¿™ç§æ‰èƒ½ä¿®æ”¹æˆåŠŸ</span></span><br><span class="line"><span class="keyword">for</span> i, m := <span class="keyword">range</span> arr &#123;</span><br><span class="line">arr[i] = m + <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è¿›é˜¶æ•™ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> Slice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼23-ä¸­ä»‹æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/23-mediator/"/>
      <url>/golang/go-design-pattern/gdp-act/23-mediator/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼22-è§£é‡Šå™¨æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/22-interpreter/"/>
      <url>/golang/go-design-pattern/gdp-act/22-interpreter/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼21-å‘½ä»¤æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/21-command/"/>
      <url>/golang/go-design-pattern/gdp-act/21-command/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼20-å¤‡å¿˜å½•æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/20-memento/"/>
      <url>/golang/go-design-pattern/gdp-act/20-memento/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼19-è®¿é—®è€…æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/19-visitor/"/>
      <url>/golang/go-design-pattern/gdp-act/19-visitor/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼18-è¿­ä»£å™¨æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/18-iterator/"/>
      <url>/golang/go-design-pattern/gdp-act/18-iterator/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼17-çŠ¶æ€æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/17-state/"/>
      <url>/golang/go-design-pattern/gdp-act/17-state/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè¯­è¨€ Map ç»“æ„çš„åº•å±‚å®ç°</title>
      <link href="/golang/advanced-tutorial/go-map/"/>
      <url>/golang/advanced-tutorial/go-map/</url>
      
        <content type="html"><![CDATA[<h2 id="Golang-ä¸­çš„-map-è¯¦è§£"><a href="#Golang-ä¸­çš„-map-è¯¦è§£" class="headerlink" title="Golang ä¸­çš„ map è¯¦è§£"></a>Golang ä¸­çš„ map è¯¦è§£</h2><h3 id="ä¸€ã€ä»€ä¹ˆæ˜¯-mapï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-mapï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ mapï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ mapï¼Ÿ</h3><h4 id="1ã€map-çš„å®šä¹‰"><a href="#1ã€map-çš„å®šä¹‰" class="headerlink" title="1ã€map çš„å®šä¹‰"></a>1ã€map çš„å®šä¹‰</h4><p>â€ƒâ€ƒåœ¨è®¡ç®—æœºç§‘å­¦é‡Œï¼Œè¢«ç§°ä¸ºç›¸å…³æ•°ç»„ã€mapã€ç¬¦å·è¡¨æˆ–è€…å­—å…¸ï¼Œæ˜¯ç”±ä¸€ç»„ &lt;key, value&gt; å¯¹ç»„æˆçš„æŠ½è±¡æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”åŒä¸€ä¸ª key åªä¼šå‡ºç°ä¸€æ¬¡ã€‚<br>â€ƒâ€ƒä¸¤ä¸ªå…³é”®ç‚¹ï¼šmap æ˜¯ç”± key-value å¯¹ç»„æˆçš„ï¼›key åªä¼šå‡ºç°ä¸€æ¬¡ã€‚<br>â€ƒâ€ƒmap çš„è®¾è®¡ä¹Ÿè¢«ç§°ä¸º â€œThe dictionary problemï¼ˆå­—å…¸é—®é¢˜ï¼‰â€ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯è®¾è®¡ä¸€ç§æ•°æ®ç»“æ„ç”¨æ¥ç»´æŠ¤ä¸€ä¸ªé›†åˆçš„æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶å¯¹é›†åˆè¿›è¡Œå¢åˆ æŸ¥æ”¹çš„æ“ä½œã€‚</p><h4 id="2ã€map-çš„æ•°æ®ç»“æ„"><a href="#2ã€map-çš„æ•°æ®ç»“æ„" class="headerlink" title="2ã€map çš„æ•°æ®ç»“æ„"></a>2ã€map çš„æ•°æ®ç»“æ„</h4><p>â€ƒâ€ƒæœ€ä¸»è¦çš„æ•°æ®ç»“æ„æœ‰ä¸¤ç§ï¼šå“ˆå¸ŒæŸ¥æ‰¾è¡¨ï¼ˆHash tableï¼‰ã€æœç´¢æ ‘ï¼ˆSearch treeï¼‰ã€‚</p><p>å“ˆå¸ŒæŸ¥æ‰¾è¡¨ï¼ˆHash tableï¼‰<br>â€ƒâ€ƒå“ˆå¸ŒæŸ¥æ‰¾è¡¨ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°† key åˆ†é…åˆ°ä¸åŒçš„æ¡¶ï¼ˆbucketï¼Œä¹Ÿå°±æ˜¯æ•°ç»„çš„ä¸åŒ indexï¼‰ï¼Œå¼€é”€ä¸»è¦åœ¨å“ˆå¸Œå‡½æ•°çš„è®¡ç®—ä»¥åŠæ•°ç»„çš„å¸¸æ•°è®¿é—®æ—¶é—´ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œå“ˆå¸ŒæŸ¥æ‰¾è¡¨çš„æ€§èƒ½å¾ˆé«˜ã€‚</p><p>æœç´¢æ ‘ï¼ˆSearch treeï¼‰<br>â€ƒâ€ƒæœç´¢æ ‘ä¸€èˆ¬é‡‡ç”¨è‡ªå¹³è¡¡æœç´¢æ ‘ï¼ŒåŒ…æ‹¬ï¼šAVL æ ‘ï¼Œçº¢é»‘æ ‘ã€‚<br>â€ƒâ€ƒå“ˆå¸ŒæŸ¥æ‰¾è¡¨çš„å¹³å‡æŸ¥æ‰¾æ•ˆç‡æ˜¯ O(1)ï¼Œæœ€å·®æ˜¯ O(N)ï¼Œå¦‚æœå“ˆå¸Œå‡½æ•°è®¾è®¡çš„å¾ˆå¥½ï¼Œæœ€åçš„æƒ…å†µåŸºæœ¬ä¸ä¼šå‡ºç°ã€‚è‡ªå¹³è¡¡æœç´¢æ ‘æ³•çš„æœ€å·®æœç´¢æ•ˆç‡æ˜¯ O(logN)ã€‚éå†è‡ªå¹³è¡¡æœç´¢æ ‘ï¼Œè¿”å›çš„ key åºåˆ—ï¼Œä¸€èˆ¬ä¼šæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºï¼›è€Œå“ˆå¸ŒæŸ¥æ‰¾è¡¨åˆ™æ˜¯ä¹±åºçš„ã€‚</p><h3 id="äºŒã€Golang-ä¸­-map-çš„ç±»å‹"><a href="#äºŒã€Golang-ä¸­-map-çš„ç±»å‹" class="headerlink" title="äºŒã€Golang ä¸­ map çš„ç±»å‹"></a>äºŒã€Golang ä¸­ map çš„ç±»å‹</h3><p>â€ƒâ€ƒGolang ä¸­ map æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå ç”¨ 8 ä¸ªå­—èŠ‚ã€‚å½“ä½¿ç”¨ make åˆ›å»º map æ—¶ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯ makemap() å‡½æ•°ï¼Œmakemap() å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºè¿”å›çš„æ˜¯æŒ‡é’ˆï¼Œæ‰€ä»¥ map ä½œä¸ºå‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°å†…éƒ¨èƒ½ä¿®æ”¹mapã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makemap</span><span class="params">(t *maptype, hint <span class="type">int</span>, h *hmap)</span></span> *hmap &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€map-çš„åº•å±‚å®ç°"><a href="#ä¸‰ã€map-çš„åº•å±‚å®ç°" class="headerlink" title="ä¸‰ã€map çš„åº•å±‚å®ç°"></a>ä¸‰ã€map çš„åº•å±‚å®ç°</h3><p>â€ƒâ€ƒ æºç ä½äº src\runtime\map.go ä¸­ã€‚</p><p>â€ƒâ€ƒgolang ä¸­ map åº•å±‚ä½¿ç”¨çš„æ˜¯å“ˆå¸ŒæŸ¥æ‰¾è¡¨ï¼Œç”¨é“¾è¡¨æ¥è§£å†³å“ˆå¸Œå†²çªã€‚æ¯ä¸ª map çš„åº•å±‚ç»“æ„æ˜¯ hmapï¼Œæ˜¯ç”±è‹¥å¹²ä¸ªç»“æ„ä¸º bmap çš„ bucket ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ª bucket åº•å±‚éƒ½é‡‡ç”¨é“¾è¡¨ç»“æ„ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A header for a Go map.  </span></span><br><span class="line"><span class="keyword">type</span> hmap <span class="keyword">struct</span> &#123;  </span><br><span class="line"><span class="comment">// Note: the format of the hmap is also encoded in cmd/compile/internal/gc/reflect.go.   </span></span><br><span class="line"><span class="comment">// Make sure this stays in sync with the compiler&#x27;s definition.   </span></span><br><span class="line">count     <span class="type">int</span>    <span class="comment">// mapä¸­å…ƒç´ çš„æ•°é‡ï¼Œè°ƒç”¨len()ç›´æ¥è¿”å›æ­¤å€¼  </span></span><br><span class="line">flags     <span class="type">uint8</span>  <span class="comment">// çŠ¶æ€æ ‡è¯†ç¬¦ï¼Œkeyå’Œvalueæ˜¯å¦åŒ…æŒ‡é’ˆã€æ˜¯å¦æ­£åœ¨æ‰©å®¹ã€æ˜¯å¦å·²ç»è¢«è¿­ä»£</span></span><br><span class="line">B         <span class="type">uint8</span>  <span class="comment">// mapä¸­æ¡¶æ•°ç»„çš„æ•°é‡ï¼Œæ¡¶æ•°ç»„çš„é•¿åº¦çš„å¯¹æ•°ï¼Œlen(buckets) == 2^Bï¼Œå¯ä»¥æœ€å¤šå®¹çº³ 6.5 * 2 ^ B ä¸ªå…ƒç´ ï¼Œ6.5ä¸ºè£…è½½å› å­  </span></span><br><span class="line">noverflow <span class="type">uint16</span> <span class="comment">// æº¢å‡ºæ¡¶çš„å¤§æ¦‚æ•°é‡ï¼Œå½“Bå°äº16æ—¶æ˜¯å‡†ç¡®å€¼ï¼Œå¤§äºç­‰äº16æ—¶æ˜¯å¤§æ¦‚çš„å€¼</span></span><br><span class="line">hash0     <span class="type">uint32</span> <span class="comment">// å“ˆå¸Œç§å­ï¼Œç”¨äºè®¡ç®—å“ˆå¸Œå€¼ï¼Œä¸ºå“ˆå¸Œå‡½æ•°çš„ç»“æœå¼•å…¥ä¸€å®šçš„éšæœºæ€§</span></span><br><span class="line"></span><br><span class="line">buckets    unsafe.Pointer <span class="comment">// æŒ‡å‘æ¡¶æ•°ç»„çš„æŒ‡é’ˆï¼Œé•¿åº¦ä¸º 2^B ï¼Œå¦‚æœå…ƒç´ ä¸ªæ•°ä¸º0ï¼Œå°±ä¸º nil  </span></span><br><span class="line">oldbuckets unsafe.Pointer <span class="comment">// æŒ‡å‘ä¸€ä¸ªæ—§æ¡¶æ•°ç»„ï¼Œç”¨äºæ‰©å®¹ï¼Œå®ƒçš„é•¿åº¦æ˜¯å½“å‰æ¡¶æ•°ç»„çš„ä¸€åŠ, æ‰©å®¹æ—¶éç©º  </span></span><br><span class="line">nevacuate  <span class="type">uintptr</span>        <span class="comment">// æ¬è¿è¿›åº¦ï¼Œå°äºæ­¤åœ°å€çš„æ¡¶æ•°ç»„è¿ç§»å®Œæˆ  </span></span><br><span class="line"></span><br><span class="line">extra *mapextra <span class="comment">// å¯é€‰å­—æ®µï¼Œç”¨äºgcï¼ŒæŒ‡å‘æ‰€æœ‰çš„æº¢å‡ºæ¡¶ï¼Œé¿å…gcæ—¶æ‰«ææ•´ä¸ªmapï¼Œä»…æ‰«ææ‰€æœ‰æº¢å‡ºæ¡¶å°±è¶³å¤Ÿäº†</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mapextra holds fields that are not present on all maps.type </span></span><br><span class="line">mapextra <span class="keyword">struct</span> &#123;  </span><br><span class="line">   <span class="comment">// If both key and elem do not contain pointers and are inline, then we mark bucket  </span></span><br><span class="line">   <span class="comment">// type as containing no pointers. This avoids scanning such maps.  </span></span><br><span class="line">   <span class="comment">// However, bmap.overflow is a pointer. In order to keep overflow buckets   </span></span><br><span class="line">   <span class="comment">// alive, we store pointers to all overflow buckets in hmap.extra.overflow and hmap.extra.oldoverflow.   </span></span><br><span class="line">   <span class="comment">// overflow and oldoverflow are only used if key and elem do not contain pointers.   </span></span><br><span class="line">   <span class="comment">// overflow contains overflow buckets for hmap.buckets.  </span></span><br><span class="line">   <span class="comment">// oldoverflow contains overflow buckets for hmap.oldbuckets.  </span></span><br><span class="line">   <span class="comment">// The indirection allows to store a pointer to the slice in hiter.  </span></span><br><span class="line">   overflow    *[]*bmap  <span class="comment">// æŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‡å‘æ‰€æœ‰æº¢å‡ºæ¡¶</span></span><br><span class="line">   oldoverflow *[]*bmap  <span class="comment">// æŒ‡é’ˆæ•°ç»„ï¼Œå‘ç”Ÿæ‰©å®¹æ—¶ï¼ŒæŒ‡å‘æ‰€æœ‰æ—§çš„æº¢å‡ºæ¡¶</span></span><br><span class="line">  </span><br><span class="line">   <span class="comment">// nextOverflow holds a pointer to a free overflow bucket.  </span></span><br><span class="line">   nextOverflow *bmap  <span class="comment">// æŒ‡å‘æ‰€æœ‰æº¢å‡ºæ¡¶ä¸­ä¸‹ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„æº¢å‡ºæ¡¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>bmapçš„ç»“æ„ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> bmap <span class="keyword">struct</span> &#123;</span><br><span class="line">    tophash [bucketCnt]<span class="type">uint8</span>    <span class="comment">// bucketCnt=8ï¼Œ// å­˜æ”¾keyå“ˆå¸Œå€¼çš„é«˜8ä½ï¼Œç”¨äºå†³å®škvé”®å€¼å¯¹æ”¾åœ¨æ¡¶å†…çš„å“ªä¸ªä½ç½®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®é™…ä¸Šç¼–è¾‘æœŸé—´ä¼šåŠ¨æ€ç”Ÿæˆä¸€ä¸ªæ–°çš„ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">type</span> bmap <span class="keyword">struct</span> &#123;</span><br><span class="line">topbits  [<span class="number">8</span>]<span class="type">uint8</span>     <span class="comment">// å­˜æ”¾keyå“ˆå¸Œå€¼çš„é«˜8ä½ï¼Œç”¨äºå†³å®škvé”®å€¼å¯¹æ”¾åœ¨æ¡¶å†…çš„å“ªä¸ªä½ç½®</span></span><br><span class="line">keys     [<span class="number">8</span>]keytype   <span class="comment">// å­˜æ”¾keyçš„æ•°ç»„</span></span><br><span class="line">values   [<span class="number">8</span>]valuetype <span class="comment">// å­˜æ”¾valueçš„æ•°ç»„</span></span><br><span class="line">pad      <span class="type">uintptr</span>      <span class="comment">// ç”¨äºå¯¹é½å†…å­˜</span></span><br><span class="line">overflow <span class="type">uintptr</span>      <span class="comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªæ¡¶ï¼Œå³æº¢å‡ºæ¡¶ï¼Œæ‹‰é“¾æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€ƒâ€ƒbucketsæ˜¯ä¸€ä¸ªbmapæ•°ç»„ï¼Œæ•°ç»„çš„é•¿åº¦å°±æ˜¯ 2^Bã€‚æ¯ä¸ªbucketå›ºå®šåŒ…å«8ä¸ªkeyå’Œvalueï¼Œå®ç°ä¸Šé¢æ˜¯ä¸€ä¸ªå›ºå®šçš„å¤§å°è¿ç»­å†…å­˜å—ï¼Œåˆ†æˆå››éƒ¨åˆ†ï¼štophash å€¼ï¼Œ8ä¸ªkeyå€¼ï¼Œ8ä¸ªvalueå€¼ï¼ŒæŒ‡å‘ä¸‹ä¸ªbucketçš„æŒ‡é’ˆã€‚</p><p>â€ƒâ€ƒtophash å€¼ç”¨äºå¿«é€ŸæŸ¥æ‰¾keyæ˜¯å¦åœ¨è¯¥bucketä¸­ï¼Œå½“æ’å…¥å’ŒæŸ¥è¯¢è¿è¡Œæ—¶éƒ½ä¼šä½¿ç”¨å“ˆå¸Œå“ˆæ•°å¯¹keyåšå“ˆå¸Œè¿ç®—ï¼Œè·å–ä¸€ä¸ªhashcodeï¼Œå–é«˜8ä½å­˜æ”¾åœ¨bmap tophashå­—æ®µä¸­ã€‚</p><p>â€ƒâ€ƒæ¡¶é‡Œé¢ä¼šæœ€å¤šè£… 8 ä¸ª keyï¼Œè¿™äº› key ä¹‹æ‰€ä»¥ä¼šè½å…¥åŒä¸€ä¸ªæ¡¶ï¼Œæ˜¯å› ä¸ºå®ƒä»¬ç»è¿‡å“ˆå¸Œè®¡ç®—åï¼Œå“ˆå¸Œç»“æœæ˜¯â€œä¸€ç±»â€çš„ã€‚åœ¨æ¡¶å†…ï¼Œåˆä¼šæ ¹æ® key è®¡ç®—å‡ºæ¥çš„ hash å€¼çš„é«˜ 8 ä½æ¥å†³å®š key åˆ°åº•è½å…¥æ¡¶å†…çš„å“ªä¸ªä½ç½®ï¼ˆä¸€ä¸ªæ¡¶å†…æœ€å¤šæœ‰8ä¸ªä½ç½®ï¼‰ã€‚</p><p>â€ƒâ€ƒå¦‚å›¾ï¼ŒB&#x3D;5 è¡¨ç¤ºhmapçš„æœ‰2^5&#x3D;32ä¸ªbmapï¼Œbucketsæ˜¯ä¸€ä¸ªbmapæ•°ç»„ï¼Œå…¶é•¿åº¦ä¸º32ï¼Œæ¯ä¸ªbmapæœ‰8ä¸ªkeyã€‚</p><p>â€ƒâ€ƒæ¡¶ç»“æ„çš„å¾ˆå¤šå­—æ®µå¾—åœ¨ç¼–è¯‘æ—¶æ‰ä¼šåŠ¨æ€ç”Ÿæˆï¼Œæ¯”å¦‚ key å’Œ values ç­‰</p><p>â€ƒâ€ƒæ¡¶ç»“æ„ä¸­ï¼Œä¹‹æ‰€ä»¥æ‰€æœ‰çš„ key æ”¾ä¸€èµ·ï¼Œæ‰€æœ‰çš„ value æ”¾ä¸€èµ·ï¼Œè€Œä¸æ˜¯ key&#x2F;value ä¸€å¯¹å¯¹çš„ä¸€èµ·å­˜æ”¾ï¼Œç›®çš„ä¾¿æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥çœå»padå­—æ®µï¼ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚ç”±äºå†…å­˜å¯¹é½çš„åŸå› ï¼Œkey0&#x2F;value0&#x2F;key1&#x2F;value1â€¦ è¿™æ ·çš„å½¢å¼å¯èƒ½éœ€è¦æ›´å¤šçš„è¡¥é½ç©ºé—´ï¼Œæ¯”å¦‚ map[int64]int8 ï¼Œ1å­—èŠ‚çš„valueåé¢éœ€è¦è¡¥é½7ä¸ªå­—èŠ‚æ‰èƒ½ä¿è¯ä¸‹ä¸€ä¸ªkeyæ˜¯ int64 å¯¹é½çš„ã€‚</p><p>â€ƒâ€ƒgolangä¸­çš„mapä½¿ç”¨çš„å†…å­˜æ˜¯ä¸ä¼šæ”¶ç¼©çš„ï¼Œåªä¼šè¶Šç”¨è¶Šå¤šã€‚</p><p>â€ƒâ€ƒæ¯ä¸ª bucket è®¾è®¡æˆæœ€å¤šåªèƒ½æ”¾ 8 ä¸ª key-value å¯¹ï¼Œå¦‚æœæœ‰ç¬¬ 9 ä¸ª key-value è½å…¥å½“å‰çš„ bucketï¼Œé‚£å°±éœ€è¦å†æ„å»ºä¸€ä¸ªæº¢å‡ºæ¡¶ bucket ï¼Œé€šè¿‡ overflow æŒ‡é’ˆè¿æ¥èµ·æ¥ã€‚</p><h3 id="å››ã€map-çš„æ‰©å®¹"><a href="#å››ã€map-çš„æ‰©å®¹" class="headerlink" title="å››ã€map çš„æ‰©å®¹"></a>å››ã€map çš„æ‰©å®¹</h3><h4 id="1ã€è£…è½½å› å­ï¼ˆå¹³å‡æ¯ä¸ªæ¡¶å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ï¼‰"><a href="#1ã€è£…è½½å› å­ï¼ˆå¹³å‡æ¯ä¸ªæ¡¶å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ï¼‰" class="headerlink" title="1ã€è£…è½½å› å­ï¼ˆå¹³å‡æ¯ä¸ªæ¡¶å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ï¼‰"></a>1ã€è£…è½½å› å­ï¼ˆå¹³å‡æ¯ä¸ªæ¡¶å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ï¼‰</h4><p>â€ƒâ€ƒGoçš„è£…è½½å› å­é˜ˆå€¼å¸¸é‡ï¼š6.5ï¼Œmap æœ€å¤šå¯å®¹çº³ 6.5*2^B ä¸ªå…ƒç´ ã€‚</p><p>â€ƒâ€ƒè£…è½½å› å­ç­‰äº mapä¸­å…ƒç´ çš„ä¸ªæ•° &#x2F; mapçš„å®¹é‡ï¼Œå³len(map) &#x2F; 2^Bã€‚è£…è½½å› å­ç”¨æ¥è¡¨ç¤ºç©ºé—²ä½ç½®çš„æƒ…å†µï¼Œè£…è½½å› å­è¶Šå¤§ï¼Œè¡¨æ˜ç©ºé—²ä½ç½®è¶Šå°‘ï¼Œå†²çªä¹Ÿè¶Šå¤šã€‚éšç€è£…è½½å› å­çš„å¢å¤§ï¼Œå“ˆå¸Œè¡¨çº¿æ€§æ¢æµ‹çš„å¹³å‡ç”¨æ—¶å°±ä¼šå¢åŠ ï¼Œè¿™ä¼šå½±å“å“ˆå¸Œè¡¨çš„æ€§èƒ½ï¼Œå½“è£…è½½å› å­å¤§äº70%ï¼Œå“ˆå¸Œè¡¨çš„æ€§èƒ½å°±ä¼šæ€¥å‰§ä¸‹é™ï¼Œå½“è£…è½½å› å­è¾¾åˆ°100%ï¼Œæ•´ä¸ªå“ˆå¸Œè¡¨å°±ä¼šå®Œå…¨å¤±æ•ˆï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒæŸ¥æ‰¾å’Œæ’å…¥ä»»æ„å…ƒç´ çš„å¤æ‚åº¦éƒ½æ˜¯O(N),å› ä¸ºéœ€è¦éå†æ‰€æœ‰å…ƒç´ ã€‚</p><p>â€ƒâ€ƒå¦å¤–è£…è½½å› å­ä¸æ‰©å®¹ã€è¿ç§»ç­‰é‡æ–°æ•£åˆ—(rehash) è¡Œä¸ºæœ‰ç›´æ¥å…³ç³»ï¼š</p><p>åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œä¼šä¸æ–­åœ°è¿›è¡Œæ’å…¥ã€åˆ é™¤ç­‰ï¼Œä¼šå¯¼è‡´ bucket ä¸å‡ï¼Œå†…å­˜åˆ©ç”¨ç‡ä½ï¼Œéœ€è¦è¿ç§»ã€‚<br>åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå‡ºç°è£…è½½å› å­è¿‡å¤§ï¼Œéœ€è¦åšæ‰©å®¹ï¼Œè§£å†³ bucket è¿‡å¤§çš„é—®é¢˜ã€‚<br>ä¸ºä»€ä¹ˆè£…è½½å› å­æ˜¯6.5ï¼Ÿä¸æ˜¯8ï¼Ÿä¸æ˜¯1ï¼Ÿ<br>â€ƒâ€ƒè£…è½½å› å­æ˜¯å“ˆå¸Œè¡¨ä¸­çš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å¹³è¡¡ buckets çš„å­˜å‚¨ç©ºé—´å¤§å°å’ŒæŸ¥æ‰¾å…ƒç´ æ—¶çš„æ€§èƒ½é«˜ä½ã€‚å®é™…ä¸Šè¿™æ˜¯ Go å®˜æ–¹çš„ç»è¿‡è®¤çœŸçš„æµ‹è¯•å¾—å‡ºçš„æ•°å­—ï¼Œä¸€èµ·æ¥çœ‹çœ‹å®˜æ–¹çš„è¿™ä»½æµ‹è¯•æŠ¥å‘Šã€‚åŒ…å«å››ä¸ªæŒ‡æ ‡ï¼š</p><p>loadFactorï¼šè´Ÿè½½å› å­ï¼Œä¹Ÿå«è£…è½½å› å­ï¼›<br>%overflowï¼šæº¢å‡ºç‡ï¼Œæœ‰æº¢å‡º bukcet çš„ç™¾åˆ†æ¯”ï¼›<br>bytes&#x2F;entryï¼šå¹³å‡æ¯å¯¹ key&#x2F;alue çš„å¼€é”€å­—èŠ‚æ•°ï¼›<br>hitprobeï¼šæŸ¥æ‰¾ä¸€ä¸ªå­˜åœ¨çš„ key æ—¶ï¼Œè¦æŸ¥æ‰¾çš„å¹³å‡ä¸ªæ•°ï¼›<br>missprobeï¼šæŸ¥æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„ key æ—¶ï¼Œè¦æŸ¥æ‰¾çš„å¹³å‡ä¸ªæ•°ã€‚</p><p>â€ƒâ€ƒGo å®˜æ–¹å‘ç°ï¼šè£…è½½å› å­è¶Šå¤§ï¼Œå¡«å…¥çš„å…ƒç´ è¶Šå¤šï¼Œç©ºé—´åˆ©ç”¨ç‡å°±è¶Šé«˜ï¼Œä½†å‘ç”Ÿå†²çªçš„å‡ ç‡å°±å˜å¤§ï¼›åä¹‹ï¼Œè£…æ•°å› å­è¶Šå°ï¼Œå¡«å…¥çš„å…ƒç´ è¶Šå°‘ï¼Œå†²çªå‘ç”Ÿçš„å‡ ç‡å‡å°ï¼Œä½†ç©ºé—´åˆ©ç”¨ç‡ä½ï¼Œè€Œä¸”è¿˜ä¼šæé«˜æ‰©å®¹æ“ä½œçš„æ¬¡æ•°ã€‚</p><p>â€ƒâ€ƒæ ¹æ®è¿™ä»½æµ‹è¯•ç»“æœå’Œè®¨è®ºï¼ŒGo å®˜æ–¹å–äº†ä¸€ä¸ªç›¸å¯¹é€‚ä¸­çš„å€¼ï¼ŒæŠŠ Go ä¸­çš„ map çš„è´Ÿæ•°å› å­ç¡¬ç¼–ç ä¸º 6.5ï¼Œè¿™å°±æ˜¯ 6.5 çš„é€‰æ‹©ç¼˜ç”±ã€‚è¿™æ„å‘³ç€åœ¨ Go è¯­è¨€ä¸­ï¼Œå½“ mapå­˜å‚¨çš„å…ƒç´ ä¸ªæ•°å¤§äºæˆ–ç­‰äº 6.5*æ¡¶ä¸ªæ•° æ—¶ï¼Œå°±ä¼šå‘æ‰©å®¹è¡Œä¸ºã€‚</p><h4 id="2ã€è§¦å‘-map-æ‰©å®¹çš„æ—¶æœºï¼ˆæ’å…¥ã€åˆ é™¤keyï¼‰"><a href="#2ã€è§¦å‘-map-æ‰©å®¹çš„æ—¶æœºï¼ˆæ’å…¥ã€åˆ é™¤keyï¼‰" class="headerlink" title="2ã€è§¦å‘ map æ‰©å®¹çš„æ—¶æœºï¼ˆæ’å…¥ã€åˆ é™¤keyï¼‰"></a>2ã€è§¦å‘ map æ‰©å®¹çš„æ—¶æœºï¼ˆæ’å…¥ã€åˆ é™¤keyï¼‰</h4><p>å½“è£…è½½å› å­è¶…è¿‡6.5æ—¶ï¼Œæ‰©å®¹ä¸€å€ï¼Œå±äºå¢é‡æ‰©å®¹ï¼›<br>å½“ä½¿ç”¨çš„æº¢å‡ºæ¡¶è¿‡å¤šæ—¶ï¼Œé‡æ–°åˆ†é…ä¸€æ ·å¤§çš„å†…å­˜ç©ºé—´ï¼Œå±äºç­‰é‡æ‰©å®¹ï¼›<br>ï¼ˆå®é™…ä¸Šæ²¡æœ‰æ‰©å®¹ï¼Œä¸»è¦æ˜¯ä¸ºäº†å›æ”¶ç©ºé—²çš„æº¢å‡ºæ¡¶ï¼ŒèŠ‚çœç©ºé—´ï¼Œæé«˜ map çš„æŸ¥æ‰¾å’Œæ’å…¥æ•ˆç‡ï¼‰<br>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿ<br>â€ƒâ€ƒè¿™ç§æƒ…å†µå¯èƒ½æ˜¯å› ä¸ºmapåˆ é™¤çš„ç‰¹æ€§å¯¼è‡´çš„ã€‚å½“æˆ‘ä»¬ä¸æ–­å‘å“ˆå¸Œè¡¨ä¸­æ’å…¥æ•°æ®ï¼Œå¹¶ä¸”å°†ä»–ä»¬åˆå…¨éƒ¨åˆ é™¤æ—¶ï¼Œå…¶å†…å­˜å ç”¨å¹¶ä¸ä¼šå‡å°‘ï¼Œå› ä¸ºåˆ é™¤åªæ˜¯å°†æ¡¶å¯¹åº”ä½ç½®çš„tophashç½®nilè€Œå·²ã€‚<br>â€ƒâ€ƒè¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä¼šä¸æ–­çš„ç§¯ç´¯æº¢å‡ºæ¡¶é€ æˆå†…å­˜æ³„éœ²ï¼Œä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œé‡‡ç”¨äº†ç­‰é‡æ‰©å®¹çš„æœºåˆ¶ï¼Œä¸€æ—¦å“ˆå¸Œè¡¨ä¸­å‡ºç°äº†è¿‡å¤šçš„æº¢å‡ºæ¡¶ï¼Œä¼šåˆ›å»ºæ–°æ¡¶ä¿å­˜æ•°æ®ï¼Œgcä¼šæ¸…ç†æ‰è€çš„æº¢å‡ºæ¡¶ï¼Œä»è€Œé¿å…å†…å­˜æ³„éœ²ã€‚</p><p>å¦‚ä½•å®šä¹‰æº¢å‡ºæ¡¶æ˜¯å¦å¤ªå¤šéœ€è¦ç­‰é‡æ‰©å®¹å‘¢ï¼Ÿä¸¤ç§æƒ…å†µï¼š</p><p>å½“Bå°äº15æ—¶ï¼Œæº¢å‡ºæ¡¶çš„æ•°é‡è¶…è¿‡2^Bï¼Œå±äºæº¢å‡ºæ¡¶æ•°é‡å¤ªå¤šï¼Œéœ€è¦ç­‰é‡æ‰©å®¹ï¼›<br>å½“Bå¤§äºç­‰äº15æ—¶ï¼Œæº¢å‡ºæ¡¶æ•°é‡è¶…è¿‡2^15ï¼Œå±äºæº¢å‡ºæ¡¶æ•°é‡å¤ªå¤šï¼Œéœ€è¦ç­‰é‡æ‰©å®¹ã€‚</p><h4 id="3ã€æ‰©å®¹ç­–ç•¥ï¼ˆæ€ä¹ˆæ‰©å®¹ï¼Ÿï¼‰"><a href="#3ã€æ‰©å®¹ç­–ç•¥ï¼ˆæ€ä¹ˆæ‰©å®¹ï¼Ÿï¼‰" class="headerlink" title="3ã€æ‰©å®¹ç­–ç•¥ï¼ˆæ€ä¹ˆæ‰©å®¹ï¼Ÿï¼‰"></a>3ã€æ‰©å®¹ç­–ç•¥ï¼ˆæ€ä¹ˆæ‰©å®¹ï¼Ÿï¼‰</h4><p>â€ƒâ€ƒGo ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ buckets æ•°ç»„ï¼Œæ–°çš„ buckets æ•°ç»„çš„å®¹é‡æ˜¯æ—§bucketsæ•°ç»„çš„ä¸¤å€ï¼ˆæˆ–è€…å’Œæ—§æ¡¶å®¹é‡ç›¸åŒï¼‰ï¼Œå°†åŸå§‹æ¡¶æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ é‡æ–°æ•£åˆ—åˆ°æ–°çš„æ¡¶æ•°ç»„ä¸­ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ä½¿æ¯ä¸ªæ¡¶ä¸­çš„å…ƒç´ æ•°é‡å°½å¯èƒ½å¹³å‡åˆ†å¸ƒï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚æ—§çš„bucketsæ•°ç»„ä¸ä¼šè¢«ç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯ä¼šæŠŠåŸæ¥å¯¹æ—§æ•°ç»„çš„å¼•ç”¨å»æ‰ï¼Œè®©GCæ¥æ¸…é™¤å†…å­˜ã€‚</p><p>â€ƒâ€ƒåœ¨mapè¿›è¡Œæ‰©å®¹è¿ç§»çš„æœŸé—´ï¼Œä¸ä¼šè§¦å‘ç¬¬äºŒæ¬¡æ‰©å®¹ã€‚åªæœ‰åœ¨å‰ä¸€ä¸ªæ‰©å®¹è¿ç§»å·¥ä½œå®Œæˆåï¼Œmapæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ¬¡æ‰©å®¹æ“ä½œã€‚</p><h4 id="4ã€æ¬è¿ç­–ç•¥"><a href="#4ã€æ¬è¿ç­–ç•¥" class="headerlink" title="4ã€æ¬è¿ç­–ç•¥"></a>4ã€æ¬è¿ç­–ç•¥</h4><p>â€ƒâ€ƒç”±äºmapæ‰©å®¹éœ€è¦å°†åŸæœ‰çš„kvé”®å€¼å¯¹æ¬è¿åˆ°æ–°çš„å†…å­˜åœ°å€ï¼Œå¦‚æœä¸€ä¸‹å­å…¨éƒ¨æ¬å®Œï¼Œä¼šéå¸¸çš„å½±å“æ€§èƒ½ã€‚go ä¸­ map çš„æ‰©å®¹é‡‡ç”¨æ¸è¿›å¼çš„æ¬è¿ç­–ç•¥ï¼ŒåŸæœ‰çš„ key å¹¶ä¸ä¼šä¸€æ¬¡æ€§æ¬è¿å®Œæ¯•ï¼Œä¸€æ¬¡æ€§æ¬è¿ä¼šé€ æˆæ¯”è¾ƒå¤§çš„å»¶æ—¶ï¼Œæ¯æ¬¡æœ€å¤šåªä¼šæ¬è¿ 2 ä¸ª bucketï¼Œå°†æ¬è¿çš„O(N)å¼€é”€å‡æ‘Šåˆ°O(1)çš„èµ‹å€¼å’Œåˆ é™¤æ“ä½œä¸Šã€‚</p><p>â€ƒâ€ƒä¸Šé¢è¯´çš„ hashGrow() å‡½æ•°å®é™…ä¸Šå¹¶æ²¡æœ‰çœŸæ­£åœ°â€œæ¬è¿â€ï¼Œå®ƒåªæ˜¯åˆ†é…å¥½äº†æ–°çš„ bucketsï¼Œå¹¶å°†è€çš„ buckets æŒ‚åˆ°äº† oldbuckets å­—æ®µä¸Šã€‚çœŸæ­£æ¬è¿ buckets çš„åŠ¨ä½œåœ¨ growWork() å‡½æ•°ä¸­ï¼Œè€Œè°ƒç”¨ growWork() å‡½æ•°çš„åŠ¨ä½œæ˜¯åœ¨ mapassign å’Œ mapdelete å‡½æ•°ä¸­ã€‚ä¹Ÿå°±æ˜¯æ’å…¥æˆ–ä¿®æ”¹ã€åˆ é™¤ key çš„æ—¶å€™ï¼Œéƒ½ä¼šå°è¯•è¿›è¡Œæ¬è¿ buckets çš„å·¥ä½œã€‚å…ˆæ£€æŸ¥ oldbuckets æ˜¯å¦æ¬è¿å®Œæ¯•ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯æ£€æŸ¥ oldbuckets æ˜¯å¦ä¸º nilã€‚</p><h3 id="äº”ã€è§£å†³å“ˆå¸Œå†²çª"><a href="#äº”ã€è§£å†³å“ˆå¸Œå†²çª" class="headerlink" title="äº”ã€è§£å†³å“ˆå¸Œå†²çª"></a>äº”ã€è§£å†³å“ˆå¸Œå†²çª</h3><h4 id="1ã€å¼€æ”¾å¯»å€æ³•"><a href="#1ã€å¼€æ”¾å¯»å€æ³•" class="headerlink" title="1ã€å¼€æ”¾å¯»å€æ³•"></a>1ã€å¼€æ”¾å¯»å€æ³•</h4><p>â€ƒâ€ƒå¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œä»å‘ç”Ÿå†²çªçš„é‚£ä¸ªå•å…ƒèµ·ï¼ŒæŒ‰ä¸€å®šçš„æ¬¡åºï¼Œä¸æ–­é‡å¤ï¼Œä»å“ˆå¸Œè¡¨ä¸­å¯»æ‰¾ä¸€ä¸ªç©ºé—²çš„å•å…ƒï¼Œå°†è¯¥é”®å€¼å¯¹å­˜å‚¨åœ¨è¯¥å•å…ƒä¸­ã€‚å…·ä½“çš„å®ç°æ–¹å¼åŒ…æ‹¬çº¿æ€§æ¢æµ‹æ³•ã€å¹³æ–¹æ¢æµ‹æ³•ã€éšæœºæ¢æµ‹æ³•å’ŒåŒé‡å“ˆå¸Œæ³•ç­‰ã€‚å¼€æ”¾å¯»å€æ³•éœ€è¦çš„è¡¨é•¿åº¦è¦å¤§äºç­‰äºæ‰€éœ€è¦å­˜æ”¾çš„å…ƒç´ æ•°é‡ã€‚</p><h4 id="2ã€é“¾åœ°å€æ³•"><a href="#2ã€é“¾åœ°å€æ³•" class="headerlink" title="2ã€é“¾åœ°å€æ³•"></a>2ã€é“¾åœ°å€æ³•</h4><p>â€ƒâ€ƒåŸºäºæ•°ç»„ + é“¾è¡¨ å®ç°å“ˆå¸Œè¡¨ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œå°†æ¯ä¸ªæ¡¶éƒ½æŒ‡å‘ä¸€ä¸ªé“¾è¡¨ï¼Œå½“å“ˆå¸Œå†²çªå‘ç”Ÿæ—¶ï¼Œæ–°çš„é”®å€¼å¯¹ä¼šæŒ‰é¡ºåºæ·»åŠ åˆ°è¯¥æ¡¶å¯¹åº”çš„é“¾è¡¨çš„å°¾éƒ¨ã€‚åœ¨æŸ¥æ‰¾ç‰¹å®šé”®å€¼å¯¹æ—¶ï¼Œå¯ä»¥éå†è¯¥é“¾è¡¨ä»¥æŸ¥æ‰¾ä¸ä¹‹åŒ¹é…çš„é”®å€¼å¯¹ã€‚</p><h4 id="3ã€ä¸¤ç§æ–¹æ¡ˆçš„æ¯”è¾ƒ"><a href="#3ã€ä¸¤ç§æ–¹æ¡ˆçš„æ¯”è¾ƒ" class="headerlink" title="3ã€ä¸¤ç§æ–¹æ¡ˆçš„æ¯”è¾ƒ"></a>3ã€ä¸¤ç§æ–¹æ¡ˆçš„æ¯”è¾ƒ</h4><p>å†…å­˜åˆ©ç”¨ç‡<br>â€ƒâ€ƒå¯¹äºé“¾åœ°å€æ³•ï¼ŒåŸºäº æ•°ç»„ + é“¾è¡¨ è¿›è¡Œå­˜å‚¨ï¼Œé“¾è¡¨èŠ‚ç‚¹å¯ä»¥åœ¨éœ€è¦æ—¶å†åˆ›å»ºï¼Œå¼€æ”¾å¯»å€æ³•éœ€è¦äº‹å…ˆç”³è¯·å¥½è¶³å¤Ÿå†…å­˜ï¼Œå› æ­¤é“¾åœ°å€æ³•å¯¹å†…å­˜çš„åˆ©ç”¨ç‡é«˜ã€‚<br>é€‚ç”¨åœºæ™¯<br>â€ƒâ€ƒé“¾åœ°å€æ³•å¯¹è£…è½½å› å­çš„å®¹å¿åº¦ä¼šæ›´é«˜ï¼Œé€‚åˆå­˜å‚¨å¤§å¯¹è±¡ã€å¤§æ•°æ®é‡çš„å“ˆå¸Œè¡¨ï¼Œè€Œä¸”ç›¸è¾ƒäºå¼€æ”¾å¯»å€æ³•ï¼Œå®ƒæ›´åŠ çµæ´»ï¼Œæ”¯æŒæ›´å¤šçš„ä¼˜åŒ–ç­–ç•¥ï¼Œæ¯”å¦‚å¯é‡‡ç”¨çº¢é»‘æ ‘ä»£æ›¿é“¾è¡¨ã€‚ä½†æ˜¯é“¾åœ°å€æ³•éœ€è¦é¢å¤–çš„ç©ºé—´æ¥å­˜å‚¨æŒ‡é’ˆã€‚<br>â€ƒâ€ƒå¯¹äºå¼€æ”¾å¯»å€æ³•ï¼Œå®ƒåªæœ‰æ•°ç»„ä¸€ç§æ•°æ®ç»“æ„å°±å¯å®Œæˆå­˜å‚¨ï¼Œç»§æ‰¿äº†æ•°ç»„çš„ä¼˜ç‚¹ï¼Œå¯¹CPUç¼“å­˜å‹å¥½ï¼Œæ˜“äºåºåˆ—åŒ–æ“ä½œï¼Œä½†æ˜¯å®ƒå¯¹å†…å­˜çš„åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¸”å‘ç”Ÿå†²çªæ—¶ä»£ä»·æ›´é«˜ã€‚å½“æ•°æ®é‡æ˜ç¡®ã€è£…è½½å› å­å°ï¼Œé€‚åˆé‡‡ç”¨å¼€æ”¾å¯»å€æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è¿›é˜¶æ•™ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼16-èŒè´£é“¾æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/16-chain/"/>
      <url>/golang/go-design-pattern/gdp-act/16-chain/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼15-ç­–ç•¥æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/15-strategy/"/>
      <url>/golang/go-design-pattern/gdp-act/15-strategy/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼14-æ¨¡æ¿æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/14-template/"/>
      <url>/golang/go-design-pattern/gdp-act/14-template/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼13-è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-act/13-observer/"/>
      <url>/golang/go-design-pattern/gdp-act/13-observer/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼12-äº«å…ƒæ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/12-flyweight/"/>
      <url>/golang/go-design-pattern/gdp-struct/12-flyweight/</url>
      
        <content type="html"><![CDATA[<p>æŒ‰ç…§è¯¾ç¨‹ä¸­çš„ä¾‹å­æ¥ç†è§£ï¼Œå°±æ˜¯è±¡æ£‹æ£‹å­ä½œä¸ºäº«å…ƒï¼Œå¯ä»¥è¢«æ‰€æœ‰çš„å¯¹å±€å…±äº«ï¼Œä»¥è¾¾åˆ°å‡å°‘å†…å­˜çš„ç›®çš„</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼11-ç»„åˆæ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/11-composite/"/>
      <url>/golang/go-design-pattern/gdp-struct/11-composite/</url>
      
        <content type="html"><![CDATA[<p>æ¯”è¾ƒç®€å•çš„ä¾‹å­æ˜¯ äººå‘˜æ¶æ„ä¸­ éƒ¨é—¨å’Œäººå‘˜çš„å…³ç³»ï¼ŒäºŒè€…å¯ä»¥å½¢æˆç®€å•çš„æ ‘å½¢æ¥å£ï¼Œéƒ¨é—¨ä¸­è§„å®šäº†ä¸€äº›åŠŸèƒ½ï¼›è€Œäººå‘˜åˆæœ‰è‡ªå·±çš„åŸºæœ¬å±æ€§åŠŸèƒ½</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼10-é—¨é¢æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/10-facade/"/>
      <url>/golang/go-design-pattern/gdp-struct/10-facade/</url>
      
        <content type="html"><![CDATA[<p>ç®€å•æ¥ç†è§£å°±æ˜¯ æœ‰ç™»å½•å’Œæ³¨å†Œä¸¤ä¸ªåŸºç¡€åŠŸèƒ½ï¼Œå¯¹å¤–ç»Ÿä¸€å°è£…æˆ ç™»å½•&amp;æ³¨å†Œï¼Œä¸Šå±‚è°ƒç”¨æ— éœ€çŸ¥é“å…·ä½“è°ƒç”¨çš„é€»è¾‘ï¼Œåªé€šè¿‡ä¸€ä¸ªæ¥å£è·å–ç™»å½•çŠ¶æ€å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼09-é€‚é…å™¨æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/09-adapter/"/>
      <url>/golang/go-design-pattern/gdp-struct/09-adapter/</url>
      
        <content type="html"><![CDATA[<p>ç®€å•ç†è§£æ˜¯æœ‰ä¸¤ä¸ªä¸åŒçš„ä¸šåŠ¡ç³»ç»Ÿï¼Œéœ€è¦åŒæ—¶å®ŒæˆåŒä¸€ç§ä¸šåŠ¡åŠ¨ä½œï¼Œå¯ä»¥å°è£…åç»Ÿä¸€æä¾›ç»™ä¸Šå±‚è°ƒç”¨</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼08-è£…é¥°å™¨æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/08-decorator/"/>
      <url>/golang/go-design-pattern/gdp-struct/08-decorator/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç”»ç”»çš„ä¾‹å­ï¼Œé»˜è®¤çš„Â <code>Line</code>Â  åªæœ‰åŸºç¡€çš„ç”»ç”»åŠŸèƒ½ï¼ŒÂ <code>ColorLine</code>Â  ä¸ºä»–åŠ ä¸Šäº†é¢œè‰²ï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹ç°æœ‰åŠŸèƒ½ç±»è¿›è¡ŒåŒ…è£…ï¼Œå¢åŠ æ–°åŠŸèƒ½ç‚¹</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> decorator  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// IDraw IDraw  </span></span><br><span class="line"><span class="keyword">type</span> IDraw <span class="keyword">interface</span> &#123;  </span><br><span class="line">   Draw() <span class="type">string</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Line åˆ’çº¿  </span></span><br><span class="line"><span class="keyword">type</span> Line <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Draw Draw  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l Line)</span></span> Draw() <span class="type">string</span> &#123;  </span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;Drawing a line here&quot;</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ColorLine æœ‰é¢œè‰²çš„çº¿  </span></span><br><span class="line"><span class="keyword">type</span> ColorLine <span class="keyword">struct</span> &#123;  </span><br><span class="line">   line IDraw  </span><br><span class="line">   color  <span class="type">string</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// NewColorLine NewColorLine  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewColorLine</span><span class="params">(line IDraw, color <span class="type">string</span>)</span></span> ColorLine &#123;  </span><br><span class="line">   <span class="keyword">return</span> ColorLine&#123;color: color, line: line&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Draw Draw  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c ColorLine)</span></span> Draw() <span class="type">string</span> &#123;  </span><br><span class="line">   <span class="keyword">return</span> c.line.Draw() + <span class="string">&quot;, color is &quot;</span> + c.color  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestColorLine_Draw</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">   l := Line&#123;&#125;  </span><br><span class="line">   ncl := NewColorLine(sq, <span class="string">&quot;red&quot;</span>)  </span><br><span class="line">   got := ncl.Draw()  </span><br><span class="line">   assert.Equal(t, <span class="string">&quot;Drawing a line here, color is red&quot;</span>, got)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼07-æ¡¥æ¥æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/07-bridge/"/>
      <url>/golang/go-design-pattern/gdp-struct/07-bridge/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bridge  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// IMsgSender IMsgSender  </span></span><br><span class="line"><span class="keyword">type</span> IMsgSender <span class="keyword">interface</span> &#123;  </span><br><span class="line">   Send(msg <span class="type">string</span>) <span class="type">error</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// EmailMsgSender å‘é€é‚®ä»¶  </span></span><br><span class="line"><span class="comment">// å¯èƒ½è¿˜æœ‰ ç”µè¯ã€çŸ­ä¿¡ç­‰å„ç§å®ç°  </span></span><br><span class="line"><span class="keyword">type</span> EmailMsgSender <span class="keyword">struct</span> &#123;  </span><br><span class="line">   emails []<span class="type">string</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// NewEmailMsgSender NewEmailMsgSender  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewEmailMsgSender</span><span class="params">(emails []<span class="type">string</span>)</span></span> *EmailMsgSender &#123;  </span><br><span class="line">   <span class="keyword">return</span> &amp;EmailMsgSender&#123;emails: emails&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Send Send  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *EmailMsgSender)</span></span> Send(msg <span class="type">string</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="comment">// è¿™é‡Œå»å‘é€æ¶ˆæ¯  </span></span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// INotification é€šçŸ¥æ¥å£  </span></span><br><span class="line"><span class="keyword">type</span> INotification <span class="keyword">interface</span> &#123;  </span><br><span class="line">   Notify(msg <span class="type">string</span>) <span class="type">error</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ErrorNotification é”™è¯¯é€šçŸ¥  </span></span><br><span class="line"><span class="comment">// åé¢å¯èƒ½è¿˜æœ‰ warning å„ç§çº§åˆ«  </span></span><br><span class="line"><span class="keyword">type</span> ErrorNotification <span class="keyword">struct</span> &#123;  </span><br><span class="line">   sender IMsgSender  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// NewErrorNotification NewErrorNotification  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewErrorNotification</span><span class="params">(sender IMsgSender)</span></span> *ErrorNotification &#123;  </span><br><span class="line">   <span class="keyword">return</span> &amp;ErrorNotification&#123;sender: sender&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Notify å‘é€é€šçŸ¥  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *ErrorNotification)</span></span> Notify(msg <span class="type">string</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="keyword">return</span> n.sender.Send(msg)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestErrorNotification_Notify</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">   sender := NewEmailMsgSender([]<span class="type">string</span>&#123;<span class="string">&quot;test@test.com&quot;</span>&#125;)  </span><br><span class="line">   n := NewErrorNotification(sender)  </span><br><span class="line">   err := n.Notify(<span class="string">&quot;test msg&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">   assert.Nil(t, err)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼06-ä»£ç†æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-struct/06-proxy/"/>
      <url>/golang/go-design-pattern/gdp-struct/06-proxy/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼05-åˆ›é€ è€…æ¨¡å¼æ€»ç»“</title>
      <link href="/golang/go-design-pattern/gdp-create/05-create-summarize/"/>
      <url>/golang/go-design-pattern/gdp-create/05-create-summarize/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼04-åŸå‹æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-create/04-prototype/"/>
      <url>/golang/go-design-pattern/gdp-create/04-prototype/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼03-æ„é€ æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-create/03-builder/"/>
      <url>/golang/go-design-pattern/gdp-create/03-builder/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>å…¶å®åœ¨ Golang ä¸­å¯¹äºåˆ›å»ºç±»å‚æ•°æ¯”è¾ƒå¤šçš„å¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸è§çš„åšæ³•æ˜¯å¿…å¡«å‚æ•°ç›´æ¥ä¼ é€’ï¼Œå¯é€‰å‚æ•°é€šè¿‡ä¼ é€’å¯å˜çš„æ–¹æ³•è¿›è¡Œåˆ›å»ºã€‚<br>æœ¬æ–‡ä¼šå…ˆå®ç°è¯¾ç¨‹ä¸­çš„å»ºé€ è€…æ¨¡å¼ï¼Œç„¶åå†å®ç°æˆ‘ä»¬å¸¸ç”¨çš„æ–¹å¼ã€‚</p><h3 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h3><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><p>é€šè¿‡ä¸‹é¢å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ Go ç¼–å†™å»ºé€ è€…æ¨¡å¼çš„ä»£ç å…¶å®ä¼šå¾ˆé•¿ï¼Œè¿™äº›æ˜¯å®ƒçš„ä¸€ä¸ªç¼ºç‚¹ï¼Œæ‰€ä»¥å¦‚æœä¸æ˜¯å‚æ•°çš„æ ¡éªŒé€»è¾‘å¾ˆå¤æ‚çš„æƒ…å†µä¸‹ä¸€èˆ¬æˆ‘ä»¬åœ¨ Go ä¸­ä¸ä¼šé‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œä¼šé‡‡ç”¨åé¢çš„å¦å¤–ä¸€ç§æ–¹å¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> builder  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> (  </span><br><span class="line">   defaultMaxTotal = <span class="number">10</span>  </span><br><span class="line">   defaultMaxIdle  = <span class="number">9</span>  </span><br><span class="line">   defaultMinIdle  = <span class="number">1</span>  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ResourcePoolConfig resource pooltype ResourcePoolConfig struct &#123;  </span></span><br><span class="line">   name     <span class="type">string</span>  </span><br><span class="line">   maxTotal <span class="type">int</span>  </span><br><span class="line">   maxIdle  <span class="type">int</span>  </span><br><span class="line">   minIdle  <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ResourcePoolConfigBuilder ç”¨äºæ„å»º ResourcePoolConfig  </span></span><br><span class="line"><span class="keyword">type</span> ResourcePoolConfigBuilder <span class="keyword">struct</span> &#123;  </span><br><span class="line">   name     <span class="type">string</span>  </span><br><span class="line">   maxTotal <span class="type">int</span>  </span><br><span class="line">   maxIdle  <span class="type">int</span>  </span><br><span class="line">   minIdle  <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// SetName SetName  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *ResourcePoolConfigBuilder)</span></span> SetName(name <span class="type">string</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> name == <span class="string">&quot;&quot;</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;name can not be empty&quot;</span>)  </span><br><span class="line">   &#125;  </span><br><span class="line">   b.name = name  </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// SetMinIdle SetMinIdle  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *ResourcePoolConfigBuilder)</span></span> SetMinIdle(minIdle <span class="type">int</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> minIdle &lt; <span class="number">0</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;max tatal cannot &lt; 0, input: %d&quot;</span>, minIdle)  </span><br><span class="line">   &#125;  </span><br><span class="line">   b.minIdle = minIdle  </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// SetMaxIdle SetMaxIdle  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *ResourcePoolConfigBuilder)</span></span> SetMaxIdle(maxIdle <span class="type">int</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> maxIdle &lt; <span class="number">0</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;max tatal cannot &lt; 0, input: %d&quot;</span>, maxIdle)  </span><br><span class="line">   &#125;  </span><br><span class="line">   b.maxIdle = maxIdle  </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// SetMaxTotal SetMaxTotal  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *ResourcePoolConfigBuilder)</span></span> SetMaxTotal(maxTotal <span class="type">int</span>) <span class="type">error</span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> maxTotal &lt;= <span class="number">0</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;max tatal cannot &lt;= 0, input: %d&quot;</span>, maxTotal)  </span><br><span class="line">   &#125;  </span><br><span class="line">   b.maxTotal = maxTotal  </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Build Build  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *ResourcePoolConfigBuilder)</span></span> Build() (*ResourcePoolConfig, <span class="type">error</span>) &#123;  </span><br><span class="line">   <span class="keyword">if</span> b.name == <span class="string">&quot;&quot;</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;name can not be empty&quot;</span>)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="comment">// è®¾ç½®é»˜è®¤å€¼  </span></span><br><span class="line">   <span class="keyword">if</span> b.minIdle == <span class="number">0</span> &#123;  </span><br><span class="line">      b.minIdle = defaultMinIdle  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> b.maxIdle == <span class="number">0</span> &#123;  </span><br><span class="line">      b.maxIdle = defaultMaxIdle  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> b.maxTotal == <span class="number">0</span> &#123;  </span><br><span class="line">      b.maxTotal = defaultMaxTotal  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> b.maxTotal &lt; b.maxIdle &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;max total(%d) cannot &lt; max idle(%d)&quot;</span>, b.maxTotal, b.maxIdle)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> b.minIdle &gt; b.maxIdle &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;max idle(%d) cannot &lt; min idle(%d)&quot;</span>, b.maxIdle, b.minIdle)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">return</span> &amp;ResourcePoolConfig&#123;  </span><br><span class="line">      name:     b.name,  </span><br><span class="line">      maxTotal: b.maxTotal,  </span><br><span class="line">      maxIdle:  b.maxIdle,  </span><br><span class="line">      minIdle:  b.minIdle,  </span><br><span class="line">   &#125;, <span class="literal">nil</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> builder  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> (  </span><br><span class="line">   <span class="string">&quot;testing&quot;</span>  </span><br><span class="line">   <span class="string">&quot;github.com/stretchr/testify/assert&quot;</span>   </span><br><span class="line">   <span class="string">&quot;github.com/stretchr/testify/require&quot;</span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestResourcePoolConfigBuilder_Build</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">   tests := []<span class="keyword">struct</span> &#123;  </span><br><span class="line">      name    <span class="type">string</span>  </span><br><span class="line">      builder *ResourcePoolConfigBuilder  </span><br><span class="line">      want    *ResourcePoolConfig  </span><br><span class="line">      wantErr <span class="type">bool</span>  </span><br><span class="line">   &#125;&#123;  </span><br><span class="line">      &#123;  </span><br><span class="line">         name: <span class="string">&quot;name empty&quot;</span>,  </span><br><span class="line">         builder: &amp;ResourcePoolConfigBuilder&#123;  </span><br><span class="line">            name:     <span class="string">&quot;&quot;</span>,  </span><br><span class="line">            maxTotal: <span class="number">0</span>,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         want:    <span class="literal">nil</span>,  </span><br><span class="line">         wantErr: <span class="literal">true</span>,  </span><br><span class="line">      &#125;,  </span><br><span class="line">      &#123;  </span><br><span class="line">         name: <span class="string">&quot;maxIdle &lt; minIdle&quot;</span>,  </span><br><span class="line">         builder: &amp;ResourcePoolConfigBuilder&#123;  </span><br><span class="line">            name:     <span class="string">&quot;test&quot;</span>,  </span><br><span class="line">            maxTotal: <span class="number">0</span>,  </span><br><span class="line">            maxIdle:  <span class="number">10</span>,  </span><br><span class="line">            minIdle:  <span class="number">20</span>,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         want:    <span class="literal">nil</span>,  </span><br><span class="line">         wantErr: <span class="literal">true</span>,  </span><br><span class="line">      &#125;,  </span><br><span class="line">      &#123;  </span><br><span class="line">         name: <span class="string">&quot;success&quot;</span>,  </span><br><span class="line">         builder: &amp;ResourcePoolConfigBuilder&#123;  </span><br><span class="line">            name: <span class="string">&quot;test&quot;</span>,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         want: &amp;ResourcePoolConfig&#123;  </span><br><span class="line">            name:     <span class="string">&quot;test&quot;</span>,  </span><br><span class="line">            maxTotal: defaultMaxTotal,  </span><br><span class="line">            maxIdle:  defaultMaxIdle,  </span><br><span class="line">            minIdle:  defaultMinIdle,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         wantErr: <span class="literal">false</span>,  </span><br><span class="line">      &#125;,  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests &#123;  </span><br><span class="line">      t.Run(tt.name, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">         got, err := tt.builder.Build()  </span><br><span class="line">         require.Equalf(t, tt.wantErr, err != <span class="literal">nil</span>, <span class="string">&quot;Build() error = %v, wantErr %v&quot;</span>, err, tt.wantErr)  </span><br><span class="line">         assert.Equal(t, tt.want, got)  </span><br><span class="line">      &#125;)  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Go-å¸¸ç”¨çš„å‚æ•°ä¼ é€’æ–¹æ³•"><a href="#Go-å¸¸ç”¨çš„å‚æ•°ä¼ é€’æ–¹æ³•" class="headerlink" title="Go å¸¸ç”¨çš„å‚æ•°ä¼ é€’æ–¹æ³•"></a>Go å¸¸ç”¨çš„å‚æ•°ä¼ é€’æ–¹æ³•</h3><h4 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> builder  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ResourcePoolConfigOption option</span></span><br><span class="line"><span class="keyword">type</span> ResourcePoolConfigOption <span class="keyword">struct</span> &#123;  </span><br><span class="line">   maxTotal <span class="type">int</span>  </span><br><span class="line">   maxIdle  <span class="type">int</span>  </span><br><span class="line">   minIdle  <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ResourcePoolConfigOptFunc to set option</span></span><br><span class="line"><span class="keyword">type</span> ResourcePoolConfigOptFunc <span class="function"><span class="keyword">func</span><span class="params">(option *ResourcePoolConfigOption)</span></span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// NewResourcePoolConfig NewResourcePoolConfig  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewResourcePoolConfig</span><span class="params">(name <span class="type">string</span>, opts ...ResourcePoolConfigOptFunc)</span></span> (*ResourcePoolConfig, <span class="type">error</span>) &#123;  </span><br><span class="line">   <span class="keyword">if</span> name == <span class="string">&quot;&quot;</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;name can not be empty&quot;</span>)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   option := &amp;ResourcePoolConfigOption&#123;  </span><br><span class="line">      maxTotal: <span class="number">10</span>,  </span><br><span class="line">      maxIdle:  <span class="number">9</span>,  </span><br><span class="line">      minIdle:  <span class="number">1</span>,  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">for</span> _, opt := <span class="keyword">range</span> opts &#123;  </span><br><span class="line">      opt(option)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> option.maxTotal &lt; <span class="number">0</span> || option.maxIdle &lt; <span class="number">0</span> || option.minIdle &lt; <span class="number">0</span> &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;args err, option: %v&quot;</span>, option)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">if</span> option.maxTotal &lt; option.maxIdle || option.minIdle &gt; option.maxIdle &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;args err, option: %v&quot;</span>, option)  </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="keyword">return</span> &amp;ResourcePoolConfig&#123;  </span><br><span class="line">      name:     name,  </span><br><span class="line">      maxTotal: option.maxTotal,  </span><br><span class="line">      maxIdle:  option.maxIdle,  </span><br><span class="line">      minIdle:  option.minIdle,  </span><br><span class="line">   &#125;, <span class="literal">nil</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å•å…ƒæµ‹è¯•-1"><a href="#å•å…ƒæµ‹è¯•-1" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> builder  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> (  </span><br><span class="line">   <span class="string">&quot;testing&quot;</span>  </span><br><span class="line">   <span class="string">&quot;github.com/stretchr/testify/assert&quot;</span>   </span><br><span class="line">   <span class="string">&quot;github.com/stretchr/testify/require&quot;</span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestNewResourcePoolConfig</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">   <span class="keyword">type</span> args <span class="keyword">struct</span> &#123;  </span><br><span class="line">      name <span class="type">string</span>  </span><br><span class="line">      opts []ResourcePoolConfigOptFunc  </span><br><span class="line">   &#125;  </span><br><span class="line">   tests := []<span class="keyword">struct</span> &#123;  </span><br><span class="line">      name    <span class="type">string</span>  </span><br><span class="line">      args    args  </span><br><span class="line">      want    *ResourcePoolConfig  </span><br><span class="line">      wantErr <span class="type">bool</span>  </span><br><span class="line">   &#125;&#123;  </span><br><span class="line">      &#123;  </span><br><span class="line">         name: <span class="string">&quot;name empty&quot;</span>,  </span><br><span class="line">         args: args&#123;  </span><br><span class="line">            name: <span class="string">&quot;&quot;</span>,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         want:    <span class="literal">nil</span>,  </span><br><span class="line">         wantErr: <span class="literal">true</span>,  </span><br><span class="line">      &#125;,  </span><br><span class="line">      &#123;  </span><br><span class="line">         name: <span class="string">&quot;success&quot;</span>,  </span><br><span class="line">         args: args&#123;  </span><br><span class="line">            name: <span class="string">&quot;test&quot;</span>,  </span><br><span class="line">            opts: []ResourcePoolConfigOptFunc&#123;  </span><br><span class="line">               <span class="function"><span class="keyword">func</span><span class="params">(option *ResourcePoolConfigOption)</span></span> &#123;  </span><br><span class="line">                  option.minIdle = <span class="number">2</span>  </span><br><span class="line">               &#125;,  </span><br><span class="line">            &#125;,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         want: &amp;ResourcePoolConfig&#123;  </span><br><span class="line">            name:     <span class="string">&quot;test&quot;</span>,  </span><br><span class="line">            maxTotal: <span class="number">10</span>,  </span><br><span class="line">            maxIdle:  <span class="number">9</span>,  </span><br><span class="line">            minIdle:  <span class="number">2</span>,  </span><br><span class="line">         &#125;,  </span><br><span class="line">         wantErr: <span class="literal">false</span>,  </span><br><span class="line">      &#125;,  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests &#123;  </span><br><span class="line">      t.Run(tt.name, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;  </span><br><span class="line">         got, err := NewResourcePoolConfig(tt.args.name, tt.args.opts...)  </span><br><span class="line">         require.Equalf(t, tt.wantErr, err != <span class="literal">nil</span>, <span class="string">&quot;error = %v, wantErr %v&quot;</span>, err, tt.wantErr)  </span><br><span class="line">         assert.Equal(t, tt.want, got)  </span><br><span class="line">      &#125;)  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¼€å‘ä¸€äº›å…¬å…±åº“çš„æ—¶å€™ï¼Œå¯¹äºå…¥å£å‚æ•°çš„ä¼ é€’æ¨èåé¢ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé¿å…å‚æ•°å˜åŒ–ç ´åå¼æ›´æ–°çš„æƒ…å†µ</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•å®˜101</title>
      <link href="/interview/interviewer/interviewer101/"/>
      <url>/interview/interviewer/interviewer101/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢è¯•"><a href="#é¢è¯•" class="headerlink" title="é¢è¯•"></a><strong>é¢è¯•</strong></h3><h4 id="ç®—æ³•èƒ½åŠ›-ä¸€é¢˜5-10min"><a href="#ç®—æ³•èƒ½åŠ›-ä¸€é¢˜5-10min" class="headerlink" title="ç®—æ³•èƒ½åŠ› ä¸€é¢˜5-10min :"></a>ç®—æ³•èƒ½åŠ› ä¸€é¢˜5-10min :</h4><ol><li>é¢˜ç›®ï¼šä»…å‡ºç°ä¸€æ¬¡çš„æ•°</li><li>é¢˜ç›®ï¼šè¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼<br>ç»™ä½ ä¸€ä¸ªæ•°ç»„Â numsÂ å’Œä¸€ä¸ªå¤§å°ä¸ºÂ kçš„åŒºé—´ã€‚è¿™ä¸ªåŒºé—´å¯ä»¥ä»æ•°ç»„çš„æœ€å·¦ä¾§ä¸æ–­ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚æ¯ä¸ªç§»åŠ¨åŒºé—´å›ºå®šæœ‰Â kÂ ä¸ªæ•°å­—ã€‚è¿™ä¸ªåŒºé—´æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚<br>è®©ä½ è¿”å›ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œè¿™äº›å›ºå®šåŒºé—´ä¸­çš„æœ€å¤§å€¼ã€‚</li></ol><p>æ ·ä¾‹è¾“å…¥ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nums = [1,3,-1,-3,5,3,6,7], k = 3</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[3,3,5,5,6,7]</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è§£é‡Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç§»åŠ¨æƒ…å†µ æœ€å¤§å€¼</span><br><span class="line"></span><br><span class="line">[1 3 -1] -3 5 3 6 7 3</span><br><span class="line"></span><br><span class="line">1 [3 -1 -3] 5 3 6 7 3</span><br><span class="line"></span><br><span class="line">1 3 [-1 -3 5] 3 6 7 5</span><br><span class="line"></span><br><span class="line">1 3 -1 [-3 5 3] 6 7 5</span><br><span class="line"></span><br><span class="line">1 3 -1 -3 [5 3 6] 7 6</span><br><span class="line"></span><br><span class="line">1 3 -1 -3 5 [3 6 7] 7</span><br></pre></td></tr></table></figure><ol start="3"><li>æ‹“å±•</li></ol><p>æ ·ä¾‹è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nums = [1,3,-1,-3,5,3,6,7], t = 5</span><br><span class="line">k = 2</span><br><span class="line">k = 3</span><br><span class="line">k = 4</span><br><span class="line">k = 5</span><br><span class="line">k = 6</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è¾“å‡º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 3 -1 5 5 6 7</span><br><span class="line">3 3 5 5 6 7</span><br><span class="line">3 5 5 6 7</span><br><span class="line">5 5 6 7</span><br><span class="line">5 6 7</span><br></pre></td></tr></table></figure><h4 id="åŸºç¡€èƒ½åŠ›"><a href="#åŸºç¡€èƒ½åŠ›" class="headerlink" title="åŸºç¡€èƒ½åŠ›"></a>åŸºç¡€èƒ½åŠ›</h4><h6 id="Goå…«è‚¡"><a href="#Goå…«è‚¡" class="headerlink" title="Goå…«è‚¡"></a>Goå…«è‚¡</h6><p><a href="https://www.topgoer.cn/docs/gomianshiti/gomianshiti-1dd225t6esqld">https://www.topgoer.cn/docs/gomianshiti/gomianshiti-1dd225t6esqld</a></p><h6 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h6><ol><li><p>Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ</p><ul><li>å®Œå…¨åŸºäºå†…å­˜ï¼Œç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼Œéå¸¸å¿«é€Ÿã€‚æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äºHashMapï¼ŒHashMapçš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼›</li><li>æ•°æ®ç»“æ„ç®€å•ï¼Œå¯¹æ•°æ®æ“ä½œä¹Ÿç®€å•ï¼ŒRedisä¸­çš„æ•°æ®ç»“æ„æ˜¯ä¸“é—¨è¿›è¡Œè®¾è®¡çš„ï¼›</li><li>é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ï¼Œä¹Ÿä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPUï¼Œä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—ï¼›</li><li>ä½¿ç”¨å¤šè·¯I&#x2F;Oå¤ç”¨æ¨¡å‹ï¼Œéé˜»å¡IOï¼›è¿™é‡Œâ€œå¤šè·¯â€æŒ‡çš„æ˜¯å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œâ€œå¤ç”¨â€æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹</li><li>ä½¿ç”¨åº•å±‚æ¨¡å‹ä¸åŒï¼Œå®ƒä»¬ä¹‹é—´åº•å±‚å®ç°æ–¹å¼ä»¥åŠä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡çš„åº”ç”¨åè®®ä¸ä¸€æ ·ï¼ŒRedisç›´æ¥è‡ªå·±æ„å»ºäº†VM æœºåˆ¶ ï¼Œå› ä¸ºä¸€èˆ¬çš„ç³»ç»Ÿè°ƒç”¨ç³»ç»Ÿå‡½æ•°çš„è¯ï¼Œä¼šæµªè´¹ä¸€å®šçš„æ—¶é—´å»ç§»åŠ¨å’Œè¯·æ±‚</li></ul></li><li><p>ç¼“å­˜ç©¿é€å’Œé›ªå´©çš„è§£å†³æ–¹æ¡ˆ</p></li><li><p>è¯·ç®€è¿°Reidsçš„åˆ é™¤ç­–ç•¥</p><ul><li>å®šæ—¶åˆ é™¤ï¼šåœ¨è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´çš„åŒæ—¶ï¼Œåˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå½“é”®è¾¾åˆ°è¿‡æœŸæ—¶é—´æ—¶ï¼Œç«‹å³æ‰§è¡Œå¯¹é”®çš„åˆ é™¤æ“ä½œ</li><li>æƒ°æ€§åˆ é™¤ï¼šæ”¾ä»»é”®è¿‡æœŸä¸ç®¡ï¼Œä½†åœ¨æ¯æ¬¡ä»é”®ç©ºé—´è·å–é”®æ—¶ï¼Œéƒ½æ£€æŸ¥å–å¾—çš„é”®æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸçš„è¯ï¼Œå°±åˆ é™¤è¯¥é”®ï¼Œå¦‚æœæ²¡æœ‰è¿‡æœŸï¼Œå°±è¿”å›è¯¥é”®</li><li>å®šæœŸåˆ é™¤ï¼šæ¯éš”ä¸€ç‚¹æ—¶é—´ï¼Œç¨‹åºå°±å¯¹æ•°æ®åº“è¿›è¡Œä¸€æ¬¡æ£€æŸ¥ï¼Œåˆ é™¤é‡Œé¢çš„è¿‡æœŸé”®ï¼Œè‡³äºè¦åˆ é™¤å¤šå°‘è¿‡æœŸé”®ï¼Œä»¥åŠè¦æ£€æŸ¥å¤šå°‘ä¸ªæ•°æ®åº“ï¼Œåˆ™ç”±ç®—æ³•å†³å®šã€‚</li></ul><ol start="3"><li>ç´¢å¼•çš„æ„å»ºæµç¨‹ï¼Ÿ</li><li>bæ ‘ï¼Œb+æ ‘åŒºåˆ«ï¼ŒMongoDBä¸ºä»€ä¹ˆé€‰ç”¨bæ ‘</li></ol></li></ol><h6 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h6><ol><li>CPUä¸‰çº§ç¼“å­˜</li><li>è¿›ç¨‹ä¸çº¿ç¨‹<ul><li>è¿›ç¨‹: è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ã€‚ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡é‡ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ã€‚</li><li>çº¿ç¨‹: çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,çº¿ç¨‹æ˜¯å†…æ ¸æ€,è€Œä¸”æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚</li><li>åç¨‹: åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåç¨‹çš„è°ƒåº¦å®Œå…¨æ˜¯ç”±ç”¨æˆ·æ¥æ§åˆ¶çš„ã€‚åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆã€‚åç¨‹è°ƒåº¦åˆ‡æ¢æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡å›æ¥çš„æ—¶å€™ï¼Œæ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œç›´æ¥æ“ä½œæ ˆåˆ™åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œå¯ä»¥ä¸åŠ é”çš„è®¿é—®å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çš„åˆ‡æ¢éå¸¸å¿«ã€‚</li></ul></li></ol><h6 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h6><ol><li><p>åˆ›å»ºç´¢å¼•çš„è§„åˆ™ï¼šæœ€å·¦åŒ¹é…ï¼ŒåŒºåˆ†åº¦ç­‰</p></li><li><p>ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µ</p><ul><li>æœªéµå¾ªæœ€ä½³å·¦å‰ç¼€è§„åˆ™å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li><li>è®¡ç®—ã€å‡½æ•°ã€ç±»å‹è½¬æ¢(è‡ªåŠ¨æˆ–æ‰‹åŠ¨)å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li><li>èŒƒå›´æ¡ä»¶å³è¾¹åˆ—ç´¢å¼•å¤±æ•ˆ</li><li>ä¸ç­‰äº(!&#x3D;)ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li><li>is nullå¯ä»¥ç”¨åˆ°ç´¢å¼•ï¼Œis not nullä¸èƒ½ç”¨åˆ°ç´¢å¼•</li><li>likeä»¥é€šé…ç¬¦%å¼€å¤´ç´¢å¼•å¤±æ•ˆ</li><li>or å‰çš„åˆ—å»ºç«‹äº†ç´¢å¼• oråé¢çš„åˆ—æ²¡æœ‰å»ºç«‹ç´¢å¼• ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li><li>ä¸åŒå­—ç¬¦é›†è¿›è¡Œæ¯”è¾ƒå‰éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li></ul></li><li><p>æ•°æ®çš„å­˜å‚¨æ–¹å¼ï¼š B+æ ‘</p><ul><li>éå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œåªå­˜ç´¢å¼•ï¼ˆå†—ä½™ï¼‰ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å­˜æ”¾æ›´å¤šçš„ç´¢å¼•</li><li>å¶å­èŠ‚ç‚¹å­˜å‚¨æ‰€æœ‰ç´¢å¼•å­—æ®µ</li><li>å¶å­èŠ‚ç‚¹ç”¨æŒ‡é’ˆè¿æ¥ï¼Œæé«˜åŒºé—´è®¿é—®æ€§èƒ½<br> ![[Pasted image 20221201183525.png]]</li></ul></li><li><p>å¤§æ•°æ®é‡çº§çš„mysqlï¼Œå¦‚ä½•åˆ†åº“åˆ†è¡¨ï¼Ÿè§£å†³æ–¹æ¡ˆï¼Ÿ</p></li><li><p>ç½‘ç»œè¿™äº›å¯ä»¥æŒ‘ä¸€ä¸¤ä¸ªä¸»é¢˜èŠã€‚</p></li><li><p>è‡ªæˆ‘ä»‹ç»ï¼Œå‘ŠçŸ¥è§„åˆ™ä¸æµç¨‹ï¼šä¸¤ä¸ªéƒ¨åˆ†ï¼šç®—æ³•é¢˜ &amp; èŠä¸€èŠåŸºç¡€é—®é¢˜</p></li><li><p>å…ˆä»‹ç»ä¸‹è‡ªå·±ï¼›ä¸»è¦æŠ€èƒ½ï¼Œå¸¸ç”¨è¯­è¨€ï¼Œå·¥ä½œç»å†ç®€å•å™è¿°</p></li><li><p>é¡¹ç›®ï¼šæ”¯ä»˜ç›¸å…³ï¼Œå¹‚ç­‰ï¼Ÿ</p></li><li><p>å‘è¿‡å»åœ¨çº¿æ–‡æ¡£</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> é¢è¯•å®˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•å®˜ </tag>
            
            <tag> åˆå­¦è€… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜-è¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼</title>
      <link href="/interview/interviewer/maximum-of-segments/"/>
      <url>/interview/interviewer/maximum-of-segments/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼"><a href="#è¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼" class="headerlink" title="è¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼"></a>è¿ç»­å›ºå®šåŒºé—´æœ€å¤§å€¼</h1><ul><li>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šå †ï¼Œæ ˆã€åŒæŒ‡é’ˆã€æ»‘åŠ¨çª—å£ï¼ŒåŒå‘é˜Ÿåˆ—ã€çº¿æ®µæ ‘ï¼Œæ ‘çŠ¶æ•°ç»„, dp ç­‰ã€‚</li></ul><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªå¤§å°ä¸º <code>k</code>çš„åŒºé—´ã€‚è¿™ä¸ªåŒºé—´å¯ä»¥ä»æ•°ç»„çš„æœ€å·¦ä¾§ä¸æ–­ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚æ¯ä¸ªç§»åŠ¨åŒºé—´å›ºå®šæœ‰ <code>k</code> ä¸ªæ•°å­—ã€‚è¿™ä¸ªåŒºé—´æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚</p><p>è®©ä½ è¿”å›ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œè¿™äº›å›ºå®šåŒºé—´ä¸­çš„æœ€å¤§å€¼ã€‚</p><p>æ ·ä¾‹è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nums = [1,3,-1,-3,5,3,6,7], k = 3</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[3,3,5,5,6,7]</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è§£é‡Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">          ç§»åŠ¨æƒ…å†µ              æœ€å¤§å€¼</span><br><span class="line">[1  3  -1] -3  5  3  6  7       3</span><br><span class="line"> 1 [3  -1  -3] 5  3  6  7       3</span><br><span class="line"> 1  3 [-1  -3  5] 3  6  7       5</span><br><span class="line"> 1  3  -1 [-3  5  3] 6  7       5</span><br><span class="line"> 1  3  -1  -3 [5  3  6] 7       6</span><br><span class="line"> 1  3  -1  -3  5 [3  6  7]      7</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœå€™é€‰äººè¯¢é—®åˆ°æ•°æ®èŒƒå›´ï¼Œå¯æç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;= nums.size() &lt;= 10^5</span><br><span class="line">-10^4 &lt;= nums[i] &lt;= 10^4</span><br><span class="line">1 &lt;= k &lt;= nums.size()</span><br></pre></td></tr></table></figure><h2 id="æ€è·¯æè¿°"><a href="#æ€è·¯æè¿°" class="headerlink" title="æ€è·¯æè¿°"></a>æ€è·¯æè¿°</h2><h3 id="æ€è·¯-1ï¼šæš´åŠ›æ»‘åŠ¨-O-n-2"><a href="#æ€è·¯-1ï¼šæš´åŠ›æ»‘åŠ¨-O-n-2" class="headerlink" title="æ€è·¯ 1ï¼šæš´åŠ›æ»‘åŠ¨ O(n^2)"></a>æ€è·¯ 1ï¼šæš´åŠ›æ»‘åŠ¨ O(n^2)</h3><p>æš´åŠ›è¿›è¡Œæ»‘åŠ¨çª—å£ï¼Œ æ¯æ¬¡éå†å½“å‰çª—å£å†…çš„å…ƒç´ å–æœ€å¤§å€¼ã€‚</p><p>å‚è€ƒä»£ç :</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">find_maximum_of_sgements</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp;nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i + k &lt;= nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">      res.<span class="built_in">push_back</span>(*<span class="built_in">max_element</span>(nums.<span class="built_in">begin</span>() + i, nums.<span class="built_in">begin</span>() + i + k));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ <code>O(n * k)ï½O(n^2)</code></li><li>ç©ºé—´å¤æ‚åº¦ <code>O(n - k + 1)</code></li></ul><p><strong>è¿™ä¸ªæ˜¯æš´åŠ›è§£ï¼Œéæ­£ç¡®è§£ï¼Œåªèƒ½ç»™ 2 åˆ†ï¼Œå¯æç¤ºæ¬¡ä¼˜è§£å’Œæœ€ä¼˜è§£</strong></p><blockquote><p>ä¼˜åŒ–æç¤º 1ï¼šå¯ä»¥ä¼˜åŒ–åˆ°ä½äº O(n^2) çš„å—ï¼Ÿæ¯”å¦‚ O(nlogn)ï¼ŒO(nlogk), ç”šè‡³æ˜¯çº¿æ€§ O(n) çš„åšæ³•ã€‚</p></blockquote><blockquote><p>ä¼˜åŒ–æç¤º 2ï¼šå¯ä»¥æƒ³åˆ°ç”¨ä¸€äº›å¯ä»¥ç»´æŠ¤æå€¼çš„æ•°æ®ç»“æ„åšå—ï¼Ÿ</p></blockquote><blockquote><p>ä¼˜åŒ–æç¤º 3ï¼šé‚£å¦‚æœæ‹†åˆ†æˆå­é—®é¢˜ï¼Œå¿«é€Ÿæ±‚è¿ç»­åŒºé—´çš„æœ€å¤§å€¼ï¼Œä½ æ€ä¹ˆåšæ‰ä¼šæœ‰å¸¦ log çš„æ—¶é—´å¤æ‚åº¦ï¼Ÿ</p></blockquote><p><strong>æç¤ºåï¼Œå€™é€‰äººè¿˜æ˜¯ä¸ä¼šã€‚å¯æ¢é¢˜ã€‚</strong></p><h3 id="æ€è·¯-2ï¼šå †-O-nlogk"><a href="#æ€è·¯-2ï¼šå †-O-nlogk" class="headerlink" title="æ€è·¯ 2ï¼šå † O(nlogk)"></a>æ€è·¯ 2ï¼šå † O(nlogk)</h3><p>ç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸º <code>k</code> çš„å †ï¼Œå‘å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ (å•ä¸ªæ“ä½œæ—¶é—´å¤æ‚åº¦ <code>O(logk)</code>), å°†æ•°æ®ä¸æ–­ <code>push</code> è¿›å †ï¼Œæ¯æ¬¡å–ç»“æœéƒ½å°† <code>top</code> çš„æ•°å–å‡ºæ¥å°±æ˜¯åºåˆ—ç­”æ¡ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">find_maximum_of_segments</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">  priority_queue&lt; pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; pq;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; k;i++) &#123;</span><br><span class="line">      pq.<span class="built_in">push</span>(&#123;nums[i],i&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="built_in">push_back</span>(pq.<span class="built_in">top</span>().first);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = k;i &lt; nums.<span class="built_in">size</span>(); i++) &#123; </span><br><span class="line">      <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>() &amp;&amp; pq.<span class="built_in">top</span>().second &lt;= (i - k)) &#123;</span><br><span class="line">          pq.<span class="built_in">pop</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      pq.<span class="built_in">push</span>(&#123;nums[i],i&#125;);</span><br><span class="line">      res.<span class="built_in">push_back</span>(pq.<span class="built_in">top</span>().first);   </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(nlogk)</code>, å€™é€‰äººæœ‰å¯èƒ½å†™æˆ<code>O(nlogn)</code>, ä½†é—®é¢˜ä¸å¤§ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(k)</code>ã€‚</li></ul><p><strong>è¿™ä¸ªæ˜¯æ­£ç¡®è§£ï¼Œä½†éæœ€ä¼˜è§£ï¼Œå¯ç»™ 3 åˆ†ï¼Œé€šè¿‡ã€‚</strong></p><h3 id="æ€è·¯-3ï¼šåŒå‘é˜Ÿåˆ—-O-n"><a href="#æ€è·¯-3ï¼šåŒå‘é˜Ÿåˆ—-O-n" class="headerlink" title="æ€è·¯ 3ï¼šåŒå‘é˜Ÿåˆ— O(n)"></a>æ€è·¯ 3ï¼šåŒå‘é˜Ÿåˆ— O(n)</h3><p>å¯ä»¥ç»´æŠ¤ä¸€ä¸ªåŒå‘é˜Ÿåˆ—ï¼Œè¿™ä¸ªé˜Ÿåˆ—æ˜¯é€’å‡çš„ã€‚é˜Ÿåˆ—ç”¨æ¥ä¿å­˜å¯èƒ½æ˜¯æœ€å¤§å€¼çš„æ•°å­—çš„ <code>index</code>ã€‚<br>å½“å‰çª—å£æœ€å¤§å€¼çš„ <code>index</code> åœ¨é˜Ÿé¦–ï¼Œå½“çª—å£æ»‘åŠ¨æ—¶ï¼Œä¼šè¿›å…¥ä¸€ä¸ªæ–°å€¼ï¼Œå‡ºå»ä¸€ä¸ªæ—§å€¼ï¼Œä¸æ–­æ›´æ–°ç»™å‡ºå½“å‰çª—å£çš„æœ€å¤§å€¼å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">find_maximum_of_segments</span>(vector&lt;<span class="type">int</span>&gt;&amp;nums, <span class="type">int</span> k) &#123;</span><br><span class="line">  deque&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">      <span class="comment">// æ–°å…ƒç´ å…¥é˜Ÿæ—¶, æ¯”é˜Ÿå°¾å…ƒç´ å¤§çš„è¯åˆ™æ›¿ä»£é˜Ÿå°¾å…ƒç´ </span></span><br><span class="line">      <span class="keyword">while</span>(!que.<span class="built_in">empty</span>() &amp;&amp; nums[i] &gt; nums[que.<span class="built_in">back</span>()])&#123;</span><br><span class="line">          que.<span class="built_in">pop_back</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// æ£€æŸ¥é˜Ÿé¦–çš„ index æ˜¯å¦åœ¨çª—å£å†…ï¼Œä¸åœ¨åˆ™å‡ºé˜Ÿ</span></span><br><span class="line">      <span class="keyword">if</span>(!que.<span class="built_in">empty</span>() &amp;&amp; que.<span class="built_in">front</span>() &lt; i - k + <span class="number">1</span>) &#123;</span><br><span class="line">          que.<span class="built_in">pop_front</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      que.<span class="built_in">push_back</span>(i);</span><br><span class="line">      <span class="keyword">if</span> (i &gt;= k <span class="number">-1</span>) &#123;</span><br><span class="line">        res.<span class="built_in">push_back</span>(nums[que.<span class="built_in">front</span>()]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(n)</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(k)</code>ã€‚</li></ul><p><strong>è¿™ä¸ªæ˜¯æ­£ç¡®è§£ï¼Œæœ€ä¼˜è§£ï¼Œå¯ç»™ 4 åˆ†ï¼Œé€šè¿‡ã€‚</strong></p><h3 id="æ€è·¯-4ï¼šdynamic-programming"><a href="#æ€è·¯-4ï¼šdynamic-programming" class="headerlink" title="æ€è·¯ 4ï¼šdynamic programming"></a>æ€è·¯ 4ï¼šdynamic programming</h3><p>å…ˆå°†æ•°ç»„åˆ†å‰²æˆæœ‰ <code>k</code> ä¸ªå…ƒç´ çš„å—ã€‚<br>å»ºç«‹æ•°ç»„ <code>left</code>,å…¶ä¸­ <code>left[j]</code> æ˜¯ä»å—çš„å¼€å§‹åˆ°ä¸‹æ ‡ <code>j</code> æœ€å¤§çš„å…ƒç´ ï¼Œæ–¹å‘ï¼š <code>å·¦-&gt;å³</code>ã€‚<br>æ•°ç»„ <code>right</code>ï¼Œå…¶ä¸­ <code>right[j]</code> æ˜¯ä»å—çš„ç»“å°¾åˆ°ä¸‹æ ‡ <code>j</code> æœ€å¤§çš„å…ƒç´ ï¼Œæ–¹å‘ï¼š <code>å³-&gt;å·¦</code>ã€‚</p><p>ä»å·¦åˆ°å³éå†æ•°ç»„ï¼Œå»ºç«‹æ•°ç»„ <code>left</code>ã€‚</p><p>ä»å³åˆ°å·¦éå†æ•°ç»„ï¼Œå»ºç«‹æ•°ç»„ <code>right</code>ã€‚</p><p>å› ä¸ºä¸€ä¸ªçª—å£ <code>[i, i + k - 1]</code> æœ€å¤šè·¨è¶Šä¸¤ä¸ªå—ï¼Œæ‰€ä»¥æ±‚çª—å£ä¸­çš„æœ€å¤§å€¼å°±æ˜¯æ±‚è¿™ä¸ªçª—å£è·¨è¶Šçš„å—ä¸­çš„æœ€å¤§å€¼ï¼Œ<br>å¯ä»¥çŸ¥é“ï¼Œæ— è®ºæ˜¯è·¨è¶Š 1 ä¸ªå—ä¹Ÿå¥½ï¼Œ2 ä¸ªå—ä¹Ÿå¥½ï¼Œè®¡ç®—å¤„äºè¾¹ç•Œçš„ <code>i</code> å’Œ <code>i + k - 1</code> å¯¹åº”çš„å€¼å³å¯ã€‚</p><p><code>right[i]</code> è¡¨ç¤ºä»å—çš„ç»“å°¾åˆ°ä¸‹æ ‡ <code>j</code> çš„æœ€å¤§çš„å…ƒç´ ã€‚</p><p><code>left[i + k - 1]</code> è¡¨ç¤ºä»å—çš„å¼€å§‹åˆ°ä¸‹æ ‡ <code>i + k - 1</code> çš„æœ€å¤§çš„å…ƒç´ ã€‚</p><p>è¿™ä¸¤ä¸ªèŒƒå›´åˆšå¥½æ˜¯æ•´ä¸ªçª—å£ã€‚</p><p>æ‰€ä»¥çª—å£çš„æœ€å¤§å€¼æ˜¯ <code>max(right[i], left[i + k - 1])</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt;<span class="built_in">find_maximum_of_segments</span>(vector&lt;<span class="type">int</span>&gt;&amp;nums, <span class="type">int</span> k) &#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">left</span><span class="params">(n, <span class="number">0</span>)</span>, <span class="title">right</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="type">int</span> max_num;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(i % k == <span class="number">0</span>)&#123;</span><br><span class="line">          max_num = nums[i];</span><br><span class="line">      &#125;</span><br><span class="line">      max_num = <span class="built_in">max</span>(max_num, nums[i]);</span><br><span class="line">      left[i] = max_num;</span><br><span class="line">  &#125;</span><br><span class="line">  max_num = nums[n - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">      <span class="keyword">if</span>(i % k == k - <span class="number">1</span>)&#123;</span><br><span class="line">          max_num = nums[i];</span><br><span class="line">      &#125;</span><br><span class="line">      max_num = <span class="built_in">max</span>(max_num, nums[i]);</span><br><span class="line">      right[i] = max_num;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - k; i ++)&#123;</span><br><span class="line">      res.<span class="built_in">push_back</span>(<span class="built_in">max</span>(right[i], left[i + k - <span class="number">1</span>]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿™ä¸ªæ˜¯æ­£ç¡®è§£ï¼Œæœ€ä¼˜è§£ï¼Œä½†æ¯”è¾ƒéš¾æƒ³åˆ°ã€‚å¯ç»™ 5 åˆ†ï¼Œé€šè¿‡ã€‚</strong></p><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(n)</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(n)</code>ã€‚</li></ul><h2 id="å…¶ä»–æ€è·¯å‚è€ƒ"><a href="#å…¶ä»–æ€è·¯å‚è€ƒ" class="headerlink" title="å…¶ä»–æ€è·¯å‚è€ƒ"></a>å…¶ä»–æ€è·¯å‚è€ƒ</h2><p>ä»¥ä¸‹è§£æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œè€Œä¸”ç¼–ç æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœçœŸçš„æœ‰å€™é€‰äººåœ¨é¢è¯•ä¸­å†™äº†ï¼Œå¯ä»¥è€ƒè™‘ç»™ 5 åˆ†ã€‚</p><h3 id="æ€è·¯-4-çº¿æ®µæ ‘-segment-tree"><a href="#æ€è·¯-4-çº¿æ®µæ ‘-segment-tree" class="headerlink" title="æ€è·¯ 4: çº¿æ®µæ ‘ (segment tree)"></a>æ€è·¯ 4: çº¿æ®µæ ‘ (segment tree)</h3><p>æ¯”è¾ƒè£¸çš„çº¿æ®µæ ‘ç»´æŠ¤æå€¼çš„åšæ³•ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;tree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushUp</span><span class="params">(<span class="type">int</span> rt)</span> </span>&#123;</span><br><span class="line">  tree[rt] = <span class="built_in">max</span>(tree[<span class="number">1</span> &lt;&lt; rt], tree[<span class="number">1</span> &lt;&lt; rt | <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> l,<span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp;nums)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">    tree[rt] = nums[l];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span> &lt;&lt; rt, l, mid, nums);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span> &lt;&lt; rt | <span class="number">1</span>, mid + <span class="number">1</span>, r, nums);</span><br><span class="line">  <span class="built_in">pushUp</span>(rt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l &gt; r) &#123;</span><br><span class="line">    <span class="keyword">return</span> INT_MIN;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(l &gt; qr || r &lt; ql) &#123;</span><br><span class="line">    <span class="keyword">return</span> INT_MIN;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// [ql [l, r] qr]</span></span><br><span class="line">  <span class="keyword">if</span>(l &gt;= ql &amp;&amp; r &lt;= qr) &#123;</span><br><span class="line">      <span class="keyword">return</span> tree[rt];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> left_val = <span class="built_in">query</span>(<span class="number">1</span> &lt;&lt; rt, l, mid, ql, qr);</span><br><span class="line">  <span class="type">int</span> right_val = <span class="built_in">query</span>(<span class="number">1</span> &lt;&lt; rt | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>(left_val, right_val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">find_maximum_of_segments</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="keyword">if</span>(n == <span class="number">0</span> || n &lt; k) &#123;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">  tree.<span class="built_in">resize</span>(<span class="number">1</span> &lt;&lt; n);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>, nums.<span class="built_in">size</span>() - <span class="number">1</span>, nums);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i + k - <span class="number">1</span> &lt; n; i++) &#123;</span><br><span class="line">      <span class="type">int</span> val = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, i + k - <span class="number">1</span>);</span><br><span class="line">      res.<span class="built_in">push_back</span>(val);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<ul><li>å»ºæ ‘ï¼š<code>O(n)</code>ã€‚</li><li>æŸ¥è¯¢ï¼š<code>O(logn)</code></li></ul></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(3 * n)</code>ã€‚</li></ul><h3 id="æ€è·¯-5ï¼šæ ‘çŠ¶æ•°ç»„-fenwick-tree"><a href="#æ€è·¯-5ï¼šæ ‘çŠ¶æ•°ç»„-fenwick-tree" class="headerlink" title="æ€è·¯ 5ï¼šæ ‘çŠ¶æ•°ç»„ (fenwick tree)"></a>æ€è·¯ 5ï¼šæ ‘çŠ¶æ•°ç»„ (fenwick tree)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;val;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;tmp;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX_VAL = <span class="number">1e5</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(x &lt;= n) &#123;</span><br><span class="line">    val[x] = v;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;x = &quot; &lt;&lt; x &lt;&lt; endl;</span></span><br><span class="line">    <span class="type">int</span> lx = <span class="built_in">lowbit</span>(x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; lx; i &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      val[x] = <span class="built_in">max</span>(val[x], val[x - i]);</span><br><span class="line">    &#125;</span><br><span class="line">    x += <span class="built_in">lowbit</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(r &gt;= l) &#123;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;r = &quot; &lt;&lt; r &lt;&lt; endl;</span></span><br><span class="line">    ans = <span class="built_in">max</span>(tmp[r - <span class="number">1</span>], ans);</span><br><span class="line">    r--;</span><br><span class="line">    <span class="keyword">while</span>(r &gt;= l + <span class="built_in">lowbit</span>(r))&#123;</span><br><span class="line">        ans = <span class="built_in">max</span>(val[r], ans);</span><br><span class="line">        r -= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">find_maximum_of_segments</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">  n = nums.<span class="built_in">size</span>();</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">  <span class="keyword">if</span>(n == <span class="number">0</span> || n &lt; k) &#123;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">  val.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> num = nums[i] + MAX_VAL;</span><br><span class="line">    tmp.<span class="built_in">push_back</span>(num);</span><br><span class="line">    <span class="built_in">update</span>(i + <span class="number">1</span>, num);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i + k - <span class="number">1</span> &lt; n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> max_val = <span class="built_in">query</span>(i + <span class="number">1</span>, i + k);</span><br><span class="line">    res.<span class="built_in">push_back</span>(max_val - MAX_VAL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<ul><li>å»ºæ ‘ï¼š<code>O(n)</code>ã€‚</li><li>æŸ¥è¯¢ï¼š<code>O(logn)</code></li></ul></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(3 * n)</code>ã€‚</li></ul><h2 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h2><p>å¦‚æœé‡åˆ°æ°´å¹³æ¯”è¾ƒé«˜çš„å€™é€‰äººï¼Œæ¯”å¦‚å…·æœ‰ OI æˆ–è€… ACM ç»å†ä¸”å®åŠ›æ¯”è¾ƒå¼ºçš„å€™é€‰äººã€‚</p><p>å€™é€‰äººåªéœ€è¦å£è¿°è§£æ³•å³å¯ã€‚</p><p>å¯å°†ä¸Šé¢é¢˜ç›®æ”¹ç¼–æˆï¼š</p><p>é¢˜æ„ä¸å˜ï¼ŒåŒæ ·æ˜¯ç»™ä½ ä¸€ä¸ªæ•°ç»„ <code>nums = [1,3,-1,-3,5,3,6,7]</code> å’Œ ä¸€ä¸ª <code>t</code>, <code>t</code> ä»£è¡¨æŸ¥è¯¢æ¬¡æ•°ã€‚<br>å³å­˜åœ¨å¤šç»„æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢ç»™ä½ ä¸ä¸€æ ·çš„ <code>k</code>, è®©ä½ è¾“å‡ºæ¯ä¸ªæŸ¥è¯¢åŒºé—´ä¸º <code>k</code> çš„åŒºé—´çš„ç­”æ¡ˆåºåˆ—ã€‚</p><p>æ•°æ®èŒƒå›´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;= nums.size() &lt;= 10^5</span><br><span class="line">-10^4 &lt;= nums[i] &lt;= 10^4</span><br><span class="line">1 &lt;= k &lt;= nums.size()</span><br><span class="line">1 &lt;= t &lt;= 10^3</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nums = [1,3,-1,-3,5,3,6,7], t = 5</span><br><span class="line">k = 2</span><br><span class="line">k = 3</span><br><span class="line">k = 4</span><br><span class="line">k = 5</span><br><span class="line">k = 6</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 3 -1 5 5 6 7</span><br><span class="line">3 3 5 5 6 7 </span><br><span class="line">3 5 5 6 7 </span><br><span class="line">5 5 6 7 </span><br><span class="line">5 6 7</span><br></pre></td></tr></table></figure><h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯ 1"></a>æ€è·¯ 1</h3><p>è¿™ç§å±äºæ¯”è¾ƒç»å…¸çš„ RMQ (Range Minimum&#x2F;Maximum Query) é—®é¢˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸€ç§æ•°æ®ç»“æ„ <code>Sparse Tables</code> æ¥è§£å†³ã€‚</p><p>è¯¥æ•°æ®ç»“æ„å¯åœ¨ <code>O(nlogn)</code> å†…å®Œæˆæ•°æ®é¢„å¤„ç†ï¼Œ åœ¨ <code>O(1)</code> å†…å®ŒæˆæŸ¥è¯¢ã€‚</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<ul><li>é¢„å¤„ç†ï¼š<code>O(nlogn)</code>ã€‚</li><li>æŸ¥è¯¢ï¼š<code>O(1)</code></li></ul></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(nlogn)</code>ã€‚</li></ul><p>ä»£ç å‚è€ƒï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> M;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prepare</span><span class="params">(vector&lt; vector&lt;<span class="type">int</span>&gt; &gt;&amp;dp, vector&lt;<span class="type">int</span>&gt;&amp;nums)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">      dp[i][<span class="number">0</span>] = nums[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; M; j++) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">          dp[i][j] = <span class="built_in">max</span>(dp[i][j<span class="number">-1</span>], dp[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(vector&lt; vector&lt;<span class="type">int</span>&gt; &gt;&amp;dp, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> k = (<span class="type">int</span>) (<span class="built_in">log</span>(r - l + <span class="number">1</span>) / <span class="built_in">log</span>(<span class="number">2</span>));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>(dp[l][k], dp[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find_maximum_of_segments</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp;nums, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">  M = (<span class="type">int</span>) (<span class="built_in">log</span>(n) / <span class="built_in">log</span>(<span class="number">2</span>)) + <span class="number">1</span>; </span><br><span class="line">  vector&lt; vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">dp</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(M + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">  <span class="built_in">prepare</span>(dp, nums);</span><br><span class="line">  <span class="type">int</span> k;</span><br><span class="line">  <span class="keyword">while</span>(t--) &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    cin &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i + k - <span class="number">1</span> &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">      res.<span class="built_in">push_back</span>(<span class="built_in">query</span>(dp, i, i + k - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: res) &#123;</span><br><span class="line">      cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> é¢è¯•å®˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜-ç§»æ‰Kä½æ•°å­—</title>
      <link href="/interview/interviewer/remove-the-k-digit/"/>
      <url>/interview/interviewer/remove-the-k-digit/</url>
      
        <content type="html"><![CDATA[<h1 id="ç§»æ‰Kä½æ•°å­—-leetcode-402"><a href="#ç§»æ‰Kä½æ•°å­—-leetcode-402" class="headerlink" title="ç§»æ‰Kä½æ•°å­—-leetcode-402"></a>ç§»æ‰Kä½æ•°å­—-leetcode-402</h1><ul><li>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šè´ªå¿ƒ,æ ˆ</li></ul><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªä»¥å­—ç¬¦ä¸²è¡¨ç¤ºçš„éè´Ÿæ•´æ•° numï¼Œç§»é™¤è¿™ä¸ªæ•°ä¸­çš„ k ä½æ•°å­—ï¼Œä½¿å¾—å‰©ä¸‹çš„æ•°å­—æœ€å°ã€‚  </p><p>æ³¨æ„:  </p><ul><li>num çš„é•¿åº¦å°äº 10002 ä¸” â‰¥ kã€‚  </li><li>num ä¸ä¼šåŒ…å«ä»»ä½•å‰å¯¼é›¶ã€‚</li></ul><p>è¾“å…¥&#x2F;è¾“å‡ºç¤ºä¾‹ï¼š  </p><p>Example 1:  </p><p>Input:   </p><pre><code>num = &quot;1432219&quot;, k = 3  </code></pre><p>Output:   </p><pre><code>&quot;1219&quot;  </code></pre><p>Explanation: ç§»é™¤æ‰ä¸‰ä¸ªæ•°å­— 4, 3, å’Œ 2 å½¢æˆä¸€ä¸ªæ–°çš„æœ€å°çš„æ•°å­— 1219ã€‚  </p><p>Example 2:  </p><p>Input:   </p><pre><code>num = &quot;10200&quot;, k = 1  </code></pre><p>Output:   </p><pre><code>&quot;200&quot;  </code></pre><p>Explanation: ç§»æ‰é¦–ä½çš„ 1 å‰©ä¸‹çš„æ•°å­—ä¸º 200. æ³¨æ„è¾“å‡ºä¸èƒ½æœ‰ä»»ä½•å‰å¯¼é›¶ã€‚  </p><p>Example 3:  </p><p>Input:   </p><pre><code>num = &quot;10&quot;, k = 2  </code></pre><p>Output:   </p><pre><code>&quot;0&quot;  </code></pre><p>Explanation: ä»åŸæ•°å­—ç§»é™¤æ‰€æœ‰çš„æ•°å­—ï¼Œå‰©ä½™ä¸ºç©ºå°±æ˜¯0ã€‚  </p><h2 id="æ€è·¯æè¿°"><a href="#æ€è·¯æè¿°" class="headerlink" title="æ€è·¯æè¿°"></a>æ€è·¯æè¿°</h2><h2 id="æ€è·¯-0"><a href="#æ€è·¯-0" class="headerlink" title="æ€è·¯ 0"></a>æ€è·¯ 0</h2><p>è¯¦ç»†æè¿°ï¼šæ€è·¯ï¼Œä»å·¦åˆ°å³ï¼Œæ‰¾ç¬¬ä¸€ä¸ªæ¯”åé¢å¤§çš„å­—ç¬¦ï¼Œåˆ é™¤ï¼Œæ¸…é›¶ï¼Œkæ¬¡æ‰«æã€‚  </p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šo(n*k)  </li><li>ç©ºé—´å¤æ‚åº¦ï¼šo(1)</li></ul><p>ä»£ç ï¼š  </p><pre><code class="java">class Solution &#123;      public String removeKdigits(String num, int k) &#123;        if (num.length() == k) return &quot;0&quot;;        StringBuilder s = new StringBuilder(num);        for (int i = 0; i &lt; k; i++) &#123;            int idx = 0;            for (int j = 1; j &lt; s.length() &amp;&amp; s.charAt(j) &gt;= s.charAt(j - 1); j++) idx = j;            s.delete(idx, idx + 1);            while (s.length() &gt; 1 &amp;&amp; s.charAt(0) == &#39;0&#39;) s.delete(0, 1);        &#125;        return s.toString();    &#125;&#125;  </code></pre><h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯ 1"></a>æ€è·¯ 1</h3><p>è¯¦ç»†æè¿°ï¼šåœ¨ä¸€å®šçš„èŒƒå›´å†…é€æ­¥é€‰å–æœ€å°çš„æ•°å­—ã€‚<br>  </p><ol><li>åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯ä¸­ï¼Œnum &#x3D; 1432219, k&#x3D;3ï¼Œæ­¤æ—¶æˆ‘ä»¬è¦åˆ å»k&#x3D;3ä¸ªæ•°å­—ï¼Œä¿ç•™n-k&#x3D;7-3&#x3D;4ä¸ªæ•°å­—ã€‚  </li><li>æœ€ç»ˆè¦æŒ‘é€‰4ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥æŒ‘é€‰ åƒä½ çš„å­—ç¬¦ï¼Œï¼Œç”±äºæŒ‘é€‰å®Œåƒä½åè¿˜éœ€è¦æŒ‘é€‰ç™¾ä½ï¼Œåä½ï¼Œä¸ªä½è¿™ä¸‰ä¸ªä½ç½®çš„å­—ç¬¦ï¼Œæ‰€ä»¥åƒä½èƒ½é€‰æ‹©çš„èŒƒå›´åªèƒ½åœ¨1432ä¹‹é—´,å› ä¸ºè¦ç•™å‡ºæœ«å°¾çš„219è¿™ä¸‰ä¸ªå­—ç¬¦ä¾›ç™¾ä½ã€åä½ã€ä¸ªä½ å»æŒ‘é€‰ã€‚  </li><li>1432ä¸­æœ€å°çš„å€¼æ˜¯1ï¼Œæ‰€ä»¥åƒä½çš„å€¼é€‰å¥½äº†ï¼Œå°±æ˜¯1ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä»åƒä½åé¢çš„432219ä¸­å»æŒ‘é€‰ç™¾ä½å€¼ï¼Œå¯ä»¥å‘ç°æŒ‘é€‰æ¯ä¸€ä½çš„å€¼æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ã€‚  </li><li>start &#x3D; 0, end &#x3D; kã€‚ä¹Ÿå°±æ˜¯è¦åœ¨[start,end]ä¸­é€‰å–ä¸€ä¸ªæœ€å°çš„è¿›è¡Œä¿ç•™ï¼Œè¿”å›æœ€å°æ•°å­—çš„ä¸‹æ ‡minIndexã€‚è€Œåœ¨ä¸‹æ¬¡å¾ªç¯ä¸­ï¼Œstart &#x3D; minIndex+1, end++ ï¼Œä¹Ÿå°±æ˜¯åœ¨[start,end]ä¸­é€‰æ‹©ä¸‹ä¸€ä¸ªæœ€å°çš„æ•°å­—ã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³æ‰€æœ‰æ•°å­—éƒ½é€‰å–å®Œæ¯•ã€‚</li></ol><p>æ³¨æ„ï¼šå½“è¿”å›çš„ä¸‹æ ‡minIndexåŠåé¢çš„å­—ç¬¦ä¸²çš„é•¿åº¦ &#x3D; è¿˜éœ€è¦ä¿ç•™çš„å­—ç¬¦ä¸²çš„é•¿åº¦çš„æ—¶å€™ï¼Œç›´æ¥è¿”å›  </p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šo(n*k)  </li><li>ç©ºé—´å¤æ‚åº¦ï¼šo(1)</li></ul><p>ä»£ç ï¼š  </p><pre><code class="go">func removeKdigits(num string, k int) string &#123;      if 0 == k &#123;        return num    &#125;    if k == len(num) &#123;        return &quot;0&quot;    &#125;    result := &quot;&quot;    i := len(num)-k    for &#123;        if i == 0 &#123;            break        &#125;        minIndex := 0        for  j := 0; j &lt; len(num)-(i-1); j++ &#123;            if num[j] &lt; num[minIndex] &#123;                minIndex = j            &#125;        &#125;        // ä¼˜åŒ–        if len(num)- minIndex == i &#123;            result = result + num[minIndex:]            break        &#125;        result += num[minIndex:minIndex+1]        num = num[minIndex+1:]        i--    &#125;    // å‰å¯¼0    ans := strings.TrimLeft(result, &quot;0&quot;)    if ans == &quot;&quot; &#123;        ans = &quot;0&quot;    &#125;    return ans&#125;    </code></pre><h3 id="æ€è·¯2-è´ªå¿ƒ-å•è°ƒæ ˆï¼ˆä¸€èˆ¬å¯ç”¨-æ ˆã€é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—ã€åŒæŒ‡é’ˆ-å®ç°ï¼‰"><a href="#æ€è·¯2-è´ªå¿ƒ-å•è°ƒæ ˆï¼ˆä¸€èˆ¬å¯ç”¨-æ ˆã€é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—ã€åŒæŒ‡é’ˆ-å®ç°ï¼‰" class="headerlink" title="æ€è·¯2: è´ªå¿ƒ + å•è°ƒæ ˆï¼ˆä¸€èˆ¬å¯ç”¨ æ ˆã€é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—ã€åŒæŒ‡é’ˆ å®ç°ï¼‰"></a>æ€è·¯2: è´ªå¿ƒ + å•è°ƒæ ˆï¼ˆä¸€èˆ¬å¯ç”¨ æ ˆã€é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—ã€åŒæŒ‡é’ˆ å®ç°ï¼‰</h3><p>è¯¦ç»†æè¿°ï¼š  </p><ul><li><p>éå†å­—ç¬¦ä¸²ï¼Œé€ä¸ªå…¥æ ˆ,è‹¥æ–°æ¥çš„æ¯”æ ˆé¡¶å°ï¼Œåˆ™æ ˆé¡¶å‡ºæ ˆ ,å‡ºæ ˆç›¸å½“äºç§»é™¤åŠ¨ä½œï¼Œéœ€æ¬¡æ•°å¹¶ä¸ k æ¯”è¾ƒï¼Œåˆ«åˆ å¤šäº†  </p></li><li><p>ç§»é™¤å¤´éƒ¨é›¶æœ‰ â€˜0â€™,å…¨ç©ºï¼Œreturn â€œ0â€,æ„å»ºå­—ç¬¦ä¸²ï¼Œé¡ºåºè¿”å›æ•´ä¸ªå•è°ƒæ ˆå…ƒç´ .  </p></li><li><p>æ—¶é—´å¤æ‚åº¦ï¼šo(n+k)  </p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼šo(n)</p></li></ul><p>ä»£ç ï¼š  </p><pre><code class="go">func removeKdigits(num string, k int) string &#123;      stack := []byte&#123;&#125;        for i := range num &#123;        digit := num[i]        for k &gt; 0 &amp;&amp; len(stack) &gt; 0 &amp;&amp; digit &lt; stack[len(stack)-1] &#123;            stack = stack[:len(stack)-1]            k--                &#125;        stack = append(stack, digit)     &#125;    stack = stack[:len(stack)-k]    ans := strings.TrimLeft(string(stack), &quot;0&quot;)    if ans == &quot;&quot; &#123;        ans = &quot;0&quot;        &#125;    return ans&#125;  </code></pre><h4 id="è¯„åˆ†"><a href="#è¯„åˆ†" class="headerlink" title="è¯„åˆ†"></a>è¯„åˆ†</h4><ul><li>æå‡ºæ€è·¯0ï¼Œèƒ½æ­£ç¡®åˆ†ææ—¶ç©ºå¤æ‚åº¦(2åˆ†)  </li><li>æå‡ºæ€è·¯1ï¼Œèƒ½æ­£ç¡®åˆ†ææ—¶ç©ºå¤æ‚åº¦(3åˆ†)  </li><li>æå‡ºæ€è·¯2ï¼Œèƒ½æ­£ç¡®åˆ†ææ—¶ç©ºå¤æ‚åº¦(4åˆ†)  </li><li>bugfreeä¸”ä»£ç ç®€æ´(5åˆ†)</li></ul>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> é¢è¯•å®˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜-ä»…å‡ºç°ä¸€æ¬¡çš„å…ƒç´ </title>
      <link href="/interview/interviewer/single-numbers/"/>
      <url>/interview/interviewer/single-numbers/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»…å‡ºç°ä¸€æ¬¡çš„å…ƒç´ "><a href="#ä»…å‡ºç°ä¸€æ¬¡çš„å…ƒç´ " class="headerlink" title="ä»…å‡ºç°ä¸€æ¬¡çš„å…ƒç´ "></a>ä»…å‡ºç°ä¸€æ¬¡çš„å…ƒç´ </h1><ul><li>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šæ•£åˆ—è¡¨ã€ä½è¿ç®—</li></ul><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ï¼ˆè‹±æ–‡ï¼‰<br>Given an array of numbers nums, in which exactly two elements appear only once and all the other elements appear exactly twice. Find the two elements that appear only once.  </p><p>For example:  </p><p>Given nums &#x3D; [1, 2, 1, 3, 2, 5], return [3, 5].  </p><p>Note:  </p><ol><li>The order of the result is not important. So in the above example, [5, 3] is also correct.</li></ol><p>ï¼ˆä¸­æ–‡ï¼‰<br>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå…¶ä¸­æ°å¥½æœ‰ä¸¤ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ï¼Œå…¶ä½™æ‰€æœ‰å…ƒç´ å‡å‡ºç°ä¸¤æ¬¡ã€‚ æ‰¾å‡ºä»…å‡ºç°ä¸€æ¬¡çš„é‚£ä¸¤ä¸ªå…ƒç´ ã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦åœ¨O(N)å†…ã€‚  </p><p>ç¤ºä¾‹è¾“å…¥:  </p><pre><code>[1, 2, 1, 3, 2, 5]  </code></pre><p>ç¤ºä¾‹è¾“å‡ºï¼š  </p><pre><code>[3, 5]  </code></pre><h2 id="æ€è·¯æè¿°"><a href="#æ€è·¯æè¿°" class="headerlink" title="æ€è·¯æè¿°"></a>æ€è·¯æè¿°</h2><h3 id="æ€è·¯1ï¼šæ’åº-éå†"><a href="#æ€è·¯1ï¼šæ’åº-éå†" class="headerlink" title="æ€è·¯1ï¼šæ’åº+éå†"></a>æ€è·¯1ï¼šæ’åº+éå†</h3><p>å¯¹åºåˆ—æ’åºï¼Œåéå†æ‰€æœ‰å…ƒç´ ï¼Œé€šè¿‡ç›¸é‚»å…ƒç´ æ˜¯å¦æœ‰ç›¸åŒå€¼æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œè¾“å‡ºã€‚  </p><p>å¸¸è§„æ’åºæ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦å¦‚ä¸‹ï¼š  </p><ul><li>æ—¶é—´å¤æ‚åº¦ <code>O(N*log(N))</code>  </li><li>ç©ºé—´å¤æ‚åº¦ <code>O(1)</code></li></ul><p>æ­¤æ—¶è§£æ³•ä¸æ»¡è¶³è¦æ±‚ï¼Œå¯ç»™åˆ°2åˆ†ï¼Œè‹¥èƒ½ç»™å‡ºè®¡æ•°æ’åºï¼ˆæ—¶é—´å¤æ‚åº¦O(N)ï¼‰æ³•ï¼Œå¯ç»™åˆ°3åˆ†ã€‚  </p><h3 id="æ€è·¯2ï¼šæ•£åˆ—è¡¨-éå†"><a href="#æ€è·¯2ï¼šæ•£åˆ—è¡¨-éå†" class="headerlink" title="æ€è·¯2ï¼šæ•£åˆ—è¡¨+éå†"></a>æ€è·¯2ï¼šæ•£åˆ—è¡¨+éå†</h3><p>éå†æ¯ä¸ªå…ƒç´ ï¼Œä½¿ç”¨æ•£åˆ—è¡¨å­˜å‚¨å…ƒç´ å€¼åˆ°æ•°é‡çš„æ˜ å°„å…³ç³»ï¼Œå†éå†æ•£åˆ—è¡¨æ‰¾å‡ºå…¶ä¸­valueä¸º1çš„keyï¼Œè¾“å‡ºã€‚  </p><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š  </p><ul><li>æ—¶é—´å¤æ‚åº¦ <code>O(N)</code>  </li><li>ç©ºé—´å¤æ‚åº¦ <code>O(N)</code></li></ul><p>æ­¤æ—¶ä¸ºæ¬¡ä¼˜è§£ï¼Œå¯å»¶ä¼¸æé—®å¯¹æ•£åˆ—è¡¨çš„ç†è§£ï¼ˆå¦‚éå†ç»“æœæ˜¯å¦æœ‰åºï¼Œä¸¤ä¸ªå…ƒç´ è¾“å‡ºé¡ºåºæ˜¯å¦ç¡®å®šï¼‰ï¼Œå›ç­”æ­£ç¡®å¯ç»™åˆ°4åˆ†  </p><h3 id="æ€è·¯3ï¼šä½è¿ç®—"><a href="#æ€è·¯3ï¼šä½è¿ç®—" class="headerlink" title="æ€è·¯3ï¼šä½è¿ç®—"></a>æ€è·¯3ï¼šä½è¿ç®—</h3><p>éå†å…ƒç´ ï¼Œä½¿ç”¨å¼‚æˆ–è¿ç®—å¯æ¶ˆé™¤ç›¸åŒçš„å…ƒç´ ï¼Œå¾—åˆ°æ‰€æ±‚ä¸¤ä¸ªå…ƒç´ çš„å¼‚æˆ–ç»“æœï¼Œä»ä¸­æ‰¾å‡ºäºŒè¿›åˆ¶ä¸º1çš„æœ€ä½ä½æ•°å­—ï¼Œå†éå†ä¸€æ¬¡ï¼Œæ±‚å‡ºå…¶ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œå†ä¸å‰é¢ç»“æœå¼‚æˆ–å¾—åˆ°å¦ä¸€ä¸ªå…ƒç´ ï¼Œè¾“å‡ºã€‚  </p><p>è¯¥æ–¹æ¡ˆçš„æ—¶ç©ºå¤æ‚åº¦åˆ†æå¦‚ä¸‹ï¼š  </p><ul><li>æ—¶é—´å¤æ‚åº¦ <code>O(N)</code>  </li><li>ç©ºé—´å¤æ‚åº¦ <code>O(1)</code></li></ul><p>æ­¤ä¸ºæœ€ä¼˜è§£ï¼Œå¯ç»™åˆ°5åˆ†  </p><h2 id="è§£æ³•ç¤ºä¾‹"><a href="#è§£æ³•ç¤ºä¾‹" class="headerlink" title="è§£æ³•ç¤ºä¾‹"></a>è§£æ³•ç¤ºä¾‹</h2><p><a href="./single-numbers/sortSolution.go">æ’åº+éå†</a>  </p><p><a href="./single-numbers/hashSolution.go">hash+éå†</a>  </p><p><a href="./single-numbers/bitSolution.go">ä½è¿ç®—</a></p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> é¢è¯•å®˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/%E8%BD%AF%E5%AE%9E%E5%8A%9B/1/"/>
      <url>/%E8%BD%AF%E5%AE%9E%E5%8A%9B/1/</url>
      
        <content type="html"><![CDATA[<h1 id="è½¯å®åŠ›"><a href="#è½¯å®åŠ›" class="headerlink" title="è½¯å®åŠ›"></a>è½¯å®åŠ›</h1><h2 id="ä¸»åŠ¨æ€§ï¼Œè´£ä»»å¿ƒ"><a href="#ä¸»åŠ¨æ€§ï¼Œè´£ä»»å¿ƒ" class="headerlink" title="ä¸»åŠ¨æ€§ï¼Œè´£ä»»å¿ƒ"></a>ä¸»åŠ¨æ€§ï¼Œè´£ä»»å¿ƒ</h2><h3 id="é¡¹ç›®"><a href="#é¡¹ç›®" class="headerlink" title="é¡¹ç›®"></a>é¡¹ç›®</h3><p>ä¸»åŠ¨æ¨è¿›è‡ªå·±å‚ä¸çš„æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œå°†è‡ªå·±çœ‹ä½œæ˜¯æ¯ä¸€ä¸ªé¡¹ç›®çš„è´Ÿè´£äººï¼Œä»¥é¡¹ç›®è´Ÿè´£äººçš„è§’åº¦å»çœ‹å¾…äº‹æƒ…ï¼Œä¸€æ–¹é¢èƒ½å¤Ÿè®©è‡ªå·±æ›´å¥½çš„åšäº‹æƒ…ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿèƒ½åŸ¹å…»è‡ªå·±çš„é¡¹ç›®æ¨åŠ¨èƒ½åŠ›</p><h3 id="ä¸ªäººäº‹åŠ¡"><a href="#ä¸ªäººäº‹åŠ¡" class="headerlink" title="ä¸ªäººäº‹åŠ¡"></a>ä¸ªäººäº‹åŠ¡</h3><p>è½¬ä»‹ç»ç›¸å…³é“¾è·¯å¾ˆé•¿ï¼Œç”¨æˆ·ä»çœ‹åˆ°ç¬¬ä¸‰æ–¹å¹¿å‘Šå¼€å§‹ï¼Œåˆ°æœ€ç»ˆæˆä¸ºå¿ å®ç”¨æˆ·</p><h2 id="æŠ—å‹èƒ½åŠ›â€“ã€‹æœ‰æ‰€è¿›æ­¥ï¼Œè¿˜éœ€åŠ å¼º"><a href="#æŠ—å‹èƒ½åŠ›â€“ã€‹æœ‰æ‰€è¿›æ­¥ï¼Œè¿˜éœ€åŠ å¼º" class="headerlink" title="æŠ—å‹èƒ½åŠ›â€“ã€‹æœ‰æ‰€è¿›æ­¥ï¼Œè¿˜éœ€åŠ å¼º"></a>æŠ—å‹èƒ½åŠ›â€“ã€‹æœ‰æ‰€è¿›æ­¥ï¼Œè¿˜éœ€åŠ å¼º</h2><p>è¿™ä¸€ç‚¹æˆ‘æœ€åˆåšçš„ä¸å¤Ÿå¥½ï¼Œç°åœ¨ç›¸å¯¹è€Œè¨€å·²ç»åšçš„ä¸é”™ï¼Œæ€»ä½“ç»éªŒå¦‚ä¸‹</p><p><strong>å­¦ä¼šåŒºåˆ†äº‹æƒ…çš„è½»é‡ç¼“æ€¥ï¼Œä¸é‚£ä¹ˆç´§æ€¥çš„äº‹æƒ…å°±å…ˆæ”¾ç€ï¼Œä¸å»ç†ä¼šï¼Œé›†ä¸­ç²¾ç¥è§£å†³æ‰ç´§æ€¥çš„äº‹æƒ…ï¼Œç„¶åä»¥å¹³å’Œçš„å¿ƒæ€å»è§£å†³é‚£äº›ä¸ç´§æ€¥çš„</strong></p><p>å¯èƒ½è¯´èµ·æ¥ç®€å•ï¼Œä½†æ˜¯å…·ä½“å¦‚ä½•å®æ–½ï¼Œè¿˜æ˜¯è¦è‡ªå·±å¤šç»å†</p><h2 id="æ²Ÿé€šèƒ½åŠ›â€“ã€‹åœ¨æ²Ÿé€šä¸­çš„è°¦é€Šæ²¡æœ‰é—®é¢˜ï¼Œä¸€å‘æ˜¯è‡ªå·±é”™äº†å°±æ˜¯é”™äº†ä¸æ‰¾æ¥å£ï¼Œä½†æ˜¯æœ‰æ—¶å€™äº‹æƒ…å¤šäº†ï¼Œè¯­æ°”ä¼šæ€¥èºï¼Œæœ‰æ‰€æ³¨æ„å’Œæ”¹è¿›ï¼Œè¿˜éœ€è¦ç»§ç»­åŠªåŠ›"><a href="#æ²Ÿé€šèƒ½åŠ›â€“ã€‹åœ¨æ²Ÿé€šä¸­çš„è°¦é€Šæ²¡æœ‰é—®é¢˜ï¼Œä¸€å‘æ˜¯è‡ªå·±é”™äº†å°±æ˜¯é”™äº†ä¸æ‰¾æ¥å£ï¼Œä½†æ˜¯æœ‰æ—¶å€™äº‹æƒ…å¤šäº†ï¼Œè¯­æ°”ä¼šæ€¥èºï¼Œæœ‰æ‰€æ³¨æ„å’Œæ”¹è¿›ï¼Œè¿˜éœ€è¦ç»§ç»­åŠªåŠ›" class="headerlink" title="æ²Ÿé€šèƒ½åŠ›â€“ã€‹åœ¨æ²Ÿé€šä¸­çš„è°¦é€Šæ²¡æœ‰é—®é¢˜ï¼Œä¸€å‘æ˜¯è‡ªå·±é”™äº†å°±æ˜¯é”™äº†ä¸æ‰¾æ¥å£ï¼Œä½†æ˜¯æœ‰æ—¶å€™äº‹æƒ…å¤šäº†ï¼Œè¯­æ°”ä¼šæ€¥èºï¼Œæœ‰æ‰€æ³¨æ„å’Œæ”¹è¿›ï¼Œè¿˜éœ€è¦ç»§ç»­åŠªåŠ›"></a>æ²Ÿé€šèƒ½åŠ›â€“ã€‹åœ¨æ²Ÿé€šä¸­çš„è°¦é€Šæ²¡æœ‰é—®é¢˜ï¼Œä¸€å‘æ˜¯è‡ªå·±é”™äº†å°±æ˜¯é”™äº†ä¸æ‰¾æ¥å£ï¼Œä½†æ˜¯æœ‰æ—¶å€™äº‹æƒ…å¤šäº†ï¼Œè¯­æ°”ä¼šæ€¥èºï¼Œæœ‰æ‰€æ³¨æ„å’Œæ”¹è¿›ï¼Œè¿˜éœ€è¦ç»§ç»­åŠªåŠ›</h2><h3 id="ä¿è¯æ²Ÿé€šçš„é«˜æ•ˆæ€§"><a href="#ä¿è¯æ²Ÿé€šçš„é«˜æ•ˆæ€§" class="headerlink" title="ä¿è¯æ²Ÿé€šçš„é«˜æ•ˆæ€§"></a>ä¿è¯æ²Ÿé€šçš„é«˜æ•ˆæ€§</h3><p>ä½æ•ˆçš„æ²Ÿé€šä¸ä»…ä¼šè®©ä½ çƒ¦ï¼Œä¹Ÿä¼šè®©æ²Ÿé€šå¯¹è±¡æ„Ÿåˆ°çƒ¦ï¼Œå½“å‘ç°æ‰“å­—å·²ç»è¯´ä¸æ¸…æ¥šäº‹æƒ…çš„æ—¶å€™å¯ä»¥è€ƒè™‘ç›´æ¥è¯­éŸ³ï¼Œæˆ–è€…ç›´æ¥å½“é¢å¯¹æ¥ã€‚</p><h3 id="æ²Ÿé€šè¿‡ç¨‹ä¿æŒè°¦é€Šå’Œå¹³å’Œ"><a href="#æ²Ÿé€šè¿‡ç¨‹ä¿æŒè°¦é€Šå’Œå¹³å’Œ" class="headerlink" title="æ²Ÿé€šè¿‡ç¨‹ä¿æŒè°¦é€Šå’Œå¹³å’Œ"></a>æ²Ÿé€šè¿‡ç¨‹ä¿æŒè°¦é€Šå’Œå¹³å’Œ</h3><h4 id="æ–¹æ¡ˆæ²Ÿé€š"><a href="#æ–¹æ¡ˆæ²Ÿé€š" class="headerlink" title="æ–¹æ¡ˆæ²Ÿé€š"></a>æ–¹æ¡ˆæ²Ÿé€š</h4><p>ä¸ä»–äººæ²Ÿé€šè¿‡ç¨‹ä¸­éš¾å…æœ‰æ‰€äº‰æ‰§ï¼Œè¦èƒ½æ˜ç¡®çš„ä»å¯¹æ–¹çš„è§’åº¦æ€è€ƒï¼Œå¯¹æ–¹è¯´çš„ä¸€äº›è§£å†³æ–¹æ¡ˆä½ å¯èƒ½ä¸€å¼€å§‹ä¸è®¤å¯ï¼Œä½†æ˜¯åˆ«äººæ—¢ç„¶è¿™ä¹ˆè¯´äº†å°±ä¸€å®šæœ‰ä»–è¿™ä¹ˆè¯´çš„åŸå› ï¼Œå¯ä»¥å…ˆé—®æ¸…æ¥šï¼Œæ˜¯ä¸æ˜¯æœ‰ä»€ä¹ˆå†å²é—ç•™é—®é¢˜æˆ–è€…ä¸šåŠ¡åœºæ™¯ï¼Œå¯¼è‡´ä»–è¦é‡‡ç”¨ä½ ä¸è®¤å¯çš„æ–¹æ¡ˆï¼Œå¦‚æœå‘ç°ç¡®å®æ˜¯å¯¹æ–¹æ€è€ƒä¸å‘¨ï¼Œç„¶åå¯ä»¥æä¾›è‡ªå·±çš„æƒ³æ³•ï¼Œäº’ç›¸æ²Ÿé€šï¼Œæ€»ä¼šè¾¾æˆä¸€è‡´ã€‚</p><h4 id="æ¥å—è‡ªå·±ä¸è¶³"><a href="#æ¥å—è‡ªå·±ä¸è¶³" class="headerlink" title="æ¥å—è‡ªå·±ä¸è¶³"></a>æ¥å—è‡ªå·±ä¸è¶³</h4><p>ä¸è¦æœ‰è‡ªå·±ç»å¯¹ä¸èƒ½çŠ¯é”™çš„æ€æƒ³ï¼Œæœ‰æ—¶å€™æ˜æ˜æ˜¯ä½ çš„é—®é¢˜æˆ–è€…å°±æ˜¯ä½ èƒ½åŠ›ä¸è¶³æ²¡æœ‰æ€è€ƒåˆ°ä¸€äº›ä¸œè¥¿ï¼Œè¢«åŒäº‹å½“é¢æŒ‡å‡ºï¼Œè¿™æ—¶å€™è¦ä¿æŒè°¦é€Šçš„å¿ƒï¼Œä¸è¦ç¡¬æŠ—ï¼Œè¿™æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œé”™äº†å°±æ˜¯é”™äº†ï¼Œæ²¡æœ‰æƒ³åˆ°å°±æ˜¯æ²¡æœ‰æƒ³åˆ°ï¼Œæ¥å—åˆ«äººçš„æŒ‡è´£ï¼Œç„¶ååçœè¿›æ­¥å³å¯ï¼Œç¡¬æŠ—å¯¹ä»–äººå¯¹è‡ªå·±éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹å¼ã€‚</p><h1 id="ä¸€äº›å¥½çš„å·¥ä½œä¹ æƒ¯å’Œå»ºè®®"><a href="#ä¸€äº›å¥½çš„å·¥ä½œä¹ æƒ¯å’Œå»ºè®®" class="headerlink" title="ä¸€äº›å¥½çš„å·¥ä½œä¹ æƒ¯å’Œå»ºè®®"></a>ä¸€äº›å¥½çš„å·¥ä½œä¹ æƒ¯å’Œå»ºè®®</h1><p><strong>1.äº‹äº‹æœ‰å›éŸ³</strong></p><p>è¿™ä¸€ç‚¹å¾ˆå¤šé¸¡æ±¤æ–‡éƒ½æœ‰å†™ï¼Œä½†æ˜¯çœŸçš„å¾ˆé‡è¦ï¼Œæ‰€ä»¥åœ¨æ­¤æ”¾åœ¨ç¬¬ä¸€ä¸ªå¼ºè°ƒã€‚</p><p>äº¤ç»™ä½ çš„ä»»åŠ¡ï¼Œä½ åšåˆ°å“ªä¸€æ­¥ï¼Œä¸€å®šè¦è®©ç»™ä½ å¸ƒç½®çš„äººå¿ƒé‡Œæœ‰æ•°ï¼Œæˆ–è€…è¯´ä½ æ‰“ç®—ä»€ä¹ˆæ—¶å€™åšå®Œï¼Œä¹Ÿä¸€å®šè¦ç»™ä¸€ä¸ªdeadlineï¼Œè‹¥æ˜¯é•¿ä¹…æ²¡æœ‰å›éŸ³ï¼Œæˆ–è€…æœ€åå‡ºäº†å²”å­ï¼Œéš¾å…å°±ä¼šç•™ä¸‹ä¸é è°±çš„å°è±¡ã€‚</p><p><strong>2.è·Ÿäº‹æƒ…è¦è·Ÿåˆ°åº•</strong></p><p>è®©ä½ è·Ÿä¸€ä»¶äº‹æƒ…ï¼Œå°±è¦è·Ÿåˆ°åº•ï¼Œä¸­é—´å¦‚æœé‡åˆ°é˜»ç¢å‘ç°äº‹æƒ…æ²¡æœ‰è¿›å±•ï¼Œå°±è¦æƒ³åŠæ³•å»è§£å†³ï¼Œå¦‚æœå®åœ¨è§£å†³ä¸äº†ï¼Œå°±è¦è·Ÿå‘ä½ å¸ƒç½®ä»»åŠ¡çš„äººä¸»åŠ¨æ²Ÿé€šï¼Œæœ€èµ·ç æˆ‘ä»¬ç»„å†…è¾¾æˆå…±è¯†å¾—å‡ºä¸€ä¸ªç»“è®ºã€‚</p><p><strong>3.ä¸åªæ˜¯å®Œæˆä»»åŠ¡</strong></p><p>Â ä»¥é«˜æ ‡å‡†è¦æ±‚è‡ªå·±ï¼Œåœ¨å®Œæˆä»»åŠ¡çš„åŒæ—¶èƒ½å¦åšçš„æ›´å¥½ï¼Œæˆ–è€…è¯´ç»™æˆ‘çš„æ–¹æ¡ˆæ˜¯è¿™æ ·ï¼Œæˆ‘èƒ½å¦æƒ³å‡ºæ›´å¥½çš„æ–¹æ¡ˆï¼Œåœ¨è¿™æ ·çš„æ€è€ƒä¸­è‡ªå·±çš„èƒ½åŠ›ä¹Ÿä¼šæœ‰æ‰€æå‡ã€‚</p><p><strong>4.é«˜æ•ˆ</strong></p><p>ä¸€ä¸ªä»»åŠ¡ï¼Œä»–èŠ±è´¹å¤šå°‘æ—¶é—´ï¼Œå¤§å®¶å¿ƒé‡Œä¸€èˆ¬éƒ½æœ‰æ•°ï¼Œå¦‚æœè¿™ä¸ªä»»åŠ¡ä¸€èˆ¬åªèŠ±è´¹ä¸€å¤©ï¼Œç»“æœä½ åšäº†ä¸¤å¤©ï¼Œä¸‰å¤©è¿˜æ²¡æœ‰åšå¥½ï¼Œé‚£ä¸€å®šæ˜¯ä½ çš„é—®é¢˜ï¼Œè¿˜æœ‰çš„æƒ…å†µæ˜¯å› ä¸ºå…¶ä»–äº‹æƒ…å¤šï¼Œæ‰€ä»¥è®¾ç½®äº†deadlineï¼Œä½†æ˜¯å‡ºç°ä¸€æ‹–å†æ‹–ï¼Œåˆ°äº†deadlineè¿˜ç»§ç»­å¾€ä¸‹æ‹–çš„æƒ…å†µï¼Œé‚£æœ€èµ·ç ä¹Ÿæ˜¯ä½ å¯¹è‡ªå·±æ—¶é—´è§„åˆ’ä¸æ¸…æ¥šæ‰€é€ æˆçš„é—®é¢˜ï¼Œå“ªæ€•è‡ªå·±åŠ ç­ä¹Ÿä¸èƒ½å‡ºç°å› ä¸ºè‡ªå·±å¯¼è‡´é¡¹ç›®blockçš„æƒ…å†µï¼Œè¿™æ˜¯æˆ‘å¯¹æˆ‘è‡ªå·±çš„è¦æ±‚ã€‚</p><p><strong>5.å›¢é˜Ÿé…åˆ</strong></p><p>ä¸è¦æ€•é—®é—®é¢˜ï¼Œä½†æ˜¯è¦é—®å¯¹çš„é—®é¢˜ã€‚</p><p>å½“å‡ºç°äº†é—®é¢˜ï¼Œä¸€å®šè¦å…ˆåˆ¤å®šé—®é¢˜çš„èŒƒç•´ï¼Œæ˜¯æŠ€æœ¯é—®é¢˜ï¼Œè¿˜æ˜¯éæŠ€æœ¯é—®é¢˜ã€‚</p><p>æŠ€æœ¯é—®é¢˜å½“ç„¶è¦é è‡ªå·±æœèµ„æ–™å’Œæƒ³åŠæ³•è§£å†³ï¼Œä½†æ˜¯å¯ä»¥åˆ†æƒ…å†µç»™è‡ªå·±ä¸€ä¸ªæ—¶é—´é™åˆ¶ï¼Œæ¯”å¦‚æˆ‘æ‰‹ä¸Šè¿˜æœ‰å¾ˆå¤šäº‹æƒ…ï¼Œæˆ‘å·²ç»èŠ±äº†ä¸€ä¸ªå°æ—¶ï¼Œè¿˜æ˜¯è§£å†³ä¸äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æˆ‘è¿™è¾¹è¯¥åšçš„éƒ½åšäº†ï¼Œå®åœ¨æ‰¾ä¸åˆ°é—®é¢˜äº†ï¼Œé—®äº†é¿å…æµªè´¹æ—¶é—´å¯ä»¥è€ƒè™‘æ±‚åŠ©ä¸€ä¸‹èµ„æ·±åŒäº‹æˆ–è€…è‡ªå·±ç»„å†…çš„leaderã€‚</p><p>éæŠ€æœ¯é—®é¢˜ï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬å…¬å¸çš„ç»„ä»¶ï¼Œæˆ–è€…ç›¸å…³çš„æŠ€æœ¯è§„èŒƒå¯¼è‡´ï¼Œæ˜¯ä¸€ç§ä½ çŸ¥é“äº†å°±çŸ¥é“äº†ï¼Œä¸çŸ¥é“å°±æ— æ³•è§£å†³çš„é—®é¢˜ï¼Œå®Œå…¨æ²¡æœ‰ä¸‹æ‰‹æ€è·¯ï¼Œè¿™ç§é—®é¢˜å¯ä»¥ç»™è‡ªå·±çš„æ—¶é—´é™åˆ¶å°‘ä¸€äº›ï¼Œæ¯”å¦‚10åˆ†é’Ÿï¼Œå½“ç„¶åœ¨æé—®ä¹‹å‰ä¹Ÿè¦ç¡®å®šè‡ªå·±æŠŠè¯¥åšçš„æ’æŸ¥éƒ½åšäº†ï¼Œç„¶åå»é—®ä¸€ä¸‹çŸ¥é“çš„äººã€‚</p><p>äºæˆ‘ä»¬ç»„è€Œè¨€ï¼Œå¤§å®¶éƒ½æ˜¯æ¯”è¾ƒå¹³å’Œçš„äººï¼Œæ‰€ä»¥ä¸è¦æ€•é—®é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿä¸è¦é—®æµªè´¹å¤§å®¶æ—¶é—´çš„ä½çº§é—®é¢˜ã€‚</p><p><strong>6.ä¸å½“ä¼ è¯ç­’</strong></p><p>ç»„å†…è´Ÿè´£çš„æœåŠ¡å¾ˆå¤šï¼Œæœ‰çš„ä¸šåŠ¡ä¸äº†è§£æ¯ä¸ªäººè´Ÿè´£çš„èŒƒç•´ä¼šå‡ºç°é—®é”™äººçš„æƒ…å†µï¼Œå¦‚æœè¿™ä¸ªé—®é¢˜ä½ æ°å¥½ä¹ŸçŸ¥é“å¯ä»¥ååŠ©åšç­”ï¼Œä¸è¿‡ä½œç­”åä¹Ÿè¦è·Ÿä¸šåŠ¡æ˜ç¡®è´Ÿè´£è¿™é—®é¢˜çš„äººå…¶å®æ˜¯è°ï¼Œä¸è®©ä»¥åæ‰€æœ‰è¿™äº›é—®é¢˜éƒ½å¯èƒ½ä¼šå…ˆé—®ä½ ï¼Œå¦‚æœä½ ä¸æ¸…æ¥šï¼Œå°±ä¸è¦åšä¼ è¯ç­’ï¼Œå¯ä»¥ç›´æ¥æ‹‰ç¾¤æˆ–è€…ç›´æ¥å‘Šè¯‰ä¸šåŠ¡æ–¹åº”è¯¥é—®è°ï¼Œä¸è¦è½¬å‘é—®é¢˜ï¼Œè¿™æ ·ä¸šåŠ¡æ–¹è·Ÿé—®é¢˜è´Ÿè´£äººçš„æ²Ÿé€šä¸­å°±å¤šåŠ äº†ä¸€å±‚ä½ ï¼Œæœ‰æ—¶å€™ä¸šåŠ¡æ–¹å¯¹æœåŠ¡äº†è§£ä¸æ¸…æ¥šï¼Œé—®çš„é—®é¢˜æœ¬èº«å°±ä¸æ­£ç¡®ï¼Œä½ è¿˜ååŠ©ä¼ è¾¾ï¼Œé‚£å°±æ˜¯åœ¨æµªè´¹æ‰€æœ‰äººçš„æ—¶é—´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è½¯å®åŠ› </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åº</title>
      <link href="/golang/go-design-pattern/startup/"/>
      <url>/golang/go-design-pattern/startup/</url>
      
        <content type="html"><![CDATA[<h2 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h2><ul><li>Go è®¾è®¡æ¨¡å¼å®ç°ï¼ŒåŒ…å« 23 ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼å®ç°ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯ <a href="https://time.geekbang.org/column/intro/250">æå®¢æ—¶é—´-è®¾è®¡æ¨¡å¼ä¹‹ç¾</a> çš„ç¬”è®°</li><li>ä¸€äº›åŸºç¡€åŸåˆ™å’Œæ€æƒ³</li></ul><h3 id="â€œå¥½â€ä»£ç çš„å‡ ä¸ªæ ‡å‡†"><a href="#â€œå¥½â€ä»£ç çš„å‡ ä¸ªæ ‡å‡†" class="headerlink" title="â€œå¥½â€ä»£ç çš„å‡ ä¸ªæ ‡å‡†"></a>â€œå¥½â€ä»£ç çš„å‡ ä¸ªæ ‡å‡†</h3><ol><li>å¦‚ä½•è¯„ä»·ä»£ç è´¨é‡çš„é«˜ä½ï¼Ÿ<br>ä»£ç è´¨é‡çš„è¯„ä»·æœ‰å¾ˆå¼ºçš„ä¸»è§‚æ€§ï¼Œæè¿°ä»£ç è´¨é‡çš„è¯æ±‡ä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€çµæ´»ã€ä¼˜é›…ã€ç®€æ´ç­‰ï¼Œè¿™äº›è¯æ±‡æ˜¯ä»ä¸åŒçš„ç»´åº¦å»è¯„ä»·ä»£ç è´¨é‡çš„ã€‚å®ƒä»¬ä¹‹é—´æœ‰äº’ç›¸ä½œç”¨ï¼Œå¹¶ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œæ¯”å¦‚ï¼Œä»£ç çš„å¯è¯»æ€§å¥½ã€å¯æ‰©å±•æ€§å¥½å°±æ„å‘³ç€ä»£ç çš„å¯ç»´æŠ¤æ€§å¥½ã€‚ä»£ç è´¨é‡é«˜ä½æ˜¯ä¸€ä¸ªç»¼åˆå„ç§å› ç´ å¾—åˆ°çš„ç»“è®ºã€‚æˆ‘ä»¬å¹¶ä¸èƒ½é€šè¿‡å•ä¸€çš„ç»´åº¦å»è¯„ä»·ä¸€æ®µä»£ç çš„å¥½åã€‚</li><li>æœ€å¸¸ç”¨çš„è¯„ä»·æ ‡å‡†æœ‰å“ªå‡ ä¸ªï¼Ÿ<br>æœ€å¸¸ç”¨åˆ°å‡ ä¸ªè¯„åˆ¤ä»£ç è´¨é‡çš„æ ‡å‡†æ˜¯ï¼šå¯ç»´æŠ¤æ€§ã€å¯è¯»æ€§ã€å¯æ‰©å±•æ€§ã€çµæ´»æ€§ã€ç®€æ´æ€§ã€å¯å¤ç”¨æ€§ã€å¯æµ‹è¯•æ€§ã€‚å…¶ä¸­ï¼Œå¯ç»´æŠ¤æ€§ã€å¯è¯»æ€§ã€å¯æ‰©å±•æ€§åˆæ˜¯æåˆ°æœ€å¤šçš„ã€æœ€é‡è¦çš„ä¸‰ä¸ªè¯„ä»·æ ‡å‡†ã€‚</li><li>å¦‚ä½•æ‰èƒ½å†™å‡ºé«˜è´¨é‡çš„ä»£ç ï¼Ÿ<br>è¦å†™å‡ºé«˜è´¨é‡ä»£ç ï¼Œæˆ‘ä»¬å°±éœ€è¦æŒæ¡ä¸€äº›æ›´åŠ ç»†åŒ–ã€æ›´åŠ èƒ½è½åœ°çš„ç¼–ç¨‹æ–¹æ³•è®ºï¼Œè¿™å°±åŒ…å«é¢å‘å¯¹è±¡è®¾è®¡æ€æƒ³ã€è®¾è®¡åŸåˆ™ã€è®¾è®¡æ¨¡å¼ã€ç¼–ç è§„èŒƒã€é‡æ„æŠ€å·§ç­‰ç­‰</li></ol>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>zookeeper</title>
      <link href="/interview/distribution/zookeeper/"/>
      <url>/interview/distribution/zookeeper/</url>
      
        <content type="html"><![CDATA[<h3 id="1-ä»€ä¹ˆæ˜¯-zookeeper-ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯-zookeeper-ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ zookeeper ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯ zookeeper ï¼Ÿ</h3><p>Zookeeperï¼ˆCPï¼‰<br>ä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ååŒæœåŠ¡ï¼ŒZooKeeperéå¸¸å¥½ï¼Œä½†æ˜¯å¯¹äºServiceå‘ç°æœåŠ¡æ¥è¯´å°±ä¸åˆé€‚äº†ï¼Œå› ä¸ºå¯¹äºServiceå‘ç°æœåŠ¡æ¥è¯´å°±ç®—æ˜¯è¿”å›äº†åŒ…å«ä¸å®çš„ä¿¡æ¯çš„ç»“æœä¹Ÿæ¯”ä»€ä¹ˆéƒ½ä¸è¿”å›è¦å¥½ã€‚æ‰€ä»¥å½“å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿æ³¨å†Œä¸­å¿ƒè¿”å›çš„æ˜¯å‡ åˆ†é’Ÿä»¥å‰çš„æ³¨å†Œä¿¡æ¯ï¼Œä½†ä¸èƒ½æ¥å—æœåŠ¡ç›´æ¥downæ‰ä¸å¯ç”¨ã€‚</p><p>ä½†æ˜¯zkä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼Œå½“masterèŠ‚ç‚¹å› ä¸ºç½‘ç»œæ•…éšœä¸å…¶ä»–èŠ‚ç‚¹å¤±å»è”ç³»æ—¶ï¼Œå‰©ä½™èŠ‚ç‚¹ä¼šé‡æ–°è¿›è¡Œleaderé€‰ä¸¾ã€‚é—®é¢˜åœ¨äºï¼Œé€‰ä¸¾leaderçš„æ—¶é—´å¤ªé•¿ï¼Œä¸”é€‰ä¸¾æœŸé—´æ•´ä¸ªzké›†ç¾¤éƒ½æ˜¯ä¸å¯ç”¨çš„ï¼Œè¿™å°±å¯¼è‡´åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚åœ¨äº‘éƒ¨ç½²çš„ç¯å¢ƒä¸‹ï¼Œå› ç½‘ç»œé—®é¢˜ä½¿å¾—zké›†ç¾¤å¤±å»masterèŠ‚ç‚¹æ˜¯è¾ƒå¤§æ¦‚ç‡ä¼šå‘ç”Ÿçš„äº‹ï¼Œè™½ç„¶æœåŠ¡èƒ½å¤Ÿæœ€ç»ˆæ¢å¤ï¼Œä½†æ˜¯æ¼«é•¿çš„é€‰ä¸¾æ—¶é—´å¯¼è‡´çš„æ³¨å†Œé•¿æœŸä¸å¯ç”¨æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œå¯ç”¨æ€§çš„è¦æ±‚è¦é«˜äºä¸€è‡´æ€§ï¼</p><p>åœ¨ CAP æ¨¡å‹ä¸­ï¼ŒZookeeperæ•´ä½“éµå¾ªä¸€è‡´æ€§ï¼ˆCPï¼‰åŸåˆ™ï¼Œå³åœ¨ä»»ä½•æ—¶å€™å¯¹ Zookeeper çš„è®¿é—®è¯·æ±‚èƒ½å¾—åˆ°ä¸€è‡´çš„æ•°æ®ç»“æœï¼Œä½†æ˜¯å½“æœºå™¨ä¸‹çº¿æˆ–è€…å®•æœºæ—¶ï¼Œä¸èƒ½ä¿è¯æœåŠ¡å¯ç”¨æ€§ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆZookeeperä¸ä½¿ç”¨æœ€ç»ˆä¸€è‡´æ€§ï¼ˆAPï¼‰æ¨¡å‹å‘¢ï¼Ÿå› ä¸ºè¿™ä¸ªä¾èµ–Zookeeperçš„æ ¸å¿ƒç®—æ³•æ˜¯ZABï¼Œæ‰€æœ‰è®¾è®¡éƒ½æ˜¯ä¸ºäº†å¼ºä¸€è‡´æ€§ã€‚è¿™ä¸ªå¯¹äºåˆ†å¸ƒå¼åè°ƒç³»ç»Ÿï¼Œå®Œå…¨æ²¡æœ‰æ¯›ç—…ï¼Œä½†æ˜¯ä½ å¦‚æœå°†Zookeeperä¸ºåˆ†å¸ƒå¼åè°ƒæœåŠ¡æ‰€åšçš„ä¸€è‡´æ€§ä¿éšœï¼Œç”¨åœ¨æ³¨å†Œä¸­å¿ƒï¼Œæˆ–è€…è¯´æœåŠ¡å‘ç°åœºæ™¯ï¼Œè¿™ä¸ªå…¶å®å°±ä¸åˆé€‚ã€‚</p><h3 id="2-ä»€ä¹ˆæ˜¯å¼ºã€å¼±ã€æœ€ç»ˆä¸€è‡´æ€§"><a href="#2-ä»€ä¹ˆæ˜¯å¼ºã€å¼±ã€æœ€ç»ˆä¸€è‡´æ€§" class="headerlink" title="2. ä»€ä¹ˆæ˜¯å¼ºã€å¼±ã€æœ€ç»ˆä¸€è‡´æ€§"></a>2. ä»€ä¹ˆæ˜¯å¼ºã€å¼±ã€æœ€ç»ˆä¸€è‡´æ€§</h3><h3 id="3-ZooKeeper-å¿«é€Ÿé¢†å¯¼é€‰ä¸¾æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"><a href="#3-ZooKeeper-å¿«é€Ÿé¢†å¯¼é€‰ä¸¾æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ" class="headerlink" title="3. ZooKeeper å¿«é€Ÿé¢†å¯¼é€‰ä¸¾æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"></a>3. ZooKeeper å¿«é€Ÿé¢†å¯¼é€‰ä¸¾æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h3><h3 id="4-å¦‚ä½•é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥ä¿è¯ä¸€è‡´æ€§"><a href="#4-å¦‚ä½•é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥ä¿è¯ä¸€è‡´æ€§" class="headerlink" title="4. å¦‚ä½•é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥ä¿è¯ä¸€è‡´æ€§"></a>4. å¦‚ä½•é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥ä¿è¯ä¸€è‡´æ€§</h3><h3 id="5-è§‚å¯Ÿè€…èŠ‚ç‚¹çš„ä½œç”¨"><a href="#5-è§‚å¯Ÿè€…èŠ‚ç‚¹çš„ä½œç”¨" class="headerlink" title="5. è§‚å¯Ÿè€…èŠ‚ç‚¹çš„ä½œç”¨"></a>5. è§‚å¯Ÿè€…èŠ‚ç‚¹çš„ä½œç”¨</h3><h3 id="6-ä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨å¥‡æ•°å°æœºå™¨æ¥æ„å»ºé›†ç¾¤ï¼Ÿ"><a href="#6-ä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨å¥‡æ•°å°æœºå™¨æ¥æ„å»ºé›†ç¾¤ï¼Ÿ" class="headerlink" title="6. ä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨å¥‡æ•°å°æœºå™¨æ¥æ„å»ºé›†ç¾¤ï¼Ÿ"></a>6. ä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨å¥‡æ•°å°æœºå™¨æ¥æ„å»ºé›†ç¾¤ï¼Ÿ</h3><h3 id="7-ä¸ºä»€ä¹ˆä¼šå‡ºç°è„‘è£‚é—®é¢˜ï¼Ÿ"><a href="#7-ä¸ºä»€ä¹ˆä¼šå‡ºç°è„‘è£‚é—®é¢˜ï¼Ÿ" class="headerlink" title="7. ä¸ºä»€ä¹ˆä¼šå‡ºç°è„‘è£‚é—®é¢˜ï¼Ÿ"></a>7. ä¸ºä»€ä¹ˆä¼šå‡ºç°è„‘è£‚é—®é¢˜ï¼Ÿ</h3>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GMP åŸç†ä¸è°ƒåº¦</title>
      <link href="/golang/concurrency/gmp/"/>
      <url>/golang/concurrency/gmp/</url>
      
        <content type="html"><![CDATA[<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>M(machine): ä»£è¡¨ç€çœŸæ­£çš„æ‰§è¡Œè®¡ç®—èµ„æºï¼Œå¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯os threadï¼ˆç³»ç»Ÿçº¿ç¨‹ï¼‰ã€‚<br>P(processor): è¡¨ç¤ºé€»è¾‘processorï¼Œæ˜¯çº¿ç¨‹Mçš„æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ã€‚<br>G(goroutine): è°ƒåº¦ç³»ç»Ÿçš„æœ€åŸºæœ¬å•ä½goroutineï¼Œå­˜å‚¨äº†goroutineçš„æ‰§è¡Œstackä¿¡æ¯ã€goroutineçŠ¶æ€ä»¥åŠgoroutineçš„ä»»åŠ¡å‡½æ•°ç­‰ã€‚</p><h1 id="1-GMP-åŸç†ä¸è°ƒåº¦"><a href="#1-GMP-åŸç†ä¸è°ƒåº¦" class="headerlink" title="1. GMP åŸç†ä¸è°ƒåº¦"></a>1. GMP åŸç†ä¸è°ƒåº¦</h1><h3 id="1-1-1-ä¸€ã€Golang-â€œè°ƒåº¦å™¨â€-çš„ç”±æ¥ï¼Ÿ"><a href="#1-1-1-ä¸€ã€Golang-â€œè°ƒåº¦å™¨â€-çš„ç”±æ¥ï¼Ÿ" class="headerlink" title="1.1.1 ä¸€ã€Golang â€œè°ƒåº¦å™¨â€ çš„ç”±æ¥ï¼Ÿ"></a>1.1.1 ä¸€ã€Golang â€œè°ƒåº¦å™¨â€ çš„ç”±æ¥ï¼Ÿ</h3><h4 id="1-å•è¿›ç¨‹æ—¶ä»£ä¸éœ€è¦è°ƒåº¦å™¨"><a href="#1-å•è¿›ç¨‹æ—¶ä»£ä¸éœ€è¦è°ƒåº¦å™¨" class="headerlink" title="(1) å•è¿›ç¨‹æ—¶ä»£ä¸éœ€è¦è°ƒåº¦å™¨"></a>(1) å•è¿›ç¨‹æ—¶ä»£ä¸éœ€è¦è°ƒåº¦å™¨</h4><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€åˆ‡çš„è½¯ä»¶éƒ½æ˜¯è·‘åœ¨æ“ä½œç³»ç»Ÿä¸Šï¼ŒçœŸæ­£ç”¨æ¥å¹²æ´» (è®¡ç®—) çš„æ˜¯ CPUã€‚æ—©æœŸçš„æ“ä½œç³»ç»Ÿæ¯ä¸ªç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ŒçŸ¥é“ä¸€ä¸ªç¨‹åºè¿è¡Œå®Œï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼Œå°±æ˜¯ â€œå•è¿›ç¨‹æ—¶ä»£â€<br>ä¸€åˆ‡çš„ç¨‹åºåªèƒ½ä¸²è¡Œå‘ç”Ÿã€‚<br>æ—©æœŸçš„å•è¿›ç¨‹æ“ä½œç³»ç»Ÿï¼Œé¢ä¸´ 2 ä¸ªé—®é¢˜ï¼š</p><ol><li><p>å•ä¸€çš„æ‰§è¡Œæµç¨‹ï¼Œè®¡ç®—æœºåªèƒ½ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡å¤„ç†ã€‚</p></li><li><p>è¿›ç¨‹é˜»å¡æ‰€å¸¦æ¥çš„ CPU æ—¶é—´æµªè´¹ã€‚</p></li></ol><p>é‚£ä¹ˆèƒ½ä¸èƒ½æœ‰å¤šä¸ªè¿›ç¨‹æ¥å®è§‚ä¸€èµ·æ¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡å‘¢ï¼Ÿ</p><p>åæ¥æ“ä½œç³»ç»Ÿå°±å…·æœ‰äº†æœ€æ—©çš„å¹¶å‘èƒ½åŠ›ï¼šå¤šè¿›ç¨‹å¹¶å‘ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹é˜»å¡çš„æ—¶å€™ï¼Œåˆ‡æ¢åˆ°å¦å¤–ç­‰å¾…æ‰§è¡Œçš„è¿›ç¨‹ï¼Œè¿™æ ·å°±èƒ½å°½é‡æŠŠ CPU åˆ©ç”¨èµ·æ¥ï¼ŒCPU å°±ä¸æµªè´¹äº†ã€‚</p><h4 id="2-å¤šè¿›ç¨‹-x2F-çº¿ç¨‹æ—¶ä»£æœ‰äº†è°ƒåº¦å™¨éœ€æ±‚"><a href="#2-å¤šè¿›ç¨‹-x2F-çº¿ç¨‹æ—¶ä»£æœ‰äº†è°ƒåº¦å™¨éœ€æ±‚" class="headerlink" title="(2) å¤šè¿›ç¨‹ &#x2F; çº¿ç¨‹æ—¶ä»£æœ‰äº†è°ƒåº¦å™¨éœ€æ±‚"></a>(2) å¤šè¿›ç¨‹ &#x2F; çº¿ç¨‹æ—¶ä»£æœ‰äº†è°ƒåº¦å™¨éœ€æ±‚</h4><p><img src="https://s3.bmp.ovh/imgs/2022/02/921c521bed752387.jpg" alt="image"><br>åœ¨å¤šè¿›ç¨‹ &#x2F; å¤šçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå°±è§£å†³äº†é˜»å¡çš„é—®é¢˜ï¼Œå› ä¸ºä¸€ä¸ªè¿›ç¨‹é˜»å¡ cpu å¯ä»¥ç«‹åˆ»åˆ‡æ¢åˆ°å…¶ä»–è¿›ç¨‹ä¸­å»æ‰§è¡Œï¼Œè€Œä¸”è°ƒåº¦ cpu çš„ç®—æ³•å¯ä»¥ä¿è¯åœ¨è¿è¡Œçš„è¿›ç¨‹éƒ½å¯ä»¥è¢«åˆ†é…åˆ° cpu çš„è¿è¡Œæ—¶é—´ç‰‡ã€‚è¿™æ ·ä»å®è§‚æ¥çœ‹ï¼Œä¼¼ä¹å¤šä¸ªè¿›ç¨‹æ˜¯åœ¨åŒæ—¶è¢«è¿è¡Œã€‚</p><p>ä½†æ–°çš„é—®é¢˜å°±åˆå‡ºç°äº†ï¼Œè¿›ç¨‹æ‹¥æœ‰å¤ªå¤šçš„èµ„æºï¼Œè¿›ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ã€é”€æ¯ï¼Œéƒ½ä¼šå ç”¨å¾ˆé•¿çš„æ—¶é—´ï¼ŒCPU è™½ç„¶åˆ©ç”¨èµ·æ¥äº†ï¼Œä½†å¦‚æœè¿›ç¨‹è¿‡å¤šï¼ŒCPU æœ‰å¾ˆå¤§çš„ä¸€éƒ¨åˆ†éƒ½è¢«ç”¨æ¥è¿›è¡Œè¿›ç¨‹è°ƒåº¦äº†ã€‚</p><p>æ€ä¹ˆæ‰èƒ½æé«˜ CPU çš„åˆ©ç”¨ç‡å‘¢ï¼Ÿ</p><p>ä½†æ˜¯å¯¹äº Linux æ“ä½œç³»ç»Ÿæ¥è®²ï¼Œcpu å¯¹è¿›ç¨‹çš„æ€åº¦å’Œçº¿ç¨‹çš„æ€åº¦æ˜¯ä¸€æ ·çš„ã€‚<br><img src="https://s3.bmp.ovh/imgs/2022/02/bad5998d362c5be9.jpg" alt="image"></p><p>æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸Šï¼ŒçœŸæ­£ç”¨æ¥å¹²æ´»(è®¡ç®—)çš„æ˜¯<code>CPU</code>ã€‚æ‰€ä»¥è°ˆåˆ°<code>Go</code>è¯­è¨€è°ƒåº¦å™¨ï¼Œæˆ‘ä»¬ä¹Ÿç»•ä¸å¼€æ“ä½œç³»ç»Ÿã€è¿›ç¨‹ä¸çº¿ç¨‹è¿™äº›æ¦‚å¿µã€‚çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦æ—¶çš„æœ€åŸºæœ¬å•å…ƒï¼Œè€Œ Linux åœ¨è°ƒåº¦å™¨å¹¶ä¸åŒºåˆ†è¿›ç¨‹å’Œçº¿ç¨‹çš„è°ƒåº¦ï¼Œå®ƒä»¬åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šä¹Ÿæœ‰ä¸åŒçš„å®ç°ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°çš„å®ç°ä¸­çº¿ç¨‹éƒ½å±äºè¿›ç¨‹ã€‚</p><p>å¤šä¸ªçº¿ç¨‹å¯ä»¥å±äºåŒä¸€ä¸ªè¿›ç¨‹å¹¶å…±äº«å†…å­˜ç©ºé—´ã€‚å› ä¸ºå¤šçº¿ç¨‹ä¸éœ€è¦åˆ›å»ºæ–°çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿä¸éœ€è¦å†…å­˜ç®¡ç†å•å…ƒå¤„ç†ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ï¼Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ä¹Ÿæ­£æ˜¯åŸºäºå…±äº«çš„å†…å­˜è¿›è¡Œçš„ï¼Œä¸é‡é‡çº§çš„è¿›ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹æ˜¾å¾—æ¯”è¾ƒè½»é‡ã€‚</p><p>è™½ç„¶çº¿ç¨‹æ¯”è¾ƒè½»é‡ï¼Œä½†æ˜¯åœ¨è°ƒåº¦æ—¶ä¹Ÿæœ‰æ¯”è¾ƒå¤§çš„é¢å¤–å¼€é”€ã€‚æ¯ä¸ªçº¿ç¨‹ä¼šéƒ½å ç”¨ 1 å…†ä»¥ä¸Šçš„å†…å­˜ç©ºé—´ï¼Œåœ¨å¯¹çº¿ç¨‹è¿›è¡Œåˆ‡æ¢æ—¶ä¸æ­¢ä¼šæ¶ˆè€—è¾ƒå¤šçš„å†…å­˜ï¼Œæ¢å¤å¯„å­˜å™¨ä¸­çš„å†…å®¹è¿˜éœ€è¦å‘æ“ä½œç³»ç»Ÿç”³è¯·æˆ–è€…é”€æ¯å¯¹åº”çš„èµ„æºã€‚</p><p>å¤§é‡çš„çº¿ç¨‹å‡ºç°äº†æ–°çš„é—®é¢˜</p><ul><li><p>é«˜å†…å­˜å ç”¨</p></li><li><p>è°ƒåº¦çš„CPUé«˜æ¶ˆè€—</p></li></ul><p>ç„¶åå·¥ç¨‹å¸ˆä»¬å°±å‘ç°ï¼Œå…¶å®ä¸€ä¸ªçº¿ç¨‹åˆ†ä¸ºâ€å†…æ ¸æ€â€çº¿ç¨‹å’Œâ€ç”¨æˆ·æ€â€çº¿ç¨‹ã€‚</p><p>ä¸€ä¸ª<code>ç”¨æˆ·æ€çº¿ç¨‹</code>å¿…é¡»è¦ç»‘å®šä¸€ä¸ª<code>å†…æ ¸æ€çº¿ç¨‹</code>ï¼Œä½†æ˜¯CPUå¹¶ä¸çŸ¥é“æœ‰<code>ç”¨æˆ·æ€çº¿ç¨‹</code>çš„å­˜åœ¨ï¼Œå®ƒåªçŸ¥é“å®ƒè¿è¡Œçš„æ˜¯ä¸€ä¸ª<code>å†…æ ¸æ€çº¿ç¨‹</code>(Linuxçš„PCBè¿›ç¨‹æ§åˆ¶å—)ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å†å»ç»†åŒ–åˆ†ç±»ï¼Œå†…æ ¸çº¿ç¨‹ä¾ç„¶å«çº¿ç¨‹(thread)ï¼Œç”¨æˆ·çº¿ç¨‹å«åç¨‹(co-routine)ã€‚æ—¢ç„¶ä¸€ä¸ªåç¨‹å¯ä»¥ç»‘å®šä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡å®ç°åç¨‹è°ƒåº¦å™¨æŠŠå¤šä¸ªåç¨‹ä¸ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹è¿›è¡Œç»‘å®šã€‚</p><p><code>Go</code>è¯­è¨€çš„<code>goroutine</code>æ¥è‡ªåç¨‹çš„æ¦‚å¿µï¼Œè®©ä¸€ç»„å¯å¤ç”¨çš„å‡½æ•°è¿è¡Œåœ¨ä¸€ç»„çº¿ç¨‹ä¹‹ä¸Šï¼Œå³ä½¿æœ‰åç¨‹é˜»å¡ï¼Œè¯¥çº¿ç¨‹çš„å…¶ä»–åç¨‹ä¹Ÿå¯ä»¥è¢«<code>runtime</code>è°ƒåº¦ï¼Œè½¬ç§»åˆ°å…¶ä»–å¯è¿è¡Œçš„çº¿ç¨‹ä¸Šã€‚æœ€å…³é”®çš„æ˜¯ï¼Œç¨‹åºå‘˜çœ‹ä¸åˆ°è¿™äº›åº•å±‚çš„ç»†èŠ‚ï¼Œè¿™å°±é™ä½äº†ç¼–ç¨‹çš„éš¾åº¦ï¼Œæä¾›äº†æ›´å®¹æ˜“çš„å¹¶å‘ã€‚</p><p><code>Go</code>ä¸­ï¼Œåç¨‹è¢«ç§°ä¸º<code>goroutine</code>ï¼Œå®ƒéå¸¸è½»é‡ï¼Œä¸€ä¸ª<code>goroutine</code>åªå å‡ KBï¼Œå¹¶ä¸”è¿™å‡ KBå°±è¶³å¤Ÿ<code>goroutine</code>è¿è¡Œå®Œï¼Œè¿™å°±èƒ½åœ¨æœ‰é™çš„å†…å­˜ç©ºé—´å†…æ”¯æŒå¤§é‡<code>goroutine</code>ï¼Œæ”¯æŒäº†æ›´å¤šçš„å¹¶å‘ã€‚è™½ç„¶ä¸€ä¸ª<code>goroutine</code>çš„æ ˆåªå å‡ KBï¼Œä½†å®é™…æ˜¯å¯ä¼¸ç¼©çš„ï¼Œå¦‚æœéœ€è¦æ›´å¤šå†…å­˜ï¼Œ<code>runtime</code>ä¼šè‡ªåŠ¨ä¸º<code>goroutine</code>åˆ†é…ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†<code>goroutine</code>å’Œç³»ç»Ÿçº¿ç¨‹çš„å…³ç³»ï¼Œé‚£ä¹ˆæœ€å…³é”®çš„ä¸€ç‚¹å°±æ˜¯å®ç°åç¨‹è°ƒåº¦å™¨äº†ã€‚</p><p><code>Go</code>ç›®å‰ä½¿ç”¨çš„è°ƒåº¦å™¨æ˜¯2012å¹´é‡æ–°è®¾è®¡çš„ï¼Œå› ä¸ºä¹‹å‰çš„è°ƒåº¦å™¨æ€§èƒ½å­˜åœ¨é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨4å¹´å°±è¢«åºŸå¼ƒäº†ã€‚é‡æ–°è®¾è®¡çš„è°ƒåº¦å™¨ä½¿ç”¨<code>G-M-P</code>æ¨¡å‹å¹¶ä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/z4pQ0O5h0f68Yc2PzBpdRSf4iaE1bicpADBkw9ITic8G4yctoweOep4Yc0fQKlkHeWkUIsUatove0g7AFsIAw22tA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡" title="è°ƒåº¦å™¨G-M-Pæ¨¡å‹"></p><p>è°ƒåº¦å™¨G-M-Pæ¨¡å‹</p><ul><li><p>G â€” è¡¨ç¤º goroutineï¼Œå®ƒæ˜¯ä¸€ä¸ªå¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼›</p></li><li><p>M â€” è¡¨ç¤ºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ï¼Œå®ƒç”±æ“ä½œç³»ç»Ÿçš„è°ƒåº¦å™¨è°ƒåº¦å’Œç®¡ç†ï¼›</p></li><li><p>P â€” è¡¨ç¤ºå¤„ç†å™¨ï¼Œå®ƒå¯ä»¥è¢«çœ‹åšè¿è¡Œåœ¨çº¿ç¨‹ä¸Šçš„æœ¬åœ°è°ƒåº¦å™¨ï¼›</p></li></ul><h3 id="G"><a href="#G" class="headerlink" title="G"></a>G</h3><p><code>gorotuine</code>Â å°±æ˜¯<code>Go</code>è¯­è¨€è°ƒåº¦å™¨ä¸­å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå®ƒåœ¨è¿è¡Œæ—¶è°ƒåº¦å™¨ä¸­çš„åœ°ä½ä¸çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿä¸­å·®ä¸å¤šï¼Œä½†æ˜¯å®ƒå ç”¨äº†æ›´å°çš„å†…å­˜ç©ºé—´ï¼Œä¹Ÿé™ä½äº†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚</p><p><code>goroutine</code>åªå­˜åœ¨äº<code>Go</code>è¯­è¨€çš„è¿è¡Œæ—¶ï¼Œå®ƒæ˜¯<code>Go</code>è¯­è¨€åœ¨ç”¨æˆ·æ€æä¾›çš„çº¿ç¨‹ï¼Œä½œä¸ºä¸€ç§ç²’åº¦æ›´ç»†çš„èµ„æºè°ƒåº¦å•å…ƒï¼Œå¦‚æœä½¿ç”¨å¾—å½“èƒ½å¤Ÿåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹æ›´é«˜æ•ˆåœ°åˆ©ç”¨æœºå™¨çš„<code>CPU</code>ã€‚</p><h3 id="M"><a href="#M" class="headerlink" title="M"></a>M</h3><p><code>Go</code>è¯­è¨€å¹¶å‘æ¨¡å‹ä¸­çš„<code>M</code>æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚è°ƒåº¦å™¨æœ€å¤šå¯ä»¥åˆ›å»º 10000 ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯å…¶ä¸­å¤§å¤šæ•°çš„çº¿ç¨‹éƒ½ä¸ä¼šæ‰§è¡Œç”¨æˆ·ä»£ç ï¼ˆå¯èƒ½é™·å…¥ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œæœ€å¤šåªä¼šæœ‰Â <code>GOMAXPROCS</code>Â ä¸ªæ´»è·ƒçº¿ç¨‹èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿è¡Œæ—¶ä¼šå°†Â <code>GOMAXPROCS</code>Â è®¾ç½®æˆå½“å‰æœºå™¨çš„æ ¸æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Â <code>runtime.GOMAXPROCS</code>Â æ¥æ”¹å˜ç¨‹åºä¸­æœ€å¤§çš„çº¿ç¨‹æ•°ã€‚ä¸€ä¸ªå››æ ¸æœºå™¨ä¸Šä¼šåˆ›å»ºå››ä¸ªæ´»è·ƒçš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯¹åº”ä¸€ä¸ªè¿è¡Œæ—¶ä¸­çš„Â <code>runtime.m</code>Â ç»“æ„ä½“ã€‚</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨<code>Go</code>çš„é»˜è®¤è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯æ´»è·ƒçº¿ç¨‹æ•°ç­‰äº<code>CPU</code>ä¸ªæ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ä¼šè§¦å‘æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ‰€æœ‰çš„è°ƒåº¦éƒ½ä¼šå‘ç”Ÿåœ¨ç”¨æˆ·æ€ï¼Œç”±<code>Go</code>è¯­è¨€è°ƒåº¦å™¨è§¦å‘ï¼Œèƒ½å¤Ÿå‡å°‘éå¸¸å¤šçš„é¢å¤–å¼€é”€ã€‚</p><p>æ“ä½œç³»ç»Ÿçº¿ç¨‹åœ¨<code>Go</code>è¯­è¨€ä¸­ä¼šä½¿ç”¨ç§æœ‰ç»“æ„ä½“Â <code>runtime.m</code>Â æ¥è¡¨ç¤º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeÂ mÂ structÂ &#123;Â Â Â Â g0Â Â Â *gÂ Â Â Â Â curgÂ *gÂ Â Â Â ...&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>g0</code>æ˜¯æŒæœ‰è°ƒåº¦æ ˆçš„<code>goroutine</code>ï¼Œ<code>curg</code>Â æ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸Šè¿è¡Œçš„ç”¨æˆ·<code>goroutine</code>ï¼Œç”¨æˆ·<code>goroutine</code>æ‰§è¡Œå®Œåï¼Œçº¿ç¨‹åˆ‡æ¢å›<code>g0</code>ä¸Šï¼Œ<code>g0</code>ä¼šä»çº¿ç¨‹<code>M</code>ç»‘å®šçš„<code>P</code>ä¸Šçš„ç­‰å¾…é˜Ÿåˆ—ä¸­è·å–<code>goroutine</code>äº¤ç»™çº¿ç¨‹ã€‚</p><h3 id="P"><a href="#P" class="headerlink" title="P"></a>P</h3><p>è°ƒåº¦å™¨ä¸­çš„å¤„ç†å™¨<code>P</code>æ˜¯çº¿ç¨‹å’Œ<code>goroutine</code>Â çš„ä¸­é—´å±‚ï¼Œå®ƒèƒ½æä¾›çº¿ç¨‹éœ€è¦çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¹Ÿä¼šè´Ÿè´£è°ƒåº¦çº¿ç¨‹ä¸Šçš„ç­‰å¾…é˜Ÿåˆ—ï¼Œé€šè¿‡å¤„ç†å™¨<code>P</code>çš„è°ƒåº¦ï¼Œæ¯ä¸€ä¸ªå†…æ ¸çº¿ç¨‹éƒ½èƒ½å¤Ÿæ‰§è¡Œå¤šä¸ªÂ <code>goroutine</code>ï¼Œå®ƒèƒ½åœ¨<code>goroutine</code>Â è¿›è¡Œä¸€äº›Â <code>I/O</code>Â æ“ä½œæ—¶åŠæ—¶åˆ‡æ¢ï¼Œæé«˜çº¿ç¨‹çš„åˆ©ç”¨ç‡ã€‚å› ä¸ºè°ƒåº¦å™¨åœ¨å¯åŠ¨æ—¶å°±ä¼šåˆ›å»ºÂ <code>GOMAXPROCS</code>Â ä¸ªå¤„ç†å™¨ï¼Œæ‰€ä»¥<code>Go</code>è¯­è¨€ç¨‹åºçš„å¤„ç†å™¨æ•°é‡ä¸€å®šä¼šç­‰äºÂ <code>GOMAXPROCS</code>ï¼Œè¿™äº›å¤„ç†å™¨ä¼šç»‘å®šåˆ°ä¸åŒçš„å†…æ ¸çº¿ç¨‹ä¸Šå¹¶åˆ©ç”¨çº¿ç¨‹çš„è®¡ç®—èµ„æºè¿è¡Œ<code>goroutine</code>ã€‚</p><p>æ­¤å¤–åœ¨è°ƒåº¦å™¨é‡Œè¿˜æœ‰ä¸€ä¸ªå…¨å±€ç­‰å¾…é˜Ÿåˆ—ï¼Œå½“æ‰€æœ‰Pæœ¬åœ°çš„ç­‰å¾…é˜Ÿåˆ—è¢«å æ»¡åï¼Œæ–°åˆ›å»ºçš„<code>goroutine</code>ä¼šè¿›å…¥å…¨å±€ç­‰å¾…é˜Ÿåˆ—ã€‚<code>P</code>çš„æœ¬åœ°é˜Ÿåˆ—ä¸ºç©ºåï¼Œ<code>M</code>ä¹Ÿä¼šä»å…¨å±€é˜Ÿåˆ—ä¸­æ‹¿ä¸€æ‰¹å¾…æ‰§è¡Œçš„<code>goroutine</code>æ”¾åˆ°<code>P</code>æœ¬åœ°çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p><h3 id="GMPæ¨¡å‹å›¾ç¤º"><a href="#GMPæ¨¡å‹å›¾ç¤º" class="headerlink" title="GMPæ¨¡å‹å›¾ç¤º"></a>GMPæ¨¡å‹å›¾ç¤º</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/z4pQ0O5h0f68Yc2PzBpdRSf4iaE1bicpADicd9ka0ILRcZEob1gRNjuXgu6ic2dBysv5VeibYUUTru76UmRiaFrOmdtg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡" title="GMPæ¨¡å‹å›¾ç¤º"></p><p>GMPæ¨¡å‹å›¾ç¤º</p><ul><li><p>å…¨å±€é˜Ÿåˆ—ï¼šå­˜æ”¾ç­‰å¾…è¿è¡Œçš„Gã€‚</p></li><li><p>Pçš„æœ¬åœ°é˜Ÿåˆ—ï¼šåŒå…¨å±€é˜Ÿåˆ—ç±»ä¼¼ï¼Œå­˜æ”¾çš„ä¹Ÿæ˜¯ç­‰å¾…è¿è¡Œçš„Gï¼Œå­˜çš„æ•°é‡æœ‰é™ï¼Œä¸è¶…è¿‡256ä¸ªã€‚æ–°å»ºGæ—¶ï¼ŒGä¼˜å…ˆåŠ å…¥åˆ°Pçš„æœ¬åœ°é˜Ÿåˆ—ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™ä¼šæŠŠæœ¬åœ°é˜Ÿåˆ—ä¸­ä¸€åŠçš„Gç§»åŠ¨åˆ°å…¨å±€é˜Ÿåˆ—ã€‚</p></li><li><p>Påˆ—è¡¨ï¼šæ‰€æœ‰çš„Péƒ½åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºï¼Œå¹¶ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œæœ€å¤šæœ‰GOMAXPROCS(å¯é…ç½®)ä¸ªã€‚</p></li><li><p>Mï¼šçº¿ç¨‹æƒ³è¿è¡Œä»»åŠ¡å°±å¾—è·å–Pï¼Œä»Pçš„æœ¬åœ°é˜Ÿåˆ—è·å–Gï¼ŒPé˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼ŒMä¹Ÿä¼šå°è¯•ä»å…¨å±€é˜Ÿåˆ—æ‹¿ä¸€æ‰¹Gæ”¾åˆ°Pçš„æœ¬åœ°é˜Ÿåˆ—ï¼Œæˆ–ä»å…¶ä»–Pçš„æœ¬åœ°é˜Ÿåˆ—å·ä¸€åŠæ”¾åˆ°è‡ªå·±Pçš„æœ¬åœ°é˜Ÿåˆ—ã€‚Mè¿è¡ŒGï¼ŒGæ‰§è¡Œä¹‹åï¼ŒMä¼šä»Pè·å–ä¸‹ä¸€ä¸ªGï¼Œä¸æ–­é‡å¤ä¸‹å»ã€‚</p></li><li><p><code>goroutine</code>è°ƒåº¦å™¨å’ŒOSè°ƒåº¦å™¨æ˜¯é€šè¿‡Mç»“åˆèµ·æ¥çš„ï¼Œæ¯ä¸ªMéƒ½ä»£è¡¨äº†1ä¸ªå†…æ ¸çº¿ç¨‹ï¼ŒOSè°ƒåº¦å™¨è´Ÿè´£æŠŠå†…æ ¸çº¿ç¨‹åˆ†é…åˆ°CPUä¸Šæ‰§è¡Œã€‚</p></li></ul><h3 id="è°ƒåº¦å™¨çš„ç­–ç•¥"><a href="#è°ƒåº¦å™¨çš„ç­–ç•¥" class="headerlink" title="è°ƒåº¦å™¨çš„ç­–ç•¥"></a>è°ƒåº¦å™¨çš„ç­–ç•¥</h3><p>è°ƒåº¦å™¨çš„ä¸€ä¸ªç­–ç•¥æ˜¯å°½å¯èƒ½çš„å¤ç”¨ç°æœ‰çš„æ´»è·ƒçº¿ç¨‹ï¼Œé€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæœºåˆ¶æé«˜çº¿ç¨‹çš„å¤ç”¨ï¼š</p><ol><li><p>work stealingæœºåˆ¶ï¼Œå½“æœ¬çº¿ç¨‹æ— å¯è¿è¡Œçš„Gæ—¶ï¼Œå°è¯•ä»å…¶ä»–çº¿ç¨‹ç»‘å®šçš„På·å–Gï¼Œè€Œä¸æ˜¯é”€æ¯çº¿ç¨‹ã€‚</p></li><li><p>hand offæœºåˆ¶ï¼Œå½“æœ¬çº¿ç¨‹å› ä¸ºGè¿›è¡Œç³»ç»Ÿè°ƒç”¨é˜»å¡æ—¶ï¼Œçº¿ç¨‹é‡Šæ”¾ç»‘å®šçš„Pï¼ŒæŠŠPè½¬ç§»ç»™å…¶ä»–ç©ºé—²çš„çº¿ç¨‹æ‰§è¡Œã€‚</p></li></ol><p><code>Go</code>çš„è¿è¡Œæ—¶å¹¶ä¸å…·å¤‡æ“ä½œç³»ç»Ÿå†…æ ¸çº§çš„ç¡¬ä»¶ä¸­æ–­èƒ½åŠ›ï¼ŒåŸºäºå·¥ä½œçªƒå–çš„è°ƒåº¦å™¨å®ç°ï¼Œæœ¬è´¨ä¸Šå±äºå…ˆæ¥å…ˆæœåŠ¡çš„åä½œå¼è°ƒåº¦ï¼Œä¸ºäº†è§£å†³å“åº”æ—¶é—´å¯èƒ½è¾ƒé«˜çš„é—®é¢˜ï¼Œç›®å‰è¿è¡Œæ—¶å®ç°äº†åä½œå¼è°ƒåº¦å’ŒæŠ¢å å¼è°ƒåº¦ä¸¤ç§ä¸åŒçš„è°ƒåº¦ç­–ç•¥ï¼Œä¿è¯åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸åŒçš„ G èƒ½å¤Ÿè·å¾—å‡åŒ€çš„<code>CPU</code>æ—¶é—´ç‰‡ã€‚</p><p>åä½œå¼è°ƒåº¦ä¾é è¢«è°ƒåº¦æ–¹ä¸»åŠ¨å¼ƒæƒï¼Œç³»ç»Ÿç›‘æ§åˆ°ä¸€ä¸ª<code>goroutine</code>è¿è¡Œè¶…è¿‡10msä¼šé€šè¿‡Â <code>runtime.Gosched</code>Â è°ƒç”¨ä¸»åŠ¨è®©å‡ºæ‰§è¡Œæœºä¼šã€‚æŠ¢å å¼è°ƒåº¦åˆ™ä¾é è°ƒåº¦å™¨å¼ºåˆ¶å°†è¢«è°ƒåº¦æ–¹è¢«åŠ¨ä¸­æ–­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> å¹¶å‘ </tag>
            
            <tag> GMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>go-mutex</title>
      <link href="/golang/concurrency/go-mutex/"/>
      <url>/golang/concurrency/go-mutex/</url>
      
        <content type="html"><![CDATA[<h3 id="locké€»è¾‘ï¼š"><a href="#locké€»è¾‘ï¼š" class="headerlink" title="locké€»è¾‘ï¼š"></a>locké€»è¾‘ï¼š</h3><ol><li>ç¬¬ä¸€æ¬¡ä¸Šé”çš„æ—¶å€™ï¼Œç›´æ¥èµ°ç¬¬ä¸€æ­¥<strong>CAS</strong>ä¸Šé”ï¼ŒæˆåŠŸè¿”å›</li><li><strong>Mutex</strong>å·²ç»è¢«å¦ä¸€ä¸ª<strong>g</strong>ä¸Šé”ï¼Œé‚£ä¹ˆ<strong>state</strong>çš„<strong>g</strong>ç­‰å¾…æ•°+1ï¼Œæ›´æ–°å½“å‰çš„é”çŠ¶æ€ï¼Œç„¶åå°±è¿›å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼Œç­‰åˆ°å¦ä¸ª<strong>g</strong>è°ƒç”¨äº†<strong>Unlock</strong>æ–¹æ³•ä¹‹åï¼Œå½“å‰<strong>g</strong>è¢«å”¤é†’ï¼Œç„¶åè®¾ç½®<strong>awoken&#x3D;true</strong>ï¼Œå†æ‰§è¡Œä¸€é<strong>for</strong>å¾ªç¯ï¼Œæ­¤æ—¶<strong>locked</strong>ä½å°±æ˜¯æœªä¸Šé”çŠ¶æ€ï¼ˆ0ï¼‰ï¼Œ<strong>new</strong>å°±æ˜¯ä»£è¡¨ä¸Šé”ï¼Œç„¶åæ¸…é™¤<strong>woken</strong>ä½ï¼Œç„¶åå†<strong>CAS</strong>æ›´æ–°<strong>new</strong>åˆ°<strong>state</strong>ä¸Šï¼Œå› ä¸ºä¹‹å‰çš„é”æ˜¯æœªä¸Šé”çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä»£è¡¨æŠ¢é”æˆåŠŸï¼Œ<strong>break</strong>ï¼Œè¿”å›</li><li>å’Œç¬¬äºŒç§ä¸€æ ·ï¼Œåªä¸è¿‡ï¼Œåœ¨<strong>CAS</strong>æ›´æ–°<strong>new</strong>åˆ°<strong>state</strong>ä¸Šæ—¶ï¼Œæœ‰å…¶ä»–<strong>g</strong>å…ˆæ”¹æ‰äº†<strong>state</strong>çš„å€¼ï¼Œé‚£ä¹ˆå°±ç»§ç»­forå¾ªç¯ï¼Œç„¶åé‡å¤åˆ°ç¬¬äºŒç§æƒ…å†µã€‚</li></ol><h3 id="è‡ªæ—‹é”ï¼š"><a href="#è‡ªæ—‹é”ï¼š" class="headerlink" title="è‡ªæ—‹é”ï¼š"></a>è‡ªæ—‹é”ï¼š</h3><p>ç®€å•æ¦‚æ‹¬ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³é”ç²’åº¦éå¸¸å°çš„æ—¶å€™ï¼Œç»™ç³»ç»Ÿå¸¦æ¥çš„ä¸å¿…è¦çš„è°ƒåº¦å¼€é”€<br>ä¸è¿‡è‡ªæ—‹è¦å…ˆæ»¡è¶³å‡ ä¸ªæ¡ä»¶<br>é¦–å…ˆç¨‹åºè¦è·‘åœ¨å¤šæ ¸çš„æœºå™¨ä¸Šï¼Œç„¶åGOMAXPROCSè¦å¤§äº1ï¼Œå¹¶ä¸”æ­¤æ—¶æœ‰è‡³å°‘ä¸€ä¸ªPçš„local runqæ˜¯ç©ºçš„ï¼Œæ‰èƒ½è¿›å…¥åˆ°è‡ªæ—‹çš„çŠ¶æ€</p><p>è‡ªæ—‹æ˜¯ä¸€ç§å¤šçº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œå½“å‰çš„è¿›ç¨‹åœ¨è¿›å…¥è‡ªæ—‹çš„è¿‡ç¨‹ä¸­ä¼šä¸€ç›´ä¿æŒ CPU çš„å ç”¨ï¼ŒæŒç»­æ£€æŸ¥æŸä¸ªæ¡ä»¶æ˜¯å¦ä¸ºçœŸã€‚åœ¨å¤šæ ¸çš„ CPU ä¸Šï¼Œè‡ªæ—‹å¯ä»¥é¿å… Goroutine çš„åˆ‡æ¢ï¼Œä½¿ç”¨æ°å½“ä¼šå¯¹æ€§èƒ½å¸¦æ¥å¾ˆå¤§çš„å¢ç›Šï¼Œä½†æ˜¯ä½¿ç”¨çš„ä¸æ°å½“å°±ä¼šæ‹–æ…¢æ•´ä¸ªç¨‹åºï¼Œæ‰€ä»¥ Goroutine è¿›å…¥è‡ªæ—‹çš„æ¡ä»¶éå¸¸è‹›åˆ»</p><p>å½“<strong>Mutex</strong>å·²ç»ä¸Šé”çš„æ—¶å€™ï¼Œå½“å‰<strong>G</strong>åœ¨æ»¡è¶³è‡ªæ—‹æ¡ä»¶ä¸‹ï¼Œè¿›å…¥è‡ªæ—‹çŠ¶æ€ï¼Œåœ¨è‡ªæ—‹ä¸­ï¼Œå…¶ä»–<strong>G</strong>è§£é”äº†<strong>Mutex</strong>ï¼Œé‚£ä¹ˆå½“å‰<strong>G</strong>å°±è®¾ç½®äº†<strong>woken</strong>æ ‡è®°ä½ï¼Œè¿™æ ·å…¶ä»–<strong>G</strong>åœ¨<strong>Unlock</strong>çš„æ—¶å€™å°±ä¸ä¼šå»ç­‰å¾…é˜Ÿåˆ—é‡Œé¢å”¤é†’<strong>G</strong>äº†ï¼Œç„¶åå½“å‰<strong>G</strong>å°±é¡ºç†æˆç« çš„æŠ¢åˆ°äº†é”</p><p>è¿™æ ·è‡ªæ—‹é”åœ¨é”ç²’åº¦éå¸¸å°çš„åœºæ™¯ä¸‹çš„èƒ½å¯¹å…¶æ€§èƒ½å¸¦æ¥ä¸€å®šçš„ä¼˜åŒ–ã€‚</p><p>å¼•å…¥è‡ªæ—‹é”ä¹‹åï¼Œåˆå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ã€‚å°±æ˜¯<strong>G</strong>ç­‰å¾…é˜Ÿåˆ—çš„<strong>é•¿å°¾é—®é¢˜</strong>ã€‚å› ä¸ºä»ç­‰å¾…é˜Ÿåˆ—é‡Œé¢è¢«å”¤é†’ï¼Œç„¶åå†å»æŠ¢é”ï¼Œå¯¹æœ¬èº«å°±åœ¨æ‰§è¡Œçš„<strong>G</strong>æ¥è¯´ï¼Œè¢«å”¤é†’çš„<strong>G</strong>å…¶å®æ˜¯å¾ˆéš¾æŠ¢è¿‡å½“å‰æ‰§è¡Œçš„<strong>G</strong>çš„ï¼Œè¿™æ ·çš„è¯ï¼Œç­‰å¾…é˜Ÿåˆ—é‡Œé¢çš„<strong>G</strong>ï¼Œå°±ä¼šè¢«é¥¿æ­»(é•¿æ—¶é—´è·å–ä¸åˆ°é”)ï¼Œè¿™æ ·å¯¹ç­‰å¾…é˜Ÿåˆ—çš„<strong>G</strong>æ¥è¯´å…¶å®æ˜¯ä¸å…¬å¹³çš„ã€‚</p><h3 id="é¥¥é¥¿æ¨¡å¼"><a href="#é¥¥é¥¿æ¨¡å¼" class="headerlink" title="é¥¥é¥¿æ¨¡å¼"></a>é¥¥é¥¿æ¨¡å¼</h3><p>ç®€å•æ¦‚æ‹¬ä¸€ä¸‹ï¼Œå°±æ˜¯è§£å†³äº†ç­‰å¾…Gé˜Ÿåˆ—çš„é•¿å°¾é—®é¢˜<br>é¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œç›´æ¥ç”±unlockæŠŠé”äº¤ç»™ç­‰å¾…é˜Ÿåˆ—ä¸­æ’åœ¨ç¬¬ä¸€ä½çš„Gï¼ŒåŒæ—¶ï¼Œé¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œæ–°è¿›æ¥çš„Gä¸ä¼šå‚ä¸æŠ¢é”ä¹Ÿä¸ä¼šè¿›å…¥è‡ªæ—‹çŠ¶æ€ï¼Œä¼šç›´æ¥è¿›å…¥ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚<br>é¥¥é¥¿æ¨¡å¼çš„è§¦å‘æ¡ä»¶ï¼Œå½“ä¸€ä¸ªGç­‰å¾…é”æ—¶é—´è¶…è¿‡1æ¯«ç§’æ—¶ï¼ŒMutexåˆ‡æ¢åˆ°é¥¥é¥¿æ¨¡å¼<br>é¥¥é¥¿æ¨¡å¼çš„å–æ¶ˆæ¡ä»¶ï¼Œå½“ä¸€ä¸ªGè·å–åˆ°é”ä¸”åœ¨ç­‰å¾…é˜Ÿåˆ—çš„æœ«å°¾ï¼Œæˆ–è€…è¿™ä¸ªGè·å–é”çš„ç­‰å¾…æ—¶é—´åœ¨1mså†…ï¼Œé‚£ä¹ˆMutexåˆ‡æ¢å›æ­£å¸¸æ¨¡å¼</p><p>å¸¦æ¥çš„æ”¹å˜</p><p>Mutex.stateçš„å€’æ•°ç¬¬ä¸‰ä½ï¼Œå˜æˆäº†mutexStarvingæ ‡è®°ä½ï¼Œ0è¡¨ç¤ºæ­£å¸¸æ¨¡å¼ï¼Œ1è¡¨ç¤ºé¥¥é¥¿æ¨¡å¼ï¼Œä¸æ­¤åŒæ—¶ï¼Œæ”¯æŒçš„æœ€å¤§ç­‰å¾…Gæ•°é‡ä»230ä¸ª å˜æˆäº†229ä¸ª</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> å¹¶å‘ </tag>
            
            <tag> mutex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golangæ¨¡æ‹Ÿé¢è¯•é¢˜01</title>
      <link href="/interview/simulation/simulation01/"/>
      <url>/interview/simulation/simulation01/</url>
      
        <content type="html"><![CDATA[<ol><li><p>channelå®ç°åŸç†</p></li><li><p>Mutex æ˜¯æ‚²è§‚è¿˜æ˜¯ä¹è§‚é”ï¼ˆä»€ä¹ˆæ˜¯ä¹è§‚é”ï¼‰</p></li><li><p>Mutex æœ‰å‡ ç§æ¨¡å¼ï¼ˆé¥¥é¥¿å’Œäº’æ–¥ï¼‰</p></li><li><p>Mutex è‡ªæ—‹é”ï¼Ÿ</p></li><li><p>goroutine æ¨¡å‹ å’ŒæŠ¢å æ—¶æœº</p><p><a href="https://www.bilibili.com/video/BV19r4y1w7Nx/?spm_id_from=333.788.recommend_more_video.6">https://www.bilibili.com/video/BV19r4y1w7Nx/?spm_id_from&#x3D;333.788.recommend_more_video.6</a></p></li><li><p>GC åŸç†</p></li><li><p>goå†…å­˜åˆ†é…ï¼Œå“ªäº›å¯¹è±¡åˆ†é…åœ¨å †ä¸Šï¼Œå“ªäº›åˆ†é…åœ¨æ ˆä¸Šï¼ˆå¤§å¯¹è±¡å°å¯¹è±¡ï¼‰</p></li><li><p>OOM out of MEMERY å†…å­˜æ³„æ¼</p></li><li><p>signalä¿¡å·ï¼ˆ64ç§ï¼‰</p></li><li><p>Go Micro</p></li><li><p>CPUä¸‰çº§ç¼“å­˜ï¼ŒåŠ è½½å›ºå®šé•¿åº¦åˆ°cacheï¼Œè¿ç»­çš„åœ°å€ç©ºé—´</p></li><li><p>å¤šæ ¸CPUå¦‚ä½•ä¿æŒcacheä¸å†²çªï¼ˆMESIï¼‰</p></li><li><p>rune å’Œ uint è¶…å‡ºä½æ•°åè®¡ç®—</p></li></ol><p>å°å‚01</p><ol><li>mutexæœ‰å‡ ç§é”ï¼Ÿ<ol><li>äº’æ–¥é”mutex</li><li>è¯»å†™äº’æ–¥é”rwmutex</li></ol></li><li>åç¨‹å’Œçº¿ç¨‹ï¼Ÿè§golang101-1 .4</li><li>channelçš„ä½œç”¨ï¼Ÿç”¨æ³•ï¼Ÿ<ol><li>æ§åˆ¶å¹¶å‘æ•°ï¼Œä¸€èˆ¬ç»“åˆ waitgroup</li><li>æ§åˆ¶åç¨‹é€€å‡ºç­‰</li></ol></li><li>tidbåŸºç¡€</li><li>gcæµç¨‹ åŸç† golang101-2.4</li><li>çº¿ç¨‹ä¸è¿›ç¨‹</li><li>slice å’Œ map çº¿ç¨‹å®‰å…¨å¦</li><li>ä½¿ç”¨goé‡åˆ°çš„æŒ‘æˆ˜ï¼Ÿ</li><li>postgreï¼Ÿåˆ†å¸ƒå¼ç¼“å­˜ï¼Ÿ</li><li>æ¡†æ¶grpcç›¸å…³</li><li>ç»Ÿè®¡åç¨‹æ•°é‡<ol><li>runtime.NumGoroutine()</li></ol></li><li>ä¸ºä»€ä¹ˆè½¬go<ol><li>å¾®æœåŠ¡ï¼Œä¸Šäº‘</li><li>k8s</li><li>å¤§é‡ï¼Œåˆ†å¸ƒå¼</li></ol></li></ol><p>ihandy</p><ol><li>é¡¹ç›®</li><li>gc</li><li>redis æŒä¹…åŒ–</li><li>channelï¼Œcontext</li><li>mutexä½¿ç”¨</li><li>gmp</li><li>è¿›ç¨‹çº¿ç¨‹åç¨‹</li></ol><p>æ•°ç¨ç§‘æŠ€ï¼šå¤šä¸šåŠ¡æˆ–è€…å¤šæ–¹æ•°æ®ä¸å‡ºåº“ï¼Œæ€æ ·æ¨¡å‹åŒ–ä½¿ç”¨è¿™äº›æ•°æ® tob</p><ol><li>é¡¹ç›®<ol><li>æœ€æ‹¿æ‰‹çš„å“ªä¸ªï¼Ÿ</li><li>æŠ€æœ¯ç‚¹ä¸æ˜¯ç‰¹åˆ«çªå‡º</li><li>ä»»åŠ¡ç³»ç»Ÿè¦è®²æ˜ç™½å¯¹ç”¨æˆ·å’Œè¿è¥çš„ä¸¤å¥—æ¥å£æ¨¡å¼ï¼Œä»¥åŠç›¸å…³çš„ç¼“å­˜å®ç°æ–¹æ¡ˆå’Œåˆ·æ–°æœºåˆ¶</li><li>å¹¿å‘Šç³»ç»Ÿè¦è®²æ˜ç™½å…·ä½“æå‡äº†å“ªäº›æ•ˆç‡</li><li>ä»€ä¹ˆç»´åº¦çš„ç¼“å­˜keyï¼Œç­‰</li></ol></li><li>ç®¡ç†<ol><li>æ—¶é—´åˆ†é…</li><li>éœ€æ±‚è¯„å®¡å¤§æ¦‚æµç¨‹å’Œå†…å®¹</li></ol></li><li>å­—ç¬¦ä¸²ç›¸åŠ </li><li>kafka ï¼štopicï¼Œ partitionå’Œconsumerçš„å…³ç³»ï¼Œ replica<ol><li>consumerçš„è´Ÿè½½åˆ†é…ç­‰</li><li>ç»„å†…æ¯ä¸ªæ¶ˆè´¹è€…å¯¹åº”ä¸€ä¸ªpartitionï¼Œpartitionå¤šçš„è¯ç”±consumeræ‰¿æ¥ï¼Œå…¶ä¸­ä¸€ä¸ªæˆ–å‡ ä¸ªæ¥å—çš„é‡ä¼šå¤šï¼›æ¶ˆè´¹è€…å¤šçš„è¯ï¼Œå¤šå‡ºpartitionçš„ä¼šå¤„äºç©ºé—²çŠ¶æ€</li></ol></li></ol><p>ä¸­ç‰©è”è®¯</p><ol><li>é¡¹ç›®</li></ol><p>å­—èŠ‚å›½é™…æ”¯ä»˜</p><ol><li>é¡¹ç›®</li><li>redis æŒä¹…åŒ–</li><li>æ±‚æ ¹å·2<ol><li>å¡ç®—æ³•é¢˜äº†ä½ æ•¢ä¿¡ï¼Œèœé€¼</li><li>å»æŠŠè¯¾ç¨‹ä¸­çš„é¢˜æ¯ä¸ªè‡³å°‘æ¥ä¸¤éæ‰å¤Ÿçš„ï¼ï¼ï¼ï¼ï¼ï¼</li></ol></li></ol><p>å¾ªç¯è°ƒåº¦ï¼šé“¶è¡Œ or é”€å”®çš„ææ•ˆå·¥å…·ï¼Œé€šè¯è´¨é‡æ¨¡å‹ tob</p><ol><li>http + åç¨‹ï¼Œæ€ä¹ˆè°ƒåº¦çš„ï¼Ÿæ˜¯å¦æ¶‰åŠç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€çš„åˆ‡æ¢ï¼Ÿ</li><li>ç´¢å¼•çš„æ„å»ºæµç¨‹ï¼Ÿ</li><li>bæ ‘ï¼Œb+æ ‘åŒºåˆ«ï¼ŒMongoDBä¸ºä»€ä¹ˆé€‰ç”¨bæ ‘</li><li>gmpè°ƒåº¦æµç¨‹</li><li>redis å“ªäº›å‘½ä»¤? æ—¶é—´å¤æ‚åº¦æ˜¯ o(n)</li><li>kafka æŒä¹…åŒ–ï¼Ÿ</li><li>kafka partitionæ•°é‡æ ¹æ®å“ªäº›ä¿¡æ¯ç¡®å®šçš„ï¼Ÿ<ol><li>å›ç­”ï¼šconsumerçš„æ•°é‡</li><li>ç­”æ¡ˆï¼šï¼Ÿ</li></ol></li></ol><p>umu</p><ol><li>mysql èšåˆç´¢å¼•å’ŒXXç´¢å¼•</li><li>redis å„ç§æ•°æ®ç±»å‹çš„åº•å±‚ç»“æ„</li></ol><p>è‡ªå·±æ€»ç»“ï¼š<br>å¹¶å‘ï¼Œç¼“å­˜ï¼Œé«˜å¯ç”¨ï¼Œgrpcï¼Œgcï¼Œgmpï¼Œmutexï¼Œchannelï¼Œcontextç­‰<br>httpï¼Œredisï¼Œmysqlï¼Œzookeeperï¼Œraft<br>ä¹è§‚é”æ‚²è§‚é”ï¼Ÿ<br>casï¼Ÿ</p><p>é›†åº¦åŸºç¡€æœåŠ¡å¼€å‘</p><ol><li>grpcé€šä¿¡é—®é¢˜</li><li>grpcé™æµï¼Œç†”æ–­ç›¸å…³</li><li>golang åº•å±‚ï¼Œå†™äº†å°±ä¼šé—®ï¼Œchannelå®ç°æ–¹å¼ï¼Œsliceå®ç°æ–¹å¼</li><li>å¦‚ä½•åšé™æµï¼Œredisè¯·æ±‚é”çš„è¿‡æœŸæ—¶é—´ä¸ºä»€ä¹ˆï¼Œå¦‚æœæœ‰äººä¸€ç›´æŒæœ‰é”æ€ä¹ˆåŠï¼Ÿ</li><li>å»¶æ—¶é˜Ÿåˆ—çš„å®ç°æ–¹æ¡ˆ</li><li>golangçš„gc</li><li>redis é”çš„å®ç°æ–¹æ¡ˆï¼Ÿ</li><li>ç®—æ³•ï¼šåˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦å¯¹ç§°</li><li>é€ƒé€¸åˆ†æ</li></ol><p>åˆ·é¢˜ï¼š<br>å‰‘æŒ‡offer<br>ç®—æ³•è®­ç»ƒè¥<br>ç®€å•é¢˜*3<br>ä¸­ç­‰é¢˜*4</p><p>Tik TokäºŒé¢<br>1.ä»‹ç»æ•°æ®åº“ç´¢å¼•ï¼Ÿ<br>    æ•°æ®åº“ç´¢å¼•æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºæé«˜æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡ã€‚å®ƒé€šè¿‡åˆ›å»ºç‰¹å®šçš„æ•°æ®ç»“æ„ï¼ˆå¦‚Bæ ‘ã€B+æ ‘ï¼‰æ¥å­˜å‚¨æ•°æ®çš„æœ‰åºå‰¯æœ¬ï¼Œä»¥ä¾¿æ›´å¿«åœ°å®šä½å’Œæ£€ç´¢æ•°æ®ã€‚<br>2.ä¸ºä»€ä¹ˆæŠŠäºŒå‰æŸ¥æ‰¾æ ‘å˜æˆå¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘å°±èƒ½å‡å°‘ç£ç›˜IOï¼Ÿä¸ºä»€ä¹ˆæ ‘çš„é«˜åº¦å†³å®šäº†ç£ç›˜çš„IOæ¬¡æ•°ï¼Ÿå¦‚æœæŸ¥æ‰¾æŸä¸€ä¸ªæ•°æ®ï¼Œç”¨äºŒå‰æŸ¥æ‰¾æ ‘å’Œç”¨B+æ ‘çš„æ—¶é—´å¤æ‚åº¦åˆ†åˆ«æ˜¯å¤šå°‘?<br>3.B+æ ‘çš„å¶å­ç»“ç‚¹çš„é»˜è®¤å¤§å°æ˜¯å¤šå°‘ï¼Ÿå¦‚æœæŠŠBæ ‘çš„éå¶å­ç»“ç‚¹åªå­˜æ”¾æŒ‡é’ˆ,é‚£Bæ ‘æ˜¯ä¸æ˜¯å°±å’ŒB+æ ‘ä¸€æ ·äº†å‘¢ï¼Ÿ<br>4.é™¤äº†äºŒå‰æ ‘ï¼ŒB+æ ‘ï¼ŒBæ ‘è¿™äº›ç´¢å¼•ï¼Œè¿˜æœ‰ä»€ä¹ˆå¸¸è§çš„å­˜å‚¨æ•°æ®ç»“æ„é€‚åˆåšç´¢å¼•å‘¢ï¼Ÿ<br>    å“ˆå¸Œç´¢å¼•å’Œå…¨æ–‡ç´¢å¼•ä¹Ÿå¸¸ç”¨äºæ•°æ®åº“ç´¢å¼•ã€‚<br>5.ä¸ºä»€ä¹ˆInnoDBä¸ç”¨å“ˆå¸Œåšç´¢å¼•ï¼Œç”¨å“ˆå¸Œå’Œç”¨B+æ ‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<br>    å“ˆå¸Œç´¢å¼•é€‚ç”¨äºç­‰å€¼æŸ¥è¯¢ï¼Œè€ŒB+æ ‘ç´¢å¼•æ”¯æŒèŒƒå›´æŸ¥è¯¢å’Œæ’åºã€‚InnoDBä½¿ç”¨B+æ ‘ç´¢å¼•ï¼Œå› ä¸ºå®ƒæ”¯æŒæ›´å¤šçš„æŸ¥è¯¢ç±»å‹ã€‚<br>6.Redisé‡Œé¢æœ‰åºé›†åˆç”¨çš„ç´¢å¼•ï¼Ÿä»‹ç»ä¸€ä¸‹è·³è·ƒè¡¨ï¼Œä¸å“ˆå¸Œçš„åŒºåˆ«ï¼Ÿ<br>    è·³è·ƒè¡¨æ˜¯ä¸€ç§æœ‰åºæ•°æ®ç»“æ„ï¼Œç”¨äºå®ç°æœ‰åºé›†åˆã€‚ä¸å“ˆå¸Œè¡¨ç›¸æ¯”ï¼Œè·³è·ƒè¡¨æ”¯æŒæœ‰åºæ€§å’ŒèŒƒå›´æŸ¥è¯¢ã€‚<br>7.MySQLäº‹åŠ¡éš”ç¦»çº§åˆ«æœ‰å“ªäº›ï¼Œä¼šäº§ç”Ÿå“ªäº›é—®é¢˜ï¼ŒMySQLé»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ<br>    MySQLçš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬è¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»å’Œä¸²è¡ŒåŒ–ã€‚ä¸åŒçš„éš”ç¦»çº§åˆ«å¯èƒ½å¯¼è‡´è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ã€‚MySQLé»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯å¯é‡å¤è¯»ã€‚<br>8.MySQLå¦‚ä½•å®ç°å¯é‡å¤è¯»ï¼ŸMVCCçš„åº•å±‚åŸç†ï¼Ÿ<br>9.çœ‹ä½ ç”¨è¿‡palsuarï¼Œä¹Ÿç”¨è¿‡Kafkaï¼Œé‚£ä½ è¯´ä¸€ä¸‹è¿™ä¸¤è€…ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Ÿæˆ–è€…è®¾è®¡ä¸Šæœ‰å“ªäº›ä¸ä¸€æ ·ï¼Ÿ<br>    Pulsarå’ŒKafkaéƒ½æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä½†å®ƒä»¬çš„æ¶æ„å’Œè®¾è®¡æœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼ŒPulsaræ”¯æŒå¤šç§Ÿæˆ·ã€å¤šæ•°æ®ä¸­å¿ƒå¤åˆ¶å’ŒåŠ¨æ€æ¶ˆæ¯è·¯ç”±ç­‰ç‰¹æ€§ï¼Œè€ŒKafkaåˆ™æ›´åŠ ä¸“æ³¨äºé«˜ååé‡å’Œä½å»¶è¿Ÿã€‚<br>14.è¯´è¯´ä¸¤è€…åº•å±‚å­˜å‚¨æ¶ˆæ¯æ–¹å¼çš„åŒºåˆ«ï¼Ÿ<br>15.ä¸ºä»€ä¹ˆè¿™ä¸¤è€…è¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ<br>17.Rediså¦‚ä½•å®ç°é«˜å¯ç”¨å’Œé«˜å¯é çš„ï¼Ÿ<br>    Rediså®ç°é«˜å¯ç”¨é€šå¸¸é€šè¿‡ä¸»ä»å¤åˆ¶å’Œå“¨å…µæˆ–é›†ç¾¤æ¨¡å¼ã€‚å“¨å…µè´Ÿè´£ç›‘æ§èŠ‚ç‚¹å¥åº·ï¼Œå¹¶åœ¨ä¸»èŠ‚ç‚¹å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä»èŠ‚ç‚¹ã€‚é›†ç¾¤æ¨¡å¼æ”¯æŒæ•°æ®åˆ†ç‰‡å’ŒèŠ‚ç‚¹è‡ªåŠ¨å‘ç°ï¼Œæé«˜äº†å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚<br>18.Redisçš„ä¸»ä»å¤åˆ¶æ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿå¼‚æ­¥å’ŒåŒæ­¥çš„ä¼˜ç¼ºç‚¹ï¼Ÿ<br>    Redisçš„ä¸»ä»å¤åˆ¶æ˜¯å¼‚æ­¥çš„ã€‚å¼‚æ­¥å¤åˆ¶æé«˜äº†æ€§èƒ½ï¼Œä½†å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´æ€§å’Œæ•°æ®ä¸¢å¤±ã€‚<br>19.äº†è§£goå—ï¼Œè¯´è¯´åç¨‹ï¼Œä¸ºä»€ä¹ˆè¦ç”¨åç¨‹ï¼Ÿ<br>    åç¨‹æ˜¯ä¸€ç§è½»é‡çº§çš„çº¿ç¨‹ï¼Œç”±Goè¯­è¨€åŸç”Ÿæ”¯æŒã€‚åç¨‹çš„ä¼˜ç‚¹åŒ…æ‹¬ä½å¼€é”€ã€é«˜å¹¶å‘å’Œç®€å•æ˜“ç”¨ï¼Œä½¿å¾—ç¼–å†™å¹¶å‘ç¨‹åºå˜å¾—æ›´åŠ ç®€å•å’Œé«˜æ•ˆã€‚<br>20.ä¸ºä»€ä¹ˆå¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºéœ€è¦åŠ é”å¤„ç†ï¼Ÿ<br>    å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«èµ„æºå¯èƒ½å¯¼è‡´æ•°æ®ç«æ€å’Œä¸ä¸€è‡´æ€§ã€‚åŠ é”èƒ½å¤Ÿä¿è¯æ•°æ®çš„åŸå­æ€§å’Œä¸€è‡´æ€§ï¼Œä»è€Œç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚<br>21.è¯´è¯´å¯è§æ€§ï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªçº¿ç¨‹çœ‹ä¸åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹ï¼Ÿ<br>    çº¿ç¨‹çš„å¯è§æ€§æŒ‡çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹èƒ½å¤Ÿè¢«å…¶ä»–çº¿ç¨‹ç«‹å³çœ‹åˆ°ã€‚åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œç”±äºCPUçš„ä¼˜åŒ–ã€ç¼“å­˜ä»¥åŠç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œå¯èƒ½å¯¼è‡´çº¿ç¨‹ä¹‹é—´çš„æ•°æ®ä¸ä¸€è‡´ã€‚ä¸ºäº†ç¡®ä¿çº¿ç¨‹å®‰å…¨å’Œæ­£ç¡®æ€§ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¤šçº¿ç¨‹å¯¹åŒä¸€å…±äº«å˜é‡åšä¿®æ”¹æ—¶ï¼ŒæŸä¸ªçº¿ç¨‹ä¿®æ”¹åçš„æ–°å€¼å¯èƒ½ä¸ä¼šç«‹å³æ›´æ–°åˆ°ä¸»å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½ä»æ—§è¯»åˆ°è¯¥å˜é‡æ—§å€¼ã€‚<br>    ä½¿ç”¨é”ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®å…±äº«å˜é‡ï¼›<br>    å¯¹å˜é‡è®¿é—®ä½¿ç”¨åŸå­æ“ä½œ<br>23.è®©ä½ è®¾è®¡ä¸€ä¸ªä»»åŠ¡è°ƒåº¦å™¨çš„ç±»ï¼Œaddä¸€ä¸ªtaskï¼ŒæŒ‡å®šè¿™ä¸ªtaskçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥addå¾ˆå¤šä»»åŠ¡ï¼Œä½†æ¯ä¸ªtaskæ‰§è¡Œçš„æ—¶é—´åˆå„ä¸ç›¸åŒï¼Œä½ å¦‚ä½•å®ç°ï¼Œç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿ<br>    å¯ä»¥ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå¦‚æœ€å°å †ï¼‰æ¥å­˜å‚¨ä»»åŠ¡ï¼Œå¹¶æŒ‰ç…§æ‰§è¡Œæ—¶é—´è¿›è¡Œæ’åºã€‚æ¯æ¬¡è°ƒåº¦å™¨æ£€æŸ¥æ—¶ï¼Œéƒ½ä¼šé€‰æ‹©æœ€æ—©çš„ä»»åŠ¡æ‰§è¡Œã€‚<br>24.ä¼˜å…ˆé˜Ÿåˆ—çš„å®ç°åŸç†ï¼Ÿ</p><h2 id="å®šä¹‰ä¸æ¦‚å¿µ"><a href="#å®šä¹‰ä¸æ¦‚å¿µ" class="headerlink" title="å®šä¹‰ä¸æ¦‚å¿µ"></a><strong>å®šä¹‰ä¸æ¦‚å¿µ</strong></h2><p>ä¼˜å…ˆé˜Ÿåˆ—æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨å…·æœ‰ä¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡æˆ–å…ƒç´ </p><p>åŒ…æ‹¬FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰å’ŒLIFOï¼ˆåè¿›å…ˆå‡ºï¼‰ä¸¤ç§åŸºæœ¬ç±»å‹</p><h2 id="å®ç°æŠ€æœ¯"><a href="#å®ç°æŠ€æœ¯" class="headerlink" title="å®ç°æŠ€æœ¯"></a><strong>å®ç°æŠ€æœ¯</strong></h2><p>æ•°æ®ç»“æ„</p><p>å †å¼é˜Ÿåˆ—ï¼šé«˜æ•ˆçš„æ•°æ®ç»„ç»‡ç»“æ„</p><p>Kå‰æ ‘ï¼šåŸºäºKå‰æ ‘çš„ä¼˜å…ˆé˜Ÿåˆ—ç®—æ³•ï¼Œè¿ç®—æ•ˆç‡é«˜</p><p>åŒè¾“å…¥é€šé“ä¼˜å…ˆç½‘ç»œï¼šç”¨äºé€šä¿¡ç½‘ç»œè®¾è®¡</p><p>ç®—æ³•è®¾è®¡</p><p>PQDSAç®—æ³•ï¼šåŸºäºDAGä»»åŠ¡é›†çš„å…¥å£èŠ‚ç‚¹æ•°é‡ç¡®å®šä¼˜å…ˆé˜Ÿåˆ—æ•°</p><p>MP-SAQMç®—æ³•ï¼šåŸºäºä¼˜å…ˆçº§åŒºåˆ†çš„è°ƒåº¦åŠä¸»åŠ¨é˜Ÿåˆ—ç®¡ç†</p><p>ç¡¬ä»¶æ”¯æŒ</p><p>SP-PIFO: ä½¿ç”¨ä¸¥æ ¼ä¼˜å…ˆçº§é˜Ÿåˆ—é€¼è¿‘PIFOè¡Œä¸º</p><p>å…‰å­¦ä¼˜å…ˆé˜Ÿåˆ—ï¼šé€šè¿‡åé¦ˆç³»ç»Ÿå®ç°ï¼Œæé«˜äº†ç¼“å†²å®¹é‡çš„åˆ©ç”¨ç‡</p><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a><strong>åº”ç”¨åœºæ™¯</strong></h2><p>æ“ä½œç³»ç»Ÿ</p><p>è°ƒåº¦ç®—æ³•ä¼˜åŒ–ï¼šæé«˜å¤„ç†å™¨è°ƒåº¦æ•ˆç‡</p><p>ç½‘ç»œä¼ è¾“</p><p>æ•°æ®åŒ…è°ƒåº¦ï¼šå®ç°å¯ç¼–ç¨‹çš„æ•°æ®åŒ…è°ƒåº¦</p><p>äººå·¥æ™ºèƒ½</p><p>å¼‚æ„è®¡ç®—ç¯å¢ƒä¸‹çš„ä»»åŠ¡è°ƒåº¦é—®é¢˜è§£å†³</p><p>ä¸­é—´ä»¶æŠ€æœ¯</p><p>å¤„ç†å¤šä¸ªä»»åŠ¡æ—¶æŒ‰è½»é‡é¡ºåºæ‰§è¡Œï¼Œç¼©çŸ­ç”¨æˆ·å¹³å‡ç­‰å¾…æ—¶é—´</p><h2 id="æ€§èƒ½åˆ†æä¸ä¼˜åŒ–"><a href="#æ€§èƒ½åˆ†æä¸ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½åˆ†æä¸ä¼˜åŒ–"></a><strong>æ€§èƒ½åˆ†æä¸ä¼˜åŒ–</strong></h2><p>å¹¶è¡Œæ“ä½œæ€§èƒ½</p><p>å¹¶è¡Œæ’å…¥å’Œåˆ é™¤æ–¹æ³•ï¼šä¿è¯å¹¶è¡Œåº¦å’Œä¸²è¡Œå­˜å–ç®—æ³•çš„ä¼˜å…ˆé¡ºåºä¸€è‡´</p><p>é«˜æ•ˆåˆå¹¶ä¼˜å…ˆé˜Ÿåˆ—çš„æŠ€æœ¯ï¼šå‡å°‘å­˜å‚¨å¼€é”€ï¼Œæé«˜æ“ä½œæ•ˆç‡</p><p>å®éªŒéªŒè¯ä¸æ¯”è¾ƒ</p><p>å®éªŒç»“æœéªŒè¯äº†ä¸åŒç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œå¦‚SP-PIFOã€PQDSAç­‰</p><p>å¯¹æ¯”ç»å…¸å †ç®—æ³•å’Œæ–°é¢–å †å˜ä½“åœ¨ä¸åŒè¾“å…¥ä¸‹çš„è¡¨ç°</p><h2 id="æŒ‘æˆ˜ä¸æœªæ¥æ–¹å‘"><a href="#æŒ‘æˆ˜ä¸æœªæ¥æ–¹å‘" class="headerlink" title="æŒ‘æˆ˜ä¸æœªæ¥æ–¹å‘"></a><strong>æŒ‘æˆ˜ä¸æœªæ¥æ–¹å‘</strong></h2><p>æŠ€æœ¯æŒ‘æˆ˜</p><p>å®ç°å¤§è§„æ¨¡å¹¶è¡Œæ“ä½œçš„å­˜å‚¨ç©ºé—´è‡ªé€‚åº”æ€§</p><p>æé«˜ç¡¬ä»¶æ”¯æŒä¸‹çš„å®æ—¶æ€§å’Œå‡†ç¡®æ€§</p><p>å‘å±•è¶‹åŠ¿</p><p>æ¢ç´¢æ–°çš„æ•°æ®ç»“æ„å’Œç®—æ³•ä»¥é€‚åº”æ›´å¤æ‚çš„åº”ç”¨åœºæ™¯</p><p>åŠ å¼ºå¯¹å¼‚æ„è®¡ç®—ç¯å¢ƒä¸‹çš„ä¼˜åŒ–å’Œæ”¯æŒèƒ½åŠ›</p><p>25.ç®—æ³•é¢˜ï¼šäºŒå‰æ ‘çš„å®Œå…¨æ€§æ£€éªŒï¼Ÿ</p><h2 id="å­—èŠ‚è·³åŠ¨"><a href="#å­—èŠ‚è·³åŠ¨" class="headerlink" title="å­—èŠ‚è·³åŠ¨"></a>å­—èŠ‚è·³åŠ¨</h2><p>1.ä»‹ç»ä¸€ä¸‹ä¸šåŠ¡è¡¨çš„å­—æ®µ</p><p>2.å®šæ—¶ä»»åŠ¡åˆ·æ–°å­—æ®µ, æ˜¯æ€ä¹ˆå®ç°çš„?</p><p>3.åˆ†å¸ƒå¼é”? åˆ†å¸ƒå¼æ­»é”å¦‚ä½•è§£å†³? çœ‹é—¨ç‹—æœºåˆ¶? å¦‚ä½•é¿å…å½“å‰çº¿ç¨‹åŠ çš„é”, è¢«å…¶å®ƒçº¿ç¨‹è§£é”?</p><p>4.ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«? å†™å¤šè¯»å°‘çš„æƒ…å†µ, åº”è¯¥ä½¿ç”¨ä¹è§‚é”è¿˜æ˜¯æ‚²è§‚é”?</p><p>5.åˆ†å¸ƒå¼åœºæ™¯ä¸‹, å¦‚ä½•å®ç°ä¹è§‚é”?</p><p>6.kafkaçš„å¹‚ç­‰æ€§? å¦‚ä½•é¿å…æ¶ˆæ¯è¢«é‡å¤æ¶ˆè´¹?</p><p>7.ä¸¤ä¸ªçº¿ç¨‹, åŒæ—¶å‘mysqlä¸­æ’å…¥ä¸€æ¡æ•°æ®?</p><p>8.kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±</p><p>9.sqlä¼˜åŒ–åœºæ™¯:</p><p>select id,name,balance from account where update_time &gt; â€˜2020-09-19â€™ limit 100000, 10</p><p>è¯¥è¯­å¥ä¸ºä»€ä¹ˆæŸ¥è¯¢æ…¢? æœ‰ä»€ä¹ˆä¼˜åŒ–æ€è·¯?</p><ol start="10"><li>ç®—æ³•é¢˜: å­é›†</li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> å®å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Goè®¾è®¡æ¨¡å¼01-å•ä¾‹æ¨¡å¼</title>
      <link href="/golang/go-design-pattern/gdp-create/01-singleton/"/>
      <url>/golang/go-design-pattern/gdp-create/01-singleton/</url>
      
        <content type="html"><![CDATA[<h2 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h2><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>å•ä¾‹æ¨¡å¼é‡‡ç”¨äº† é¥¿æ±‰å¼ å’Œ æ‡’æ±‰å¼ ä¸¤ç§å®ç°ï¼Œä¸ªäººå…¶å®æ›´å€¾å‘äºé¥¿æ±‰å¼çš„å®ç°ï¼Œç®€å•ï¼Œå¹¶ä¸”å¯ä»¥å°†é—®é¢˜åŠæ—©æš´éœ²ï¼Œæ‡’æ±‰å¼è™½ç„¶æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œä½†æ˜¯è¿™åªæ˜¯æŠŠå†·å¯åŠ¨æ—¶é—´æ”¾åˆ°äº†ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æœ¬è´¨ä¸Šè§£å†³é—®é¢˜ï¼Œå¹¶ä¸”ä¸ºäº†å®ç°æ‡’æ±‰å¼è¿˜ä¸å¯é¿å…çš„éœ€è¦åŠ é”ã€‚</p><h3 id="é¥¿æ±‰å¼"><a href="#é¥¿æ±‰å¼" class="headerlink" title="é¥¿æ±‰å¼"></a>é¥¿æ±‰å¼</h3><p><strong>ä»£ç å®ç°:</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"></span><br><span class="line"><span class="comment">// Singleton é¥¿æ±‰å¼å•ä¾‹</span></span><br><span class="line"><span class="keyword">type</span> Singleton <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> singleton *Singletonfunc init() &#123;</span><br><span class="line">singleton = &amp;Singleton&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetInstance è·å–å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *Singleton &#123;</span><br><span class="line"><span class="keyword">return</span> singleton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å•å…ƒæµ‹è¯•:</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton_test</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;testing&quot;</span></span><br><span class="line">singleton </span><br><span class="line"><span class="string">&quot;github.com/stretchr/testify/assert&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestGetInstance</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">assert.Equal(t, singleton.GetInstance(), singleton.GetInstance())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkGetInstanceParallel</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line">b.RunParallel(<span class="function"><span class="keyword">func</span><span class="params">(pb *testing.PB)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> pb.Next() &#123;</span><br><span class="line"><span class="keyword">if</span> singleton.GetInstance() != singleton.GetInstance() &#123;</span><br><span class="line">b.Errorf(<span class="string">&quot;test fail&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰"><a href="#æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰" class="headerlink" title="æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰"></a>æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰</h3><p><strong>ä»£ç å®ç°:</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sync&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">lazySingleton *Singleton</span><br><span class="line">once          = &amp;sync.Once&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetLazyInstance æ‡’æ±‰å¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetLazyInstance</span><span class="params">()</span></span> *Singleton &#123;</span><br><span class="line"><span class="keyword">if</span> lazySingleton == <span class="literal">nil</span> &#123;</span><br><span class="line">once.Do(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">lazySingleton = &amp;Singleton&#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> lazySingleton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å•å…ƒæµ‹è¯•:</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton_test</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;testing&quot;</span></span><br><span class="line">singleton </span><br><span class="line"><span class="string">&quot;github.com/stretchr/testify/assert&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestGetInstance</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">assert.Equal(t, singleton.GetInstance(), singleton.GetInstance())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkGetInstanceParallel</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line">b.RunParallel(<span class="function"><span class="keyword">func</span><span class="params">(pb *testing.PB)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> pb.Next() &#123;</span><br><span class="line"><span class="keyword">if</span> singleton.GetInstance() != singleton.GetInstance() &#123;</span><br><span class="line">b.Errorf(<span class="string">&quot;test fail&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golang201</title>
      <link href="/golang/advanced-tutorial/golang201/"/>
      <url>/golang/advanced-tutorial/golang201/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> è¿›é˜¶æ•™ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>channel</title>
      <link href="/golang/concurrency/go-channel/"/>
      <url>/golang/concurrency/go-channel/</url>
      
        <content type="html"><![CDATA[<h2 id="channel-101"><a href="#channel-101" class="headerlink" title="channel 101"></a>channel 101</h2><h3 id="1-å¼•å­"><a href="#1-å¼•å­" class="headerlink" title="1. å¼•å­"></a>1. å¼•å­</h3><p>å•çº¯åœ°å°†å‡½æ•°å¹¶å‘æ‰§è¡Œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å‡½æ•°ä¸å‡½æ•°é—´éœ€è¦äº¤æ¢æ•°æ®æ‰èƒ½ä½“ç°å¹¶å‘æ‰§è¡Œå‡½æ•°çš„æ„ä¹‰ã€‚</p><p>è™½ç„¶å¯ä»¥ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œä½†æ˜¯å…±äº«å†…å­˜åœ¨ä¸åŒçš„goroutineä¸­å®¹æ˜“å‘ç”Ÿç«æ€é—®é¢˜ã€‚ä¸ºäº†ä¿è¯æ•°æ®äº¤æ¢çš„æ­£ç¡®æ€§ï¼Œå¿…é¡»ä½¿ç”¨äº’æ–¥é‡å¯¹å†…å­˜è¿›è¡ŒåŠ é”ï¼Œè¿™ç§åšæ³•åŠ¿å¿…é€ æˆæ€§èƒ½é—®é¢˜ã€‚</p><p>Goè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯CSPï¼ˆCommunicating Sequential Processesï¼‰ï¼Œæå€¡é€šè¿‡é€šä¿¡å…±äº«å†…å­˜è€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜è€Œå®ç°é€šä¿¡ã€‚</p><p>å¦‚æœè¯´goroutineæ˜¯Goç¨‹åºå¹¶å‘çš„æ‰§è¡Œä½“ï¼Œchannelå°±æ˜¯å®ƒä»¬ä¹‹é—´çš„è¿æ¥ã€‚channelæ˜¯å¯ä»¥è®©ä¸€ä¸ªgoroutineå‘é€ç‰¹å®šå€¼åˆ°å¦ä¸€ä¸ªgoroutineçš„é€šä¿¡æœºåˆ¶ã€‚</p><p>Go è¯­è¨€ä¸­çš„é€šé“ï¼ˆchannelï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ã€‚é€šé“åƒä¸€ä¸ªä¼ é€å¸¦æˆ–è€…é˜Ÿåˆ—ï¼Œæ€»æ˜¯éµå¾ªå…ˆå…¥å…ˆå‡ºï¼ˆFirst In First Outï¼‰çš„è§„åˆ™ï¼Œä¿è¯æ”¶å‘æ•°æ®çš„é¡ºåºã€‚æ¯ä¸€ä¸ªé€šé“éƒ½æ˜¯ä¸€ä¸ªå…·ä½“ç±»å‹çš„å¯¼ç®¡ï¼Œä¹Ÿå°±æ˜¯å£°æ˜channelçš„æ—¶å€™éœ€è¦ä¸ºå…¶æŒ‡å®šå…ƒç´ ç±»å‹ã€‚</p><h4 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2. ä½¿ç”¨"></a>2. ä½¿ç”¨</h4><h2 id="channel-åº•å±‚åŸç†"><a href="#channel-åº•å±‚åŸç†" class="headerlink" title="channel åº•å±‚åŸç†"></a>channel åº•å±‚åŸç†</h2><ul><li><code>buf</code>æ˜¯æœ‰ç¼“å†²çš„channelæ‰€ç‰¹æœ‰çš„ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨ç¼“å­˜æ•°æ®ã€‚æ˜¯ä¸ªå¾ªç¯é“¾è¡¨ ï¼ˆä¸ºå•¥æ˜¯å¾ªç¯é“¾è¡¨ï¼Ÿæ™®é€šæ•°ç»„ä¸è¡Œå—ï¼Œæ™®é€šæ•°ç»„åœ°å€å’Œå®¹é‡å›ºå®šæ›´é€‚åˆæŒ‡å®šçš„ç©ºé—´ã€‚éœ€è¦pop æ‰å…ƒç´ ï¼Œæ™®é€šæ•°ç»„éœ€è¦å…¨éƒ¨éƒ½å‰ç§»ï¼‰</li><li><code>sendx</code>å’Œ<code>recvx</code>ç”¨äºè®°å½•<code>buf</code>è¿™ä¸ªå¾ªç¯é“¾è¡¨ä¸­çš„<del>å‘é€æˆ–è€…æ¥æ”¶çš„</del>index</li><li><code>lock</code>æ˜¯ä¸ªäº’æ–¥é”ã€‚</li><li><code>recvq</code>å’Œ<code>sendq</code>åˆ†åˆ«æ˜¯æ¥æ”¶(&lt;-channel)æˆ–è€…å‘é€(channel &lt;- xxx)çš„goroutineæŠ½è±¡å‡ºæ¥çš„ç»“æ„ä½“(sudog)çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸ªåŒå‘é“¾è¡¨</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123;</span><br><span class="line">qcount   <span class="type">uint</span>  <span class="comment">// é˜Ÿåˆ—ä¸­çš„æ€»å…ƒç´ ä¸ªæ•° </span></span><br><span class="line">dataqsiz <span class="type">uint</span>  <span class="comment">// ç¯å½¢é˜Ÿåˆ—å¤§å°ï¼Œå³å¯å­˜æ”¾å…ƒç´ çš„ä¸ªæ•° </span></span><br><span class="line">buf      unsafe.Pointer <span class="comment">// ç¯å½¢é˜Ÿåˆ—æŒ‡é’ˆ </span></span><br><span class="line">elemsize <span class="type">uint16</span>  <span class="comment">//æ¯ä¸ªå…ƒç´ çš„å¤§å° </span></span><br><span class="line">closed   <span class="type">uint32</span>  <span class="comment">//æ ‡è¯†å…³é—­çŠ¶æ€ </span></span><br><span class="line">elemtype *_type <span class="comment">// å…ƒç´ ç±»å‹ </span></span><br><span class="line">sendx    <span class="type">uint</span>   <span class="comment">// å‘é€ç´¢å¼•ï¼Œå…ƒç´ å†™å…¥æ—¶å­˜æ”¾åˆ°é˜Ÿåˆ—ä¸­çš„ä½ç½®</span></span><br><span class="line">recvx    <span class="type">uint</span>   <span class="comment">// æ¥æ”¶ç´¢å¼•ï¼Œå…ƒç´ ä»é˜Ÿåˆ—çš„è¯¥ä½ç½®è¯»å‡º</span></span><br><span class="line">recvq    waitq  <span class="comment">// ç­‰å¾…è¯»æ¶ˆæ¯çš„goroutineé˜Ÿåˆ—</span></span><br><span class="line">sendq    waitq <span class="comment">// ç­‰å¾…å†™æ¶ˆæ¯çš„goroutineé˜Ÿåˆ—</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// lock protects all fields in hchan, as well as several</span></span><br><span class="line">    <span class="comment">// fields in sudogs blocked on this channel.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// Do not change another G&#x27;s status while holding this lock</span></span><br><span class="line">    <span class="comment">// (in particular, do not ready a G), as this can deadlock</span></span><br><span class="line">    <span class="comment">// with stack shrinking.</span></span><br><span class="line">    lock mutex <span class="comment">//äº’æ–¥é”ï¼Œchanä¸å…è®¸å¹¶å‘è¯»å†™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-è¯»å†™æµç¨‹"><a href="#1-è¯»å†™æµç¨‹" class="headerlink" title="1. è¯»å†™æµç¨‹"></a>1. è¯»å†™æµç¨‹</h4><blockquote><p>å‘ channel å†™æ•°æ®:</p><ol><li><p>è‹¥ç­‰å¾…æ¥æ”¶é˜Ÿåˆ— recvq ä¸ä¸ºç©ºï¼Œåˆ™ç¼“å†²åŒºä¸­æ— æ•°æ®æˆ–æ— ç¼“å†²åŒºï¼Œå°†ç›´æ¥ä» recvq å–å‡º G ï¼Œå¹¶æŠŠæ•°æ®å†™å…¥ï¼Œæœ€åæŠŠè¯¥ G å”¤é†’ï¼Œç»“æŸå‘é€è¿‡ç¨‹ã€‚</p></li><li><p>è‹¥ç¼“å†²åŒºä¸­æœ‰ç©ºä½™ä½ç½®ï¼Œåˆ™å°†æ•°æ®å†™å…¥ç¼“å†²åŒºï¼Œç»“æŸå‘é€è¿‡ç¨‹ã€‚</p></li><li><p>è‹¥ç¼“å†²åŒºä¸­æ²¡æœ‰ç©ºä½™ä½ç½®ï¼Œåˆ™å°†å‘é€æ•°æ®å†™å…¥ Gï¼Œå°†å½“å‰ G åŠ å…¥ sendq ï¼Œè¿›å…¥ç¡çœ ï¼Œç­‰å¾…è¢«è¯» goroutine å”¤é†’ã€‚</p></li></ol></blockquote><blockquote><p>ä» channel è¯»æ•°æ®</p><ol><li><p>è‹¥ç­‰å¾…å‘é€é˜Ÿåˆ— sendq ä¸ä¸ºç©ºï¼Œä¸”æ²¡æœ‰ç¼“å†²åŒºï¼Œç›´æ¥ä» sendq ä¸­å–å‡º G ï¼ŒæŠŠ G ä¸­æ•°æ®è¯»å‡ºï¼Œæœ€åæŠŠ G å”¤é†’ï¼Œç»“æŸè¯»å–è¿‡ç¨‹ã€‚</p></li><li><p>å¦‚æœç­‰å¾…å‘é€é˜Ÿåˆ— sendq ä¸ä¸ºç©ºï¼Œè¯´æ˜ç¼“å†²åŒºå·²æ»¡ï¼Œä»ç¼“å†²åŒºä¸­é¦–éƒ¨è¯»å‡ºæ•°æ®ï¼ŒæŠŠ G ä¸­æ•°æ®å†™å…¥ç¼“å†²åŒºå°¾éƒ¨ï¼ŒæŠŠ G å”¤é†’ï¼Œç»“æŸè¯»å–è¿‡ç¨‹ã€‚</p></li><li><p>å¦‚æœç¼“å†²åŒºä¸­æœ‰æ•°æ®ï¼Œåˆ™ä»ç¼“å†²åŒºå–å‡ºæ•°æ®ï¼Œç»“æŸè¯»å–è¿‡ç¨‹ã€‚</p></li><li><p>å°†å½“å‰ goroutine åŠ å…¥ recvq ï¼Œè¿›å…¥ç¡çœ ï¼Œç­‰å¾…è¢«å†™ goroutine å”¤é†’ã€‚</p></li></ol></blockquote><blockquote><p>å…³é—­ channel</p><p>1.å…³é—­ channel æ—¶ä¼šå°† recvq ä¸­çš„ G å…¨éƒ¨å”¤é†’ï¼Œæœ¬è¯¥å†™å…¥ G çš„æ•°æ®ä½ç½®ä¸º nilã€‚å°† sendq ä¸­çš„ G å…¨éƒ¨å”¤é†’ï¼Œä½†æ˜¯è¿™äº› G ä¼š panicã€‚</p><p>panic å‡ºç°çš„åœºæ™¯è¿˜æœ‰ï¼š</p><ul><li>å…³é—­å€¼ä¸º nil çš„ channel</li><li>å…³é—­å·²ç»å…³é—­çš„ channel</li><li>å‘å·²ç»å…³é—­çš„ channel ä¸­å†™æ•°æ®</li></ul></blockquote><h4 id="2-åˆ›å»ºchannel"><a href="#2-åˆ›å»ºchannel" class="headerlink" title="2. åˆ›å»ºchannel"></a>2. åˆ›å»ºchannel</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ— ç¼“å†²çš„channelç”±äºæ²¡æœ‰ç¼“å†²å‘é€å’Œæ¥æ”¶éœ€è¦åŒæ­¥</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)   </span><br><span class="line"><span class="comment">//æœ‰ç¼“å†²channelä¸è¦æ±‚å‘é€å’Œæ¥æ”¶æ“ä½œåŒæ­¥</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>å®ä¾‹åŒ–äº† chan çš„ç»“æ„ä½“ï¼Œè¿”å›chæŒ‡é’ˆ</p><h4 id="channelä¸­å‘é€send-ch-lt-xxx-å’Œrecv-lt-ch-æ¥æ”¶"><a href="#channelä¸­å‘é€send-ch-lt-xxx-å’Œrecv-lt-ch-æ¥æ”¶" class="headerlink" title="channelä¸­å‘é€send(ch &lt;- xxx)å’Œrecv(&lt;- ch)æ¥æ”¶"></a>channelä¸­å‘é€send(ch &lt;- xxx)å’Œrecv(&lt;- ch)æ¥æ”¶</h4><p>ä½¿ç”¨ mutex åŠ é”æ“ä½œï¼Œæ–°è¿›å…ˆå‡ºçš„é˜Ÿåˆ—</p><h4 id="å½“channelç¼“å­˜æ»¡å"><a href="#å½“channelç¼“å­˜æ»¡å" class="headerlink" title="å½“channelç¼“å­˜æ»¡å"></a>å½“channelç¼“å­˜æ»¡å</h4><h5 id="å‘é€æ»¡çš„æ—¶å€™"><a href="#å‘é€æ»¡çš„æ—¶å€™" class="headerlink" title="å‘é€æ»¡çš„æ—¶å€™"></a>å‘é€æ»¡çš„æ—¶å€™</h5><p>å½“é˜Ÿåˆ—å·²æ»¡çš„æ—¶å€™ï¼ŒG1æ­£åœ¨è¿è¡Œï¼Œå½“å†æ¬¡sendæ“ä½œæ—¶ï¼Œä¼šä¸»åŠ¨è°ƒç”¨GOçš„è°ƒåº¦å™¨ï¼Œè®©G1ç­‰å¾…ï¼Œå¹¶è®©å‡ºMï¼ŒåŒæ—¶G1ä¹Ÿä¼šè¢«æŠ½è±¡æˆå«æœ‰G1æŒ‡é’ˆå’Œsendå…ƒç´ çš„sudogç»“æ„ä½“ä¿å­˜åˆ°hchançš„<code>sendq</code>ä¸­ç­‰å¾…è¢«å”¤é†’ã€‚</p><p>å½“G2 recvæ“ä½œçš„æ—¶å€™ï¼ŒG2ä»ç¼“å­˜é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®ï¼Œchannelä¼šå°†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„G1æ¨å‡ºï¼Œå°†G1å½“æ—¶sendçš„æ•°æ®æ¨åˆ°ç¼“å­˜ä¸­ï¼Œç„¶åè°ƒç”¨Goçš„schedulerï¼Œå”¤é†’G1ï¼Œå¹¶æŠŠG1æ”¾åˆ°å¯è¿è¡Œçš„Goroutineé˜Ÿåˆ—ä¸­ã€‚</p><h5 id="æ¥æ”¶æ»¡çš„æ—¶å€™"><a href="#æ¥æ”¶æ»¡çš„æ—¶å€™" class="headerlink" title="æ¥æ”¶æ»¡çš„æ—¶å€™"></a>æ¥æ”¶æ»¡çš„æ—¶å€™</h5><p>è¿™ä¸ªæ—¶å€™G2ä¼šä¸»åŠ¨è°ƒç”¨Goçš„è°ƒåº¦å™¨,è®©G2ç­‰å¾…ï¼Œå¹¶ä»è®©å‡ºMï¼Œè®©å…¶ä»–Gå»ä½¿ç”¨ã€‚ G2è¿˜ä¼šè¢«æŠ½è±¡æˆå«æœ‰G2æŒ‡é’ˆå’Œrecvç©ºå…ƒç´ çš„<code>sudog</code>ç»“æ„ä½“ä¿å­˜åˆ°hchançš„<code>recvq</code>ä¸­ç­‰å¾…è¢«å”¤é†’ã€‚æ­¤æ—¶æ°å¥½æœ‰ä¸ªgoroutine G1å¼€å§‹å‘channelä¸­æ¨é€æ•°æ® <code>ch &lt;- 1</code>ã€‚ æ­¤æ—¶ï¼Œéå¸¸æœ‰æ„æ€çš„äº‹æƒ…å‘ç”Ÿäº†ï¼šG1å¹¶æ²¡æœ‰é”ä½channelï¼Œç„¶åå°†æ•°æ®æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œè€Œæ˜¯ç›´æ¥æŠŠæ•°æ®ä»G1ç›´æ¥copyåˆ°äº†G2çš„æ ˆä¸­ã€‚ è¿™ç§æ–¹å¼éå¸¸çš„èµï¼åœ¨å”¤é†’è¿‡ç¨‹ä¸­ï¼ŒG2æ— éœ€å†è·å¾—channelçš„é”ï¼Œç„¶åä»ç¼“å­˜ä¸­å–æ•°æ®ã€‚å‡å°‘äº†å†…å­˜çš„copyï¼Œæé«˜äº†æ•ˆç‡ã€‚</p><h4 id="4-channel-çš„çŠ¶æ€å’Œæ“ä½œæ–¹å¼"><a href="#4-channel-çš„çŠ¶æ€å’Œæ“ä½œæ–¹å¼" class="headerlink" title="4. channel çš„çŠ¶æ€å’Œæ“ä½œæ–¹å¼"></a>4. channel çš„çŠ¶æ€å’Œæ“ä½œæ–¹å¼</h4><p>å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">æ“ä½œ</th><th align="left">nil çš„ channel</th><th align="left">å·²å…³é—­çš„ channel</th><th align="left">æ­£å¸¸ channel</th></tr></thead><tbody><tr><td align="left">close å…³é—­</td><td align="left">panic</td><td align="left">panic</td><td align="left">æˆåŠŸ</td></tr><tr><td align="left">ch &lt;- å†™</td><td align="left">æ­»é”</td><td align="left">panic</td><td align="left">é˜»å¡æˆ–æˆåŠŸ</td></tr><tr><td align="left">&lt;-ch è¯»</td><td align="left">æ­»é”</td><td align="left">é›¶å€¼</td><td align="left">é˜»å¡æˆ–æˆåŠŸ</td></tr></tbody></table><p>channelä¸€ä¸ªç±»å‹ç®¡é“ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨goroutineä¹‹é—´å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å®ƒæ˜¯Golangåœ¨è¯­è¨€å±‚é¢æä¾›çš„goroutineé—´çš„é€šä¿¡æ–¹å¼ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒGoä¾èµ–äºç§°ä¸ºCSPï¼ˆCommunicating Sequential Processesï¼‰çš„å¹¶å‘æ¨¡å‹ï¼Œé€šè¿‡Channelå®ç°è¿™ç§åŒæ­¥æ¨¡å¼ã€‚Goå¹¶å‘çš„æ ¸å¿ƒå“²å­¦æ˜¯ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡; ç›¸åï¼Œé€šè¿‡æ²Ÿé€šåˆ†äº«è®°å¿†ã€‚</p><h2 id="channel-å¸¸è§ç”¨æ³•"><a href="#channel-å¸¸è§ç”¨æ³•" class="headerlink" title="channel å¸¸è§ç”¨æ³•"></a>channel å¸¸è§ç”¨æ³•</h2><h4 id="å¾ªç¯è¯»å–"><a href="#å¾ªç¯è¯»å–" class="headerlink" title="å¾ªç¯è¯»å–"></a>å¾ªç¯è¯»å–</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x := <span class="keyword">range</span> ch &#123;</span><br><span class="line">fmt.Println(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> channel </tag>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>http ç½‘ç»œé¢è¯•å¿…å¤‡</title>
      <link href="/interview/http/"/>
      <url>/interview/http/</url>
      
        <content type="html"><![CDATA[<h3 id="HTTP-åè®®å’Œ-HTTPS"><a href="#HTTP-åè®®å’Œ-HTTPS" class="headerlink" title="HTTP åè®®å’Œ HTTPS"></a>HTTP åè®®å’Œ HTTPS</h3><ul><li>HTTPSæ˜¯åŠ å¯†ä¼ è¾“åè®®ï¼ŒHTTPæ˜¯åæ–‡ä¼ è¾“åè®®</li><li>HTTPSéœ€è¦ç”¨åˆ°SSLè¯ä¹¦ï¼Œè€ŒHTTPä¸ç”¨</li><li>HTTPSæ¯”HTTPæ›´åŠ å®‰å…¨ï¼Œå¯¹æœç´¢å¼•æ“æ›´å‹å¥½ï¼Œåˆ©äºSEOã€å‚è€ƒï¼šï¼ˆ1ï¼‰ä¸ºä¿æŠ¤ç”¨æˆ·éšç§å®‰å…¨,è°·æ­Œä¼˜å…ˆç´¢å¼•HTTPSç½‘é¡µã€ï¼ˆ2ï¼‰ç™¾åº¦å¼€æ”¾æ”¶å½•httpsç«™ç‚¹ï¼Œhttpså…¨ç½‘åŒ–åŠ¿ä¸å¯æŒ¡ã€‘</li><li>HTTPSæ ‡å‡†ç«¯å£443ï¼ŒHTTPæ ‡å‡†ç«¯å£80</li><li>HTTPSåŸºäºä¼ è¾“å±‚ï¼ŒHTTPåŸºäºåº”ç”¨å±‚</li><li>HTTPSåœ¨æµè§ˆå™¨æ˜¾ç¤ºç»¿è‰²å®‰å…¨é”ï¼ŒHTTPæ²¡æœ‰æ˜¾ç¤º</li></ul><h3 id="TLS-x2F-SSLå·¥ä½œåŸç†"><a href="#TLS-x2F-SSLå·¥ä½œåŸç†" class="headerlink" title="TLS&#x2F;SSLå·¥ä½œåŸç†"></a>TLS&#x2F;SSLå·¥ä½œåŸç†</h3><p>å¯¹ç§°åŠ å¯†ï¼š</p><ul><li>ç®—æ³•æ˜¯å…¬å¼€çš„</li><li>é€šè¿‡ç§˜é’¥æ¥åŠ å¯†ï¼Œä½¿ç”¨ç›¸åŒçš„ç§˜é’¥åŠ å¯†è§£å¯†</li><li>des, 3des, aes</li><li>ç¼ºç‚¹ï¼š<ul><li>ç§˜é’¥å®¹æ˜“æ³„éœ²</li><li>ä¸€ä¸ªç”¨æˆ·éœ€è¦å¯¹åº”ä¸€ä¸ªç§˜é’¥ï¼ŒæœåŠ¡å™¨ç®¡ç†ç§˜é’¥æ¯”è¾ƒéº»çƒ¦</li></ul></li></ul><p>éå¯¹ç§°åŠ å¯†ï¼š</p><ul><li>ç®—æ³•å…¬å¼€</li><li>å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†</li><li>ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†</li><li>é»‘å®¢æ‹¿åˆ°å…¬é’¥å’Œå…¬é’¥åŠ å¯†çš„å†…å®¹ä¹Ÿè§£ä¸äº†å¯†</li><li>rsa, ecc, dh</li><li>ä¼˜ç‚¹ï¼š<ul><li>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„é’¥åŒ™ï¼Œå¯ä»¥ä¼ è¾“å…¬é’¥æ˜¯å®‰å…¨çš„</li></ul></li><li>ç¼ºç‚¹<ul><li>åŠ å¯†å’Œè§£å¯†çš„é€Ÿåº¦æ¯”è¾ƒæ…¢</li></ul></li></ul><p>æ•£åˆ—å‡½æ•°Hashï¼š</p><ul><li>MD5ï¼ŒSHA1ï¼ŒSHA256</li><li>å‡½æ•°å•å‘ä¸å¯é€†ã€å¯¹è¾“å…¥éå¸¸æ•æ„Ÿã€è¾“å‡ºé•¿åº¦å›ºå®š</li><li>æ•£åˆ—å‡½æ•°ä¸èƒ½å•ç‹¬å®ç°ä¿¡æ¯é˜²ç¯¡æ”¹ï¼Œå› ä¸ºæ˜æ–‡ä¼ è¾“ï¼Œä¸­é—´äººå¯ä»¥ä¿®æ”¹ä¿¡æ¯ä¹‹åé‡æ–°è®¡ç®—ä¿¡æ¯æ‘˜è¦ï¼Œå› æ­¤éœ€è¦å¯¹ä¼ è¾“çš„ä¿¡æ¯ä»¥åŠä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†</li></ul><h4 id="HTTPSçš„æ¡æ‰‹è¿‡ç¨‹"><a href="#HTTPSçš„æ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="HTTPSçš„æ¡æ‰‹è¿‡ç¨‹"></a>HTTPSçš„æ¡æ‰‹è¿‡ç¨‹</h4><p><img src="https://static.studygolang.com/200511/4bf1766991151c30854781c4b4455eb2.png" alt="image"><br>HTTPSçš„æ¡æ‰‹è¿‡ç¨‹</p><ol><li>â€œclient helloâ€æ¶ˆæ¯ï¼šå®¢æˆ·ç«¯é€šè¿‡å‘é€â€client helloâ€æ¶ˆæ¯å‘æœåŠ¡å™¨å‘èµ·æ¡æ‰‹è¯·æ±‚ï¼Œè¯¥æ¶ˆæ¯åŒ…å«äº†å®¢æˆ·ç«¯æ‰€æ”¯æŒçš„ TLS ç‰ˆæœ¬å’Œå¯†ç ç»„åˆä»¥ä¾›æœåŠ¡å™¨è¿›è¡Œé€‰æ‹©ï¼Œè¿˜æœ‰ä¸€ä¸ªâ€client randomâ€éšæœºå­—ç¬¦ä¸²ã€‚</li><li>â€œserver helloâ€æ¶ˆæ¯ï¼šæœåŠ¡å™¨å‘é€â€server helloâ€æ¶ˆæ¯å¯¹å®¢æˆ·ç«¯è¿›è¡Œå›åº”ï¼Œè¯¥æ¶ˆæ¯åŒ…å«äº†æ•°å­—è¯ä¹¦ï¼ŒæœåŠ¡å™¨é€‰æ‹©çš„å¯†ç ç»„åˆå’Œâ€server randomâ€éšæœºå­—ç¬¦ä¸²ã€‚</li><li>éªŒè¯ï¼šå®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨å‘æ¥çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿å¯¹æ–¹çš„åˆæ³•èº«ä»½ï¼ŒéªŒè¯è¿‡ç¨‹å¯ä»¥ç»†åŒ–ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š<ol><li>æ£€æŸ¥æ•°å­—ç­¾å</li><li>éªŒè¯è¯ä¹¦é“¾</li><li>æ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæœŸ</li><li>æ£€æŸ¥è¯ä¹¦çš„æ’¤å›çŠ¶æ€ (æ’¤å›ä»£è¡¨è¯ä¹¦å·²å¤±æ•ˆ)</li></ol></li><li>premaster secret å­—ç¬¦ä¸²ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å¦ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²â€premaster secret ï¼ˆé¢„ä¸»å¯†é’¥ï¼‰â€ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ç»è¿‡æœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†è¿‡çš„ï¼Œåªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚</li><li>ä½¿ç”¨ç§é’¥ï¼šæœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†â€premaster secretâ€ã€‚</li><li>ç”Ÿæˆå…±äº«å¯†é’¥ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‡ä½¿ç”¨ client randomï¼Œserver random å’Œ premaster secretï¼Œå¹¶é€šè¿‡ç›¸åŒçš„ç®—æ³•ç”Ÿæˆç›¸åŒçš„å…±äº«å¯†é’¥ KEYã€‚</li><li>å®¢æˆ·ç«¯å°±ç»ªï¼šå®¢æˆ·ç«¯å‘é€ç»è¿‡å…±äº«å¯†é’¥ KEYåŠ å¯†è¿‡çš„â€finishedâ€ä¿¡å·ã€‚</li><li>æœåŠ¡å™¨å°±ç»ªï¼šæœåŠ¡å™¨å‘é€ç»è¿‡å…±äº«å¯†é’¥ KEYåŠ å¯†è¿‡çš„â€finishedâ€ä¿¡å·ã€‚</li><li>è¾¾æˆå®‰å…¨é€šä¿¡ï¼šæ¡æ‰‹å®Œæˆï¼ŒåŒæ–¹ä½¿ç”¨å¯¹ç§°åŠ å¯†è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚</li></ol><h4 id="HTTPSæ¥å…¥ä¼˜åŒ–"><a href="#HTTPSæ¥å…¥ä¼˜åŒ–" class="headerlink" title="HTTPSæ¥å…¥ä¼˜åŒ–"></a>HTTPSæ¥å…¥ä¼˜åŒ–</h4><ol><li>CDNæ¥å…¥<br>HTTPS å¢åŠ çš„å»¶æ—¶ä¸»è¦æ˜¯ä¼ è¾“å»¶æ—¶ RTTï¼ŒRTT çš„ç‰¹ç‚¹æ˜¯èŠ‚ç‚¹è¶Šè¿‘å»¶æ—¶è¶Šå°ï¼ŒCDN å¤©ç„¶ç¦»ç”¨æˆ·æœ€è¿‘ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨ CDN ä½œä¸º HTTPS æ¥å…¥çš„å…¥å£ï¼Œå°†èƒ½å¤Ÿæå¤§å‡å°‘æ¥å…¥å»¶æ—¶ã€‚CDN èŠ‚ç‚¹é€šè¿‡å’Œä¸šåŠ¡æœåŠ¡å™¨ç»´æŒé•¿è¿æ¥ã€ä¼šè¯å¤ç”¨å’Œé“¾è·¯è´¨é‡ä¼˜åŒ–ç­‰å¯æ§æ–¹æ³•ï¼Œæå¤§å‡å°‘ HTTPS å¸¦æ¥çš„å»¶æ—¶ã€‚</li><li>ä¼šè¯ç¼“å­˜<br>è™½ç„¶å‰æ–‡æåˆ° HTTPS å³ä½¿é‡‡ç”¨ä¼šè¯ç¼“å­˜ä¹Ÿè¦è‡³å°‘1*RTTçš„å»¶æ—¶ï¼Œä½†æ˜¯è‡³å°‘å»¶æ—¶å·²ç»å‡å°‘ä¸ºåŸæ¥çš„ä¸€åŠï¼Œæ˜æ˜¾çš„å»¶æ—¶ä¼˜åŒ–;åŒæ—¶ï¼ŒåŸºäºä¼šè¯ç¼“å­˜å»ºç«‹çš„ HTTPS è¿æ¥ä¸éœ€è¦æœåŠ¡å™¨ä½¿ç”¨RSAç§é’¥è§£å¯†è·å– Pre-master ä¿¡æ¯ï¼Œå¯ä»¥çœå»CPU çš„æ¶ˆè€—ã€‚å¦‚æœä¸šåŠ¡è®¿é—®è¿æ¥é›†ä¸­ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜ï¼Œåˆ™HTTPSçš„æ¥å…¥èƒ½åŠ›è®²æ˜æ˜¾æå‡ã€‚å½“å‰TRPå¹³å°çš„ç¼“å­˜å‘½ä¸­ç‡é«˜å³°æ—¶æœŸå¤§äº30%ï¼Œ10k&#x2F;sçš„æ¥å…¥èµ„æºå®é™…å¯ä»¥æ‰¿è½½13k&#x2F;çš„æ¥å…¥ï¼Œæ”¶æ•ˆéå¸¸å¯è§‚ã€‚</li><li>ç¡¬ä»¶åŠ é€Ÿ<br>ä¸ºæ¥å…¥æœåŠ¡å™¨å®‰è£…ä¸“ç”¨çš„SSLç¡¬ä»¶åŠ é€Ÿå¡ï¼Œä½œç”¨ç±»ä¼¼ GPUï¼Œé‡Šæ”¾ CPUï¼Œèƒ½å¤Ÿå…·æœ‰æ›´é«˜çš„ HTTPS æ¥å…¥èƒ½åŠ›ä¸”ä¸å½±å“ä¸šåŠ¡ç¨‹åºçš„ã€‚æµ‹è¯•æŸç¡¬ä»¶åŠ é€Ÿå¡å•å¡å¯ä»¥æä¾›35kçš„è§£å¯†èƒ½åŠ›ï¼Œç›¸å½“äº175æ ¸ CPUï¼Œè‡³å°‘ç›¸å½“äº7å°24æ ¸çš„æœåŠ¡å™¨ï¼Œè€ƒè™‘åˆ°æ¥å…¥æœåŠ¡å™¨å…¶å®ƒç¨‹åºçš„å¼€é”€ï¼Œä¸€å¼ ç¡¬ä»¶å¡å¯ä»¥å®ç°æ¥è¿‘10å°æœåŠ¡å™¨çš„æ¥å…¥èƒ½åŠ›ã€‚</li><li>è¿œç¨‹è§£å¯†<br>æœ¬åœ°æ¥å…¥æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æºï¼Œæµªè´¹äº†ç½‘å¡å’Œç¡¬ç›˜ç­‰èµ„æºï¼Œè€ƒè™‘å°†æœ€æ¶ˆè€— CPU èµ„æºçš„RSAè§£å¯†è®¡ç®—ä»»åŠ¡è½¬ç§»åˆ°å…¶å®ƒæœåŠ¡å™¨ï¼Œå¦‚æ­¤åˆ™å¯ä»¥å……åˆ†å‘æŒ¥æœåŠ¡å™¨çš„æ¥å…¥èƒ½åŠ›ï¼Œå……åˆ†åˆ©ç”¨å¸¦å®½ä¸ç½‘å¡èµ„æºã€‚è¿œç¨‹è§£å¯†æœåŠ¡å™¨å¯ä»¥é€‰æ‹© CPU è´Ÿè½½è¾ƒä½çš„æœºå™¨å……å½“ï¼Œå®ç°æœºå™¨èµ„æºå¤ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸“é—¨ä¼˜åŒ–çš„é«˜è®¡ç®—æ€§èƒ½çš„æœåŠ¡å™¨ã€‚å½“å‰ä¹Ÿæ˜¯ CDN ç”¨äºå¤§è§„æ¨¡HTTPSæ¥å…¥çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚</li><li>SPDY&#x2F;HTTP2<br>å‰é¢çš„æ–¹æ³•åˆ†åˆ«ä»å‡å°‘ä¼ è¾“å»¶æ—¶å’Œå•æœºè´Ÿè½½çš„æ–¹æ³•æé«˜ HTTPS æ¥å…¥æ€§èƒ½ï¼Œä½†æ˜¯æ–¹æ³•éƒ½åŸºäºä¸æ”¹å˜ HTTP åè®®çš„åŸºç¡€ä¸Šæå‡ºçš„ä¼˜åŒ–æ–¹æ³•ï¼ŒSPDY&#x2F;HTTP2 åˆ©ç”¨ TLS&#x2F;SSL å¸¦æ¥çš„ä¼˜åŠ¿ï¼Œé€šè¿‡ä¿®æ”¹åè®®çš„æ–¹æ³•æ¥æå‡ HTTPS çš„æ€§èƒ½ï¼Œæé«˜ä¸‹è½½é€Ÿåº¦ç­‰ã€‚</li></ol><h4 id="httpsåŠ å¯†ã€è§£å¯†åŠéªŒè¯è¿‡ç¨‹"><a href="#httpsåŠ å¯†ã€è§£å¯†åŠéªŒè¯è¿‡ç¨‹" class="headerlink" title="httpsåŠ å¯†ã€è§£å¯†åŠéªŒè¯è¿‡ç¨‹"></a>httpsåŠ å¯†ã€è§£å¯†åŠéªŒè¯è¿‡ç¨‹</h4><ul><li>æµè§ˆå™¨å‘é€è¯·æ±‚443ç«¯å£ï¼ˆè‡ªèº«æ”¯æŒçš„éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåå•†ï¼‰</li><li>sslå±‚æ”¾å…¥å…¬é’¥å’ŒæœåŠ¡å™¨èº«ä»½è®¤è¯è¿›è¡Œç­¾åï¼Œä¿ç•™ç§é’¥</li><li>æµè§ˆå™¨æ ¡éªŒå…¬é’¥ï¼Œå’ŒæœåŠ¡å™¨èº«ä»½</li><li>äº§ç”Ÿéšæœºç ï¼Œç”¨å…¬é’¥åŠ å¯†ï¼ˆæ­¤æ—¶é»‘å®¢å°±ç®—å¾—åˆ°å…¬é’¥ä¹Ÿæ²¡åŠæ³•å¯¹å…¶è§£å¯†å‡ºéšæœºç ï¼‰</li><li>æœåŠ¡å™¨ç”¨ä¼šè¯å¯†é’¥æ¥å¯¹ç§°åŠ å¯†ä¼ è¾“</li></ul><h4 id="tcpå’Œudpçš„åŒºåˆ«"><a href="#tcpå’Œudpçš„åŒºåˆ«" class="headerlink" title="tcpå’Œudpçš„åŒºåˆ«?"></a>tcpå’Œudpçš„åŒºåˆ«?</h4><ol><li>è¿æ¥: tcpéœ€è¦å»ºç«‹è¿æ¥ udpä¸éœ€å»ºç«‹è¿æ¥</li><li>æœåŠ¡å¯¹è±¡: tcpæ˜¯ä¸€å¯¹ä¸€, udpå¯ä¸€å¯¹ä¸€, ä¸€å¯¹å¤š</li><li>å¯é æ€§: tcpå¯é , æœ‰åº, udpä¸å¯é , æ— åº</li><li>æ‹¥å¡æ§åˆ¶,æµé‡æ§åˆ¶: tcpæ‹¥æœ‰æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶, ä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§, udpå³ä½¿ç½‘ç»œéå¸¸æ‹¥å µ, ä¹Ÿä¸å½±å“udpçš„å‘é€é€Ÿç‡</li><li>ä¼ è¾“æ–¹å¼: tcpä¸ºæµå¼ä¼ è¾“, æ²¡æœ‰è¾¹ç•Œ, ä½†ä¿è¯é¡ºåºå’Œå¯é , udpæ˜¯ä¸€ä¸ªåŒ…ä¸€ä¸ªåŒ…å‘é€, æœ‰è¾¹ç•Œ, ä½†æ˜¯å¯èƒ½ä¸¢åŒ…æˆ–ä¹±åº</li><li>é¦–éƒ¨å¼€é”€: tcpçš„é¦–éƒ¨å¼€é”€å¤§, udpçš„é¦–éƒ¨åªæœ‰å›ºå®šçš„8å­—èŠ‚,å¼€é”€å°</li></ol><h4 id="é¢è¯•å¸¸é—®é—®é¢˜â€”â€”æµè§ˆå™¨è®¿é—®ç½‘å€å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#é¢è¯•å¸¸é—®é—®é¢˜â€”â€”æµè§ˆå™¨è®¿é—®ç½‘å€å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="é¢è¯•å¸¸é—®é—®é¢˜â€”â€”æµè§ˆå™¨è®¿é—®ç½‘å€å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>é¢è¯•å¸¸é—®é—®é¢˜â€”â€”æµè§ˆå™¨è®¿é—®ç½‘å€å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h4><p>æ€»ä½“æ¥è¯´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿‡ç¨‹ï¼š</p><ol><li>DNSè§£æ</li><li>TCPè¿æ¥</li><li>å‘é€HTTPè¯·æ±‚</li><li>æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›HTTPæŠ¥æ–‡</li><li>æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢</li><li>è¿æ¥ç»“æŸ</li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> https </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>channel - goroutine</title>
      <link href="/golang/concurrency/channel-gorourine/"/>
      <url>/golang/concurrency/channel-gorourine/</url>
      
        <content type="html"><![CDATA[<h3 id="goroutineè¶…æ—¶å¤„ç†"><a href="#goroutineè¶…æ—¶å¤„ç†" class="headerlink" title="goroutineè¶…æ—¶å¤„ç†"></a>goroutineè¶…æ—¶å¤„ç†</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    c1 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">        c1 &lt;- <span class="string">&quot;result 1&quot;</span></span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> res := &lt;-c1:</span><br><span class="line">        fmt.Println(res)</span><br><span class="line">    <span class="keyword">case</span> &lt;-time.After(<span class="number">1</span> * time.Second):</span><br><span class="line">        fmt.Println(<span class="string">&quot;timeout 1&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    c2 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">        c2 &lt;- <span class="string">&quot;result 2&quot;</span></span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> res := &lt;-c2:</span><br><span class="line">        fmt.Println(res)</span><br><span class="line">    <span class="keyword">case</span> &lt;-time.After(<span class="number">3</span> * time.Second):</span><br><span class="line">        fmt.Println(<span class="string">&quot;timeout 2&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ— é˜»å¡"><a href="#æ— é˜»å¡" class="headerlink" title="æ— é˜»å¡"></a>æ— é˜»å¡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> res := &lt;-c2:</span><br><span class="line">    fmt.Println(res)</span><br><span class="line">    <span class="keyword">case</span> &lt;-time.After(<span class="number">3</span> * time.Second):</span><br><span class="line">    fmt.Println(<span class="string">&quot;timeout 2&quot;</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;abc&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€šé“å…³é—­"><a href="#é€šé“å…³é—­" class="headerlink" title="é€šé“å…³é—­"></a>é€šé“å…³é—­</h3><ol><li>close(channel) å…³é—­é€šé“</li><li>jï¼Œmore :&#x3D; &lt;- channel å¦‚æœå·²å…³é—­ï¼Œåˆ™moreä¸º false</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">5</span>)</span><br><span class="line">    done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            j, more := &lt;-jobs</span><br><span class="line">            <span class="keyword">if</span> more &#123;</span><br><span class="line">                fmt.Println(<span class="string">&quot;received job&quot;</span>, j)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                fmt.Println(<span class="string">&quot;received all jobs&quot;</span>)</span><br><span class="line">                done &lt;- <span class="literal">true</span></span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">3</span>; j++ &#123;</span><br><span class="line">        jobs &lt;- j</span><br><span class="line">        fmt.Println(<span class="string">&quot;sent job&quot;</span>, j)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">close</span>(jobs)</span><br><span class="line">    fmt.Println(<span class="string">&quot;sent all jobs&quot;</span>)</span><br><span class="line"></span><br><span class="line">    &lt;-done</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç®¡é“éå†"><a href="#ç®¡é“éå†" class="headerlink" title="ç®¡é“éå†"></a>ç®¡é“éå†</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    queue := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>, <span class="number">2</span>)</span><br><span class="line">    queue &lt;- <span class="string">&quot;one&quot;</span></span><br><span class="line">    queue &lt;- <span class="string">&quot;two&quot;</span></span><br><span class="line">    <span class="built_in">close</span>(queue)</span><br><span class="line">    <span class="keyword">for</span> elem := <span class="keyword">range</span> queue &#123;</span><br><span class="line">        fmt.Println(elem)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åªè¯»å’Œåªå†™ç®¡é“"><a href="#åªè¯»å’Œåªå†™ç®¡é“" class="headerlink" title="åªè¯»å’Œåªå†™ç®¡é“"></a>åªè¯»å’Œåªå†™ç®¡é“</h3><ul><li><code>&lt;-chan string</code> åªè¯»</li><li><code>chan&lt;- string</code> åªå†™</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(jobs <span class="keyword">chan</span> <span class="type">int</span>, done <span class="keyword">chan</span> <span class="type">bool</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">j, more := &lt;-jobs</span><br><span class="line"><span class="keyword">if</span> more &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;received job&quot;</span>, j)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;received all jobs&quot;</span>)</span><br><span class="line">done &lt;- <span class="literal">true</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sendMsg</span><span class="params">(jobs <span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">3</span>; j++ &#123;</span><br><span class="line">jobs &lt;- j</span><br><span class="line">fmt.Println(<span class="string">&quot;sent job&quot;</span>, j)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(jobs)</span><br><span class="line">fmt.Println(<span class="string">&quot;sent all jobs&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">5</span>)</span><br><span class="line">done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> test(jobs, done)</span><br><span class="line"><span class="keyword">go</span> sendMsg(jobs)</span><br><span class="line"></span><br><span class="line">&lt;-done</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ§åˆ¶å¹¶å‘æ•°"><a href="#æ§åˆ¶å¹¶å‘æ•°" class="headerlink" title="æ§åˆ¶å¹¶å‘æ•°"></a>æ§åˆ¶å¹¶å‘æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;sync&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg = sync.WaitGroup&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">choice1()</span><br><span class="line">choice2()</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">choice1</span><span class="params">()</span></span> &#123;</span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span> ,<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++ &#123;</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line">ch &lt;- <span class="number">1</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(ch <span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line">time.Sleep( time.Second)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&lt;- ch</span><br><span class="line">&#125;(ch)</span><br><span class="line">&#125;</span><br><span class="line">wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">choice2</span><span class="params">()</span></span> &#123;</span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span> ,<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++ &#123;</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(ch <span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line">ch &lt;- <span class="number">1</span></span><br><span class="line">time.Sleep( time.Second)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&lt;- ch</span><br><span class="line">&#125;(ch)</span><br><span class="line">&#125;</span><br><span class="line">wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> channel </tag>
            
            <tag> goroutine </tag>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>go åå°„</title>
      <link href="/golang/reflect/"/>
      <url>/golang/reflect/</url>
      
        <content type="html"><![CDATA[<h3 id="Name-and-Kind"><a href="#Name-and-Kind" class="headerlink" title="Name and Kind"></a>Name and Kind</h3><p>å¯è°ƒç”¨å‡½æ•°å’Œå«ä¹‰ï¼Œä»¥åŠç»“æœä¸€è§ˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">typeOfCat := reflect.TypeOf(cat&#123;&#125;)</span><br><span class="line">typeOfCat.Name() <span class="comment">// cat</span></span><br><span class="line">typeOfCat.Kind()  <span class="comment">// struct</span></span><br><span class="line">typeOfCat.NumField() <span class="comment">// 2 å‡ ä¸ªå­—æ®µ</span></span><br><span class="line">typeOfCat.Field(i) <span class="comment">//ç¬¬å‡ ä¸ªå­—æ®µ</span></span><br><span class="line">typeOfCat.FieldByName(<span class="string">&quot;Type&quot;</span>) <span class="comment">// æ‰¾åä¸ºTypeçš„å­—æ®µ</span></span><br><span class="line">typeOfCat.MethodByName(<span class="string">&quot;Start&quot;</span>) <span class="comment">// æ‰¾åä¸ºStartçš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">if</span> typeofCat.Kind() == <span class="string">&quot;ptr&quot;</span>&#123;</span><br><span class="line">  res := typeOfCat.Elem()  <span class="comment">// ç­‰ä»·äº*ptr</span></span><br><span class="line">  res.Name()</span><br><span class="line">  res.Kind()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="reflect-ValueOf-å’Œreflect-Value"><a href="#reflect-ValueOf-å’Œreflect-Value" class="headerlink" title="reflect.ValueOf()å’Œreflect.Value"></a>reflect.ValueOf()å’Œreflect.Value</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">valueOfA := reflect.ValueOf(a)</span><br><span class="line"><span class="keyword">var</span> getA <span class="type">int</span> = valueOfA.Interface().(<span class="type">int</span>)</span><br><span class="line"><span class="keyword">var</span> getA2 <span class="type">int</span> = <span class="type">int</span>(valueOfA.Int())</span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡åå°„è·å–å€¼ä¿¡æ¯"><a href="#é€šè¿‡åå°„è·å–å€¼ä¿¡æ¯" class="headerlink" title="é€šè¿‡åå°„è·å–å€¼ä¿¡æ¯"></a>é€šè¿‡åå°„è·å–å€¼ä¿¡æ¯</h3><h4 id="ä½¿ç”¨åå°„å€¼å¯¹è±¡åŒ…è£…ä»»æ„å€¼"><a href="#ä½¿ç”¨åå°„å€¼å¯¹è±¡åŒ…è£…ä»»æ„å€¼" class="headerlink" title="ä½¿ç”¨åå°„å€¼å¯¹è±¡åŒ…è£…ä»»æ„å€¼"></a>ä½¿ç”¨åå°„å€¼å¯¹è±¡åŒ…è£…ä»»æ„å€¼</h4><p>Goè¯­è¨€ä¸­ï¼Œä½¿ç”¨ reflect.ValueOf() å‡½æ•°è·å¾—å€¼çš„åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ã€‚ä¹¦å†™æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value := reflect.ValueOf(rawValue)</span><br></pre></td></tr></table></figure><p>reflect.ValueOf è¿”å› reflect.Value ç±»å‹ï¼ŒåŒ…å«æœ‰ rawValue çš„å€¼ä¿¡æ¯ã€‚reflect.Value ä¸åŸå€¼é—´å¯ä»¥é€šè¿‡å€¼åŒ…è£…å’Œå€¼è·å–äº’ç›¸è½¬åŒ–ã€‚reflect.Value æ˜¯ä¸€äº›åå°„æ“ä½œçš„é‡è¦ç±»å‹ï¼Œå¦‚åå°„è°ƒç”¨å‡½æ•°ã€‚</p><h4 id="ä»åå°„å€¼å¯¹è±¡è·å–è¢«åŒ…è£…çš„å€¼"><a href="#ä»åå°„å€¼å¯¹è±¡è·å–è¢«åŒ…è£…çš„å€¼" class="headerlink" title="ä»åå°„å€¼å¯¹è±¡è·å–è¢«åŒ…è£…çš„å€¼"></a>ä»åå°„å€¼å¯¹è±¡è·å–è¢«åŒ…è£…çš„å€¼</h4><p>Goè¯­è¨€ä¸­å¯ä»¥é€šè¿‡ reflect.Value é‡æ–°è·å¾—åŸå§‹å€¼ã€‚</p><h5 id="1-ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect-Valueï¼‰ä¸­è·å–å€¼çš„æ–¹æ³•"><a href="#1-ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect-Valueï¼‰ä¸­è·å–å€¼çš„æ–¹æ³•" class="headerlink" title="1) ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ä¸­è·å–å€¼çš„æ–¹æ³•"></a>1) ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ä¸­è·å–å€¼çš„æ–¹æ³•</h5><p>å¯ä»¥é€šè¿‡ä¸‹é¢å‡ ç§æ–¹æ³•ä»åå°„å€¼å¯¹è±¡ reflect.Value ä¸­è·å–åŸå€¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th align="left">æ–¹æ³•å</th><th align="left">è¯´ æ˜</th></tr></thead><tbody><tr><td align="left">Interface() interface {}</td><td align="left">å°†å€¼ä»¥ interface{} ç±»å‹è¿”å›ï¼Œå¯ä»¥é€šè¿‡ç±»å‹æ–­è¨€è½¬æ¢ä¸ºæŒ‡å®šç±»å‹</td></tr><tr><td align="left">Int() int64</td><td align="left">å°†å€¼ä»¥ int ç±»å‹è¿”å›ï¼Œæ‰€æœ‰æœ‰ç¬¦å·æ•´å‹å‡å¯ä»¥æ­¤æ–¹å¼è¿”å›</td></tr><tr><td align="left">Uint() uint64</td><td align="left">å°†å€¼ä»¥ uint ç±»å‹è¿”å›ï¼Œæ‰€æœ‰æ— ç¬¦å·æ•´å‹å‡å¯ä»¥æ­¤æ–¹å¼è¿”å›</td></tr><tr><td align="left">Float() float64</td><td align="left">å°†å€¼ä»¥åŒç²¾åº¦ï¼ˆfloat64ï¼‰ç±»å‹è¿”å›ï¼Œæ‰€æœ‰æµ®ç‚¹æ•°ï¼ˆfloat32ã€float64ï¼‰å‡å¯ä»¥æ­¤æ–¹å¼è¿”å›</td></tr><tr><td align="left">Bool() bool</td><td align="left">å°†å€¼ä»¥ bool ç±»å‹è¿”å›</td></tr><tr><td align="left">Bytes() []bytes</td><td align="left">å°†å€¼ä»¥å­—èŠ‚æ•°ç»„ []bytes ç±»å‹è¿”å›</td></tr><tr><td align="left">String() string</td><td align="left">å°†å€¼ä»¥å­—ç¬¦ä¸²ç±»å‹è¿”å›</td></tr></tbody></table><h5 id="2-ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect-Valueï¼‰ä¸­è·å–å€¼çš„ä¾‹å­"><a href="#2-ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect-Valueï¼‰ä¸­è·å–å€¼çš„ä¾‹å­" class="headerlink" title="2) ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ä¸­è·å–å€¼çš„ä¾‹å­"></a>2) ä»åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ä¸­è·å–å€¼çš„ä¾‹å­</h5><p>ä¸‹é¢ä»£ç ä¸­ï¼Œå°†æ•´å‹å˜é‡ä¸­çš„å€¼ä½¿ç”¨ reflect.Value è·å–åå°„å€¼å¯¹è±¡ï¼ˆreflect.Valueï¼‰ã€‚å†é€šè¿‡ reflect.Value çš„ Interface() æ–¹æ³•è·å¾— interface{} ç±»å‹çš„åŸå€¼ï¼Œé€šè¿‡ int ç±»å‹å¯¹åº”çš„ reflect.Value çš„ Int() æ–¹æ³•è·å¾—æ•´å‹å€¼ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// å£°æ˜æ•´å‹å˜é‡aå¹¶èµ‹åˆå€¼</span></span><br><span class="line">    <span class="keyword">var</span> a <span class="type">int</span> = <span class="number">1024</span></span><br><span class="line">    <span class="comment">// è·å–å˜é‡açš„åå°„å€¼å¯¹è±¡</span></span><br><span class="line">    valueOfA := reflect.ValueOf(a)</span><br><span class="line">    <span class="comment">// è·å–interface&#123;&#125;ç±»å‹çš„å€¼, é€šè¿‡ç±»å‹æ–­è¨€è½¬æ¢</span></span><br><span class="line">    <span class="keyword">var</span> getA <span class="type">int</span> = valueOfA.Interface().(<span class="type">int</span>)</span><br><span class="line">    <span class="comment">// è·å–64ä½çš„å€¼, å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºintç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> getA2 <span class="type">int</span> = <span class="type">int</span>(valueOfA.Int())</span><br><span class="line">    fmt.Println(getA, getA2)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»£ç è¾“å‡ºå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">// 1024 1024</span></span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡reflectåå°„ä¿®æ”¹å€¼"><a href="#é€šè¿‡reflectåå°„ä¿®æ”¹å€¼" class="headerlink" title="é€šè¿‡reflectåå°„ä¿®æ”¹å€¼"></a>é€šè¿‡reflectåå°„ä¿®æ”¹å€¼</h3><p>åˆ¤æ–­åå°„å€¼æ˜¯å¦å¯ä»¥ä¿®æ”¹ï¼ŸCanSet()ï¼Œæ˜¯å¦èƒ½è¢«å–å€CanAddr()</p><p>ç»“æ„ä½“æˆå‘˜ä¸­ï¼Œå¦‚æœå­—æ®µæ²¡æœ‰è¢«å¯¼å‡ºï¼Œå³ä¾¿ä¸ä½¿ç”¨åå°„ä¹Ÿå¯ä»¥è¢«è®¿é—®ï¼Œä½†ä¸èƒ½é€šè¿‡åå°„ä¿®æ”¹</p><ol><li><p>æŒ‡é’ˆæŒ‡å‘çš„å…·ä½“å…ƒç´ </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x := <span class="number">1</span></span><br><span class="line">v := reflect.ValueOf(&amp;x)</span><br><span class="line">v = v.Elem()</span><br></pre></td></tr></table></figure></li><li><p>sliceçš„å…ƒç´ </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">1</span>&#125;</span><br><span class="line">v := reflect.ValueOf(s)</span><br><span class="line">e := v.Index(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></li><li><p>å¯å¯»å€çš„ç»“æ„ä½“çš„å­—æ®µ(æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆ)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Orange <span class="keyword">struct</span>&#123;</span><br><span class="line">  Size <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line">a := Orange&#123;<span class="number">99</span>&#125;</span><br><span class="line">v := reflect.ValueOf(&amp;a)</span><br><span class="line">v = v.Elem()</span><br><span class="line">field = v.FieldByName(<span class="string">&quot;field&quot;</span>)</span><br></pre></td></tr></table></figure></li><li><p>å¯å¯»å€çš„æ•°ç»„çš„å…ƒç´ (æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a := [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">1</span>&#125;</span><br><span class="line">v := reflect.ValueOf(&amp;a)</span><br><span class="line">v = v.Elem()</span><br><span class="line">vIndex = v.Index(<span class="number">0</span>)</span><br><span class="line">vIndex.SetInt(<span class="number">1</span>)</span><br><span class="line">vIndex.SetInt(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li></ol><table><thead><tr><th align="left">-</th><th align="left">-</th></tr></thead><tbody><tr><td align="left">Set(x Value)</td><td align="left">å°†å€¼è®¾ç½®ä¸ºä¼ å…¥çš„åå°„å€¼å¯¹è±¡çš„å€¼</td></tr><tr><td align="left">Setlnt(x int64)</td><td align="left">ä½¿ç”¨ int64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ intã€int8ã€int16ã€ int32ã€int64 æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr><tr><td align="left">SetUint(x uint64)</td><td align="left">ä½¿ç”¨ uint64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ uintã€uint8ã€uint16ã€uint32ã€uint64 æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr><tr><td align="left">SetFloat(x float64)</td><td align="left">ä½¿ç”¨ float64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ float32ã€float64 æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr><tr><td align="left">SetBool(x bool)</td><td align="left">ä½¿ç”¨ bool è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ bod æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr><tr><td align="left">SetBytes(x []byte)</td><td align="left">è®¾ç½®å­—èŠ‚æ•°ç»„ []byteså€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ []byte æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr><tr><td align="left">SetString(x string)</td><td align="left">è®¾ç½®å­—ç¬¦ä¸²å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ string æ—¶ä¼šå‘ç”Ÿå®•æœº</td></tr></tbody></table><h3 id="é€šè¿‡ç±»å‹ä¿¡æ¯åˆ›å»ºå®ä¾‹"><a href="#é€šè¿‡ç±»å‹ä¿¡æ¯åˆ›å»ºå®ä¾‹" class="headerlink" title="é€šè¿‡ç±»å‹ä¿¡æ¯åˆ›å»ºå®ä¾‹"></a>é€šè¿‡ç±»å‹ä¿¡æ¯åˆ›å»ºå®ä¾‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="type">int</span></span><br><span class="line">typeOfA := reflect.TypeOf(a)</span><br><span class="line">aIns := reflect.New(typeOfA) <span class="comment">// ç­‰ä»·äº new(int)</span></span><br><span class="line">fmt.Println(aIns.Type(), aIns.Kind())</span><br></pre></td></tr></table></figure><h3 id="Goè¯­è¨€ç»“æ„ä½“æ ‡ç­¾ï¼ˆStruct-Tagï¼‰"><a href="#Goè¯­è¨€ç»“æ„ä½“æ ‡ç­¾ï¼ˆStruct-Tagï¼‰" class="headerlink" title="Goè¯­è¨€ç»“æ„ä½“æ ‡ç­¾ï¼ˆStruct Tagï¼‰"></a>Goè¯­è¨€ç»“æ„ä½“æ ‡ç­¾ï¼ˆStruct Tagï¼‰</h3><h4 id="ç»“æ„ä½“æ ‡ç­¾çš„æ ¼å¼"><a href="#ç»“æ„ä½“æ ‡ç­¾çš„æ ¼å¼" class="headerlink" title="ç»“æ„ä½“æ ‡ç­¾çš„æ ¼å¼"></a>ç»“æ„ä½“æ ‡ç­¾çš„æ ¼å¼</h4><p>tag æ ¼å¼ï¼š<code>json:&quot;type&quot; id:&quot;100&quot;</code></p><p>æ³¨æ„ï¼š</p><ol><li>key:â€œvalueâ€ å†’å·åæ²¡æœ‰ç©ºæ ¼</li><li>ä¸¤ä¸ªkeyä¹‹é—´ï¼Œä¸€ä¸ªç©ºæ ¼ï¼Œå¤šä¸€ä¸ªéƒ½ä¸è¡Œ</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> cat <span class="keyword">struct</span>&#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">    Type <span class="type">int</span> <span class="string">`json:&quot;type&quot; id:&quot;100&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä»ç»“æ„ä½“æ ‡ç­¾ä¸­è·å–å€¼"><a href="#ä»ç»“æ„ä½“æ ‡ç­¾ä¸­è·å–å€¼" class="headerlink" title="ä»ç»“æ„ä½“æ ‡ç­¾ä¸­è·å–å€¼"></a>ä»ç»“æ„ä½“æ ‡ç­¾ä¸­è·å–å€¼</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">typeOfCat := reflect.TypeOf(cat&#123;&#125;)</span><br><span class="line">catType = typeOfCat.FieldByName(<span class="string">&quot;Type&quot;</span>)</span><br><span class="line">catType.Tag.Get(<span class="string">&quot;json&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§ç”¨æ³•"><a href="#å¸¸è§ç”¨æ³•" class="headerlink" title="å¸¸è§ç”¨æ³•"></a>å¸¸è§ç”¨æ³•</h1><h4 id="åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæ— å‚æ•°ï¼‰"><a href="#åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæ— å‚æ•°ï¼‰" class="headerlink" title="åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæ— å‚æ•°ï¼‰"></a>åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæ— å‚æ•°ï¼‰</h4><ol><li>ç›´æ¥<code>reflect.Valueof</code></li><li><code>MethodByName</code></li><li>è°ƒç”¨<code>Call</code>æ–¹æ³•</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    name := <span class="string">&quot;Do&quot;</span></span><br><span class="line">    t := &amp;T&#123;&#125;</span><br><span class="line">    reflect.ValueOf(t).MethodByName(name).Call(<span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span></span> Do() &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæœ‰å‚æ•°ï¼‰"><a href="#åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæœ‰å‚æ•°ï¼‰" class="headerlink" title="åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæœ‰å‚æ•°ï¼‰"></a>åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆæœ‰å‚æ•°ï¼‰</h4><ol><li>åˆ›å»º<code>reflect.Value</code>åˆ‡ç‰‡</li><li><code>reflect.Valueof(t).MethodByName(string)</code> è°ƒç”¨Callæ–¹æ³•ä¼ å…¥å‚æ•°</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    name := <span class="string">&quot;Do&quot;</span></span><br><span class="line">    t := &amp;T&#123;&#125;</span><br><span class="line">    a := reflect.ValueOf(<span class="number">1111</span>)</span><br><span class="line">    b := reflect.ValueOf(<span class="string">&quot;world&quot;</span>)</span><br><span class="line">    in := []reflect.Value&#123;a, b&#125;</span><br><span class="line">    reflect.ValueOf(t).MethodByName(name).Call(in)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span></span> Do(a <span class="type">int</span>, b <span class="type">string</span>) &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;hello&quot;</span> + b, a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¥æ”¶è¿”å›å€¼"><a href="#æ¥æ”¶è¿”å›å€¼" class="headerlink" title="æ¥æ”¶è¿”å›å€¼"></a>æ¥æ”¶è¿”å›å€¼</h4><ol><li>è¿”å›<code>[]reflect.Value</code></li><li>è°ƒç”¨<code>Interface()</code>æ–¹æ³•ï¼Œè½¬ä¸º<code>interface&#123;&#125;</code>ç±»å‹</li><li>æ–­è¨€ç±»å‹</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    name := <span class="string">&quot;Do&quot;</span></span><br><span class="line">    t := &amp;T&#123;&#125;</span><br><span class="line">    ret := reflect.ValueOf(t).MethodByName(name).Call(<span class="literal">nil</span>)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;strValue: %[1]v\nerrValue: %[2]v\nstrType: %[1]T\nerrType: %[2]T&quot;</span>, ret[<span class="number">0</span>], ret[<span class="number">1</span>].Interface().(<span class="type">error</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span></span> Do() (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>, errors.New(<span class="string">&quot;new error&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Tagè§£æ"><a href="#Tagè§£æ" class="headerlink" title="Tagè§£æ"></a>Tagè§£æ</h4><ol><li><code>reflect.Typeof</code>æœ‰<code>NumField</code>ï¼ŒFieldæ ¹æ®åºå·ç´¢å–ï¼Œå–å…¶ä¸­çš„tag</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span>&#123;</span><br><span class="line">Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">Age <span class="type">int</span> <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">a := T&#123;&#125;</span><br><span class="line">tt := reflect.TypeOf(a)</span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;tt.NumField();i++&#123;</span><br><span class="line">fmt.Println(tt.Field(i).Name)</span><br><span class="line">fmt.Println(tt.Field(i).Tag.Get(<span class="string">&quot;json&quot;</span>))</span><br><span class="line">fmt.Println(tt.Field(i).Tag.Lookup(<span class="string">&quot;json&quot;</span>))</span><br><span class="line">fmt.Println(tt.Field(i).Type)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é€šè¿‡kindï¼ˆï¼‰å¤„ç†ä¸åŒåˆ†æ”¯"><a href="#é€šè¿‡kindï¼ˆï¼‰å¤„ç†ä¸åŒåˆ†æ”¯" class="headerlink" title="é€šè¿‡kindï¼ˆï¼‰å¤„ç†ä¸åŒåˆ†æ”¯"></a>é€šè¿‡kindï¼ˆï¼‰å¤„ç†ä¸åŒåˆ†æ”¯</h4><ol><li><code>reflect.Typeof().Kind()</code></li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">t := <span class="number">1</span></span><br><span class="line">a := reflect.TypeOf(t)</span><br><span class="line"><span class="keyword">switch</span> a.Kind() &#123;</span><br><span class="line"><span class="keyword">case</span> reflect.String:</span><br><span class="line">fmt.Println(<span class="string">&quot;string&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> reflect.Int:</span><br><span class="line">fmt.Println(<span class="string">&quot;int&quot;</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Println(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ¤æ–­ç»“æ„ä½“æ˜¯å¦å®ç°æ¥å£"><a href="#åˆ¤æ–­ç»“æ„ä½“æ˜¯å¦å®ç°æ¥å£" class="headerlink" title="åˆ¤æ–­ç»“æ„ä½“æ˜¯å¦å®ç°æ¥å£"></a>åˆ¤æ–­ç»“æ„ä½“æ˜¯å¦å®ç°æ¥å£</h4><ol><li>å°†<code>nil</code>å¼ºè½¬ä¸ºæ¥å£æŒ‡é’ˆç±»å‹ï¼Œé€šè¿‡<code>reflect.Typeof().Elem</code>è·å–å…¶æ¥å£ç±»å‹</li><li><code>reflect.Typeof</code>è°ƒç”¨æ–¹æ³•<code>Implements</code>æ¥åˆ¤æ–­</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> IT <span class="keyword">interface</span> &#123;</span><br><span class="line">test1()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span><br><span class="line">A <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span></span> test1() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">t := &amp;T&#123;&#125;</span><br><span class="line">elem := reflect.TypeOf((*IT)(<span class="literal">nil</span>)).Elem()</span><br><span class="line"><span class="keyword">if</span> reflect.TypeOf(t).Implements(elem) &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥é€šè¿‡æ¥å£å¼ºè½¬åˆ¤æ–­</p><ol><li>å°†ç±»å‹è½¬æ¢ä¸º <code>reflect.Value</code></li><li>å°†<code>reflect.Value</code>è°ƒç”¨Interface()æ–¹æ³•è½¬ä¸ºæ¥å£ç±»å‹</li><li>ç±»å‹æ–­è¨€</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ITester <span class="keyword">interface</span> &#123;</span><br><span class="line">test1()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">A <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">u := &amp;User&#123;&#125;</span><br><span class="line">v := reflect.ValueOf(u)</span><br><span class="line">val, ok := v.Interface().(ITester)</span><br><span class="line"><span class="keyword">if</span> ok &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Support Interface&quot;</span>, val)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> reflect </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºåŸºç¡€çŸ¥è¯†</title>
      <link href="/interview/elementary/"/>
      <url>/interview/elementary/</url>
      
        <content type="html"><![CDATA[<h3 id="å¤šæ ¸-CPU-Cache-å¦‚ä½•ä¿æŒä¸€è‡´ï¼Ÿ"><a href="#å¤šæ ¸-CPU-Cache-å¦‚ä½•ä¿æŒä¸€è‡´ï¼Ÿ" class="headerlink" title="å¤šæ ¸ CPU Cache å¦‚ä½•ä¿æŒä¸€è‡´ï¼Ÿ"></a>å¤šæ ¸ CPU Cache å¦‚ä½•ä¿æŒä¸€è‡´ï¼Ÿ</h3><p>MESI</p><h3 id="CAP-åŸç†"><a href="#CAP-åŸç†" class="headerlink" title="CAP åŸç†"></a>CAP åŸç†</h3><p><a href="https://cloud.tencent.com/developer/article/2053602">https://cloud.tencent.com/developer/article/2053602</a></p><h3 id="å¤§è¡¨-Join-å°è¡¨ä¼˜åŒ–ï¼Œå¦‚ä½•å¤„ç†æ•°æ®å€¾æ–œ"><a href="#å¤§è¡¨-Join-å°è¡¨ä¼˜åŒ–ï¼Œå¦‚ä½•å¤„ç†æ•°æ®å€¾æ–œ" class="headerlink" title="å¤§è¡¨ Join å°è¡¨ä¼˜åŒ–ï¼Œå¦‚ä½•å¤„ç†æ•°æ®å€¾æ–œ"></a>å¤§è¡¨ Join å°è¡¨ä¼˜åŒ–ï¼Œå¦‚ä½•å¤„ç†æ•°æ®å€¾æ–œ</h3><h3 id="è®²ä¸€ä¸‹æœ€å¤§å †å’Œæœ€å°å †"><a href="#è®²ä¸€ä¸‹æœ€å¤§å †å’Œæœ€å°å †" class="headerlink" title="è®²ä¸€ä¸‹æœ€å¤§å †å’Œæœ€å°å †"></a>è®²ä¸€ä¸‹æœ€å¤§å †å’Œæœ€å°å †</h3><h3 id="happen-before-çš„è§„åˆ™"><a href="#happen-before-çš„è§„åˆ™" class="headerlink" title="happen-before çš„è§„åˆ™"></a>happen-before çš„è§„åˆ™</h3>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç®—æ³•é¢˜æ€»ç»“</title>
      <link href="/interview/inter-alg101/"/>
      <url>/interview/inter-alg101/</url>
      
        <content type="html"><![CDATA[<h3 id="è´Ÿè½½å‡è¡¡ç®—æ³•"><a href="#è´Ÿè½½å‡è¡¡ç®—æ³•" class="headerlink" title="è´Ÿè½½å‡è¡¡ç®—æ³•"></a>è´Ÿè½½å‡è¡¡ç®—æ³•</h3><p>æ›´å¤šåŠ åˆ†ç‚¹ï¼š åŠ æƒç­‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;math/rand&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> LoadBalancer <span class="keyword">struct</span> &#123;</span><br><span class="line">    client []*Client</span><br><span class="line">    size <span class="type">int32</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewLB</span><span class="params">(size <span class="type">int32</span>)</span></span> *LoadBalalcer &#123;</span><br><span class="line">    lb := &amp;LoadBalancer&#123;client: <span class="built_in">make</span>([]*Client, size), size: size&#125;</span><br><span class="line">    lb.client = <span class="built_in">append</span>(lb.client, &amp;Client&#123;&#125;)</span><br><span class="line">    <span class="keyword">return</span> lb</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *LoadBalancer)</span></span> getClient() *Client &#123;</span><br><span class="line">    rand.Seed(time.Now().Unix())</span><br><span class="line">    x := rand.Int31n(<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">return</span> m.client[x &amp; m.size]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Client <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Client)</span></span> Do &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Do&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    lb := NewLB(<span class="number">4</span>)</span><br><span class="line">    lb.getClient().Do()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨åå°„è°ƒç”¨å‡½æ•°"><a href="#åˆ©ç”¨åå°„è°ƒç”¨å‡½æ•°" class="headerlink" title="åˆ©ç”¨åå°„è°ƒç”¨å‡½æ•°"></a>åˆ©ç”¨åå°„è°ƒç”¨å‡½æ•°</h3><p>å®ä¾‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;reflect&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> Car <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Car)</span></span> Drive &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Driving&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    car := Car&#123;&#125;</span><br><span class="line">    val := reflect.ValueOf(&amp;car)</span><br><span class="line">    f := value.MethodByName(<span class="string">&quot;Drive&quot;</span>)</span><br><span class="line">    f.Call([]reflect.Value&#123;&#125;)  <span class="comment">// Drive</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç»™å®šä¸‰ä¸ªå‡½æ•°-cat-dog-fish-ï¼Œæ¯ä¸ªå‡½æ•°å¯åŠ¨ä¸€ä¸ª-goroutine-ï¼Œè¦æ±‚æŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡"><a href="#ç»™å®šä¸‰ä¸ªå‡½æ•°-cat-dog-fish-ï¼Œæ¯ä¸ªå‡½æ•°å¯åŠ¨ä¸€ä¸ª-goroutine-ï¼Œè¦æ±‚æŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡" class="headerlink" title="ç»™å®šä¸‰ä¸ªå‡½æ•° cat dog fish ï¼Œæ¯ä¸ªå‡½æ•°å¯åŠ¨ä¸€ä¸ª goroutine ï¼Œè¦æ±‚æŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡"></a>ç»™å®šä¸‰ä¸ªå‡½æ•° cat dog fish ï¼Œæ¯ä¸ªå‡½æ•°å¯åŠ¨ä¸€ä¸ª goroutine ï¼Œè¦æ±‚æŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PrintCat</span><span class="params">(fishCH,catCH <span class="keyword">chan</span> <span class="type">bool</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">defer</span> waitgroup.Done()</span><br><span class="line"><span class="keyword">defer</span> <span class="built_in">close</span>(catCH)</span><br><span class="line"><span class="keyword">for</span> i:= <span class="number">0</span>; i &lt;<span class="number">100</span>;i++&#123;</span><br><span class="line">&lt;-fishCH</span><br><span class="line">fmt.Println(<span class="string">&quot;cat ...&quot;</span>)</span><br><span class="line">catCH &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PrintDog</span><span class="params">(catCH,dogCH <span class="keyword">chan</span> <span class="type">bool</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">defer</span> waitgroup.Done()</span><br><span class="line"><span class="keyword">defer</span> <span class="built_in">close</span>(dogCH)</span><br><span class="line"><span class="keyword">for</span> i:= <span class="number">0</span>; i &lt;<span class="number">100</span>;i++&#123;</span><br><span class="line">&lt;-catCH</span><br><span class="line">fmt.Println(<span class="string">&quot;dog ...&quot;</span>)</span><br><span class="line">dogCH&lt;-<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PrintFish</span><span class="params">(dogCH,fishCH <span class="keyword">chan</span> <span class="type">bool</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">defer</span> waitgroup.Done()</span><br><span class="line"><span class="keyword">defer</span> <span class="built_in">close</span>(fishCH)</span><br><span class="line"><span class="keyword">for</span> i:= <span class="number">0</span>; i &lt;<span class="number">100</span>;i++&#123;</span><br><span class="line">&lt;-dogCH</span><br><span class="line">fmt.Println(<span class="string">&quot;fish ...&quot;</span>)</span><br><span class="line">fishCH&lt;-<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> waitgroup sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">catCH := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>,<span class="number">1</span>)</span><br><span class="line">dogCH := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>,<span class="number">1</span>)</span><br><span class="line">fishCH := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>,<span class="number">1</span>)</span><br><span class="line">fishCH &lt;- <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> PrintFish(dogCH,fishCH)</span><br><span class="line"><span class="keyword">go</span> PrintDog(catCH,dogCH)</span><br><span class="line"><span class="keyword">go</span> PrintCat(fishCH,catCH)</span><br><span class="line"></span><br><span class="line">waitgroup.Add(<span class="number">3</span>)</span><br><span class="line">waitgroup.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŠ½å¥–é—®é¢˜"><a href="#æŠ½å¥–é—®é¢˜" class="headerlink" title="æŠ½å¥–é—®é¢˜"></a>æŠ½å¥–é—®é¢˜</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™å®šå¦‚ä¸‹ç»“æ„</span></span><br><span class="line"><span class="comment">// mapä¸­ï¼Œkeyä»£è¡¨åç§°ï¼Œvalueä»£è¡¨æˆäº¤å•æ•°</span></span><br><span class="line"><span class="keyword">var</span> users <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span> = <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>&#123;</span><br><span class="line">  <span class="string">&quot;a&quot;</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="string">&quot;b&quot;</span>: <span class="number">6</span>,</span><br><span class="line">  <span class="string">&quot;c&quot;</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;d&quot;</span>: <span class="number">12</span>,</span><br><span class="line">  <span class="string">&quot;f&quot;</span>: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="1-éšæœºæŠ½å¥–"><a href="#1-éšæœºæŠ½å¥–" class="headerlink" title="1. éšæœºæŠ½å¥–"></a>1. éšæœºæŠ½å¥–</h5><p>ä» map ä¸­éšæœºé€‰å–ç”¨æˆ·ä¸­å¥–<br>æ€è·¯ï¼šå°†ç”¨æˆ·ç†è§£ä¸ºä¸€ä¸ªä¸ªæ ¼å­ï¼Œä»ä¸­é€‰å–ä¸€ä¸ªæ ¼å­ä¸­å¥–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;math/rand&quot;</span></span><br><span class="line">  <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetAwardUserName</span><span class="params">(users <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>)</span></span> (name <span class="type">string</span>) &#123;</span><br><span class="line">  sizeOfUsers := <span class="built_in">len</span>(users)</span><br><span class="line">  award_index := rand.Intn(sizeOfUsers)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> index <span class="type">int</span></span><br><span class="line">  <span class="keyword">for</span> u_name, _ := <span class="keyword">range</span> users &#123;</span><br><span class="line">    <span class="keyword">if</span> index == award_index &#123;</span><br><span class="line">      name = u_name</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> users <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span> = <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="string">&quot;b&quot;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">&quot;c&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;d&quot;</span>: <span class="number">12</span>,</span><br><span class="line">    <span class="string">&quot;e&quot;</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;f&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  rand.Seed(time.Now().Unix())</span><br><span class="line">  <span class="comment">// æŠ½å¥–1æ¬¡</span></span><br><span class="line">  name := GetAwardUserName(users)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;user: %s jack point&quot;</span>, name)</span><br><span class="line">  <span class="comment">// æŠ½å¥–1000æ¬¡</span></span><br><span class="line">  award_stat := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>)</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000</span>; i += <span class="number">1</span> &#123;</span><br><span class="line">    name := GetAwardUserName(users)</span><br><span class="line">    <span class="keyword">if</span> count, ok := award_stat[name]; ok &#123;</span><br><span class="line">      award_stat[name] = count + <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      award_stat[name] = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> name, count := <span class="keyword">range</span> award_stat &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;user: %s, award count: %d\n&quot;</span>, name, count)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šæ–¹æŠ½å¥–ä»£ç å¤æ‚åº¦ä¸º O(n) ï¼Œå¯ä»¥ç»“åˆäºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–ä¸º O(logN)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetAwardGenerator</span><span class="params">(users <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>)</span></span> (generator <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">string</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sum_num <span class="type">int64</span></span><br><span class="line">  name_arr := <span class="built_in">make</span>([]<span class="type">string</span>, <span class="built_in">len</span>(users))</span><br><span class="line">  offset_arr := <span class="built_in">make</span>([]<span class="type">int64</span>, <span class="built_in">len</span>(users))</span><br><span class="line">  <span class="keyword">var</span> index <span class="type">int</span></span><br><span class="line">  <span class="keyword">for</span> u_name, num := <span class="keyword">range</span> users &#123;</span><br><span class="line">    name_arr[index] = u_name</span><br><span class="line">    offset_arr[index] = sum_num</span><br><span class="line">    sum_num += num</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  generator = <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    award_num := rand.Int63n(sum_num)</span><br><span class="line">    <span class="keyword">return</span> name_arr[binary_search(offset_arr, award_num)]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">binary_search</span><span class="params">(nums []<span class="type">int64</span>, target <span class="type">int64</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">  start, end := <span class="number">0</span>, <span class="built_in">len</span>(nums)<span class="number">-1</span></span><br><span class="line">  <span class="keyword">for</span> start &lt;= end &#123;</span><br><span class="line">    mid := start + (end-start)/<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> nums[mid] &gt; target &#123;</span><br><span class="line">      end = mid - <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> nums[mid] &lt; target &#123;</span><br><span class="line">      <span class="keyword">if</span> mid+<span class="number">1</span> == <span class="built_in">len</span>(nums) &#123; <span class="comment">// æœ€åä¸€åä¸­å¥–</span></span><br><span class="line">        <span class="keyword">return</span> mid</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> nums[mid+<span class="number">1</span>] &gt; target &#123;</span><br><span class="line">        <span class="keyword">return</span> mid</span><br><span class="line">      &#125;</span><br><span class="line">      start = mid + <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> mid</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-åŠ æƒæŠ½å¥–"><a href="#2-åŠ æƒæŠ½å¥–" class="headerlink" title="2. åŠ æƒæŠ½å¥–"></a>2. åŠ æƒæŠ½å¥–</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è§„æ¦‚ç‡æŠ½å¥–çš„å®ç°æ–¹æ¡ˆ</span></span><br><span class="line"><span class="comment">// å‰ç½®é€»è¾‘éœ€è¦åšå¥½å¹¶å‘ç›¸å…³çš„å¤„ç†ï¼ŒåŒ…æ‹¬å¼‚å¸¸çŠ¶æ€å¤„ç†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetAwardGenerator</span><span class="params">(users <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int64</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> sum_num <span class="type">int64</span></span><br><span class="line">  name_arr := <span class="built_in">make</span>([]<span class="type">string</span>, <span class="built_in">len</span>(users))</span><br><span class="line">  <span class="keyword">for</span> u_name, num := <span class="keyword">range</span> users &#123;</span><br><span class="line">    sum_num += num</span><br><span class="line">    name_arr = <span class="built_in">append</span>(name_arr, u_name)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> generator <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">string</span></span><br><span class="line">  generator = <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    award_num := rand.Int63n(sum_num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offset_num <span class="type">int64</span></span><br><span class="line">    <span class="keyword">for</span> _, u_name := <span class="keyword">range</span> name_arr &#123;</span><br><span class="line">      offset_num += users[u_name]</span><br><span class="line">      <span class="keyword">if</span> award_num &lt; offset_num &#123;</span><br><span class="line">        <span class="keyword">return</span> u_name</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¼ºçœè¿”å›ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸ä¼šè¿è¡Œåˆ°æ­¤å¤„</span></span><br><span class="line">    <span class="keyword">return</span> name_arr[<span class="number">0</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—"><a href="#å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—"></a>å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</h3><p>æ ¸å¿ƒï¼šåˆ‡ç‰‡ + é”</p><h3 id="å­—ç¬¦ä¸²ç›¸åŠ -https-leetcode-cn-com-problems-add-s"><a href="#å­—ç¬¦ä¸²ç›¸åŠ -https-leetcode-cn-com-problems-add-s" class="headerlink" title="[å­—ç¬¦ä¸²ç›¸åŠ ](https://leetcode-cn.com/problems/add-s"></a>[å­—ç¬¦ä¸²ç›¸åŠ ](<a href="https://leetcode-cn.com/problems/add-s">https://leetcode-cn.com/problems/add-s</a></h3><p>trings&#x2F;)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addStrings</span><span class="params">(num1 <span class="type">string</span>, num2 <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">add := <span class="number">0</span></span><br><span class="line">ans := <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, j := <span class="built_in">len</span>(num1) - <span class="number">1</span>, <span class="built_in">len</span>(num2) - <span class="number">1</span>; i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span> || add != <span class="number">0</span>; i, j = i - <span class="number">1</span>, j - <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">var</span> x, y <span class="type">int</span></span><br><span class="line"><span class="keyword">if</span> i &gt;= <span class="number">0</span> &#123;</span><br><span class="line">x = <span class="type">int</span>(num1[i] - <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> j &gt;= <span class="number">0</span> &#123;</span><br><span class="line">y = <span class="type">int</span>(num2[j] - <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">result := x + y + add</span><br><span class="line">ans = strconv.Itoa(result%<span class="number">10</span>) + ans</span><br><span class="line">add = result / <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚æ ¹å·2çš„å€¼"><a href="#æ±‚æ ¹å·2çš„å€¼" class="headerlink" title="æ±‚æ ¹å·2çš„å€¼"></a>æ±‚æ ¹å·2çš„å€¼</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äºŒåˆ†æŸ¥æ‰¾æ³•æ±‚è¿‘ä¼¼å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mySqrt</span><span class="params">(x <span class="type">int</span>)</span></span> <span class="type">float64</span> &#123;  </span><br><span class="line">    l, r := <span class="type">float64</span>(<span class="number">0</span>), <span class="type">float64</span>(x)  </span><br><span class="line">    <span class="keyword">for</span> r-l &gt; <span class="number">1e-7</span> &#123;  </span><br><span class="line">        mid := l + (r - l) / <span class="number">2</span>  </span><br><span class="line"><span class="keyword">if</span> mid * mid &lt;= <span class="type">float64</span>(x) &#123;  </span><br><span class="line">            l = mid  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            r = mid  </span><br><span class="line">&#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> r  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‰›é¡¿è¿­ä»£</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mySqrt</span><span class="params">(x <span class="type">int</span>)</span></span> <span class="type">float64</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>  </span><br><span class="line">&#125;  </span><br><span class="line">    C, x0 := <span class="type">float64</span>(x), <span class="type">float64</span>(x)  </span><br><span class="line">    <span class="keyword">for</span> &#123;  </span><br><span class="line">        xi := <span class="number">0.5</span> * (x0 + C/x0)  </span><br><span class="line">        <span class="keyword">if</span> math.Abs(x0 - xi) &lt; <span class="number">1e-7</span> &#123;  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">&#125;  </span><br><span class="line">        x0 = xi  </span><br><span class="line">&#125;  </span><br><span class="line">    <span class="keyword">return</span> x0  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="101-å¯¹ç§°äºŒå‰æ ‘"><a href="#101-å¯¹ç§°äºŒå‰æ ‘" class="headerlink" title="101. å¯¹ç§°äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/symmetric-tree/">101. å¯¹ç§°äºŒå‰æ ‘</a></h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isSymmetric</span><span class="params">(root *TreeNode)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> check(root, root)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">check</span><span class="params">(p, q *TreeNode)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> p == <span class="literal">nil</span> &amp;&amp; q == <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> p == <span class="literal">nil</span> || q == <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.Val == q.Val &amp;&amp; check(p.Left, q.Right) &amp;&amp; check(p.Right, q.Left) </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> 101 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>raft</title>
      <link href="/research/distribution/raft101/"/>
      <url>/research/distribution/raft101/</url>
      
        <content type="html"><![CDATA[<p><a href="https://raft.github.io/">ä¸€ä¸ªåŠ²çˆ†çš„é“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> ç ”ç©¶æ‰€ </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 101 </tag>
            
            <tag> raft </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>paxos è®ºæ–‡ç¿»è¯‘</title>
      <link href="/research/distribution/paxos-original/"/>
      <url>/research/distribution/paxos-original/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ç ”ç©¶æ‰€ </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>mongodb é¢è¯•å¿…å¤‡</title>
      <link href="/interview/db/mongodb101/"/>
      <url>/interview/db/mongodb101/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> mongo </tag>
            
            <tag> nosql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql é¢è¯•å¿…å¤‡</title>
      <link href="/interview/db/mysql101/"/>
      <url>/interview/db/mysql101/</url>
      
        <content type="html"><![CDATA[<h1 id="1-äº‹åŠ¡"><a href="#1-äº‹åŠ¡" class="headerlink" title="1. äº‹åŠ¡"></a>1. äº‹åŠ¡</h1><h2 id="ACID-ç‰¹æ€§"><a href="#ACID-ç‰¹æ€§" class="headerlink" title="ACID ç‰¹æ€§"></a>ACID ç‰¹æ€§</h2><ul><li><p>**åŸå­æ€§(Atomicity)**ï¼šäº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å•ä½ï¼Œå› æ­¤åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œçš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨ç”Ÿæ•ˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸ç”Ÿæ•ˆã€‚</p></li><li><p>**ä¸€è‡´æ€§(Consistency)**ï¼šä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯é¢„æœŸçŠ¶æ€çš„æ­£ç¡®æ€§ï¼Œå³ä»ä¸€ä¸ªæ­£ç¡®çš„çŠ¶æ€åˆ°å¦ä¸€ä¸ªæ­£ç¡®çš„çŠ¶æ€ï¼Œè¿™é‡Œçš„çŠ¶æ€å¾€å¾€æ˜¯ç”±ä¸šåŠ¡æ¥å®šä¹‰çš„ã€‚æ¯”å¦‚è½¬è´¦ä¸­çš„ä¸€ä¸ªæ‰£é’±ä¸€ä¸ªåŠ é’±ï¼Œæ˜¯æˆ‘ä»¬è§„å®šçš„ä¸€ä¸ªæ•°æ®æµè½¬ï¼Œé‚£ä¹ˆæ‰§è¡Œå‰çš„è´¦æˆ·ä½™é¢å’Œè½¬è´¦åçš„è´¦æˆ·ä½™é¢å°±å¾—æ»¡è¶³åŠ å‡ç‰¹æ€§ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä¸šåŠ¡æ­£ç¡®ã€‚é¢˜å¤–è¯ï¼šé“¶è¡Œå®¶èˆå…¥ â€”â€” å››èˆå…­å…¥äº”è€ƒè™‘ï¼Œäº”åéé›¶åˆ™è¿›ä¸€ï¼Œäº”åçš†é›¶çœ‹å¥‡å¶ï¼Œå¥‡è¿›å¶èˆä¸è¿ç»­ã€‚</p></li><li><p>**éš”ç¦»æ€§(Isolation)**ï¼šäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œå„ä¸ªäº‹åŠ¡ä¹‹é—´ç›¸äº’å½±å“çš„ç¨‹åº¦ã€‚</p></li><li><p>**æŒä¹…åŒ–(Durability)**ï¼šé€šè¿‡æ—¥å¿—ç­‰æ‰‹æ®µï¼Œåªè¦æˆ‘ä»¬çš„äº‹åŠ¡æäº¤æˆåŠŸäº†ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¿™æ¬¡çš„æ•°æ®æ“ä½œæ˜¯æˆåŠŸçš„ã€‚å³ä½¿ä¸‹æ¬¡é‡å¯äº†ç¨‹åºï¼Œä¹Ÿä¸ä¼šä¸¢å¤±æ­¤å¤„çš„æ“ä½œç»“æœã€‚</p></li></ul><h2 id="éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»çº§åˆ«"></a>éš”ç¦»çº§åˆ«</h2><ul><li><p><strong>æœªæäº¤è¯»ï¼š</strong> å³æ‰€è°“çš„è„è¯»ï¼Œäº‹åŠ¡è¯»å–çš„æ•°æ®å¯èƒ½æ˜¯å¦ä¸€ä¸ªäº‹åŠ¡å·²ä¿®æ”¹ä½†è¿˜æ²¡æäº¤çš„ï¼Œè¿™éƒ¨åˆ†æ•°æ®æœ‰å¯èƒ½äº§ç”Ÿå›æ»šã€‚å¯¼è‡´åç»­çš„æ“ä½œä¾èµ–äº†æ— æ•ˆçš„æ•°æ®ã€‚<br>ä¿®æ”¹æ—¶åŠ æ’å®ƒé”ï¼›è¯»å–æ—¶åŠ å…±äº«é”ï¼Œè¯»å®Œé‡Šæ”¾ã€‚ egï¼šselect for update</p></li><li><p><strong>å·²æäº¤è¯»ï¼š</strong> å¦‚æœæƒ³é˜²æ­¢è„è¯»ï¼Œå°±éœ€è¦ç­‰å¾…å…¶ä»–äº‹åŠ¡æäº¤åå†è¿›è¡Œè¯»å–æ“ä½œã€‚</p></li><li><p><strong>å¯é‡å¤è¯»ï¼š</strong> å·²æäº¤è¯»çš„éš”ç¦»çº§åˆ«è€ƒè™‘åˆ°äº†æ•°æ®å›æ»šçš„æ— æ•ˆæ€§ï¼Œå´æ— æ³•é˜»æ­¢äº‹åŠ¡çš„å¤šæ¬¡æäº¤ã€‚æ¯”å¦‚äº‹åŠ¡ A ä¸æ–­çš„å¯¹è¡¨è¿›è¡Œä¿®æ”¹æäº¤ï¼Œé‚£ä¹ˆäº‹åŠ¡ B å°±ä¼šåœ¨ä¸åŒçš„æ—¶é—´ç‚¹è¯»å–åˆ°ä¸åŒçš„æ•°æ®ã€‚ä¸ºäº†è®©äº‹åŠ¡ B åœ¨æ‰§è¡ŒæœŸé—´è¯»å–çš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå°±æœ‰äº†å¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ï¼Œå³äº‹åŠ¡ B åœ¨æ‰§è¡ŒæœŸé—´ï¼Œå…¶ä»–äº‹åŠ¡ä¸å¾—è¿›è¡Œä¿®æ”¹æ“ä½œã€‚</p></li><li><p><strong>å¯ä¸²è¡ŒåŒ–ï¼š</strong> ä¸Šé¢çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¿è¯äº†äº‹åŠ¡æ‰§è¡ŒæœŸé—´è¯»å–çš„ä¸€è‡´æ€§ã€‚ç„¶è€Œè¿™é‡Œå¹¶ä¸åŒ…æ‹¬æ’å…¥ã€åˆ é™¤æ“ä½œã€‚å³ä¼šå‡ºç°è¯»å¤šè¯»å°‘æ•°æ®çš„æƒ…å†µï¼Œè¿™ç§ç°è±¡å«åšå¹»è¯»ã€‚ä¸ºäº†è§£å†³å¹»è¯»ï¼Œåªå¾—è¿›è¡Œä¸²è¡ŒåŒ–æ‰§è¡Œäº‹åŠ¡ï¼Œæ‰èƒ½äº’ä¸å½±å“ã€‚è€Œæ­¤æ—¶çš„äº‹åŠ¡å¹¶å‘æ€§æ˜¯æœ€ä½çš„</p></li></ul><h1 id="2-ç´¢å¼•"><a href="#2-ç´¢å¼•" class="headerlink" title="2. ç´¢å¼•"></a>2. ç´¢å¼•</h1><h2 id="Mysql-çš„ç´¢å¼•åˆ†ç±»"><a href="#Mysql-çš„ç´¢å¼•åˆ†ç±»" class="headerlink" title="Mysql çš„ç´¢å¼•åˆ†ç±»"></a>Mysql çš„ç´¢å¼•åˆ†ç±»</h2><ul><li><p><strong>ä»æ•°æ®ç»“æ„åˆ’åˆ†ï¼š</strong> B+ æ ‘ã€hash ç´¢å¼•ã€å…¨æ–‡ç´¢å¼•</p></li><li><p><strong>ä»ç‰©ç†ç»“æ„åˆ’åˆ†ï¼š</strong> èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•</p></li><li><p><strong>ä»é€»è¾‘ç”¨æˆ·åˆ’åˆ†ï¼š</strong> ä¸»é”®ã€å”¯ä¸€ç´¢å¼•ã€å¤åˆç´¢å¼•ã€æ™®é€šå•åˆ—ç´¢å¼•</p></li></ul><h2 id="èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•ã€ä¸»å»ºçš„åŒºåˆ«"><a href="#èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•ã€ä¸»å»ºçš„åŒºåˆ«" class="headerlink" title="èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•ã€ä¸»å»ºçš„åŒºåˆ«"></a>èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•ã€ä¸»å»ºçš„åŒºåˆ«</h2><ul><li><p>èšé›†ç´¢å¼•ï¼šåœ¨ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ç›´æ¥å­˜ data æ•°æ®, ä½¿ç”¨çš„æ˜¯ç‰©ç†æ’åºï¼Œä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µè®¾ç½®äº†èšé›†ç´¢å¼•ï¼ˆå› ä¸ºç‰©ç†æ’åºè§„åˆ™åªèƒ½æœ‰ä¸€ä¸ªï¼‰ï¼Œå…è®¸æœ‰ null çš„æ•°æ®å­˜åœ¨ï¼Œæ•°æ®ä¹Ÿä¸ä¸€å®šæ˜¯å”¯ä¸€çš„ã€‚å®ç°æ–¹æ¡ˆæ˜¯B+æ ‘</p></li><li><p>ä¸»å»ºï¼šå”¯ä¸€æ ‡è¯†æŸè¡Œè®°å½•ï¼Œä¸å…è®¸æœ‰ null çš„æ•°æ®ï¼Œè¦æ±‚æ•°æ®å¿…é¡»å”¯ä¸€ã€‚åœ¨è®¾ç½®æŸä¸ªå­—æ®µä¸ºä¸»å»ºæ—¶ï¼Œæ•°æ®åº“ä¸€èˆ¬ä¼šè‡ªåŠ¨åœ¨è¿™ä¸ªä¸»å»ºä¸Šå»ºç«‹ä¸€ä¸ªå”¯ä¸€ç´¢å¼•ï¼Œå¹¶ä¸”å¦‚æœä¹‹å‰è¡¨æ²¡æœ‰åˆ›å»ºè¿‡èšé›†ç´¢å¼•ï¼Œè¿˜ä¼šåœ¨è¿™ä¸ªä¸»å»ºä¸Šå»ºç«‹ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚è‡ªå¢Idå¼ºåˆ¶è®¾å®šä¸ºä¸»é”®ç´¢å¼•ï¼Œè¿™æ˜¯ä¸ºäº†b+treeå’Œåˆ†é¡µã€‚è¿™æ£µæ ‘çš„éå¶å­ç»“ç‚¹ä¸Šå­˜çš„éƒ½æ˜¯ä¸»é”®ï¼Œé‚£å¦‚æœä¸€ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ä¼šæ€ä¹ˆæ ·ï¼Ÿåœ¨innodbä¸­ï¼Œå¦‚æœä¸€ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼Œé‚£é»˜è®¤ä¼šæ‰¾å»ºäº†å”¯ä¸€ç´¢å¼•çš„åˆ—ï¼Œå¦‚æœä¹Ÿæ²¡æœ‰ï¼Œåˆ™ä¼šç”Ÿæˆä¸€ä¸ªéšå½¢çš„å­—æ®µä½œä¸ºä¸»é”®ï¼</p></li><li><p>éèšé›†ç´¢å¼•ï¼šç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•°æ®åŸŸçš„è®°å½•æŒ‡é’ˆï¼Œéœ€è¦è·³è½¬æŸ¥æ‰¾ã€‚æ’åºè§„åˆ™æ˜¯é€»è¾‘æ’åºï¼Œå› æ­¤å¯ä»¥æœ‰å¤šä¸ªéèšé›†ç´¢å¼•å­˜åœ¨ã€‚éèšé›†ç´¢å¼•çš„å­˜å‚¨ç»“æ„ä¸èšé›†ç´¢å¼•æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯åœ¨å¶å­ç»“ç‚¹çš„æ•°æ®éƒ¨åˆ†å­˜çš„ä¸å†æ˜¯å…·ä½“çš„æ•°æ®ï¼Œè€Œæ•°æ®çš„èšé›†ç´¢å¼•çš„keyã€‚æ‰€ä»¥é€šè¿‡éèšé›†ç´¢å¼•æŸ¥æ‰¾çš„è¿‡ç¨‹æ˜¯å…ˆæ‰¾åˆ°è¯¥ç´¢å¼•keyå¯¹åº”çš„èšé›†ç´¢å¼•çš„keyï¼Œç„¶åå†æ‹¿èšé›†ç´¢å¼•çš„keyåˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å›è¡¨</strong>ï¼</p></li></ul><h2 id="æœ‰å“ªäº›æƒ…å†µä¼šè®©ç´¢å¼•å¤±æ•ˆï¼Ÿ"><a href="#æœ‰å“ªäº›æƒ…å†µä¼šè®©ç´¢å¼•å¤±æ•ˆï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›æƒ…å†µä¼šè®©ç´¢å¼•å¤±æ•ˆï¼Ÿ"></a>æœ‰å“ªäº›æƒ…å†µä¼šè®©ç´¢å¼•å¤±æ•ˆï¼Ÿ</h2><ul><li><p>åœ¨ where å­—æ®µ ä¸Šä½¿ç”¨äº†å‡½æ•°æˆ–å…¶ä»–éšå¼è½¬æ¢</p></li><li><p>Like æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå¼€å¤´ä½¿ç”¨äº† â€œ%â€ï¼Œä¾‹å¦‚ like â€˜%hello%â€™</p></li><li><p>where æ¡ä»¶é‡Œä½¿ç”¨äº† or</p></li><li><p>å»ºç«‹äº†å¤åˆç´¢å¼•ï¼Œä½† where æ¡ä»¶é‡Œä½¿ç”¨çš„æ˜¯ç¬¬äºŒä¸ªå­—æ®µçš„æœç´¢</p></li></ul><h2 id="æœ€å·¦åŒ¹é…åŸåˆ™æ˜¯æŒ‡ï¼Ÿ"><a href="#æœ€å·¦åŒ¹é…åŸåˆ™æ˜¯æŒ‡ï¼Ÿ" class="headerlink" title="æœ€å·¦åŒ¹é…åŸåˆ™æ˜¯æŒ‡ï¼Ÿ"></a>æœ€å·¦åŒ¹é…åŸåˆ™æ˜¯æŒ‡ï¼Ÿ</h2><p>mysql å»ºç«‹è”åˆç´¢å¼•åï¼Œæ˜¯æŒ‰æœ€å·¦åŒ¹é…åŸåˆ™æ¥ç­›é€‰è®°å½•çš„ï¼Œå³æ£€ç´¢æ•°æ®æ˜¯ä»è”åˆç´¢å¼•çš„ç¬¬ä¸€ä¸ªå­—æ®µæ¥ç­›é€‰çš„ã€‚å¦‚æœ where é‡Œçš„æ¡ä»¶åªæœ‰ç¬¬äºŒä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°†æ— æ³•åº”ç”¨åˆ°ç´¢å¼•ã€‚</p><h2 id="ç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„-B-æ ‘æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#ç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„-B-æ ‘æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="ç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„ B+ æ ‘æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"></a>ç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„ B+ æ ‘æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h2><p>B+ æ ‘æ˜¯äºŒå‰æœç´¢æ ‘çš„ä¸€ä¸ªæ‰©å……ï¼Œæ˜¯å¤šè·¯æœç´¢æ ‘ã€‚å®ƒåªåœ¨å¶å­èŠ‚ç‚¹å­˜å‚¨å…·ä½“çš„æ•°æ®æˆ–è€…æ•°æ®çš„æŒ‡å‘æŒ‡é’ˆï¼Œè€Œéå¶å­èŠ‚ç‚¹å­˜æ”¾ç´¢å¼•æ•°æ®ã€‚è¿™æ ·å¯ä»¥é™ä½ç£ç›˜ IOï¼Œè¿˜èƒ½å……åˆ†åˆ©ç”¨ç£ç›˜çš„é¢„è¯»åŠŸèƒ½ï¼Œæ‰¹é‡çš„åŠ è½½ç´¢å¼•æ•°æ®ã€‚</p><p><img src="https://static001.geekbang.org/infoq/46/467603fbd92fdada63040ebad9b7f628.png"></p><h2 id="b-æ ‘-b-æ ‘-b-æ ‘çš„åŒºåˆ«"><a href="#b-æ ‘-b-æ ‘-b-æ ‘çš„åŒºåˆ«" class="headerlink" title="b æ ‘ b+æ ‘ b-æ ‘çš„åŒºåˆ«"></a>b æ ‘ b+æ ‘ b-æ ‘çš„åŒºåˆ«</h2><ul><li><p>b æ ‘å°±æ˜¯ b-æ ‘ï¼Œ å›½å¤–å« b-tree, ä¹Ÿå°±æ˜¯ b æ ‘ã€‚</p></li><li><p>b-tree æ˜¯åœ¨éå¶å­èŠ‚ç‚¹å­˜æ”¾äº†æ•°æ®ï¼Œåœ¨æŸ¥è¯¢ç´¢å¼•æ—¶ï¼Œåªè¦æ‰¾åˆ°ç´¢å¼•å€¼ä¹Ÿå°±å¯ä»¥æ‰¾åˆ°æ•°æ®äº†ï¼Œè¿™æ ·å¯ä»¥æå‰ç»ˆæ­¢æœç´¢ã€‚ä½†æ¯ä¸ªèŠ‚ç‚¹å°±å¾—å­˜å‚¨ç´¢å¼•å€¼+æ•°æ®å€¼ï¼Œå ç”¨çš„é¡µç©ºé—´ä¼šæ¯”è¾ƒå¤§ï¼Œéœ€è¦çš„ç£ç›˜ io æ¬¡æ•°ä¹Ÿä¼šå˜å¤šï¼Œå³ä½¿æ˜¯ä¸éœ€è¦å…³å¿ƒçš„æ•°æ®ä¹Ÿä¼šè¢«é¢„åŠ è½½å‡ºæ¥ï¼Œæµªè´¹æ€§èƒ½ã€‚</p></li><li><p>b+æ ‘æ˜¯å°†ç´¢å¼•å€¼å­˜åœ¨éå¶å­èŠ‚ç‚¹ï¼Œæ•°æ®å€¼å­˜åœ¨å¶å­èŠ‚ç‚¹ï¼Œè¿™æ ·å¯ä»¥å‹ç¼©æ ‘çš„é«˜åº¦ï¼Œå‡å°‘ç£ç›˜ ioã€‚</p></li></ul><h2 id="ä¸ºä»€ä¹ˆä¸èƒ½åœ¨é‡å¤ç‡é«˜ï¼Œä¾‹å¦‚æ€§åˆ«å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¸èƒ½åœ¨é‡å¤ç‡é«˜ï¼Œä¾‹å¦‚æ€§åˆ«å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¸èƒ½åœ¨é‡å¤ç‡é«˜ï¼Œä¾‹å¦‚æ€§åˆ«å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¸èƒ½åœ¨é‡å¤ç‡é«˜ï¼Œä¾‹å¦‚<code>æ€§åˆ«</code>å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Ÿ</h2><p>å¯¹äºæ€§åˆ«è¿™ç§ç´¢å¼•ï¼Œ ç”±äºé‡å¤ç‡é«˜ï¼Œå¯¹äº B+æ ‘(å¤šè·¯æœç´¢æ ‘)æ¥è®²ï¼Œå¾—éå†å¤šæ¡è·¯å¾„ï¼Œæœç´¢ä»£ä»·å¤§ã€‚è¿˜ä¸å¦‚å…¨è¡¨æ‰«æï¼Œè¿™æ ·ä¸éœ€è¦ç»´æŠ¤ç´¢å¼•ï¼Œé™ä½å¼€é”€ã€‚</p><h2 id="Mysql-çš„-hash-ç´¢å¼•æ˜¯æ€ä¹ˆæ ·ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#Mysql-çš„-hash-ç´¢å¼•æ˜¯æ€ä¹ˆæ ·ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="Mysql çš„ hash ç´¢å¼•æ˜¯æ€ä¹ˆæ ·ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"></a>Mysql çš„ hash ç´¢å¼•æ˜¯æ€ä¹ˆæ ·ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h2><p>hash ç´¢å¼•å°†åˆ—é€šè¿‡ hash è¿ç®—å¾—åˆ° hash codeï¼Œç„¶åå°† hash code è·Ÿæ•°æ®è¡Œçš„æŒ‡é’ˆåœ°å€å…³è”åœ¨ä¸€èµ·ï¼Œä¸‹æ¬¡æŸ¥æ‰¾æ—¶åªéœ€æŸ¥æ‰¾å¯¹åº” hash code çš„æ•°æ®è¡Œåœ°å€å³å¯ã€‚</p><p>hash ç´¢å¼•éå¸¸çš„ç´§å‡‘ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å¾ˆå¿«ï¼Œé€‚ç”¨äºå†…å­˜å­˜å‚¨å¼•æ“çš„åº”ç”¨ã€‚ä¸è¿‡å®ƒåªèƒ½ç²¾ç¡®æŸ¥è¯¢ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥æ‰¾ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è¿›è¡Œæ’åºã€‚é™åˆ¶è¿˜æ˜¯æŒºå¤šçš„ã€‚</p><p><img src="https://static001.geekbang.org/infoq/12/12bc94c294080d240a165e97e0a5f75e.png"></p><h2 id="Mysql-çš„å…¨æ–‡ç´¢å¼•"><a href="#Mysql-çš„å…¨æ–‡ç´¢å¼•" class="headerlink" title="Mysql çš„å…¨æ–‡ç´¢å¼•"></a>Mysql çš„å…¨æ–‡ç´¢å¼•</h2><p>å…¨æ–‡ç´¢å¼•ä¸»è¦æ˜¯ç”¨äºæ–‡æ¡£æŸ¥æ‰¾ï¼Œåƒæˆ‘ä»¬å¯èƒ½ä¼šä»å¤šç¯‡æ–‡ç« ä¸­æŸ¥æ‰¾åŒ…å«æŸäº›è¯è¯­çš„æ–‡ç« ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨å…¨æ–‡ç´¢å¼•äº†ã€‚è™½ç„¶ like ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯æ•ˆç‡å¤ªä½äº†ã€‚å…¨æ–‡ç´¢å¼•åœ¨æ¥æ”¶åˆ°æ–‡æ¡£æ—¶ï¼Œä¼šå¯¹å®ƒè¿›è¡Œåˆ†è¯å¤„ç†ï¼Œä»¥è·å–åˆ°å…³é”®è¯ã€‚ç„¶åä¼šå°†å…³é”®è¯å’Œå±äºè¿™ä¸ªæ–‡æ¡£çš„ id å…³è”èµ·æ¥ã€‚ä¸‹æ¬¡æŸ¥æ‰¾ï¼Œå°±ä¼šå…ˆåˆ°å…³é”®è¯åˆ—è¡¨é‡Œæ‰¾åˆ°å…³è”çš„æ–‡æ¡£ id ï¼Œæœ€ååˆ©ç”¨æ–‡æ¡£ id å»æŸ¥æ‰¾åˆ°æ–‡æ¡£æ•°æ®ã€‚</p><h1 id="3-æ—¥å¿—"><a href="#3-æ—¥å¿—" class="headerlink" title="3. æ—¥å¿—"></a>3. æ—¥å¿—</h1><h2 id="æ—¥å¿—ç±»åˆ«"><a href="#æ—¥å¿—ç±»åˆ«" class="headerlink" title="æ—¥å¿—ç±»åˆ«"></a>æ—¥å¿—ç±»åˆ«</h2><ul><li><p><strong>binlogï¼š</strong> äºŒè¿›åˆ¶æ—¥å¿—ï¼Œè®°å½•äº†æ•°æ®åº“å¯¹æ•°æ®çš„ä¿®æ”¹è®°å½•ï¼ŒåŒ…æ‹¬äº† DDLï¼šä¾‹å¦‚è¡¨çš„åˆ›å»ºï¼Œæ•°æ®æ›´æ–°ç­‰ã€‚ä½†å¹¶ä¸åŒ…æ‹¬ select è¿™äº›æŸ¥è¯¢è¯­å¥ã€‚binlog æ—¥å¿—æ˜¯å±äºé€»è¾‘è¯­å¥çš„è®°å½•ï¼Œå¯ç”¨äºä¸»ä»æ•°æ®åº“çš„åŒæ­¥ã€‚</p></li><li><p><strong>relay logï¼š</strong> ä¸­ç»§æ—¥å¿—ï¼Œç”¨äºä¸»ä»å¤‡ä»½æ¢å¤ä½¿ç”¨çš„ã€‚æœ‰ä¸»æœåŠ¡å™¨çš„ binlog é€»è¾‘æ“ä½œè¯­å¥ï¼Œä»¥åŠå½“å‰çš„æ¢å¤ä½ç½®ã€‚</p></li><li><p><strong>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼š</strong> è®°å½•åœ¨ mysql é‡Œæ‰§è¡Œæ—¶é—´è¶…è¿‡é¢„æœŸå€¼çš„è€—æ—¶è¯­å¥</p></li><li><p><strong>redo logï¼š</strong> redo log æ˜¯å¯¹åŠ è½½åˆ°å†…å­˜æ•°æ®é¡µçš„ä¿®æ”¹ç»“æœçš„è®°å½•ï¼Œå’Œ binlog ä¸åŒçš„æ˜¯ï¼Œbinlog è®°å½•çš„æ˜¯é€»è¾‘æ“ä½œè¯­å¥ï¼Œåå‘äºè¿‡ç¨‹è®°å½•ã€‚è€Œ redo log æ˜¯ä¸€ä¸ªæ•°æ®é¡µçš„ä¿®æ”¹æ—¥å¿—ï¼Œåå‘äºç»“æœçš„è®°å½•ã€‚</p></li><li><p><strong>undo logï¼š</strong> å›æ»šæ—¥å¿—ä¸»è¦ç”¨äºå›æ»šæ•°æ®ï¼Œå’Œ redo log ä¸ä¸€æ ·çš„æ˜¯ï¼Œundo log æ˜¯é€»è¾‘æ—¥å¿—ï¼Œæ˜¯ä¸€ç§ç›¸åæ“ä½œçš„è®°å½•ï¼Œæ¯”å¦‚åœ¨å›æ»šæ—¶ï¼Œå¦‚æœæ˜¯ insert æ“ä½œæ—¶ï¼Œåˆ™ä¼šé€†å‘ä¸º deleteï¼Œdelete æ“ä½œæ—¶ï¼Œé€†å‘ä¸º insert æ“ä½œï¼Œæ›´æ–°åˆ™æ¢å¤åˆ°å½“æ—¶çš„ç‰ˆæœ¬æ•°æ®ã€‚</p></li></ul><h2 id="redo-log-ç›¸å…³æ¦‚å¿µï¼šwriteposã€checkpointã€prepareã€commit"><a href="#redo-log-ç›¸å…³æ¦‚å¿µï¼šwriteposã€checkpointã€prepareã€commit" class="headerlink" title="redo log ç›¸å…³æ¦‚å¿µï¼šwriteposã€checkpointã€prepareã€commit"></a>redo log ç›¸å…³æ¦‚å¿µï¼šwriteposã€checkpointã€prepareã€commit</h2><p>redo log æ˜¯ç”¨æ¥è®°å½•å½“å‰æ•°æ®é¡µçš„ä¿®æ”¹æƒ…å†µï¼Œç”±äºæ€§èƒ½é—®é¢˜ï¼Œæ¯æ¬¡ä¿®æ”¹å¹¶ä¸ä¼šå®æ—¶åŒæ­¥åˆ°ç¡¬ç›˜ã€‚è€Œæ˜¯å…ˆåœ¨å†…å­˜ä¸­ä¿®æ”¹ï¼Œç„¶åå°†ä¿®æ”¹æƒ…å†µè®°å½•åˆ° redo é‡Œï¼Œå†å®šæ—¶çš„å»å°† redo åˆ·æ–°åˆ°ç¡¬ç›˜é‡Œã€‚å› æ­¤ï¼Œredo log æœ‰ 2 ä¸ªä½ç½®ï¼Œä¸€ä¸ªæ˜¯ writeposï¼Œè‡ªå·±å†™æ—¥å¿—çš„ä½ç½®ï¼›å¦ä¸€ä¸ªæ˜¯ checkpointï¼Œæ˜¯å®šæ—¶çš„å°†æ•°æ®é¡µåŒæ­¥åˆ°ç¡¬ç›˜çš„ä½ç½®ã€‚</p><p>redo log åœ¨å†™ binlog æ—¥å¿—å‰ä¼šå…ˆè®°å½• redo logï¼Œè®°å½•å®Œåæ ‡è®°ä¸º prepare çŠ¶æ€ã€‚å½“ binlog ä¹Ÿå†™å…¥å®Œæˆåï¼Œæ‰å°† redo log æ ‡è®°ä¸º commit çŠ¶æ€ã€‚åªæœ‰å½“ redo log æ˜¯ commit çŠ¶æ€æ—¶ï¼Œäº‹åŠ¡æ‰èƒ½çœŸæ­£çš„ commitã€‚è¿™æ ·èƒ½é˜²æ­¢ä¸»ä»èŠ‚ç‚¹æ ¹æ® binlog åŒæ­¥æœ‰å¯èƒ½äº‹åŠ¡ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><h1 id="4-Mysql-é‡Œçš„é”"><a href="#4-Mysql-é‡Œçš„é”" class="headerlink" title="4. Mysql é‡Œçš„é”"></a>4. Mysql é‡Œçš„é”</h1><h2 id="Mysql-é‡Œçš„é”æœ‰å“ªäº›ï¼Ÿ"><a href="#Mysql-é‡Œçš„é”æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="Mysql é‡Œçš„é”æœ‰å“ªäº›ï¼Ÿ"></a>Mysql é‡Œçš„é”æœ‰å“ªäº›ï¼Ÿ</h2><h3 id="ä¹è§‚-x2F-æ‚²è§‚é”"><a href="#ä¹è§‚-x2F-æ‚²è§‚é”" class="headerlink" title="ä¹è§‚&#x2F;æ‚²è§‚é”"></a>ä¹è§‚&#x2F;æ‚²è§‚é”</h3><ul><li><p>ä¹è§‚é”ï¼šåœ¨è¯»å–æ•°æ®æ—¶ä¼šå‡è®¾å„ä¸ªäº‹åŠ¡äº’ä¸å½±å“ï¼Œå®ƒä»¬ä¼šå¤„ç†å¥½å±äºè‡ªå·±çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚å¦‚æœåœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œå‘ç°æœ‰å…¶ä»–äº‹åŠ¡ä¿®æ”¹äº†å±äºè‡ªå·±çš„æ•°æ®ï¼Œåˆ™ä¼šå›æ»šä¹‹å‰çš„ä¸€åˆ‡æ“ä½œã€‚</p></li><li><p>æ‚²è§‚é”ï¼šé‡‡å–äº†å…ˆè·å–é”å†è®¿é—®çš„ä¿å®ˆç­–ç•¥ï¼Œå¦‚æœå·²ç»æœ‰å…¶ä»–äº‹åŠ¡è·å–äº†é”ï¼Œåˆ™å¿…é¡»ç­‰å¾…é”é‡Šæ”¾æ‰èƒ½ç»§ç»­ã€‚</p></li></ul><h3 id="å…±äº«-x2F-æ’å®ƒé”"><a href="#å…±äº«-x2F-æ’å®ƒé”" class="headerlink" title="å…±äº«&#x2F;æ’å®ƒé”"></a>å…±äº«&#x2F;æ’å®ƒé”</h3><ul><li><p>å…±äº«é”ï¼šåˆç§°è¯»é”ï¼Œå½“å‰äº‹åŠ¡åœ¨è¯»å–æ—¶ï¼Œå…è®¸å…¶ä»–äº‹åŠ¡å¹¶å‘è¯»å–ï¼Œä½†ä¸å…è®¸å…¶ä»–äº‹åŠ¡ä¸Šæ’å®ƒé”ï¼Œå¿…é¡»ç­‰è‡ªå·±é‡Šæ”¾äº†æ‰èƒ½ç»§ç»­ã€‚</p></li><li><p>æ’å®ƒé”ï¼šåˆç§°å†™é”ï¼Œåœ¨å†™é”å æœ‰æ—¶ï¼Œå¦‚æœå…¶ä»–äº‹åŠ¡æƒ³ä¸Šè¯»å†™é”ï¼Œåˆ™å¾—æ’é˜Ÿç­‰å¾…ã€‚</p></li></ul><h3 id="è¡¨é”-x2F-è¡Œé”"><a href="#è¡¨é”-x2F-è¡Œé”" class="headerlink" title="è¡¨é”&#x2F;è¡Œé”"></a>è¡¨é”&#x2F;è¡Œé”</h3><ul><li><p>è¡¨é”ï¼šåœ¨æ“ä½œæ•°æ®æ—¶ï¼Œç›´æ¥å°†æ•´å¼ è¡¨é”ä½ï¼Œæ“ä½œç²’åº¦å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“è®©å…¶ä»–äº‹åŠ¡åœ¨ç­‰å¾…ï¼Œä½†ä¸ä¼šäº§ç”Ÿæ­»é”ã€‚</p></li><li><p>è¡Œé”ï¼šé’ˆå¯¹çš„æ˜¯è¡Œè®°å½•çš„å¹¶å‘æ§åˆ¶ï¼Œé”ç²’åº¦å¾ˆç»†ï¼Œèƒ½æ”¯æŒé«˜å¹¶å‘ï¼Œä½†æ˜¯ä¸æ’é™¤ä¼šæœ‰æ­»é”æƒ…å†µäº§ç”Ÿã€‚åœ¨ mysql é‡Œè¡Œé”ä¾èµ–ç´¢å¼•å®ç°ï¼Œå¦‚æœæ²¡æœ‰ç´¢å¼•å­˜åœ¨ï¼Œåˆ™ä¼šç›´æ¥è¿›è¡Œè¡¨é”ï¼</p></li></ul><h4 id="è¡Œé”"><a href="#è¡Œé”" class="headerlink" title="è¡Œé”"></a>è¡Œé”</h4><ul><li><p>è®°å½•é”ï¼šåªé”ä½æŸä¸€æ¡è®°å½•ã€‚å½“å¯¹å”¯ä¸€ç´¢å¼•(åŒ…æ‹¬ä¸»é”®)è¿›è¡Œç²¾ç¡®æŸ¥è¯¢æ—¶ï¼Œä¼šä½¿ç”¨è®°å½•é”ã€‚</p></li><li><p>é—´éš™é”ï¼šå½“ä½¿ç”¨èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œä¼šå¯¹ç¬¦åˆæ¡ä»¶çš„åŒºé—´æ•°æ®ä¸Šé”ã€‚åœ¨æ¶‰åŠåˆ°æ™®é€šç´¢å¼•ï¼ˆå³ä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼‰çš„æŸ¥è¯¢æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨é—´éš™é”ã€‚</p></li><li><p>Next-key é”ï¼šä¸´å»ºé”ï¼Œå¯ä»¥ç†è§£ä¸º è®°å½•é” + é—´éš™é”ã€‚å½“å¯¹å”¯ä¸€ç´¢å¼•è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾æˆ–å¯¹å”¯ä¸€ç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾ä½†ç»“æœä¸å­˜åœ¨æ—¶ï¼ˆå¯ä»¥ç†è§£ä¸ºé”ä½ä¸å­˜åœ¨çš„è®°å½•ï¼‰ï¼Œä¼šä½¿ç”¨ä¸´å»ºé”ã€‚</p></li></ul><p>ä¸Šé¢çš„é—´éš™é”ã€ä¸´å»ºé”æœ‰æ•ˆçš„é˜²æ­¢äº†äº‹åŠ¡å¹»è¯»æƒ…å†µäº§ç”Ÿï¼Œé¿å…äº†åœ¨æŸ¥æ‰¾æœŸé—´æœ‰æ•°æ®æ–°å¢æˆ–åˆ é™¤ã€‚</p><h3 id="æ„å‘é”"><a href="#æ„å‘é”" class="headerlink" title="æ„å‘é”"></a>æ„å‘é”</h3><p>è¡¨é”çš„ä¸€ç§ï¼Œå®ƒä»…ä»…è¡¨ç¤ºä¸€ç§æ“ä½œæ„å‘ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ç²’åº¦æ¯”è¾ƒå°çš„è¡Œé”æ—¶ï¼Œåœ¨æ£€æµ‹æ˜¯å¦æœ‰é”æ—¶ï¼Œéœ€è¦ä¸€è¡Œä¸€è¡Œçš„æ£€æŸ¥ï¼Œæ•ˆç‡è¾ƒä½ã€‚æœ‰äº†æ„å‘é”ä¹‹åï¼Œåˆ™ä¸éœ€ä¸€è¡Œä¸€è¡Œçš„æ’æŸ¥ï¼Œåªéœ€æ£€æµ‹å¯¹åº”çš„æ„å‘é”å³å¯ã€‚</p><h2 id="äº‹åŠ¡é‡Œé”çš„åº”ç”¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#äº‹åŠ¡é‡Œé”çš„åº”ç”¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="äº‹åŠ¡é‡Œé”çš„åº”ç”¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"></a>äº‹åŠ¡é‡Œé”çš„åº”ç”¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h2><h3 id="å¯é‡å¤è¯»"><a href="#å¯é‡å¤è¯»" class="headerlink" title="å¯é‡å¤è¯»"></a>å¯é‡å¤è¯»</h3><p>å¯é‡å¤è¯»ä½¿ç”¨çš„æ˜¯ MVCC å¿«ç…§ï¼Œæ‰€ä»¥åœ¨è¯»å–æ•°æ®æ—¶å¤§å¤šæ•°æ—¶å€™ä¸éœ€è¦ä½¿ç”¨é”ã€‚</p><p>ä½†ä½¿ç”¨äº† <code>UPDATE</code>, <code>DELETE</code>ï¼Œæˆ– <code>SELECT with FOR UPDATEï¼ˆæ’å®ƒé”ï¼‰ æˆ– FOR SHAREï¼ˆå…±äº«é”ï¼‰</code>ï¼Œåˆ™ä¼šæ ¹æ®ä¸‹é¢çš„æƒ…å†µæ¥ä½¿ç”¨é”ï¼š</p><ul><li><p>åœ¨å”¯ä¸€ç´¢å¼•ä¸Šç²¾ç¡®æŸ¥æ‰¾æŸæ¡è®°å½•æ—¶ï¼Œä½¿ç”¨è®°å½•é”</p></li><li><p>å¯¹äºå…¶ä»–çš„æœç´¢ï¼ŒInnoDB å°†ä¼šé”å®šæ‰«æåˆ°çš„ç´¢å¼•èŒƒå›´ï¼Œä½¿ç”¨é—´éš™é”æˆ–ä¸´å»ºé”æ¥<strong>é˜²æ­¢å¹»è¯»</strong>çš„äº§ç”Ÿ</p></li></ul><h3 id="è¯»æäº¤"><a href="#è¯»æäº¤" class="headerlink" title="è¯»æäº¤"></a>è¯»æäº¤</h3><p>ä¹Ÿæ˜¯ä½¿ç”¨ MVCC æœºåˆ¶æ¥è¯»å–æ•°æ®ï¼Œä¸è¿‡åœ¨ä½¿ç”¨ <code>UPDATE</code>, <code>DELETE</code>ï¼Œæˆ– <code>SELECT with FOR UPDATEï¼ˆæ’å®ƒé”ï¼‰ æˆ– FOR SHAREï¼ˆå…±äº«é”ï¼‰</code>æ—¶å’Œä¸Šé¢çš„æœºåˆ¶ä¸ä¸€æ ·ï¼Œå½“å­˜å‚¨å¼•æ“å°†ç­›é€‰åˆ°çš„è®°å½•äº¤ç»™ mysql server å±‚åï¼Œä¼šå¯¹ä¸ç›¸å¹²çš„æ•°æ®è¿›è¡Œè§£é”ï¼Œæ‰€ä»¥ä¸ä¼šæ¶‰åŠé—´éš™é”æˆ–ä¸´å»ºé”ã€‚å®ƒä»¬åªä¼šåœ¨åšå¤–é”®çº¦æŸæ£€æŸ¥å’Œé‡å¤é”®æ£€æŸ¥æ—¶ä½¿ç”¨åˆ°ã€‚ç”±äºé—´éš™é”çš„ç¦ç”¨ï¼Œå¯èƒ½ä¼š<strong>å‡ºç°å¹»è¯»</strong>ç°è±¡ã€‚</p><h3 id="æœªæäº¤è¯»"><a href="#æœªæäº¤è¯»" class="headerlink" title="æœªæäº¤è¯»"></a>æœªæäº¤è¯»</h3><p>åœ¨ mysql çš„ innodb å­˜å‚¨å¼•æ“é‡Œåš <code>SELECT</code>æ“ä½œä¸ä¼šåšä»»ä½•é”åŠ¨ä½œï¼Œå¦‚æœæ˜¯ myisam å­˜å‚¨å¼•æ“ï¼Œåˆ™ä¼šä¸Šå…±äº«é”ã€‚å¦‚æœä½¿ç”¨<code>UPDATE</code>, <code>DELETE</code>ï¼Œæˆ– <code>SELECT with FOR UPDATEï¼ˆæ’å®ƒé”ï¼‰ æˆ– FOR SHAREï¼ˆå…±äº«é”ï¼‰</code>åˆ™å’Œè¯»æäº¤ä¸€æ ·çš„åŸåˆ™ã€‚</p><h3 id="å¯åºåˆ—åŒ–è¯»"><a href="#å¯åºåˆ—åŒ–è¯»" class="headerlink" title="å¯åºåˆ—åŒ–è¯»"></a>å¯åºåˆ—åŒ–è¯»</h3><p>å¯åºåˆ—åŒ–è¯»åœ¨ä½¿ç”¨ select æ—¶ï¼Œä¸€èˆ¬ä¼šè‡ªåŠ¨çš„è½¬åŒ–ä¸º SELECT â€¦ FOR SHAREï¼ˆå…±äº«é”ï¼‰ï¼Œä»¥ä¿è¯è¯»å†™åºåˆ—åŒ–ã€‚</p><h2 id="lock-in-share-mode-å’Œ-for-update-é‡Œé—´éš™é”ä»€ä¹ˆæ—¶å€™ä¼šåº”ç”¨ï¼Ÿ"><a href="#lock-in-share-mode-å’Œ-for-update-é‡Œé—´éš™é”ä»€ä¹ˆæ—¶å€™ä¼šåº”ç”¨ï¼Ÿ" class="headerlink" title="lock in share mode å’Œ for update é‡Œé—´éš™é”ä»€ä¹ˆæ—¶å€™ä¼šåº”ç”¨ï¼Ÿ"></a>lock in share mode å’Œ for update é‡Œé—´éš™é”ä»€ä¹ˆæ—¶å€™ä¼šåº”ç”¨ï¼Ÿ</h2><ul><li><p>lock in share mode, for update å¦‚æœ where æ¡ä»¶æ˜¯éç´¢å¼•ç±»çš„ï¼Œåˆ™ä¸ä¼šåŠ é—´éš™é”ï¼›</p></li><li><p>lock in share mode, for update å¦‚æœ where æ¡ä»¶æ˜¯ä¸»é”®ç±»çš„ï¼Œå¹¶ä¸”æ‰¾ä¸åˆ°è®°å½•æ—¶ä¼šåŠ é—´éš™é”ï¼›å¦‚æœæ‰¾åˆ°è®°å½•äº†åˆ™ä¼šå°†é—´éš™é”ç»™é‡Šæ”¾äº†ã€‚æ¯”å¦‚ where ä¸»é”® &#x3D; 3 èƒ½æ‰¾åˆ°è®°å½•æ—¶åˆ™ä¸ä¼šåŠ é—´éš™é”ï¼Œæ‰¾ä¸åˆ°æ—¶ä¼šåœ¨è¯¥æ•°æ®çš„å‰åå¶å­èŠ‚ç‚¹é—´åŠ é—´éš™é”ï¼›æ­¤æ—¶å‡å¦‚è®°å½•é‡Œåªæœ‰ 1ï¼Œ8ï¼Œ9ï¼Œåˆ™ä¼šåœ¨ 1, 8 ä¹‹é—´åŠ é—´éš™é”</p></li><li><p>lock in share mode, for update å¦‚æœ where æ¡ä»¶æ˜¯éèšé›†ç´¢å¼•ç±»çš„ï¼Œä¼šåŠ é—´éš™é”ï¼Œå³ä½¿æ‰¾ä¸åˆ°è®°å½•ã€‚</p></li></ul><h2 id="é”è¶…æ—¶çš„é…ç½®"><a href="#é”è¶…æ—¶çš„é…ç½®" class="headerlink" title="é”è¶…æ—¶çš„é…ç½®"></a>é”è¶…æ—¶çš„é…ç½®</h2><p>å½“ mysql è·å–é”è¶…æ—¶æ—¶å€™ï¼Œå¦‚æœç³»ç»Ÿå˜é‡ innodb_rollback_on_timeout ä¸º off ,åˆ™å½“å‰äº‹åŠ¡åªä¼šå›æ»šæœ€åä¸€æ¡ sql, æ‰€ä»¥å»ºè®®è®¾ç½® innodb_rollback_on_timeout ä¸º on, è¿™æ ·åœ¨è·å–é”è¶…æ—¶æ—¶å¯ä»¥å›æ»šå…¨éƒ¨ sqlã€‚</p><h1 id="5-MVCC-æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ"><a href="#5-MVCC-æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. MVCC æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ"></a>5. MVCC æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ</h1><p>MVCC å³<strong>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</strong>ï¼Œå®ƒåˆ©ç”¨äº† undo log ä¼šåœ¨æ•°æ®ä¿®æ”¹æ—¶ä¿ç•™ä¸Šä¸€ä¸ªä¿®æ”¹è®°å½•æŒ‡é’ˆçš„ç‰¹ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªäº‹åŠ¡å¯¹æ•°æ®çš„ä¿®æ”¹èƒ½æœ‰è‡ªå·±çš„å†å²ç‰ˆæœ¬è¿½æº¯ï¼Œå°±åƒé•œåƒå¤‡ä»½ä¸€æ ·ã€‚å½“è¿›è¡Œè¯»æ“ä½œæ—¶ï¼Œå¦‚æœæœ‰å…¶ä»–å†™æ“ä½œçš„äº‹åŠ¡å¹¶å‘è¿›è¡Œï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ä»¥æ ¹æ®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«é€‰æ‹©è¯»å–æœ€æ–°ç‰ˆæœ¬äº¦æˆ–è‡ªå·±ä¹‹å‰ç‰ˆæœ¬çš„æ•°æ®ã€‚MVCC ä¸éœ€è¦åŠ é”çš„ï¼Œå®ƒèƒ½æé«˜äº‹åŠ¡çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p><h1 id="6-mysql-çš„å¤åˆ¶æŠ€æœ¯"><a href="#6-mysql-çš„å¤åˆ¶æŠ€æœ¯" class="headerlink" title="6. mysql çš„å¤åˆ¶æŠ€æœ¯"></a>6. mysql çš„å¤åˆ¶æŠ€æœ¯</h1><ul><li><p>å…¨åŒæ­¥å¤åˆ¶ï¼šåªæœ‰ç­‰æ‰€æœ‰çš„ slave èŠ‚ç‚¹å°†åŒæ­¥çš„æ—¥å¿—å†™å…¥ relay logï¼Œå¹¶ä¸”å“åº” ack ç¡®è®¤åï¼Œæ­¤æ¬¡çš„äº‹åŠ¡æ‰ä¼šæäº¤ã€‚æ•°æ®å®Œæ•´æ€§é«˜ï¼Œä½†æ€§èƒ½ä½</p></li><li><p>åŠåŒæ­¥å¤åˆ¶ï¼šåªè¦æœ‰ä¸€ä¸ª salve èŠ‚ç‚¹å“åº” ack åå°±å¯ä»¥è®¤ä¸ºåŒæ­¥æˆåŠŸï¼Œä½†ç»†åˆ†ä¸ºäº†ä¸¤ç§ï¼Œä¸€ç§æ˜¯ <code>AFTER_COMMIT</code>ï¼šå…ˆåœ¨ä¸»åº“æäº¤äº‹åŠ¡, ç„¶ååŒæ­¥ä»åº“, ç­‰å¾…ä»åº“çš„ ack ç¡®è®¤. æ‰å‘Šè¯‰å®¢æˆ·ç«¯æ˜¯å¦ Okã€‚å¦ä¸€ç§æ˜¯ <code>AFTER_SYNC</code>ï¼šä¸»åº“å…ˆä¸æäº¤äº‹åŠ¡, åªæœ‰ä»åº“ æœ‰ replay log ,å›å¤äº† ack åæ‰è¿›è¡Œæäº¤äº‹åŠ¡ã€‚åé¢ä¸€ç§æ•°æ®ä¸€è‡´æ€§è¾ƒé«˜</p></li><li><p>å¼‚æ­¥å¤åˆ¶ï¼šä¸€æ—¦æœ‰éœ€è¦å¤åˆ¶çš„å°±é€šçŸ¥ slave, ä½†ä¸ä¼šç­‰å¾…ç¡®è®¤æˆåŠŸæ‰è¿›è¡Œåç»­æ“ä½œã€‚</p></li></ul><h1 id="7-å­˜å‚¨å¼•æ“"><a href="#7-å­˜å‚¨å¼•æ“" class="headerlink" title="7. å­˜å‚¨å¼•æ“"></a>7. å­˜å‚¨å¼•æ“</h1><h2 id="Mysql-å­˜å‚¨å¼•æ“æœ‰å“ªäº›ä»¥åŠç‰¹ç‚¹ï¼Ÿ"><a href="#Mysql-å­˜å‚¨å¼•æ“æœ‰å“ªäº›ä»¥åŠç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="Mysql å­˜å‚¨å¼•æ“æœ‰å“ªäº›ä»¥åŠç‰¹ç‚¹ï¼Ÿ"></a>Mysql å­˜å‚¨å¼•æ“æœ‰å“ªäº›ä»¥åŠç‰¹ç‚¹ï¼Ÿ</h2><ul><li><p><strong>InnoDBï¼š</strong> å®ƒæ˜¯ mysql çš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œèƒ½å¤Ÿå®ç° ACID ç‰¹æ€§çš„äº‹åŠ¡ï¼Œå¹¶ä¸”èƒ½æäº¤ã€å›æ»šã€æ¢å¤æ•°æ®ï¼Œèƒ½å¾ˆå¥½çš„ä¿éšœç”¨æˆ·æ•°æ®ã€‚åŒæ—¶æ”¯æŒäº†è¡Œçº§é”ã€èšé›†ç´¢å¼•ä»¥åŠå¤–é”®çº¦æŸï¼Œæ˜¯ä¸€ä¸ªå®Œå–„çš„å­˜å‚¨å¼•æ“ã€‚</p></li><li><p><strong>MyISAMï¼š</strong> æ˜¯ mysql æœ€å¼€å§‹çš„å­˜å‚¨å¼•æ“ï¼Œå ç”¨ç©ºé—´å°ï¼Œèƒ½å¿«é€Ÿå­˜å‚¨ï¼Œä½†ä¸æ”¯æŒäº‹åŠ¡ï¼Œæä¾›äº†åŸºäºè¡¨çº§åˆ«çš„é”ç²’åº¦ï¼Œé€‚ç”¨äºé…ç½®æˆ–åªè¯»åŠŸèƒ½çš„åº”ç”¨ç¨‹åºã€‚</p></li><li><p><strong>Memoryï¼š</strong> æ•°æ®éƒ½æ˜¯å­˜åœ¨å†…å­˜é‡Œçš„ï¼Œèƒ½æä¾›å¿«é€Ÿè®¿é—®ï¼Œä¸è¿‡åº”è¯¥è¾ƒå°‘äººä½¿ç”¨ï¼Œæ¯•ç«Ÿä¸€æ—¦æ–­ç”µæ•°æ®ä¹Ÿå°±ä¸¢å¤±äº†ã€‚</p></li><li><p><strong>CSVï¼š</strong> å¸¦æœ‰é€—å·åˆ†éš”å€¼çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ²¡æœ‰ç´¢å¼•å­˜åœ¨ã€‚ä½†æ˜¯å…¼å®¹æ€§å¾ˆå¥½ï¼Œå¯ä»¥è·Ÿå…¶ä»–çš„ç¨‹åºäº¤æ¢æ•°æ®ã€‚</p></li></ul><h2 id="myisam-å­˜å‚¨å¼•æ“å’Œ-innodb-çš„åŒºåˆ«"><a href="#myisam-å­˜å‚¨å¼•æ“å’Œ-innodb-çš„åŒºåˆ«" class="headerlink" title="myisam å­˜å‚¨å¼•æ“å’Œ innodb çš„åŒºåˆ«"></a>myisam å­˜å‚¨å¼•æ“å’Œ innodb çš„åŒºåˆ«</h2><ul><li><p>innoDB æ”¯æŒäº‹åŠ¡ï¼Œmyisam ä¸æ”¯æŒ</p></li><li><p>innoDB æ”¯æŒè¡Œé”ï¼Œmyisam ä¸æ”¯æŒï¼Œåªèƒ½åˆ°è¡¨é”</p></li><li><p>innoDB æ”¯æŒå¤–é”®ï¼Œmyisam ä¸æ”¯æŒ</p></li><li><p>innoDB ä¸æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œmyisam æ”¯æŒ</p></li><li><p>innoDB æ”¯æŒèšé›†ç´¢å¼• å’Œ éèšé›†ç´¢å¼•ï¼›myISAM åªæ”¯æŒéèšé›†ç´¢å¼•ï¼Œè¯¥ç´¢å¼•å­˜çš„æ˜¯æ•°æ®åŸŸçš„è®°å½•æŒ‡é’ˆï¼Œè¿˜å¾—è·³è½¬æŸ¥æ‰¾ã€‚</p></li></ul><h1 id="8-Mysql-çš„ä¸‰å±‚æ¶æ„"><a href="#8-Mysql-çš„ä¸‰å±‚æ¶æ„" class="headerlink" title="8. Mysql çš„ä¸‰å±‚æ¶æ„"></a>8. Mysql çš„ä¸‰å±‚æ¶æ„</h1><ul><li><p><strong>è¿æ¥å±‚ï¼š</strong> ä¸»è¦è´Ÿè´£è¿æ¥æ± ã€é€šä¿¡åè®®ã€è®¤è¯æˆæƒç­‰ï¼›</p></li><li><p><strong>SQL å±‚ï¼š</strong> è¿™ä¸€å±‚æ˜¯ mysql çš„å¤§è„‘ï¼Œé€šè¿‡ä¸€ç³»åˆ—ç»„ä»¶å¾—åˆ°æ•°æ®æ“ä½œçš„æœ€ä¼˜è§£ã€‚</p></li><li><p><strong>å­˜å‚¨å±‚ï¼š</strong> è´Ÿè´£æ•°æ®çš„å­˜å‚¨ã€æ£€ç´¢ã€‚</p></li><li><p><img src="https://static001.geekbang.org/infoq/7b/7b8895802bcf0c023f64a3ed741c1e46.pngc_center"></p></li></ul><h1 id="9-æ‰§è¡Œè®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆçœ‹ï¼Ÿ"><a href="#9-æ‰§è¡Œè®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆçœ‹ï¼Ÿ" class="headerlink" title="9. æ‰§è¡Œè®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆçœ‹ï¼Ÿ"></a>9. æ‰§è¡Œè®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆçœ‹ï¼Ÿ</h1><p>æ‰§è¡Œè®¡åˆ’æ˜¯ mysql æ ¹æ®æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œä¸€ç³»åˆ—çš„åˆ†æåå¾—åˆ°çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œè®¡åˆ’æ¥è·å–æ‰§è¡Œè¿‡ç¨‹ã€‚</p><p>æ‰§è¡Œè®¡åˆ’çš„è·å–ï¼š</p><p><code>explain select è¯­å¥</code>  </p><p><img src="https://static001.geekbang.org/infoq/da/da4a15afe4d3bf624e33a136db3eac93.png"></p><p>æ¶‰åŠçš„å­—æ®µå«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><p>idï¼š è¯¥ SELECT æ ‡è¯†ç¬¦</p></li><li><p>select_typeï¼š è¯¥ SELECT ç±»å‹</p></li><li><p>tableï¼š è¾“å‡ºè¡Œçš„è¡¨</p></li><li><p>partitionsï¼š åŒ¹é…çš„åˆ†åŒº</p></li><li><p>typeï¼š è”æ¥ç±»å‹</p></li><li><p>possible_keysï¼š å¯ä¾›é€‰æ‹©çš„å¯èƒ½ç´¢å¼•</p></li><li><p>keyï¼š å®é™…é€‰æ‹©çš„ç´¢å¼•</p></li><li><p>key_lenï¼š æ‰€é€‰å¯†é’¥çš„é•¿åº¦</p></li><li><p>refï¼š ä¸ç´¢å¼•æ¯”è¾ƒçš„åˆ—</p></li><li><p>rowsï¼š ä¼°è®¡è¦æ£€æŸ¥çš„è¡Œæ•°</p></li><li><p>filteredï¼š æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”</p></li><li><p>Extraï¼š é™„åŠ ä¿¡æ¯</p></li></ul><p>å…¶ä¸­ï¼Œæœ‰ä¸ª type å­—æ®µï¼Œå®ƒçš„å«ä¹‰å¤§æ¦‚å¦‚ä¸‹ï¼š</p><ul><li><p>eq_refï¼š ä½¿ç”¨åˆ°äº† UNIQUE æˆ– PRIMARY KEY ç´¢å¼•</p></li><li><p>refï¼š æ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†</p></li><li><p>ref_or_nullï¼š å¯¹ Null è¿›è¡Œäº†ç´¢å¼•ä¼˜åŒ–</p></li><li><p>rangeï¼š ç´¢å¼•èŒƒå›´æ£€ç´¢</p></li><li><p>indexï¼š ç´¢å¼•æ‰«æ</p></li><li><p>unique_subqueryï¼š ä½¿ç”¨äº† in å­æŸ¥è¯¢ï¼Œé‡Œé¢æ¶‰åŠäº†ä¸»é”®å­—æ®µ</p></li><li><p>index_subqueryï¼š ä½¿ç”¨äº† in å­æŸ¥è¯¢ï¼Œé‡Œé¢æ¶‰åŠäº†éå”¯ä¸€ç´¢å¼•</p></li><li><p>fulltextï¼š å…¨æ–‡ç´¢å¼•</p></li><li><p>allï¼š å…¨è¡¨æ‰«ææ•°æ®</p></li></ul><p>ä»ä¸Šé¢å¤§æ¦‚å°±èƒ½åˆ†æå‡ºç´¢å¼•çš„ä½¿ç”¨æƒ…å†µäº†ï¼Œå¦‚æœæ˜¯ allï¼Œé‚£å°±æ˜¯æ²¡æœ‰ç”¨åˆ°ç´¢å¼•äº†ã€‚</p><h1 id="10-SQL-æ³¨å…¥çš„ç°è±¡æ˜¯ï¼Ÿ"><a href="#10-SQL-æ³¨å…¥çš„ç°è±¡æ˜¯ï¼Ÿ" class="headerlink" title="10. SQL æ³¨å…¥çš„ç°è±¡æ˜¯ï¼Ÿ"></a>10. SQL æ³¨å…¥çš„ç°è±¡æ˜¯ï¼Ÿ</h1><p>åœ¨æ‹¼æ¥ SQL è¯­å¥æ—¶ï¼Œç›´æ¥ä½¿ç”¨å®¢æˆ·ç«¯ä¼ é€’è¿‡æ¥çš„å€¼æ‹¼æ¥ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¼ æ¥åŒ…å« <code>or 1=1</code> ç±»ä¼¼çš„è¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šç­›é€‰åˆ°éé¢„æœŸçš„ç»“æœï¼Œè¿›è€Œè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨çš„æ•ˆæœã€‚</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ç°åœ¨æ•°æ®åº“æä¾›çš„é¢„ç¼–è¯‘ï¼ˆprepareï¼‰å’ŒæŸ¥è¯¢å‚æ•°ç»‘å®šåŠŸèƒ½ï¼Œä¾‹å¦‚ä½¿ç”¨å ä½ç¬¦ <code>?</code>ï¼Œç„¶åå°†å¸¦æœ‰å ä½ç¬¦çš„ SQL è¯­å¥äº¤ç»™æ•°æ®åº“ç¼–è¯‘ï¼Œè¿™æ ·æ•°æ®åº“å°±èƒ½çŸ¥é“è¦æ‰§è¡Œçš„æ˜¯å“ªäº›è¯­å¥ï¼Œæ¡ä»¶å€¼åˆæ˜¯å“ªäº›ï¼Œè€Œä¸ä¼šæ··æ‚åœ¨ä¸€èµ·ã€‚</p><h1 id="11-UNION-å’Œ-UNION-ALL-çš„åŒºåˆ«ï¼Ÿ"><a href="#11-UNION-å’Œ-UNION-ALL-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="11. UNION å’Œ UNION ALL çš„åŒºåˆ«ï¼Ÿ"></a>11. UNION å’Œ UNION ALL çš„åŒºåˆ«ï¼Ÿ</h1><ul><li><p>UNION ALLï¼šå°†æ‰€æœ‰çš„æ•°æ®è”åˆèµ·æ¥ï¼Œå³ä½¿æœ‰é‡å¤æ•°æ®</p></li><li><p>UNIONï¼šä¼šåˆå¹¶é‡å¤æ•°æ®</p></li></ul><h1 id="12-ä¸ºä»€ä¹ˆå°½é‡ä½¿ç”¨è‡ªå¢-IDï¼Œè€Œä¸æ˜¯-UUIDï¼Ÿ"><a href="#12-ä¸ºä»€ä¹ˆå°½é‡ä½¿ç”¨è‡ªå¢-IDï¼Œè€Œä¸æ˜¯-UUIDï¼Ÿ" class="headerlink" title="12. ä¸ºä»€ä¹ˆå°½é‡ä½¿ç”¨è‡ªå¢ IDï¼Œè€Œä¸æ˜¯ UUIDï¼Ÿ"></a>12. ä¸ºä»€ä¹ˆå°½é‡ä½¿ç”¨è‡ªå¢ IDï¼Œè€Œä¸æ˜¯ UUIDï¼Ÿ</h1><p>è‡ªå¢ ID æ˜¯ç”±æœ‰åºçš„ï¼Œè€Œ UUID æ˜¯æ— åºçš„ï¼Œå¦‚æœè¯¥å­—æ®µä½œä¸ºç´¢å¼•ï¼Œé‚£ä¹ˆå°±ä¼šå¾ˆå®¹æ˜“æ‰“ç ´ B+ æ ‘çš„å¹³è¡¡ï¼Œè¿›è€Œä¸æ–­çš„åœ¨è¿›è¡Œç£ç›˜æ•°æ®é¡µçš„è°ƒæ•´ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™</p><h1 id="13-åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#13-åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="13. åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"></a>13. åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h1><ul><li><p>åˆ†åº“ï¼šä»ä¸šåŠ¡è§’åº¦è¿›è¡Œåˆ‡åˆ†</p></li><li><p>åˆ†è¡¨ï¼šå°†æ•°æ®æ ¹æ®ä¸€å®šçš„è§„åˆ™è½åœ¨å¤šå¼ è¡¨ä¸Šã€‚æ¯”å¦‚æŒ‰æ—¶é—´èŒƒå›´æ¥åˆ‡åˆ†ï¼Œæˆ–è€…é€šè¿‡å¯¹ ID è¿›è¡Œ Hash æ¥è·¯ç”±åˆ°å¯¹åº”çš„è¡¨ä¸Šã€‚</p></li></ul><p>åˆ†åº“åˆ†è¡¨åä½¿å¾—æ•°æ®ä¸å†é›†ä¸­åˆ°ä¸€å¼ è¡¨ä¸Šï¼Œä½†ä¹Ÿå¸¦æ¥äº†ç»´æŠ¤ä»¥åŠå…¶ä»–å¤„ç†é—®é¢˜ã€‚æ¯”å¦‚åŸæ¥çš„äº‹åŠ¡å˜ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡ï¼›åŸæ¥çš„ join æ“ä½œå°†è¦å˜ä¸ºåœ¨åº”ç”¨å±‚åºåšè¿‡æ»¤ï¼›è¿˜æœ‰æ•°æ®çš„åç»­è¿ç§»ã€æ‰©å®¹è§„åˆ’ç­‰ã€‚</p><h1 id="14-å†…è¿æ¥ã€å¤–è¿æ¥åŒºåˆ«"><a href="#14-å†…è¿æ¥ã€å¤–è¿æ¥åŒºåˆ«" class="headerlink" title="14. å†…è¿æ¥ã€å¤–è¿æ¥åŒºåˆ«"></a>14. å†…è¿æ¥ã€å¤–è¿æ¥åŒºåˆ«</h1><ul><li><p>å†…è¿æ¥ï¼šåªæœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•æ‰ä¼šå‡ºç°åœ¨ç»“æœé›†é‡Œ</p></li><li><p>å¤–è¿æ¥ï¼šå…¶ç»“æœé›†ä¸­ä¸ä»…åŒ…å«ç¬¦åˆè¿æ¥æ¡ä»¶çš„è¡Œï¼Œè¿˜ä¼šåŒ…æ‹¬å·¦è¡¨ã€å³è¡¨æˆ–ä¸¤ä¸ªè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®è¡Œï¼Œè¿™ä¸‰ç§æƒ…å†µä¾æ¬¡ç§°ä¹‹ä¸ºå·¦å¤–è¿æ¥ï¼Œå³å¤–è¿æ¥ï¼Œå’Œå…¨å¤–è¿æ¥ã€‚</p></li></ul><h1 id="15-å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–"><a href="#15-å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–" class="headerlink" title="15. å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–"></a>15. å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–</h1><ul><li><p>å¯¹ç»å¸¸å‡ºç°åœ¨ where æ¡ä»¶é‡Œï¼Œå¹¶ä¸”æ•°æ®é‡å¤ç‡ä¸é«˜çš„å­—æ®µå»ºç«‹ç´¢å¼•</p></li><li><p>ä½¿ç”¨ JOIN æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼›</p></li><li><p>èƒ½ä½¿ç”¨ in å°±ä¸ä½¿ç”¨ orï¼Œå‰è€…èƒ½å‘½ä¸­ç´¢å¼•ï¼Œåè€…ä¼šè®©ç´¢å¼•å¤±æ•ˆ</p></li><li><p>é¿å…åœ¨ where å­—æ®µä¸Šè®¡ç®—ï¼Œä¾‹å¦‚ where a &#x2F; 3 &#x3D; 1ï¼Œè¿™æ ·ä¼šè®©ç´¢å¼•å¤±æ•ˆï¼›é¿å…åœ¨ where å­—æ®µä¸Šä½¿ç”¨ NULL å€¼çš„åˆ¤æ–­</p></li><li><p>æ‰“å¼€æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®ï¼Œæœ‰é’ˆå¯¹æ€§çš„åˆ†æå“åº”ç¼“æ…¢çš„è¯­å¥ã€‚</p></li></ul><h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><h2 id="sqlçš„æ‰§è¡Œé¡ºåº"><a href="#sqlçš„æ‰§è¡Œé¡ºåº" class="headerlink" title="sqlçš„æ‰§è¡Œé¡ºåº"></a>sqlçš„æ‰§è¡Œé¡ºåº</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from on where group by having select distinct order by limit</span><br></pre></td></tr></table></figure><h3 id="ä¸€æ¡SQLæ›´æ–°è¯­å¥æ‰§è¡Œé¡ºåº"><a href="#ä¸€æ¡SQLæ›´æ–°è¯­å¥æ‰§è¡Œé¡ºåº" class="headerlink" title="ä¸€æ¡SQLæ›´æ–°è¯­å¥æ‰§è¡Œé¡ºåº"></a>ä¸€æ¡SQLæ›´æ–°è¯­å¥æ‰§è¡Œé¡ºåº</h3><p>é€šè¿‡åˆ†æå™¨åˆ†æï¼Œæ‰§è¡Œå’ŒæŸ¥è¯¢è¯­å¥ä¸€æ ·ã€‚ç„¶åå†™redo log(æ˜¯ä¸ªå¾ªç¯æ—¥å¿—æ–‡ä»¶ã€‚å†™å®Œredo logåŒæ­¥åˆ°å†…å­˜ä¸­ï¼Œé€‚å½“æ—¶æœºæ›´æ–°åˆ°ç£ç›˜ä¸­) å’Œ binary logï¼Œä¸redo log é‡‡å–äºŒé˜¶æ®µäº‹åŠ¡æäº¤</p><h3 id="äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Œä¸ºä»€ä¹ˆ"><a href="#äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Œä¸ºä»€ä¹ˆ" class="headerlink" title="äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Œä¸ºä»€ä¹ˆ"></a>äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Œä¸ºä»€ä¹ˆ</h3><h4 id="è¯»æœªæäº¤"><a href="#è¯»æœªæäº¤" class="headerlink" title="è¯»æœªæäº¤"></a>è¯»æœªæäº¤</h4><p>ä¼šè¯»åˆ°æœªæäº¤çš„äº‹åŠ¡ï¼Œè„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»</p><p>å¹»è¯»ï¼šæŒ‡çš„æ˜¯ä¸€ä¸ªäº‹åŠ¡åœ¨å‰åä¸¤æ¬¡æŸ¥è¯¢åŒä¸€ä¸ªèŒƒå›´çš„æ—¶å€™ï¼Œåä¸€æ¬¡æŸ¥è¯¢çœ‹åˆ°äº†å‰ä¸€æ¬¡æŸ¥è¯¢æ²¡æœ‰çœ‹åˆ°çš„æ•°æ®è¡Œã€‚</p><h4 id="ä¸å¯é‡å¤è¯»ï¼ˆrcï¼‰"><a href="#ä¸å¯é‡å¤è¯»ï¼ˆrcï¼‰" class="headerlink" title="ä¸å¯é‡å¤è¯»ï¼ˆrcï¼‰"></a>ä¸å¯é‡å¤è¯»ï¼ˆrcï¼‰</h4><p>åˆ«çš„äº‹åŠ¡æäº¤ï¼Œè€Œèƒ½ç›´æ¥è¯»åˆ°åˆ«çš„äº‹åŠ¡æäº¤çš„ç»“æœï¼Œå’Œåˆ«çš„äº‹åŠ¡æäº¤ä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸å¯é‡å¤è¯»</p><h4 id="å¯é‡å¤è¯»-rr"><a href="#å¯é‡å¤è¯»-rr" class="headerlink" title="å¯é‡å¤è¯»(rr)"></a>å¯é‡å¤è¯»(rr)</h4><p>è¯»å–æ˜¯ä»å¿«ç…§ä¸­è¯»å–ï¼Œå³ä½¿åˆ«çš„äº‹åŠ¡æäº¤ä»è¯»çš„æ˜¯æ—§çš„</p><h4 id="ä¸²è¡ŒåŒ–"><a href="#ä¸²è¡ŒåŒ–" class="headerlink" title="ä¸²è¡ŒåŒ–"></a>ä¸²è¡ŒåŒ–</h4><p>é”è¡¨ï¼Œåˆ«äººè¯»çš„æ—¶å€™ï¼Œä½ ä¸èƒ½å¹²ä»»ä½•äº‹æƒ…</p><h4 id="ä½¿ç”¨RCä¸ºé»˜è®¤éš”ç¦»çº§åˆ«"><a href="#ä½¿ç”¨RCä¸ºé»˜è®¤éš”ç¦»çº§åˆ«" class="headerlink" title="ä½¿ç”¨RCä¸ºé»˜è®¤éš”ç¦»çº§åˆ«"></a>ä½¿ç”¨RCä¸ºé»˜è®¤éš”ç¦»çº§åˆ«</h4><p>innodbé»˜è®¤ä¸ºRRéš”ç¦»çº§åˆ«ï¼Œæ˜¯ç”±äºå†å²åŸå› binary logåŒæ­¥çš„åŸå› ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯statementè®°å½•æ“ä½œè¯­å¥ï¼ˆæ˜¯ä»¥commitçš„é¡ºåºä¸ºè®°å½•ï¼‰ã€‚å°±ä¼šå‡ºç°ä¸»ä»ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><ol><li>åœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œå­˜åœ¨é—´éš™é”ï¼Œå¯¼è‡´å‡ºç°æ­»é”çš„å‡ ç‡æ¯”RCå¤§çš„å¤šï¼</li><li>åœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œæ¡ä»¶åˆ—æœªå‘½ä¸­ç´¢å¼•ä¼šé”è¡¨ï¼è€Œåœ¨RCéš”ç¦»çº§åˆ«ä¸‹ï¼Œåªé”è¡Œ</li><li>åœ¨RCéš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŠä¸€è‡´æ€§è¯»(semi-consistent)ç‰¹æ€§å¢åŠ äº†updateæ“ä½œçš„å¹¶å‘æ€§ï¼</li></ol><p>åœ¨RCçº§åˆ«ä¸‹ï¼Œä¸å¯é‡å¤è¯»é—®é¢˜éœ€è¦è§£å†³ä¹ˆï¼Ÿ<br>ä¸ç”¨è§£å†³ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯å¯ä»¥æ¥å—çš„ï¼æ¯•ç«Ÿä½ æ•°æ®éƒ½å·²ç»æäº¤äº†ï¼Œè¯»å‡ºæ¥æœ¬èº«å°±æ²¡æœ‰å¤ªå¤§é—®é¢˜ï¼Oracleçš„é»˜è®¤éš”ç¦»çº§åˆ«å°±æ˜¯RCï¼Œä½ ä»¬æ”¹è¿‡Oracleçš„é»˜è®¤éš”ç¦»çº§åˆ«ä¹ˆï¼Ÿ</p><p>åœ¨RCçº§åˆ«ä¸‹ï¼Œä¸»ä»å¤åˆ¶ç”¨ä»€ä¹ˆbinlogæ ¼å¼ï¼Ÿ<br>OK,åœ¨è¯¥éš”ç¦»çº§åˆ«ä¸‹ï¼Œç”¨çš„binlogä¸ºrowæ ¼å¼ï¼Œæ˜¯åŸºäºè¡Œçš„å¤åˆ¶ï¼Innodbçš„åˆ›å§‹äººä¹Ÿæ˜¯å»ºè®®binlogä½¿ç”¨è¯¥æ ¼å¼ï¼</p><h3 id="è¯´è¯´ä½ äº†è§£çš„ç´¢å¼•"><a href="#è¯´è¯´ä½ äº†è§£çš„ç´¢å¼•" class="headerlink" title="è¯´è¯´ä½ äº†è§£çš„ç´¢å¼•"></a>è¯´è¯´ä½ äº†è§£çš„ç´¢å¼•</h3><p>èšç°‡ç´¢å¼•ï¼Œä½¿ç”¨çš„æ˜¯B+ æ ‘ç±»å‹ã€‚</p><p>ä¸»é”®ç´¢å¼•ï¼Œå­˜æ”¾çš„æ˜¯valueå’Œç´¢å¼•</p><p>å…¶ä½™çš„åªå­˜æ”¾ç´¢å¼•ï¼Œéœ€è¦å›è¡¨æŸ¥è¯¢ã€‚å› ä¸ºå¶å­èŠ‚ç‚¹åªå­˜æ”¾ç´¢å¼•ã€‚</p><p>ç´¢å¼•ç±»å‹ï¼š</p><ol><li>ä¸»é”®ç´¢å¼•</li><li>å”¯ä¸€ç´¢å¼•</li><li>æ™®é€šç´¢å¼•</li><li>è”åˆç´¢å¼•</li></ol><p>explainä¸­çš„å­—æ®µ</p><ul><li><p>id</p><ul><li>id ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œé¡ºåºç”±ä¸Šè€Œä¸‹</li><li>å¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid è¶Šå¤§ï¼Œè¶Šå…ˆæ‰§è¡Œ</li><li>å°è¡¨é©±åŠ¨å¤§è¡¨</li></ul></li><li><p>select_type</p><ul><li>simple ç®€å•çš„æŸ¥è¯¢ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…union</li><li>primary ä¸»æŸ¥è¯¢ï¼Œæœ€ååŠ è½½</li><li>subquery å­æŸ¥è¯¢</li><li>derived è¡ç”Ÿçš„ä¸´æ—¶è¡¨</li><li>union<ul><li>è‹¥ç¬¬äºŒä¸ªselectå‡ºç°åœ¨unionä¹‹åï¼Œåˆ™æ ‡è®°ä¸ºunion</li><li>è‹¥unionåŒ…å«åœ¨fromå­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œåˆ™å¤–å±‚selectæ ‡è®°ä¸ºderived</li></ul></li><li>union result ä»unionè¡¨è·å–ç»“æœçš„select<ul><li>ä¸¤ä¸ªunionåˆå¹¶çš„select</li></ul></li></ul></li><li><p>table å“ªå¼ è¡¨</p></li><li><p>type</p><ul><li>ä»æœ€å¥½åˆ°æœ€å·®ä¾æ¬¡<ul><li>system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;all</li><li>system åªæœ‰ä¸€æ¡è®°å½•çš„å•è¡¨ï¼Œç³»ç»Ÿè¡¨</li><li>const ç›¸å½“äºprimary key æˆ– unique ç­‰äºä¸€ä¸ªæ•°å€¼ where id &#x3D;1</li><li>eq_ref å”¯ä¸€ç´¢å¼• t1.id&#x3D;t2.id</li><li>ref æ™®é€šç´¢å¼•ï¼Œéå”¯ä¸€å€¼</li><li>range åªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œ</li><li>index éå†æ‰€æœ‰ç´¢å¼•</li><li>all å…¨è¡¨æ‰«æï¼Œéœ€è¦ä¼˜åŒ–</li></ul></li></ul></li><li><p>possible_keysï¼Œkey</p><ul><li>å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•å’Œå®é™…ç”¨åˆ°çš„ç´¢å¼•</li><li>è¦†ç›–ç´¢å¼•ä¸ä¼šæ˜¾ç¤ºåœ¨possible_keysä¸Šï¼Œåªä¼šæ˜¾ç¤ºåœ¨keyä¸­</li></ul></li><li><p>key_len</p><ul><li>è¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦</li><li>åŒæ ·çš„æŸ¥è¯¢ç»“æœï¼Œé•¿åº¦è¶Šå°‘è¶Šå¥½</li></ul></li><li><p>ref</p><ul><li>æ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨,å¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼</li><li>const å¸¸é‡</li><li>test1.t1.id</li></ul></li><li><p>rows</p><ul><li>æ ¹æ®è¡¨ç»Ÿè®¡ä¿¡æ¯åŠç´¢å¼•é€‰ç”¨æƒ…å†µï¼Œå¤§è‡´ä¼°ç®—å‡ºæ‰¾åˆ°æ‰€éœ€çš„è®°å½•æ‰€éœ€è¦è¯»å–çš„è¡Œæ•°</li><li>ç†è®ºä¸Šå½±å“äº†å¤šå°‘è¡Œ</li></ul></li><li><p>extra</p><ul><li>ä¸é€‚åˆåœ¨å…¶ä»–åˆ—ä¸­æ˜¾ç¤ºä½†æ˜¯ååˆ†é‡è¦çš„é¢å¤–ä¿¡æ¯</li><li>using filesort<ul><li>mysql æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºï¼Œæ–‡ä»¶æ’åº</li></ul></li><li>using temporary<ul><li>å¯¹æŸ¥è¯¢ç»“æœï¼Œä½¿ç”¨äº†ä¸´æ—¶è¡¨ order by ,group by</li><li>æœ€å¥½ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä¸è¦äº§ç”Ÿä¸´æ—¶è¡¨</li></ul></li><li>using index<ul><li>è¡¨ç¤ºç›¸åº”çš„select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•</li><li>åŒæ—¶å‡ºç°using where ï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾</li><li>æ²¡å‡ºç°using whereï¼Œè¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œéæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œ</li></ul></li><li>using where<ul><li>ä½¿ç”¨äº† where</li></ul></li><li>using join buffer<ul><li>join å¤šï¼Œè€Œä½¿ç”¨äº†ç¼“å†²åŒº</li></ul></li><li>impossible where<ul><li>whereå­å¥çš„å€¼æ˜¯false</li></ul></li></ul></li><li><p>ä¸¤è¡¨åŠ ç´¢å¼•</p><ul><li>å·¦è¿æ¥<ul><li>åŠ å­è¡¨ä¸Šï¼Œä¸»è¡¨çš„æ•°æ®å…¨éƒ¨éƒ½è¦ï¼ŒåŠ äº†ç´¢å¼•ä¹Ÿæ²¡ç”¨ï¼Œå­è¡¨ä¸ä¸€å®šéƒ½è¦ï¼Œå¯ä»¥åŠ ç´¢å¼•ä¼˜åŒ–</li><li>sqlæ‰§è¡Œçš„é¡ºåºä¸º from on join å…¶ä¸­ onå°±æ˜¯å¯ä»¥ç”¨åˆ°ç´¢å¼•çš„åœ°æ–¹</li></ul></li><li>å³è¿æ¥ç›¸å</li><li>join è¯­å¥çš„ä¼˜åŒ–<ul><li>å°½å¯èƒ½å‡å°‘joinè¯­å¥çš„Nestedloopçš„å¾ªç¯æ€»æ¬¡æ•°ï¼Œæ°¸è¿œç”¨å°ç»“æœé›†é©±åŠ¨å¤§ç»“æœé›†</li><li>ä¼˜å…ˆä¼˜åŒ–NestedLoopçš„å†…å±‚å¾ªç¯</li><li>ä¿è¯Joinè¯­å¥ä¸­è¢«é©±åŠ¨è¡¨ä¸ŠJoinæ¡ä»¶å­—æ®µå·²ç»è¢«ç´¢å¼•</li><li>å½“æ— æ³•ä¿è¯è¢«é©±åŠ¨è¡¨çš„Joinæ¡ä»¶å­—æ®µè¢«ç´¢å¼•ä¸”å†…å­˜èµ„æºå……è¶³çš„å‰æä¸‹ï¼Œä¸è¦å¤ªåå•¬JoinBufferçš„è®¾ç½®</li></ul></li></ul></li><li><p>ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µï¼š</p><ul><li>å…¨å€¼åŒ¹é…æˆ‘æœ€çˆ±</li><li>è¿èƒŒæœ€å·¦å‰ç¼€åŸåˆ™</li><li>è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—</li><li>æŸåˆ—å±äºè”åˆç´¢å¼•ï¼Œå¯¹è¯¥åˆ—è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œå€¼ä½¿ç”¨éƒ¨åˆ†ç´¢å¼•ï¼Œè¯¥åˆ—å³è¾¹çš„åˆ—æ— æ³•ä½¿ç”¨ç´¢å¼•</li><li>!&#x3D;,is null,is not null</li><li>likeä»¥é€šé…ç¬¦å¼€å¤´<ul><li>è§£å†³%like% ç´¢å¼•æ—¶ä¸èƒ½å¤±æ•ˆçš„æ–¹æ³•</li><li>ä½¿ç”¨è¦†ç›–ç´¢å¼•å¯ä»¥è§£å†³</li></ul></li><li>ç”¨orè¿æ¥æ¡ä»¶</li><li>ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ï¼Œå‡½æ•°ï¼Œè‡ªåŠ¨oræ‰‹åŠ¨ç±»å‹è½¬æ¢ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æï¼‰</li><li>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•</li><li>å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·ç´¢å¼•å¤±æ•ˆ</li><li>ç´¢å¼•åˆ—çš„æ•°æ®é•¿åº¦èƒ½å°‘åˆ™å°‘</li><li>ç´¢å¼•ä¸€å®šä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè¶Šå…¨è¶Šå¥½ï¼Œä¸€å®šæ˜¯å»ºåˆé€‚çš„</li><li>åŒ¹é…åˆ—æµ…é†‰å¯ç”¨åˆ°ç´¢å¼•ï¼Œlike %9999%ã€ike %9999%ç”¨ä¸åˆ°ç´¢å¼•ï¼Œlike 9999%åœ¨åˆ—ç¦»æ•£åº¦é«˜çš„æ—¶å€™èƒ½ç”¨åˆ°ç´¢å¼•ï¼Œç¦»æ•£åº¦ä½çš„æ—¶å€™ç”¨ä¸åˆ°</li><li>whereæ¡ä»¶ä¸­not inå’Œ&lt;&gt;æ“ä½œæ— æ³•ä½¿ç”¨ç´¢å¼•</li><li>åŒ¹é…èŒƒå›´å€¼ï¼Œorder byä¹Ÿå¯ç”¨åˆ°ç´¢å¼•</li><li>å¤šç”¨æŒ‡å®šåˆ—æŸ¥è¯¢ï¼Œåªè¿”å›è‡ªå·±æƒ³è¦çš„æ•°æ®åˆ—ï¼Œå°‘ç”¨select*;</li><li>è”åˆç´¢å¼•ä¸­å¦‚æœä¸æ˜¯æŒ‰ç…§ç´¢å¼•æœ€å·¦åˆ—å¼€å§‹æŸ¥æ‰¾ï¼Œæ— æ³•ä½¿ç”¨ç´¢å¼•</li><li>è”åˆç´¢å¼•ä¸­ç²¾ç¡®åŒ¹é…æœ€å·¦å‰åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—å¯ä»¥ç”¨åˆ°ç´¢å¼•</li><li>è”åˆç´¢å¼•ä¸­å¦‚æœæŸ¥è¯¢ä¸­æœ‰æŸä¸ªåˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™å…¶å³è¾¹æ‰€æœ‰åˆ—éƒ½æ— æ³•ä½¿ç”¨ç´¢å¼•</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisé¢è¯•å¿…å¤‡</title>
      <link href="/interview/db/redis101/"/>
      <url>/interview/db/redis101/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸è§é¢è¯•é—®é¢˜"><a href="#å¸¸è§é¢è¯•é—®é¢˜" class="headerlink" title="å¸¸è§é¢è¯•é—®é¢˜"></a>å¸¸è§é¢è¯•é—®é¢˜</h2><h3 id="1-åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ç¼“å­˜æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ"><a href="#1-åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ç¼“å­˜æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="1. åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ç¼“å­˜æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ"></a>1. åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ç¼“å­˜æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ</h3><ul><li>å®¢æˆ·ç«¯ç¼“å­˜ï¼šé¡µé¢å’Œæµè§ˆå™¨ç¼“å­˜ï¼Œapp ç¼“å­˜ï¼Œh5 ç¼“å­˜ï¼ŒlocalStorageï¼ŒsessionStorage</li><li>CDNï¼šå†…å®¹å­˜å‚¨&#x3D;æ•°æ®å­˜å‚¨ï¼Œå†…å®¹åˆ†å‘&#x3D;è´Ÿè½½å‡è¡¡</li><li>Nginx ç¼“å­˜ï¼š é™æ€èµ„æº</li><li>æœåŠ¡ç«¯ç¼“å­˜ï¼šæœ¬åœ°ç¼“å­˜ï¼Œå¤–éƒ¨ç¼“å­˜</li><li>æ•°æ®åº“ç¼“å­˜ï¼šæŒä¹…ç¼“å­˜ï¼ˆmybatisï¼Œhibernate å¤šçº§ç¼“å­˜ï¼‰ï¼Œmysql æŸ¥è¯¢ç¼“å­˜</li><li>æ“ä½œç³»ç»Ÿç¼“å­˜ï¼špage cacheï¼Œbuffer cache</li></ul><h3 id="2-å¸¸è§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•"><a href="#2-å¸¸è§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•" class="headerlink" title="2. å¸¸è§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•"></a>2. å¸¸è§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•</h3><ul><li>FIFO - å…ˆè¿›å…ˆå‡º</li><li>LRU - æœ€è¿‘æœ€å°‘ä½¿ç”¨</li><li>LFU - æœ€ä¸ç»å¸¸ä½¿ç”¨</li></ul><h3 id="3-Redis-å¦‚ä½•é…ç½®-Key-çš„è¿‡æœŸæ—¶é—´ï¼Ÿä»–çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-Redis-å¦‚ä½•é…ç½®-Key-çš„è¿‡æœŸæ—¶é—´ï¼Ÿä»–çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. Redis å¦‚ä½•é…ç½® Key çš„è¿‡æœŸæ—¶é—´ï¼Ÿä»–çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. Redis å¦‚ä½•é…ç½® Key çš„è¿‡æœŸæ—¶é—´ï¼Ÿä»–çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>Expire or SETNX</li><li>åŸç†ï¼š<ul><li>å®šæœŸåˆ é™¤ï¼šæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œæ‰§è¡Œä¸€æ¬¡åˆ é™¤è¿‡æœŸ Key çš„æ“ä½œï¼ˆæ‰¹é‡è„šæœ¬ï¼‰</li><li>æ‡’æ±‰å¼åˆ é™¤ï¼šæ¯å½“ä½¿ç”¨ getï¼Œgetset ç­‰æŒ‡ä»¤å»è·å–æ•°æ®æ—¶ï¼Œåˆ¤æ–­ key æ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸçš„è¯å°±å…ˆåˆ é™¤å†æ“ä½œ</li><li>redis åŒæ—¶ä½¿ç”¨ä¸¤è€…ï¼Œå¹³è¡¡æ‰§è¡Œé¢‘ç‡å’Œæ‰§è¡Œæ—¶é•¿</li></ul></li></ul><h3 id="4-Redis-çº¿ç¨‹æ¨¡å‹ï¼Œå•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ"><a href="#4-Redis-çº¿ç¨‹æ¨¡å‹ï¼Œå•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="4. Redis çº¿ç¨‹æ¨¡å‹ï¼Œå•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ"></a>4. Redis çº¿ç¨‹æ¨¡å‹ï¼Œå•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h3><ul><li>åŸºäº Reactor å¼€å‘äº†ç½‘ç»œæ—¶é—´å¤„ç†å™¨ - æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ï¼Œé‡‡ç”¨ IO å¤šè·¯å¤ç”¨ç›‘å¬å¤šä¸ª Socket</li><li>çº¯å†…å­˜æ“ä½œã€æ ¸å¿ƒåŸºäºéé˜»å¡çš„ IO å¤šè·¯å¤ç”¨æœºåˆ¶ã€å•çº¿ç¨‹é¿å…äº†å¤šçº¿ç¨‹åå¤ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ€§èƒ½é—®é¢˜</li></ul><h3 id="5-redis-çš„å¸¸è§ç»“æ„åŠåº”ç”¨åœºæ™¯"><a href="#5-redis-çš„å¸¸è§ç»“æ„åŠåº”ç”¨åœºæ™¯" class="headerlink" title="5. redis çš„å¸¸è§ç»“æ„åŠåº”ç”¨åœºæ™¯"></a>5. redis çš„å¸¸è§ç»“æ„åŠåº”ç”¨åœºæ™¯</h3><ul><li>string<ul><li>id&#x2F;id_info ç¼“å­˜  </li><li>è®¡æ•°å™¨  </li><li>setnx åˆ†å¸ƒå¼é” </li><li>åˆ†å¸ƒå¼ID </li><li>sdsï¼ˆåŠ¨æ€ç®€å•å­—ç¬¦ä¸²ï¼‰<ul><li>è¯»å–æ—¶é—´å¤æ‚åº¦ä¸º O(1)</li><li>æƒ°æ€§åˆ é™¤ï¼Œç•™å¾…ä¸‹æ¬¡ä½¿ç”¨</li><li>ä¸€æ¬¡åˆ†é…æœ€å¤§ä¸º 128kb</li></ul></li><li></li></ul></li><li>list<ul><li>å½“é˜Ÿåˆ—ç”¨ï¼Œæœ€è¿‘100ä¸ªè´­ä¹°ç”¨æˆ·ä¿¡æ¯  </li><li>å½“æ ˆç”¨  </li><li>éå®æ—¶åˆ†é¡µåˆ—è¡¨ï¼Œæ¯”å¦‚å°æ—¶æ¦œï¼Œæ—¥æ¦œï¼Œå‘¨æ¦œ</li><li>å­˜å‚¨å¾®åšã€å¾®ä¿¡å…¬ä¼—å·ç­‰æ¶ˆæ¯æµæ•°æ®</li><li>ç­‰äºé“¾è¡¨ï¼Œæ’å…¥åˆ é™¤ O(1)ï¼ŒæŸ¥æ‰¾ O(n)</li></ul></li><li>hash<ul><li>ç›¸æ¯”stringè·å–å•ä¸ªå­—æ®µèŠ‚çœ åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ“ä½œ</li><li>ç›¸å½“äº HashMap ï¼Œç”±æ•°ç»„åŠ é“¾è¡¨ç»„åˆè€Œæˆï¼Œå½“ä¸€ç»´çš„ hash æ•°ç»„ç¢°æ’æ—¶ï¼Œç”¨é“¾è¡¨ä¸²èµ·æ¥</li></ul></li><li>set<ul><li>å–äº¤ã€å¹¶ã€å·®é›†  </li><li>ç‚¹èµã€æ”¶è—ã€å…³æ³¨ç­‰â€¦  </li><li>kv æ¨¡å¼</li></ul></li><li>sorted set<ul><li>æ’è¡Œæ¦œåŠŸèƒ½ï¼Œå®æ—¶åˆ†é¡µåˆ—è¡¨ï¼Œå®æ—¶æ¦œå•ç­‰</li><li>set åŸºç¡€ä¸Šå¢åŠ äº†åˆ†æ•°</li><li>ç»“æ„ä¸Šæ˜¯ç”±ä¸€ä¸ª dict å’Œä¸€ä¸ªè·³è¡¨ç»„æˆï¼Œdict ä¿è¯ key å”¯ä¸€æ€§</li><li>æ’å…¥åˆ é™¤éƒ½æ˜¯ O(log n)ï¼ŒæŸ¥æ‰¾ O(logn)</li><li>ä¸€å¤§ä¼˜ç‚¹æ˜¯å¯ä»¥å¯¹åˆ†æ•°è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾</li><li>å°‘é‡æ•°æ®æŒ‰ç…§ ziplist å­˜å‚¨ï¼Œå¤§é‡æ•°æ®æŒ‰ç…§è·³è¡¨å­˜å‚¨</li></ul></li></ul><h4 id="redis-å¤§key-é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆæŸ¥å‡ºæ¥ï¼Ÿä¸€èˆ¬æ€ä¹ˆè§£å†³ï¼Ÿ"><a href="#redis-å¤§key-é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆæŸ¥å‡ºæ¥ï¼Ÿä¸€èˆ¬æ€ä¹ˆè§£å†³ï¼Ÿ" class="headerlink" title="redis å¤§key é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆæŸ¥å‡ºæ¥ï¼Ÿä¸€èˆ¬æ€ä¹ˆè§£å†³ï¼Ÿ"></a>redis å¤§key é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆæŸ¥å‡ºæ¥ï¼Ÿä¸€èˆ¬æ€ä¹ˆè§£å†³ï¼Ÿ</h4><p>å¤§keyé—®é¢˜å‘¢æ˜¯è¯´ redis çš„ kv å­˜å‚¨ä¸­ï¼Œvalueå€¼è¿‡å¤§ï¼Œä¸€èˆ¬è¶…è¿‡10kbï¼Œæˆ‘ä»¬å°±ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¤§ key äº†ã€‚<br>æœ‰æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰ä¸“é—¨å‡†å¤‡è¿™ä¸ªå†…å®¹<br>å¤§ key çš„å±å®³ä¸»è¦æ˜¯ï¼šåœ¨rediså†…å­˜ä¸­åˆ†å¸ƒä¸å‡ï¼›æ“ä½œè€—æ—¶ï¼›å–ç»“æœçš„æ•°æ®é‡å¤§ï¼Œå®¹æ˜“é€ æˆç½‘ç»œioå µå¡<br>è§£å†³æ–¹å¼å‘¢ï¼šå¯ä»¥é€»è¾‘ä¸Šå¯¹äºå¤§ key çš„ value è¿›è¡Œæ‹†åˆ†å’Œé‡ç»„ã€‚å…¶ä¸­ string ç±»å‹çš„å¤§ key ä¸€èˆ¬ä¸å»ºè®®å­˜åˆ°redisã€‚å¦å¤–çš„å¯ä»¥é‡‡ç”¨ hash å°†å¤§ key æ‹†åˆ†</p><h3 id="6-redis-é›†ç¾¤æ–¹æ¡ˆ"><a href="#6-redis-é›†ç¾¤æ–¹æ¡ˆ" class="headerlink" title="6. redis é›†ç¾¤æ–¹æ¡ˆ"></a>6. redis é›†ç¾¤æ–¹æ¡ˆ</h3><ul><li>ä¸»ä»æ¨¡å¼</li><li>å“¨å…µæ¨¡å¼<ul><li>æ¦‚å¿µ<ul><li>é›†ç¾¤ç›‘æ§ï¼šç›‘æ§ä¸»ä»æ˜¯å¦æ­£å¸¸</li><li>æ¶ˆæ¯é€šçŸ¥ï¼šæ•…éšœé€šçŸ¥</li><li>æ•…éšœè½¬ç§»ï¼šä¸»æŒ‚äº†ï¼Œç§»åˆ°ä»èº«ä¸Š</li><li>é…ç½®ä¸­å¿ƒï¼šé€šçŸ¥ client æ–°çš„ master åœ°å€</li></ul></li><li>æœ¬èº«ä¹Ÿæ˜¯åˆ†å¸ƒå¼çš„ï¼Œå…·ä½“æ–¹æ¡ˆï¼š<ul><li>é€šå¸¸3ä¸ªå“¨å…µå®ä¾‹æ¥ä¿è¯å¥å£®æ€§</li><li>å³ä½¿å“¨å…µè‡ªå·±æŒ‚äº†ï¼Œè¿˜æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œ</li><li>ä¸ä¿è¯æ•°æ®é¢†ä¸¢å¤±ï¼Œå¯ä»¥è¯´ä¸»ä»ç»“æ„å°±ä¸ä¿è¯</li><li>åˆ¤æ–­æ•…éšœéœ€è¦ç”¨<code>åˆ†å¸ƒå¼é€‰ä¸¾</code>è·å¾—å¤§éƒ¨åˆ†å“¨å…µç»Ÿä¸€æ‰è¡Œ</li></ul></li></ul></li><li>Redis clusterï¼šæœåŠ¡ç«¯ Sharding è®¡æ•°ã€‚é‡‡ç”¨æ§½çš„æ¦‚å¿µï¼Œä¸€å…±16384ä¸ªæ§½ï¼Œè¯·æ±‚å‘é€è‡³ä»»æ„èŠ‚ç‚¹<ul><li>æ–¹æ¡ˆè¯´æ˜<ul><li>é€šè¿‡å“ˆå¸Œçš„æ–¹å¼ï¼Œå°†æ•°æ®åˆ†ç‰‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡åˆ†å­˜å‚¨ä¸€å®šå“ˆå¸Œæ§½ï¼ˆå“ˆå¸Œå€¼ï¼‰åŒºé—´çš„æ•°æ®</li><li>æ¯ä»½æ•°æ®åˆ†ç‰‡ä¼šå­˜å‚¨åœ¨å¤šä¸ªäº’ä¸ºä¸»ä»çš„å¤šèŠ‚ç‚¹ä¸Š</li><li>æ•°æ®å…ˆå†™å…¥ä¸»èŠ‚ç‚¹ï¼Œå†<code>é˜»å¡</code>åŒæ­¥è‡³ä»èŠ‚ç‚¹</li><li>åŒä¸€åˆ†ç‰‡ä¹‹é—´ä¸ä¿è¯å¼ºä¸€è‡´æ€§</li><li>æ‰©å®¹æ—¶éœ€è¦æŠŠæ—§èŠ‚ç‚¹æ•°æ®ä¹Ÿè¿ç§»ä¸€éƒ¨åˆ†è‡³æ–°èŠ‚ç‚¹</li></ul></li><li>gossip åè®®ï¼Œå¤šä¸»å¤šä»</li></ul></li></ul><h3 id="7-redis-æŒä¹…åŒ–æ–¹æ¡ˆ"><a href="#7-redis-æŒä¹…åŒ–æ–¹æ¡ˆ" class="headerlink" title="7. redis æŒä¹…åŒ–æ–¹æ¡ˆ"></a>7. redis æŒä¹…åŒ–æ–¹æ¡ˆ</h3><ol><li>RDBï¼šRedis Database<br>æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œå®é™…æ“ä½œæ˜¯ fork ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå…ˆå°†æ•°æ®é›†å†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œå†™å…¥æˆåŠŸåï¼Œå†æ›¿æ¢ä¹‹å‰çš„æ–‡ä»¶ï¼Œä½¿ç”¨äºŒè¿›åˆ¶å‹ç¼©å­˜å‚¨ã€‚<br>ä¼˜ç‚¹ï¼š</li></ol><ul><li>æ•´ä¸ª redis åªåŒ…å«ä¸€ä¸ªæ–‡ä»¶ dump.rdbï¼Œæ–¹ä¾¿æŒä¹…åŒ–</li><li>å®¹ç¾æ€§å¥½ï¼Œæ˜“äºå¤‡ä»½</li><li>æ€§èƒ½æœ€å¤§åŒ–ï¼Œä½¿ç”¨å­è¿›ç¨‹å¤„ç†ï¼Œä¿è¯ä¸»è¿›ç¨‹ IO ååï¼Œä¿è¯äº† redis çš„é«˜æ€§èƒ½</li><li>ç›¸å¯¹äºæ•°æ®é›†å¤§æ—¶ï¼Œæ¯” AOF çš„å¯åŠ¨æ•ˆç‡æ›´é«˜<br>ç¼ºç‚¹ï¼š</li><li>æ•°æ®å®‰å…¨æ€§ä½ï¼Œå› ä¸ºä¼šæœ‰é—´éš”æ—¶é—´ï¼Œæ‰€ä»¥å¦‚æœé—´éš”æœŸé—´å‡ºç°æ•…éšœï¼Œæ— æ³•ä¿è¯æœŸé—´çš„æ•°æ®æ­£å¸¸å¤‡ä»½</li><li>å½“æ•°æ®é›†è¾ƒå¤§æ—¶ï¼Œå­è¿›ç¨‹é•¿æœŸå ç”¨ CPUï¼Œä¼šå¯¼è‡´æœåŠ¡ä¸­æ–­æ—¶é—´å»¶é•¿è‡³ç§’çº§</li></ul><ol start="2"><li>AOFï¼šAppend Only File<br>ä»¥æ—¥å¿—çš„å½¢å¼è®°å½•æœåŠ¡å™¨å¤„ç†çš„æ¯ä¸ªè¯»å†™æ“ä½œï¼Œä»¥æ–‡æœ¬çš„æ–¹å¼è¯¦ç»†è®°å½•ï¼Œå¯ä»¥æŸ¥çœ‹å†å²æ“ä½œè®°å½•<br>ä¼˜ç‚¹ï¼š</li></ol><ul><li>æ•°æ®å®‰å…¨ï¼šæ¯ç§’åŒæ­¥ã€æ¯ä¿®æ”¹åŒæ­¥ã€ä¸åŒæ­¥3ä¸­ç­–ç•¥ã€‚æ¯ç§’åŒæ­¥å¯ä»¥ç†è§£ä¸ºç±»ä¼¼1sé—´éš”çš„ RDB ï¼Œå¯èƒ½ä¹Ÿä¼šå‡ºç°ä¸¢å¤±çš„æƒ…å†µï¼›æ¯ä¿®æ”¹åŒæ­¥å¯ä»¥è®¤ä¸ºæ˜¯åŒæ­¥æŒä¹…åŒ–ï¼Œä¸ä¼šä¸¢å¤±</li><li>é€šè¿‡ append æ–¹å¼è¿½åŠ æ–°çš„æ“ä½œï¼Œä¸æƒ§å®•æœºï¼Œå¯ä»¥ä½¿ç”¨ redis-check-aof å·¥å…·æ¥è§£å†³ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</li><li>rewrite æ¨¡å¼å¯ä»¥å®šæœŸå¯¹ AOF æ–‡ä»¶é‡å†™ï¼Œåˆå¹¶ç›¸å…³æ“ä½œï¼Œä»¥è¾¾åˆ°å‹ç¼©å­˜å‚¨çš„ç›®çš„<br>ç¼ºç‚¹</li><li>AOF æ–‡ä»¶è¾ƒå¤§ï¼Œæ¢å¤é€Ÿåº¦æ…¢</li><li>æ•°æ®é›†å¤§çš„æƒ…å†µä¸‹ï¼Œå¯åŠ¨æ¯” RDB æ…¢</li><li>è¿è¡Œæ•ˆç‡ AOF &lt; RDB</li></ul><p>4.xç‰ˆæœ¬åï¼ŒæŠŠé‡å†™æ–¹å¼å˜æˆ RDB ç›´æ¥æ”¾åˆ° AOF æ–‡ä»¶çš„å¤´éƒ¨ï¼Œæ¯”ä»¥å‰ç‰ˆæœ¬æ›´å¿«</p><ol start="3"><li>ä¸»ä»åŒæ­¥</li></ol><ul><li>å…¨é‡å¤åˆ¶ï¼š<ul><li>ä¸»èŠ‚ç‚¹é€šè¿‡ bgsave å‘½ä»¤ fork å­è¿›ç¨‹è¿›è¡Œ rdb æŒä¹…åŒ–ï¼Œè¿‡ç¨‹éå¸¸æ¶ˆè€—CPUï¼Œå†…å­˜ï¼Œç¡¬ç›˜io</li><li>ä¸»èŠ‚ç‚¹å°†rdbæ–‡ä»¶é€šè¿‡ç½‘ç»œå‘ç»™ä»èŠ‚ç‚¹ï¼Œæ¶ˆè€—å¸¦å®½</li><li>ä»èŠ‚ç‚¹æ¸…ç©ºæ•°æ®ï¼Œä½¿ç”¨rdbæ–‡ä»¶è½½å…¥ï¼Œæ•´ä¸ªè¿‡ç¨‹é˜»å¡ï¼Œæ— æ³•å“åº”å‘½ä»¤</li></ul></li><li>éƒ¨åˆ†å¤åˆ¶ï¼š<ul><li>å¤åˆ¶åç§»é‡ï¼ŒåŒæ–¹éƒ½è¦ç»´æŠ¤</li><li>å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼šå®šé•¿FIFOçš„é˜Ÿåˆ—ä½œä¸ºç¼“å†²åŒº</li></ul></li></ul><h3 id="8-Redis-çš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥"><a href="#8-Redis-çš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥" class="headerlink" title="8. Redis çš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥"></a>8. Redis çš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥</h3><ol><li>æƒ°æ€§è¿‡æœŸï¼šè®¿é—®ä¸€ä¸ª key çš„æ—¶å€™æ‰åˆ¤æ–­è¿™ä¸ª key æ˜¯å¦å·²ç»è¿‡æœŸï¼Œè¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–çš„èŠ‚çœ CPU èµ„æºï¼Œä½†æ˜¯å¯¹å†…å­˜ä¸å‹å¥½ï¼Œä¼šå­˜åœ¨å¤§é‡çš„è¿‡æœŸ key æ²¡æœ‰è¢«å†æ¬¡è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å†…å­˜</li><li>å®šæœŸè¿‡æœŸï¼šæ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œæ‰«ææ•°æ®åº“ä¸­ä¸€å®šé‡çš„ expire å­—å…¸ä¸­çš„ keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²ç»è¿‡æœŸçš„ keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆï¼Œé€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å†…å­˜å’Œ CPU è¾¾åˆ°æœ€ä¼˜å¹³è¡¡</li><li>äºŒç§ç­–ç•¥åŒæ—¶ç”Ÿæ•ˆ</li></ol><h3 id="9-æè¿°ä¸‹ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆ"><a href="#9-æè¿°ä¸‹ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="9. æè¿°ä¸‹ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆ"></a>9. æè¿°ä¸‹ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆ</h3><p>æ•°æ®åº“æ˜¯æ¶æ„çš„ç“¶é¢ˆï¼Œè¦å°½é‡ä¿è¯æœ‰æ•ˆè¯·æ±‚åˆ°è¾¾æ•°æ®åº“ï¼Œå¯ä»¥é…Œæƒ…æ”¾å¤§é“¾è·¯ä¸Šå‰ç½®ä½ç½®çš„å¤æ‚åº¦å’Œæˆæœ¬<br>c clientï¼›redis ï¼› db&#x2F;mysql</p><p>ç©¿é€ï¼šç¼“å­˜å’Œdbä¸­éƒ½æ‰¾ä¸åˆ°è¯¥æ•°æ® &#x3D; dbä¸­æ— æ•°æ®ï¼Œredisæ— æ•°æ®ï¼Œå¤§é‡å¹¶å‘ï¼Œè¯·æ±‚æ‰“åˆ°dbå±‚<br>åŸå› ï¼šæ¥å£è¯·æ±‚æ•°æ®ä¸æ˜¯æœ‰æ•ˆå‚æ•°ï¼Œå› æ­¤æ ¹æœ¬æŸ¥ä¸åˆ°ç»“æœï¼›æœ‰æ•ˆå‚æ•°ä½†æ˜¯ç¡®å®æ²¡æœ‰æ•°æ®<br>è§£æ³•ï¼šæ¥å£å±‚å¢åŠ é‰´æƒï¼Œä¸šåŠ¡å±‚å¢åŠ æœ‰æ•ˆè¯·æ±‚åˆ¤æ–­ï¼›è¿”å›ç©º &amp;&amp; å¢åŠ çŸ­æ•ˆçš„ç©ºç¼“å­˜ï¼›å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆéš¾é“è¦åŠ åˆ°æ¯ä¸ªæ¥å£ä¸Šä¹ˆï¼Ÿéœ€è¦æ€è€ƒå—·ï¼‰ï¼›ä¸šåŠ¡åŠ äº’æ–¥é”ï¼›å¯¹äºç©ºå€¼å¯ä»¥å¢åŠ ä¸€ä¸ªç©ºç¼“å­˜</p><p>å‡»ç©¿ï¼šçƒ­ç‚¹keyè¿‡æœŸ or keyä»æ¥æ²¡æœ‰è¢«è®¿é—®è¿‡ &#x3D; dbä¸­æœ‰æ•°æ®ï¼Œå¤§é‡å¹¶å‘ï¼Œredisæ— ç¼“å­˜ï¼Œè¯·æ±‚æ‰“åˆ°dbå±‚<br>è§£æ³•ï¼šçƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸï¼›äº’æ–¥é”ï¼ˆæŒ¡ä½å¤§é‡é‡å¤çš„å¹¶å‘è¯·æ±‚ï¼‰</p><p>é›ªå´©ï¼šNä¸ªkeyçš„éƒ½è¿‡æœŸäº†ï¼ˆæ²¡æœ‰è¢«ç¼“å­˜åˆ°ï¼‰ &#x3D; dbä¸­æœ‰ï¼Œå¤§é‡å¹¶å‘ï¼Œredisæ— ç¼“å­˜ï¼Œè¯·æ±‚æ‰“åˆ°dbå±‚<br>è§£æ³•ï¼šç¼“å­˜æ•°æ®è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´ï¼›å¢åŠ ç¼“å­˜å¤±æ•ˆæ ‡è®°ä½ï¼›ç¼“å­˜é¢„çƒ­ï¼›äº’æ–¥é”</p><p>æµç¨‹ï¼š è¯·æ±‚redisï¼ŒæŸ¥ä¸åˆ° â€“&gt; å¤§å®¶æŠ¢é” Oï¼ˆ1ï¼‰ â€“&gt; æŠ¢ä¸Šçš„æŸ¥dbï¼Œå¹¶æ›´æ–°ç¼“å­˜ Oï¼ˆ1ï¼‰ â€“&gt; æ²¡æŠ¢ä¸Šçš„é‡å¤è¯·æ±‚Redis ï¼Œæ‹¿åˆ°æ•°æ®<br>å»¶ä¼¸é—®é¢˜ï¼šå¤šä¸ªç­‰å¾…çš„è¯·æ±‚ï¼Œæ˜¯blockingçš„è½»é‡çº§è¿›ç¨‹ï¼Œä¸å‚ä¸cpuåŠå†…æ ¸è°ƒåº¦ï¼Œæ³¨æ„å¤„ç†çº¿ç¨‹æ± å³å¯</p><ul><li>sorted set  <ul><li>å®æ—¶åˆ†é¡µåˆ—è¡¨ï¼Œå¦‚å®æ—¶æ¦œå•</li></ul></li></ul><ul><li>ä¸€èˆ¬å°±æ˜¯å½“ç¼“å­˜ç”¨</li><li>å•çº¿ç¨‹æ¨¡å‹</li><li>ç›®çš„æ˜¯æœåŠ¡æ— çŠ¶æ€ï¼šsessionï¼Œtokenç­‰ï¼›åˆ†å¸ƒå¼é”</li><li>æ— é”åŒ–ï¼Ÿ</li></ul><h3 id="2-å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ"><a href="#2-å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ" class="headerlink" title="2. å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ"></a>2. å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ</h3><ul><li>å·¥ä½œçº¿ç¨‹éƒ½æ˜¯å•çº¿ç¨‹ï¼š<ul><li>æ“ä½œæ˜¯åŸå­çš„å•æŒ‡ä»¤ pipeline</li><li>äº‹åŠ¡ vs pipeline ï¼šäº‹åŠ¡æ‰§è¡ŒæœŸé—´æ˜¯åŸå­çš„ï¼›æ‰§è¡Œå¤±è´¥å°±æ˜¯å¤±è´¥ï¼Œå…¶ä»–æŒ‡ä»¤ç»§ç»­æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»š â€“&gt; redis å°‘ä½¿ç”¨äº‹åŠ¡ &amp;&amp; äº‹åŠ¡å†…çš„æŒ‡ä»¤å°‘ + å¿«</li></ul></li><li>6.x+ç‰ˆæœ¬å‡ºç°äº† io å¤šçº¿ç¨‹</li></ul><hr><ul><li>è¯¦ç»†ç†è§£ io å¤šçº¿ç¨‹ ï¼šå†…æ ¸ï¼Œç½‘ç»œé€šä¿¡ï¼ˆæ‡‚äº†å†è¯´ï¼‰</li><li>å•çº¿ç¨‹ï¼Œæ»¡è¶³ redis çš„ä¸²è¡ŒåŸå­ï¼›io å¤šçº¿ç¨‹ä»¥åï¼ŒæŠŠè¾“å…¥&#x2F;è¾“å‡ºæ”¾åˆ°çº¿ç¨‹ä¸­å¹¶è¡Œï¼Œå¥½å¤„æ˜¯ï¼šæ‰§è¡Œæ—¶é—´å¿«ï¼›æ›´å¥½çš„å‹æ¦¨ç³»ç»ŸåŠç¡¬ä»¶çš„èµ„æº</li></ul><h3 id="3-redis-å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#3-redis-å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. redis å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>3. redis å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><ul><li>å‚è€ƒé—®é¢˜2ï¼Œredisæ ¸å¿ƒæ˜¯å•çº¿ç¨‹ä¸²è¡Œï¼Œä¸šåŠ¡ä½¿ç”¨çš„æ—¶å€™éœ€è¦è‡ªè¡Œä¿éšœçº¿ç¨‹å®‰å…¨</li></ul><h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><h3 id="6-ç¼“å­˜å¦‚ä½•æ·˜æ±°çš„ï¼Ÿ"><a href="#6-ç¼“å­˜å¦‚ä½•æ·˜æ±°çš„ï¼Ÿ" class="headerlink" title="6. ç¼“å­˜å¦‚ä½•æ·˜æ±°çš„ï¼Ÿ"></a>6. ç¼“å­˜å¦‚ä½•æ·˜æ±°çš„ï¼Ÿ</h3><p>å†…å­˜ç©ºé—´ä¸è¶³<br>æ·˜æ±°æœºåˆ¶<br>lruï¼Œlfuï¼Œrandomï¼Œttl<br>å…¨ç©ºé—´<br>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyçš„é›†åˆä¸­</p><h3 id="7-å¦‚ä½•è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Ÿ"><a href="#7-å¦‚ä½•è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Ÿ" class="headerlink" title="7. å¦‚ä½•è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Ÿ"></a>7. å¦‚ä½•è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Ÿ</h3><p>æå‰åŠ è½½æ•°æ®ï¼ˆå¾ˆéš¾åˆ¤æ–­å“ªäº›æ˜¯çœŸæ­£çš„çƒ­æ•°æ®ï¼Œå¸¸å¸¸ä¼šå‡ºç°ç¼“å­˜å¤±è´¥çš„æƒ…å†µï¼‰<br>å¼€å‘é€»è¾‘ä¸Šè¦åº”å¯¹å·®é›†æ•°æ®é€ æˆçš„ å‡»ç©¿ï¼Œç©¿é€ï¼Œé›ªå´©</p><h3 id="8-æ•°æ®åº“å’Œç¼“å­˜ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#8-æ•°æ®åº“å’Œç¼“å­˜ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="8. æ•°æ®åº“å’Œç¼“å­˜ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ"></a>8. æ•°æ®åº“å’Œç¼“å­˜ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>æ¶å¿ƒç‚¹çš„ä½¿ç”¨äº‹åŠ¡ï¼Œä½†æ˜¯æ„ä¹‰ä¸å¤§ï¼Œåœºæ™¯å¤šä¸ºè¯»å¤šå†™æå°‘ï¼Œä»…ä»…åœ¨ç§€è‚Œè‚‰<br>ä¸šåŠ¡å†™dbï¼Œç„¶åredisæ›´æ–°ç¼“å­˜<br>ä¸šåŠ¡å†™åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œrediså’ŒdbåŒæ—¶æ¶ˆè´¹æ•°æ®ï¼ŒåŒæ—¶æ›´æ–°<br>redisç¼“å­˜ï¼Œæ›´å€¾å‘äºå…è®¸ç¨å¾®çš„æ—¶å·®<br>æ€»æ€è·¯æ˜¯å‡å°‘dbæ“ä½œ</p><h3 id="9-redis-ä¸»ä»ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#9-redis-ä¸»ä»ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="9. redis ä¸»ä»ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ"></a>9. redis ä¸»ä»ä¸ä¸€è‡´å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>redis é»˜è®¤å¼±ä¸€è‡´æ€§ï¼Œä¸»ä»å¼‚æ­¥åŒæ­¥<br>åˆ†å¸ƒå¼é”ä¸èƒ½ç”¨ä¸»ä»ï¼Œå¯ä»¥ç”¨å•å®ä¾‹ã€åˆ†ç‰‡é›†ç¾¤ã€redlock â€“&gt; redisson<br>é…ç½®ä¸­å¯ä»¥é…ç½®åŒæ­¥å› å­ï¼Œæ€»è¶‹å‘äºå¼ºä¸€è‡´æ€§</p><h3 id="10-redis-æŒä¹…åŒ–åŸç†"><a href="#10-redis-æŒä¹…åŒ–åŸç†" class="headerlink" title="10. redis æŒä¹…åŒ–åŸç†"></a>10. redis æŒä¹…åŒ–åŸç†</h3><p>å½“å‰çº¿ç¨‹é˜»å¡æœåŠ¡<br>åå°å¼‚æ­¥è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–</p><h3 id="11-å¹¶å‘è¶…é‡ï¼Œredis-å´©æºƒåå¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#11-å¹¶å‘è¶…é‡ï¼Œredis-å´©æºƒåå¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="11. å¹¶å‘è¶…é‡ï¼Œredis å´©æºƒåå¦‚ä½•å¤„ç†ï¼Ÿ"></a>11. å¹¶å‘è¶…é‡ï¼Œredis å´©æºƒåå¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>é›ªå´©å‡»ç©¿ç©¿é€å¤„ç†æ–¹æ¡ˆ</p><h3 id="12-ä¸ºå•¥ä½¿ç”¨setnx"><a href="#12-ä¸ºå•¥ä½¿ç”¨setnx" class="headerlink" title="12. ä¸ºå•¥ä½¿ç”¨setnx"></a>12. ä¸ºå•¥ä½¿ç”¨setnx</h3><p>åŸå­ï¼Œä¸å­˜åœ¨å³åˆ›å»º<br>åˆ†å¸ƒå¼é”ï¼Œç”¨ set k v nx ex ä¸å­˜åœ¨ï¼Œè¿‡æœŸæ—¶é—´ï¼Œé¿å…æ­»é”</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> å¹¶å‘ </tag>
            
            <tag> raft </tag>
            
            <tag> nosql </tag>
            
            <tag> redis </tag>
            
            <tag> å“¨å…µ </tag>
            
            <tag> ç¼“å­˜ </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golangå¹¶å‘ç¼–ç¨‹</title>
      <link href="/golang/concurrency/go-sync/"/>
      <url>/golang/concurrency/go-sync/</url>
      
        <content type="html"><![CDATA[<h3 id="go-å¹¶å‘æ§åˆ¶"><a href="#go-å¹¶å‘æ§åˆ¶" class="headerlink" title="go å¹¶å‘æ§åˆ¶"></a>go å¹¶å‘æ§åˆ¶</h3><p>å®é™…ç”Ÿäº§ä¸­ï¼ŒWaitGroup å’Œ Channel æ˜¯å¸¸è§çš„ 2 ç§å¹¶å‘æ§åˆ¶çš„æ–¹å¼ã€‚<br>å¦‚æœæœ‰ä¸€ç³»åˆ—ä»»åŠ¡ï¼Œéœ€è¦è¿™äº›ä»»åŠ¡å…¨éƒ¨å®Œæˆä»¥åæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼ŒWaitGroup éå¸¸é€‚åˆäºè¿™ç±»åœºæ™¯ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wg sync.WaitGroup  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doTask</span><span class="params">(n <span class="type">int</span>)</span></span> &#123;  </span><br><span class="line">  time.Sleep(time.Duration(n))  </span><br><span class="line">  fmt.Printf(<span class="string">&quot;Task %d Done\n&quot;</span>, n)  </span><br><span class="line">  wg.Done()  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;  </span><br><span class="line">    wg.Add(<span class="number">1</span>)  </span><br><span class="line">    <span class="keyword">go</span> doTask(i + <span class="number">1</span>)  </span><br><span class="line">  &#125;  </span><br><span class="line">  wg.Wait()  </span><br><span class="line">  fmt.Println(<span class="string">&quot;All Task Done&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Task 3 Done  </span></span><br><span class="line"><span class="comment">// Task 1 Done  </span></span><br><span class="line"><span class="comment">// Task 2 Done  </span></span><br><span class="line"><span class="comment">// All Task Done  </span></span><br></pre></td></tr></table></figure><p><code>wg.Wait()</code> ä¼šç­‰å¾…æ‰€æœ‰çš„å­ä»»åŠ¡å…¨éƒ¨å®Œæˆï¼Œæ‰€æœ‰å­åç¨‹ç»“æŸåï¼Œæ‰ä¼šæ‰§è¡Œ <code>wg.Wait()</code> åé¢çš„ä»£ç ã€‚<br>WaitGroup åªèƒ½ç­‰å¾…å­ä»»åŠ¡å…¨éƒ¨å®Œæˆæ‰èƒ½æ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ä¸»è¿›ç¨‹ä¸­é€šçŸ¥å­åç¨‹é€€å‡ºå‘¢ï¼Ÿè¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>select + chan</code> æœºåˆ¶ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stop <span class="keyword">chan</span> <span class="type">bool</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reqTask</span><span class="params">(name <span class="type">string</span>)</span></span> &#123;  </span><br><span class="line">  <span class="keyword">for</span> &#123;  </span><br><span class="line">    <span class="keyword">select</span> &#123;  </span><br><span class="line">      <span class="keyword">case</span> &lt;-stop:  </span><br><span class="line">      fmt.Println(<span class="string">&quot;stop&quot;</span>, name)  </span><br><span class="line">      <span class="keyword">return</span>  </span><br><span class="line">    <span class="keyword">default</span>:  </span><br><span class="line">      fmt.Println(name, <span class="string">&quot;send request&quot;</span>)  </span><br><span class="line">      time.Sleep(<span class="number">1</span> * time.Second)  </span><br><span class="line">    &#125;  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  stop = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">bool</span>)  </span><br><span class="line">  <span class="keyword">go</span> reqTask(<span class="string">&quot;worker&quot;</span>)  </span><br><span class="line">  time.Sleep(<span class="number">3</span> * time.Second)  </span><br><span class="line">  stop &lt;- <span class="literal">true</span>  </span><br><span class="line">  time.Sleep(<span class="number">3</span> * time.Second)  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// worker send request  </span></span><br><span class="line"><span class="comment">// worker send request  </span></span><br><span class="line"><span class="comment">// worker send request  </span></span><br><span class="line"><span class="comment">// stop worker  </span></span><br></pre></td></tr></table></figure><p>æ›´å¤æ‚çš„åœºæ™¯å¦‚ä½•åšå¹¶å‘æ§åˆ¶å‘¢ï¼ŸGo è¯­è¨€æä¾›äº† Context æ ‡å‡†åº“å¯ä»¥è§£å†³è¿™ç±»åœºæ™¯çš„é—®é¢˜ï¼ŒContext çš„ä½œç”¨å’Œå®ƒçš„åå­—å¾ˆåƒï¼Œä¸Šä¸‹æ–‡ï¼Œå³å­åç¨‹çš„ä¸‹ä¸Šæ–‡ã€‚Context æœ‰ä¸¤ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼š</p><ul><li>é€šçŸ¥å­åç¨‹é€€å‡ºï¼ˆæ­£å¸¸é€€å‡ºï¼Œè¶…æ—¶é€€å‡ºç­‰ï¼‰ï¼›</li><li>ä¼ é€’å¿…è¦çš„å‚æ•°ã€‚</li></ul><h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><p><code>context.WithCancel()</code> åˆ›å»ºå¯å–æ¶ˆçš„ Context å¯¹è±¡ï¼Œå³å¯ä»¥ä¸»åŠ¨é€šçŸ¥å­åç¨‹é€€å‡ºã€‚</p><h3 id="2-1-æ§åˆ¶å•ä¸ªåç¨‹"><a href="#2-1-æ§åˆ¶å•ä¸ªåç¨‹" class="headerlink" title="2.1 æ§åˆ¶å•ä¸ªåç¨‹"></a><a href="https://geektutu.com/post/quick-go-context.html#2-1-%E6%8E%A7%E5%88%B6%E5%8D%95%E4%B8%AA%E5%8D%8F%E7%A8%8B" title="2.1 æ§åˆ¶å•ä¸ªåç¨‹"></a>2.1 æ§åˆ¶å•ä¸ªåç¨‹</h3><p>ä½¿ç”¨ Context æ”¹å†™ä¸Šè¿°çš„ä¾‹å­ï¼Œæ•ˆæœä¸ <code>select+chan</code> ç›¸åŒã€‚</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20  </p><p>func reqTask(ctx context.Context, name string) {<br> for {<br> select {<br> case &lt;-ctx.Done():<br> fmt.Println(â€œstopâ€, name)<br> return<br> default:<br> fmt.Println(name, â€œsend requestâ€)<br> time.Sleep(1 * time.Second)<br> }<br> }<br>}  </p><p>func main() {<br> ctx, cancel :&#x3D; context.WithCancel(context.Background())<br> go reqTask(ctx, â€œworker1â€)<br> time.Sleep(3 * time.Second)<br> cancel()<br> time.Sleep(3 * time.Second)<br>}  </p><ul><li><code>context.Backgroud()</code> åˆ›å»ºæ ¹ Contextï¼Œé€šå¸¸åœ¨ main å‡½æ•°ã€åˆå§‹åŒ–å’Œæµ‹è¯•ä»£ç ä¸­åˆ›å»ºï¼Œä½œä¸ºé¡¶å±‚ Contextã€‚</li><li><code>context.WithCancel(parent)</code> åˆ›å»ºå¯å–æ¶ˆçš„å­ Contextï¼ŒåŒæ—¶è¿”å›å‡½æ•° <code>cancel</code>ã€‚</li><li>åœ¨å­åç¨‹ä¸­ï¼Œä½¿ç”¨ select è°ƒç”¨ <code>&lt;-ctx.Done()</code> åˆ¤æ–­æ˜¯å¦éœ€è¦é€€å‡ºã€‚</li><li>ä¸»åç¨‹ä¸­ï¼Œè°ƒç”¨ <code>cancel()</code> å‡½æ•°é€šçŸ¥å­åç¨‹é€€å‡ºã€‚</li></ul><h3 id="2-2-æ§åˆ¶å¤šä¸ªåç¨‹"><a href="#2-2-æ§åˆ¶å¤šä¸ªåç¨‹" class="headerlink" title="2.2 æ§åˆ¶å¤šä¸ªåç¨‹"></a><a href="https://geektutu.com/post/quick-go-context.html#2-2-%E6%8E%A7%E5%88%B6%E5%A4%9A%E4%B8%AA%E5%8D%8F%E7%A8%8B" title="2.2 æ§åˆ¶å¤šä¸ªåç¨‹"></a>2.2 æ§åˆ¶å¤šä¸ªåç¨‹</h3><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10  </p><p>func main() {<br> ctx, cancel :&#x3D; context.WithCancel(context.Background())  </p><p> go reqTask(ctx, â€œworker1â€)<br> go reqTask(ctx, â€œworker2â€)  </p><p> time.Sleep(3 * time.Second)<br> cancel()<br> time.Sleep(3 * time.Second)<br>}  </p><p>ä¸ºæ¯ä¸ªå­åç¨‹ä¼ é€’ç›¸åŒçš„ä¸Šä¸‹æ–‡ <code>ctx</code> å³å¯ï¼Œè°ƒç”¨ <code>cancel()</code> å‡½æ•°åè¯¥ Context æ§åˆ¶çš„æ‰€æœ‰å­åç¨‹éƒ½ä¼šé€€å‡ºã€‚</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8  </p><p>worker1 send request<br>worker2 send request<br>worker1 send request<br>worker2 send request<br>worker1 send request<br>worker2 send request<br>stop worker1<br>stop worker2  </p><h2 id="3-context-WithValue"><a href="#3-context-WithValue" class="headerlink" title="3 context.WithValue"></a><a href="https://geektutu.com/post/quick-go-context.html#3-context-WithValue" title="3 context.WithValue"></a>3 context.WithValue</h2><p>å¦‚æœéœ€è¦å¾€å­åç¨‹ä¸­ä¼ é€’å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>context.WithValue()</code>ã€‚</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27  </p><p>type Options struct{ Interval time.Duration }  </p><p>func reqTask(ctx context.Context, name string) {<br> for {<br> select {<br> case &lt;-ctx.Done():<br> fmt.Println(â€œstopâ€, name)<br> return<br> default:<br> fmt.Println(name, â€œsend requestâ€)<br> op :&#x3D; ctx.Value(â€œoptionsâ€).(*Options)<br> time.Sleep(op.Interval * time.Second)<br> }<br> }<br>}  </p><p>func main() {<br> ctx, cancel :&#x3D; context.WithCancel(context.Background())<br> vCtx :&#x3D; context.WithValue(ctx, â€œoptionsâ€, &amp;Options{1})  </p><p> go reqTask(vCtx, â€œworker1â€)<br> go reqTask(vCtx, â€œworker2â€)  </p><p> time.Sleep(3 * time.Second)<br> cancel()<br> time.Sleep(3 * time.Second)<br>}  </p><ul><li><code>context.WithValue()</code> åˆ›å»ºäº†ä¸€ä¸ªåŸºäº <code>ctx</code> çš„å­ Contextï¼Œå¹¶æºå¸¦äº†å€¼ <code>options</code>ã€‚</li><li>åœ¨å­åç¨‹ä¸­ï¼Œä½¿ç”¨ <code>ctx.Value(&quot;options&quot;)</code> è·å–åˆ°ä¼ é€’çš„å€¼ï¼Œè¯»å–&#x2F;ä¿®æ”¹è¯¥å€¼ã€‚</li></ul><h2 id="4-context-WithTimeout"><a href="#4-context-WithTimeout" class="headerlink" title="4 context.WithTimeout"></a><a href="https://geektutu.com/post/quick-go-context.html#4-context-WithTimeout" title="4 context.WithTimeout"></a>4 context.WithTimeout</h2><p>å¦‚æœéœ€è¦æ§åˆ¶å­åç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨ <code>context.WithTimeout</code> åˆ›å»ºå…·æœ‰è¶…æ—¶é€šçŸ¥æœºåˆ¶çš„ Context å¯¹è±¡ã€‚</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10  </p><p>func main() {<br> ctx, cancel :&#x3D; context.WithTimeout(context.Background(), 2*time.Second)<br> go reqTask(ctx, â€œworker1â€)<br> go reqTask(ctx, â€œworker2â€)  </p><p> time.Sleep(3 * time.Second)<br> fmt.Println(â€œbefore cancelâ€)<br> cancel()<br> time.Sleep(3 * time.Second)<br>}  </p><p><code>WithTimeout()</code>çš„ä½¿ç”¨ä¸ <code>WithCancel()</code> ç±»ä¼¼ï¼Œå¤šäº†ä¸€ä¸ªå‚æ•°ï¼Œç”¨äºè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7  </p><p>worker2 send request<br>worker1 send request<br>worker1 send request<br>worker2 send request<br>stop worker2<br>stop worker1<br>before cancel  </p><p>å› ä¸ºè¶…æ—¶æ—¶é—´è®¾ç½®ä¸º 2sï¼Œä½†æ˜¯ main å‡½æ•°ä¸­ï¼Œ3s åæ‰ä¼šè°ƒç”¨ <code>cancel()</code>ï¼Œå› æ­¤ï¼Œåœ¨è°ƒç”¨ <code>cancel()</code> å‡½æ•°å‰ï¼Œå­åç¨‹å› ä¸ºè¶…æ—¶å·²ç»é€€å‡ºäº†ã€‚</p><h2 id="5-context-WithDeadline"><a href="#5-context-WithDeadline" class="headerlink" title="5 context.WithDeadline"></a><a href="https://geektutu.com/post/quick-go-context.html#5-context-WithDeadline" title="5 context.WithDeadline"></a>5 context.WithDeadline</h2><p>è¶…æ—¶é€€å‡ºå¯ä»¥æ§åˆ¶å­åç¨‹çš„æœ€é•¿æ‰§è¡Œæ—¶é—´ï¼Œé‚£ <code>context.WithDeadline()</code> åˆ™å¯ä»¥æ§åˆ¶å­åç¨‹çš„æœ€è¿Ÿé€€å‡ºæ—¶é—´ã€‚</p><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23  </p><p>func reqTask(ctx context.Context, name string) {<br> for {<br> select {<br> case &lt;-ctx.Done():<br> fmt.Println(â€œstopâ€, name, ctx.Err())<br> return<br> default:<br> fmt.Println(name, â€œsend requestâ€)<br> time.Sleep(1 * time.Second)<br> }<br> }<br>}  </p><p>func main() {<br> ctx, cancel :&#x3D; context.WithDeadline(context.Background(), time.Now().Add(1*time.Second))<br> go reqTask(ctx, â€œworker1â€)<br> go reqTask(ctx, â€œworker2â€)  </p><p> time.Sleep(3 * time.Second)<br> fmt.Println(â€œbefore cancelâ€)<br> cancel()<br> time.Sleep(3 * time.Second)<br>}  </p><ul><li><code>WithDeadline</code> ç”¨äºè®¾ç½®æˆªæ­¢æ—¶é—´ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†æˆªæ­¢æ—¶é—´è®¾ç½®ä¸º1såï¼Œ<code>cancel()</code> å‡½æ•°åœ¨ 3s åè°ƒç”¨ï¼Œå› æ­¤å­åç¨‹å°†åœ¨è°ƒç”¨ <code>cancel()</code> å‡½æ•°å‰ç»“æŸã€‚</li><li>åœ¨å­åç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>ctx.Err()</code> è·å–åˆ°å­åç¨‹é€€å‡ºçš„é”™è¯¯åŸå› ã€‚</li></ul><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p>1<br>2<br>3<br>4<br>5  </p><p>worker2 send request<br>worker1 send request<br>stop worker2 context deadline exceeded<br>stop worker1 context deadline exceeded<br>before cancel  </p><p>å¯ä»¥çœ‹åˆ°ï¼Œå­åç¨‹ <code>worker1</code> å’Œ <code>worker2</code> å‡æ˜¯å› ä¸ºæˆªæ­¢æ—¶é—´åˆ°äº†è€Œé€€å‡ºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> å¿…çœ‹å¿…ä¼š </tag>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golangè¯­è¨€é¢è¯•é¢˜ - åŸºæœ¬åŸç†</title>
      <link href="/interview/go/golang101-2/"/>
      <url>/interview/go/golang101-2/</url>
      
        <content type="html"><![CDATA[<h4 id="1-golang-æ–‡ä»¶åˆå§‹åŒ–çš„é¡ºåº"><a href="#1-golang-æ–‡ä»¶åˆå§‹åŒ–çš„é¡ºåº" class="headerlink" title="1. golang æ–‡ä»¶åˆå§‹åŒ–çš„é¡ºåº"></a>1. golang æ–‡ä»¶åˆå§‹åŒ–çš„é¡ºåº</h4><p>init() å‡½æ•°æ˜¯ Go ç¨‹åºåˆå§‹åŒ–çš„ä¸€éƒ¨åˆ†ã€‚ç”± runtime åˆå§‹åŒ–æ¯ä¸ªå¯¼å…¥çš„åŒ…ï¼Œåˆå§‹åŒ–é¡ºåºä¸æ˜¯æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„å¯¼å…¥é¡ºåºï¼Œè€Œæ˜¯æŒ‰ç…§è§£æçš„ä¾èµ–å…³ç³»ï¼Œæ²¡æœ‰ä¾èµ–çš„åŒ…æœ€å…ˆåˆå§‹åŒ–ã€‚<br>æ€»ç»“é¡ºåºå¦‚ä¸‹ï¼š<br><strong>import â€“&gt; const â€“&gt; var â€“&gt; init() &#x2F; init2() â€“&gt; main()</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span>  &#123;  </span><br><span class="line"> fmt.Println(<span class="string">&quot;init1:&quot;</span>, a)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span>  &#123;  </span><br><span class="line"> fmt.Println(<span class="string">&quot;init2:&quot;</span>, a)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>  </span><br><span class="line"><span class="keyword">const</span> b = <span class="number">100</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line"> fmt.Println(<span class="string">&quot;main:&quot;</span>, a)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">// æ‰§è¡Œç»“æœ  </span></span><br><span class="line"><span class="comment">// init1: 10  </span></span><br><span class="line"><span class="comment">// init2: 10  </span></span><br><span class="line"><span class="comment">// main: 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// init2: 10  </span></span><br><span class="line"><span class="comment">// init1: 10  </span></span><br><span class="line"><span class="comment">// main: 10</span></span><br></pre></td></tr></table></figure><h4 id="2-interface-å¦‚ä½•æ¯”è¾ƒ"><a href="#2-interface-å¦‚ä½•æ¯”è¾ƒ" class="headerlink" title="2. interface å¦‚ä½•æ¯”è¾ƒ"></a>2. interface å¦‚ä½•æ¯”è¾ƒ</h4><p>Golang ä¸­ï¼Œ interface å†…éƒ¨åŒ…å«äº†ä¸¤ä¸ªå­—æ®µï¼Œç±»å‹ T å’Œå€¼ V ï¼Œinterface ä¹‹é—´å¯ä»¥ç”¨ &#x3D;&#x3D; æˆ– !&#x3D; è¿›è¡Œæ¯”è¾ƒã€‚ä¸¤ä¸ª interface ä¹‹é—´å¯èƒ½åŒ…å«ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><ol><li>ä¸¤ä¸ªéƒ½æ˜¯ nil ï¼ˆå¯¹åº”çš„ T å’Œ V éƒ½ä¸º unset çš„çŠ¶æ€ï¼‰</li><li>T ç›¸åŒï¼Œä¸” V ç›¸åŒ</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;  </span><br><span class="line">  UserName <span class="type">string</span>  <span class="string">`json:user_name`</span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> UserFace <span class="keyword">interface</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  <span class="comment">// å®é™…æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªç»“æ„ä½“çš„åœ°å€</span></span><br><span class="line">  <span class="keyword">var</span> u1, u2 UserFace = &amp;User&#123;<span class="string">&quot;Tom&quot;</span>&#125;, &amp;User&#123;<span class="string">&quot;Tom&quot;</span>&#125;  </span><br><span class="line">  <span class="comment">// æ¯”è¾ƒä¸¤ä¸ªç»“æ„ä½“</span></span><br><span class="line">  <span class="keyword">var</span> u3, u4 UserFace = User&#123;<span class="string">&quot;Tom&quot;</span>&#125;, User&#123;<span class="string">&quot;Tom&quot;</span>&#125;  </span><br><span class="line">  fmt.Println(u1 == u2) <span class="comment">// false  </span></span><br><span class="line">  fmt.Println(u3 == u4) <span class="comment">// true  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-interface-å’Œ-nil"><a href="#3-interface-å’Œ-nil" class="headerlink" title="3. interface å’Œ nil"></a>3. interface å’Œ nil</h4><p>ä¸Šè¾¹è®²äº† interface åŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œé‚£ä¹ˆä¸€ä¸ª nil çš„ç©ºç»“æ„ä½“å’Œ nil æ˜¯å¦çœŸçš„ç›¸ç­‰å‘¢ï¼Ÿå¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  <span class="keyword">var</span> p *<span class="type">int</span> = <span class="literal">nil</span>  </span><br><span class="line">  <span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125; = p  </span><br><span class="line">  fmt.Println(i == p) <span class="comment">// true  </span></span><br><span class="line">  fmt.Println(p == <span class="literal">nil</span>) <span class="comment">// true  </span></span><br><span class="line">  fmt.Println(i == <span class="literal">nil</span>) <span class="comment">// false  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† nil é interface çš„å€¼ p èµ‹ç»™ i çš„æ—¶å€™ï¼Œi å®é™…ä¸Šæ˜¯ (T&#x3D;*int, V&#x3D;nil)ã€‚å½“äºŒè€…ç›¸æ¯”è¾ƒæ—¶ï¼ŒGo ä¼šå°† p å…ˆè½¬æ¢æˆ interface ç±»å‹çš„å†å»æ¯”è¾ƒï¼Œæ­¤æ—¶äºŒè€…ç­‰ä»·ã€‚<br>p ä¸ nil æ˜¯ç›´æ¥æ¯”è¾ƒçš„å€¼ï¼Œå› æ­¤äºŒè€…ä¹Ÿç­‰ä»·ã€‚<br>i ä¸ nil  æ¯”è¾ƒæ—¶ï¼Œä¼šå°† nil è½¬æ¢ä¸ºæ¥å£ (T&#x3D;nil, V&#x3D;nil)ï¼Œä¸ i (T&#x3D;*int, V&#x3D;nil) ä¸ç›¸ç­‰ï¼Œå› æ­¤  i !&#x3D; nil</p><h4 id="4-GC-åˆæ­¥ç†è§£"><a href="#4-GC-åˆæ­¥ç†è§£" class="headerlink" title="4. GC åˆæ­¥ç†è§£"></a>4. GC åˆæ­¥ç†è§£</h4><p>æœ€å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•æœ‰æ ‡è®°æ¸…é™¤(Mark-Sweep) å’Œå¼•ç”¨è®¡æ•°(Reference Count)ï¼ŒGo è¯­è¨€ é‡‡ç”¨çš„æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•ã€‚1.5 ç‰ˆæœ¬ä»¥ååœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•å’Œå†™å±éšœæŠ€æœ¯ï¼Œæé«˜äº†æ•ˆç‡ã€‚</p><p>æ ‡è®°æ¸…é™¤æ”¶é›†å™¨æ˜¯è·Ÿè¸ªå¼åƒåœ¾æ”¶é›†å™¨ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹å¯ä»¥åˆ†æˆæ ‡è®°ï¼ˆMarkï¼‰å’Œæ¸…é™¤ï¼ˆSweepï¼‰ä¸¤ä¸ªé˜¶æ®µï¼š</p><ul><li>æ ‡è®°é˜¶æ®µ â€” ä»æ ¹å¯¹è±¡å‡ºå‘æŸ¥æ‰¾å¹¶æ ‡è®°å †ä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ï¼›</li><li>æ¸…é™¤é˜¶æ®µ â€” éå†å †ä¸­çš„å…¨éƒ¨å¯¹è±¡ï¼Œå›æ”¶æœªè¢«æ ‡è®°çš„åƒåœ¾å¯¹è±¡å¹¶å°†å›æ”¶çš„å†…å­˜åŠ å…¥ç©ºé—²é“¾è¡¨ã€‚</li></ul><p>æ ‡è®°æ¸…é™¤ç®—æ³•çš„ä¸€å¤§é—®é¢˜æ˜¯åœ¨æ ‡è®°æœŸé—´ï¼Œéœ€è¦æš‚åœç¨‹åºï¼ˆStop the worldï¼ŒSTWï¼Œè¿™ä¹Ÿæ˜¯ GC ç®—æ³•ä¼˜åŒ–çš„é‡ç‚¹ï¼‰ï¼Œæ ‡è®°ç»“æŸä¹‹åï¼Œç”¨æˆ·ç¨‹åºæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚ä¸ºäº†èƒ½å¤Ÿå¼‚æ­¥æ‰§è¡Œï¼Œå‡å°‘ STW çš„æ—¶é—´ï¼ŒGo è¯­è¨€é‡‡ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•ã€‚</p><p>ä¸‰è‰²æ ‡è®°ç®—æ³•å°†ç¨‹åºä¸­çš„å¯¹è±¡åˆ†æˆç™½è‰²ã€é»‘è‰²å’Œç°è‰²ä¸‰ç±»ã€‚</p><ul><li>ç™½è‰²ï¼šä¸ç¡®å®šå¯¹è±¡ã€‚</li><li>ç°è‰²ï¼šå­˜æ´»å¯¹è±¡ï¼Œå­å¯¹è±¡å¾…å¤„ç†ã€‚</li><li>é»‘è‰²ï¼šå­˜æ´»å¯¹è±¡ã€‚</li></ul><p>æ ‡è®°å¼€å§‹æ—¶ï¼Œæ‰€æœ‰å†…å­˜åŠ å…¥ç™½è‰²é›†åˆï¼ˆè¿™ä¸€æ­¥éœ€ STW ï¼‰ã€‚é¦–å…ˆå°†æ ¹å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼ŒåŠ å…¥å¾…æ‰«æé˜Ÿåˆ—ï¼ˆç°è‰²é›†åˆï¼‰ï¼›ä½¿ç”¨å¹¶å‘çš„ goroutine æ‰«æé˜Ÿåˆ—ï¼Œå–å‡ºä¸€ä¸ªç°è‰²å¯¹è±¡ï¼Œå°†å…¶æ ‡è®°ä¸ºé»‘è‰²ï¼Œå¹¶å°†å…¶æŒ‡å‘çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼ŒåŠ å…¥é˜Ÿåˆ—ã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°ç°è‰²é›†åˆä¸ºç©ºä¸ºæ­¢ï¼Œæ ‡è®°é˜¶æ®µç»“æŸã€‚é‚£ä¹ˆç™½è‰²å¯¹è±¡å³å¯éœ€è¦æ¸…ç†çš„å¯¹è±¡ï¼Œè€Œé»‘è‰²å¯¹è±¡å‡ä¸ºæ ¹å¯è¾¾çš„å¯¹è±¡ï¼Œä¸èƒ½è¢«æ¸…ç†ã€‚</p><p>ä¸‰è‰²æ ‡è®°æ³•å› ä¸ºå¤šäº†ä¸€ä¸ªç™½è‰²çš„çŠ¶æ€æ¥å­˜æ”¾ä¸ç¡®å®šå¯¹è±¡ï¼Œæ‰€ä»¥åç»­çš„æ ‡è®°é˜¶æ®µå¯ä»¥å¹¶å‘åœ°æ‰§è¡Œã€‚å½“ç„¶å¹¶å‘æ‰§è¡Œçš„ä»£ä»·æ˜¯å¯èƒ½ä¼šé€ æˆä¸€äº›é—æ¼ï¼Œå› ä¸ºé‚£äº›æ—©å…ˆè¢«æ ‡è®°ä¸ºé»‘è‰²çš„å¯¹è±¡å¯èƒ½ç›®å‰å·²ç»æ˜¯ä¸å¯è¾¾çš„äº†ã€‚æ‰€ä»¥ä¸‰è‰²æ ‡è®°æ³•æ˜¯ä¸€ä¸ª false negativeï¼ˆå‡é˜´æ€§ï¼‰çš„ç®—æ³•ã€‚</p><p>ä¸‰è‰²æ ‡è®°æ³•å¹¶å‘æ‰§è¡Œä»å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³åœ¨ GC è¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡æŒ‡é’ˆå‘ç”Ÿäº†æ”¹å˜ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A (é»‘) -&gt; B (ç°) -&gt; C (ç™½) -&gt; D (ç™½)  </span><br></pre></td></tr></table></figure><p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒD å¯¹è±¡æœ€ç»ˆä¼šè¢«æ ‡è®°ä¸ºé»‘è‰²ï¼Œä¸åº”è¢«å›æ”¶ã€‚ä½†åœ¨æ ‡è®°å’Œç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ç¨‹åºåˆ é™¤äº† C å¯¹ D çš„å¼•ç”¨ï¼Œè€Œ A è·å¾—äº† D çš„å¼•ç”¨ã€‚æ ‡è®°ç»§ç»­è¿›è¡Œï¼ŒD å°±æ²¡æœ‰æœºä¼šè¢«æ ‡è®°ä¸ºé»‘è‰²äº†ï¼ˆA å·²ç»å¤„ç†è¿‡ï¼Œè¿™ä¸€è½®ä¸ä¼šå†è¢«å¤„ç†ï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A (é»‘) -&gt; B (ç°) -&gt; C (ç™½)   </span><br><span class="line"> â†“  </span><br><span class="line">D (ç™½)  </span><br></pre></td></tr></table></figure><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGo ä½¿ç”¨äº†å†…å­˜å±éšœæŠ€æœ¯ï¼Œå®ƒæ˜¯åœ¨ç”¨æˆ·ç¨‹åºè¯»å–å¯¹è±¡ã€åˆ›å»ºæ–°å¯¹è±¡ä»¥åŠæ›´æ–°å¯¹è±¡æŒ‡é’ˆæ—¶æ‰§è¡Œçš„ä¸€æ®µä»£ç ï¼Œç±»ä¼¼äºä¸€ä¸ªé’©å­ã€‚åƒåœ¾æ”¶é›†å™¨ä½¿ç”¨äº†å†™å±éšœï¼ˆWrite Barrierï¼‰æŠ€æœ¯ï¼Œè¿™ä¸ªè®¡æ•°ä¼šæ‹¦æˆªå°†ç™½è‰²æŒ‡é’ˆæ’å…¥é»‘è‰²å¯¹è±¡çš„æ“ä½œï¼Œå½“å¯¹è±¡æ–°å¢æˆ–æ›´æ–°æ—¶ï¼Œä¼šå°†å…¶ç€è‰²ä¸ºç°è‰²ã€‚è¿™æ ·å³ä½¿ä¸ç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œå¯¹è±¡çš„å¼•ç”¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨ä¹Ÿèƒ½æ­£ç¡®å¤„ç†äº†ã€‚</p><p>ä¸€æ¬¡å®Œæ•´çš„ GC åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><ul><li>æ ‡è®°å‡†å¤‡(Mark Setupï¼Œéœ€ STW)ï¼Œæ‰“å¼€å†™å±éšœ(Write Barrier)ï¼Œå¼€å¯è¾…åŠ© GC ï¼ˆmutator assistï¼‰ï¼Œç»Ÿè®¡ root å¯¹è±¡çš„ä»»åŠ¡æ•°é‡</li><li>ä½¿ç”¨ä¸‰è‰²æ ‡è®°æ³•æ ‡è®°ï¼ˆMarking, å¹¶å‘ï¼‰</li><li>æ ‡è®°ç»“æŸ(Mark Terminationï¼Œéœ€ STW)ï¼Œå…³é—­å†™å±éšœã€‚</li><li>æ¸…ç†(Sweeping, å¹¶å‘)</li></ul><h4 id="5-GMP-æ¨¡å‹ï¼Œgo-åç¨‹"><a href="#5-GMP-æ¨¡å‹ï¼Œgo-åç¨‹" class="headerlink" title="5. GMP æ¨¡å‹ï¼Œgo åç¨‹"></a>5. GMP æ¨¡å‹ï¼Œgo åç¨‹</h4><h4 id="6-Gin-æ¡†æ¶ç®€ä»‹"><a href="#6-Gin-æ¡†æ¶ç®€ä»‹" class="headerlink" title="6. Gin æ¡†æ¶ç®€ä»‹"></a>6. Gin æ¡†æ¶ç®€ä»‹</h4><h4 id="7-åå°„çš„åŸç†"><a href="#7-åå°„çš„åŸç†" class="headerlink" title="7. åå°„çš„åŸç†"></a>7. åå°„çš„åŸç†</h4><h4 id="8-Go-mutex-é”æœºåˆ¶"><a href="#8-Go-mutex-é”æœºåˆ¶" class="headerlink" title="8. Go mutex é”æœºåˆ¶"></a>8. Go mutex é”æœºåˆ¶</h4><p>ä¾‹å¦‚ï¼šmap åç¨‹ä¸å®‰å…¨ï¼Œéœ€è¦è¯»å†™é”<br>Mutex å‡ ç§çŠ¶æ€<br><code>mutexLocked</code> â€” è¡¨ç¤ºäº’æ–¥é”çš„é”å®šçŠ¶æ€ï¼›<br><code>mutexWoken</code> â€” è¡¨ç¤ºä»æ­£å¸¸æ¨¡å¼è¢«ä»å”¤é†’ï¼›<br><code>mutexStarving</code> â€” å½“å‰çš„äº’æ–¥é”è¿›å…¥é¥¥é¥¿çŠ¶æ€ï¼›<br><code>waitersCount</code> â€” å½“å‰äº’æ–¥é”ä¸Šç­‰å¾…çš„ Goroutine ä¸ªæ•°ï¼›</p><h4 id="9-Channel-ä¼˜ç‚¹å’Œç›¸å…³çš„å‘"><a href="#9-Channel-ä¼˜ç‚¹å’Œç›¸å…³çš„å‘" class="headerlink" title="9. Channel ä¼˜ç‚¹å’Œç›¸å…³çš„å‘"></a>9. Channel ä¼˜ç‚¹å’Œç›¸å…³çš„å‘</h4><h4 id="10-oom-ï¼Ÿ"><a href="#10-oom-ï¼Ÿ" class="headerlink" title="10. oom ï¼Ÿ"></a>10. oom ï¼Ÿ</h4><h4 id="11-å†…å­˜ç®¡ç†æ–¹å¼"><a href="#11-å†…å­˜ç®¡ç†æ–¹å¼" class="headerlink" title="11. å†…å­˜ç®¡ç†æ–¹å¼"></a>11. å†…å­˜ç®¡ç†æ–¹å¼</h4><h4 id="12-GC-è§¦å‘æ—¶æœº"><a href="#12-GC-è§¦å‘æ—¶æœº" class="headerlink" title="12. GC è§¦å‘æ—¶æœº"></a>12. GC è§¦å‘æ—¶æœº</h4><p>ä½¿ç”¨ç³»ç»Ÿç›‘æ§ï¼Œè¯¥è§¦å‘æ¡ä»¶ç”± <code>runtime.forcegcperiod</code> å˜é‡æ§åˆ¶ï¼Œé»˜è®¤ä¸º 2 åˆ† é’Ÿã€‚å½“è¶…è¿‡ä¸¤åˆ†é’Ÿæ²¡æœ‰äº§ç”Ÿä»»ä½• GC æ—¶ï¼Œå¼ºåˆ¶è§¦å‘ GCã€‚ ä½¿ç”¨æ­¥è°ƒï¼ˆPacingï¼‰ç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ§åˆ¶å†…å­˜å¢é•¿çš„æ¯”ä¾‹ã€‚å¦‚ Go çš„ GC æ˜¯ä¸€ç§æ¯”ä¾‹ GC, ä¸‹ä¸€æ¬¡ GC ç»“æŸæ—¶çš„å †å¤§å°å’Œä¸Šä¸€æ¬¡ GC <code>å­˜æ´»</code>å †å¤§å°æˆæ¯”ä¾‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½“å‰ç”³è¯·çš„å†…å­˜æ˜¯ä¸Šä¸€æ¬¡ GC ä¸¤å€æ—¶è§¦å‘ã€‚</p><h4 id="13-GRPC-ä»¥åŠ-protobuf-åè®®ä¼˜åŒ–"><a href="#13-GRPC-ä»¥åŠ-protobuf-åè®®ä¼˜åŒ–" class="headerlink" title="13. GRPC ä»¥åŠ protobuf åè®®ä¼˜åŒ–"></a>13. GRPC ä»¥åŠ protobuf åè®®ä¼˜åŒ–</h4><p>gRPCçš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p><p>RPC(Remote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨)ï¼šgRPCæä¾›äº†ä¸€ç§ç®€å•çš„RPCæœºåˆ¶ï¼Œå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æ— ç¼é€šä¿¡ã€‚å®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ–¹æ³•ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>Protocol Buffersï¼šgRPCä½¿ç”¨Protocol Buffersä½œä¸ºæ•°æ®åºåˆ—åŒ–å’Œä¼ è¾“æ ¼å¼ã€‚Protocol Buffersæ˜¯ä¸€ç§è½»é‡çº§ã€é«˜æ•ˆçš„æ•°æ®ç»“æ„åºåˆ—åŒ–åº“ï¼Œå¯ä»¥åœ¨å¤šç§ç¼–ç¨‹è¯­è¨€ä¹‹é—´å®ç°æ— ç¼é€šä¿¡ã€‚<br>HTTP&#x2F;2ï¼šgRPCä½¿ç”¨HTTP&#x2F;2ä½œä¸ºä¼ è¾“åè®®ï¼Œåˆ©ç”¨HTTP&#x2F;2çš„å¤šè·¯å¤ç”¨ã€æµæ§åˆ¶ã€å‹ç¼©ç­‰ç‰¹æ€§ï¼Œå®ç°ä½å»¶è¿Ÿã€é«˜ååé‡çš„é€šä¿¡ã€‚</p><p>RPCè°ƒç”¨ï¼šgRPCçš„RPCè°ƒç”¨è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><p>å®¢æˆ·ç«¯é€šè¿‡Protocol Buffersåºåˆ—åŒ–è¯·æ±‚æ•°æ®ï¼Œå¹¶ä½¿ç”¨HTTP&#x2F;2å‘é€è¯·æ±‚ã€‚<br>æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼Œä½¿ç”¨Protocol Buffersååºåˆ—åŒ–è¯·æ±‚æ•°æ®ã€‚<br>æœåŠ¡å™¨æ‰§è¡ŒRPCæ–¹æ³•ï¼Œå¹¶å°†ç»“æœåºåˆ—åŒ–ä¸ºProtocol Buffersæ ¼å¼ã€‚<br>æœåŠ¡å™¨ä½¿ç”¨HTTP&#x2F;2å‘é€å“åº”ç»™å®¢æˆ·ç«¯ã€‚<br>å®¢æˆ·ç«¯ä½¿ç”¨Protocol Buffersååºåˆ—åŒ–å“åº”æ•°æ®ï¼Œå¹¶å¤„ç†ç»“æœã€‚</p><h4 id="14-golang-å‹æµ‹-pprofï¼Œç«ç„°å›¾"><a href="#14-golang-å‹æµ‹-pprofï¼Œç«ç„°å›¾" class="headerlink" title="14. golang å‹æµ‹ pprofï¼Œç«ç„°å›¾"></a>14. golang å‹æµ‹ pprofï¼Œç«ç„°å›¾</h4>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golangè¯­è¨€é¢è¯•é¢˜ - å¸¸è§é¢˜</title>
      <link href="/interview/go/golang101-3/"/>
      <url>/interview/go/golang101-3/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é¢ä¼šç»™å‡ºç½‘ä¸Šæ”¶é›†çš„å­—èŠ‚ç³» Golang è¯­è¨€å¸¸è§çš„é¢è¯•é¢˜ï¼ŒæŒ‰ç…§çƒ­åº¦æ’åºå“¦</p><h4 id="ç®€è¿°-slice-çš„åº•å±‚åŸç†ï¼Œslice-å’Œæ•°ç»„çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ç®€è¿°-slice-çš„åº•å±‚åŸç†ï¼Œslice-å’Œæ•°ç»„çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ç®€è¿° slice çš„åº•å±‚åŸç†ï¼Œslice å’Œæ•°ç»„çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ç®€è¿° slice çš„åº•å±‚åŸç†ï¼Œslice å’Œæ•°ç»„çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="ç®€å•ä»‹ç»-GMP-æ¨¡å‹ä»¥åŠè¯¥æ¨¡å‹çš„ä¼˜ç‚¹-å›°éš¾"><a href="#ç®€å•ä»‹ç»-GMP-æ¨¡å‹ä»¥åŠè¯¥æ¨¡å‹çš„ä¼˜ç‚¹-å›°éš¾" class="headerlink" title="ç®€å•ä»‹ç» GMP æ¨¡å‹ä»¥åŠè¯¥æ¨¡å‹çš„ä¼˜ç‚¹Â Â å›°éš¾"></a>ç®€å•ä»‹ç» GMP æ¨¡å‹ä»¥åŠè¯¥æ¨¡å‹çš„ä¼˜ç‚¹Â Â å›°éš¾</h4><h4 id="ç®€è¿°-Golang-åƒåœ¾å›æ”¶çš„æœºåˆ¶-ä¸­ç­‰"><a href="#ç®€è¿°-Golang-åƒåœ¾å›æ”¶çš„æœºåˆ¶-ä¸­ç­‰" class="headerlink" title="ç®€è¿° Golang åƒåœ¾å›æ”¶çš„æœºåˆ¶Â Â ä¸­ç­‰"></a>ç®€è¿° Golang åƒåœ¾å›æ”¶çš„æœºåˆ¶Â Â ä¸­ç­‰</h4><p>Golang é‡‡ç”¨çš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯ä¸‰è‰²æ ‡è®°æ³•ï¼Œåˆ†ä¸ºç™½è‰²ï¼ˆæœªæ ‡è®°ï¼‰ã€ç°è‰²ï¼ˆæ ‡è®°ä¸­ï¼‰ã€é»‘è‰²ï¼ˆå·²æ ‡è®°ï¼‰ã€‚<br>å›æ”¶æµç¨‹ä¸ºï¼š<br>    1. STWï¼Œä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œå°†æ ¹èŠ‚ç‚¹æ ‡è®°ä¸ºé»‘è‰²ï¼Œå°†èƒ½è¾¾åˆ°çš„æ‰€æœ‰èŠ‚ç‚¹æ ‡è®°ä¸ºç°è‰²ï¼Œç„¶åå°†æ‰€æœ‰èƒ½è¾¾åˆ°çš„å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—<br>    2. å¹¶å‘éå†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ï¼Œæ ‡è®°ä¸ºé»‘è‰²ï¼Œä¸”ç»§ç»­å¯»æ‰¾å…¶å­èŠ‚ç‚¹æ ‡è®°ä¸ºç°è‰²å¹¶åŠ å…¥é˜Ÿåˆ—<br>    3. ç›´åˆ°é˜Ÿåˆ—ä¸­æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹å‡éå†å®Œæ¯•ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ç™½è‰²èŠ‚ç‚¹å°±æ˜¯ä¸å¯è¾¾çš„èŠ‚ç‚¹ï¼Œå¯ä»¥å›æ”¶æ‰<br>åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨æ ‡è®°è¿‡ç¨‹ä¸­ï¼ŒèŠ‚ç‚¹æŒ‡é’ˆè¢«ç”¨æˆ·æ“ä½œæ”¹å˜ï¼Œå¯èƒ½ä¼šæ ‡è®°å¤±è´¥è¢«é”™è¯¯çš„æ¸…é™¤æ‰ï¼Œå› æ­¤ Go åˆå¼•å…¥äº†å†™å±éšœ</p><p>ä¸€æ¬¡å®Œæ•´çš„ GC åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><ul><li>æ ‡è®°å‡†å¤‡(Mark Setupï¼Œéœ€ STW)ï¼Œæ‰“å¼€å†™å±éšœ(Write Barrier)ï¼Œå¼€å¯è¾…åŠ© GC ï¼ˆmutator assistï¼‰ï¼Œç»Ÿè®¡ root å¯¹è±¡çš„ä»»åŠ¡æ•°é‡</li><li>ä½¿ç”¨ä¸‰è‰²æ ‡è®°æ³•æ ‡è®°ï¼ˆMarking, å¹¶å‘ï¼‰</li><li>æ ‡è®°ç»“æŸ(Mark Terminationï¼Œéœ€ STW)ï¼Œå…³é—­å†™å±éšœã€‚</li><li>æ¸…ç†(Sweeping, å¹¶å‘)</li></ul><p>GC è°ƒä¼˜</p><ol><li>å‡å°‘ä½¿ç”¨stringç±»å‹ä¸­çš„ â€˜+â€™ï¼ˆæ­¤ç§æ–¹å¼æ¯æ¬¡æ‹¼æ¥éƒ½ä¼šç”³è¯·ä¸€æ®µæ–°çš„å†…å­˜ç©ºé—´ï¼‰ï¼Œæ¨èä½¿ç”¨ strings.Builder ï¼ˆç±»ä¼¼åˆ‡ç‰‡çš„æ‰©å®¹æœºåˆ¶ï¼‰</li><li>å°å¯¹è±¡å¤ç”¨ï¼Œå°½é‡å‡å°‘å£°æ˜å±€éƒ¨å˜é‡ï¼Œå°å¯¹è±¡å¯ä»¥åŠ å…¥ç»“æ„ä½“æ¥å¤ç”¨ï¼Œæ–¹ä¾¿ GC æ‰«æ</li></ol><h4 id="åç¨‹ä¸è¿›ç¨‹ï¼Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåç¨‹æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"><a href="#åç¨‹ä¸è¿›ç¨‹ï¼Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåç¨‹æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ" class="headerlink" title="åç¨‹ä¸è¿›ç¨‹ï¼Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåç¨‹æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"></a>åç¨‹ä¸è¿›ç¨‹ï¼Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåç¨‹æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h4><p>Goroutinesæ˜¯å¯ä»¥åŒæ—¶è¿è¡Œçš„å‡½æ•°ä¸æ–¹æ³•ã€‚Goroutines å¯ä»¥è¢«è®¤ä¸ºæ˜¯è½»é‡çº§çš„çº¿ç¨‹ã€‚ ä¸çº¿ç¨‹ç›¸æ¯”ï¼Œåˆ›å»º Goroutine çš„å¼€é”€å¾ˆå°ã€‚ Goåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œæ•°åƒä¸ª Goroutine æ˜¯éå¸¸å¸¸è§çš„åšæ³•ã€‚</p><ul><li>è¿›ç¨‹: è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ã€‚ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡é‡ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ã€‚</li><li>çº¿ç¨‹: çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,çº¿ç¨‹æ˜¯å†…æ ¸æ€,è€Œä¸”æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚</li><li>åç¨‹: åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåç¨‹çš„è°ƒåº¦å®Œå…¨æ˜¯ç”±ç”¨æˆ·æ¥æ§åˆ¶çš„ã€‚åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆã€‚åç¨‹è°ƒåº¦åˆ‡æ¢æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡å›æ¥çš„æ—¶å€™ï¼Œæ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œç›´æ¥æ“ä½œæ ˆåˆ™åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œå¯ä»¥ä¸åŠ é”çš„è®¿é—®å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çš„åˆ‡æ¢éå¸¸å¿«ã€‚</li></ul><h4 id="ç®€è¿°-defer-çš„æ‰§è¡Œé¡ºåº-ä¸­ç­‰"><a href="#ç®€è¿°-defer-çš„æ‰§è¡Œé¡ºåº-ä¸­ç­‰" class="headerlink" title="ç®€è¿° defer çš„æ‰§è¡Œé¡ºåºÂ Â ä¸­ç­‰"></a>ç®€è¿° defer çš„æ‰§è¡Œé¡ºåºÂ Â ä¸­ç­‰</h4><ol><li>å¤šä¸ª defer çš„æ‰§è¡Œé¡ºåºä¸ºâ€œåè¿›å…ˆå‡ºâ€ï¼›</li><li>æ‰€æœ‰å‡½æ•°åœ¨æ‰§è¡Œ RET è¿”å›æŒ‡ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ defer è¯­å¥ï¼Œè‹¥å­˜åœ¨åˆ™å…ˆé€†åºè°ƒç”¨ defer è¯­å¥è¿›è¡Œæ”¶å°¾å·¥ä½œå†é€€å‡ºè¿”å›ï¼›</li><li>åŒ¿åè¿”å›å€¼æ˜¯åœ¨ return æ‰§è¡Œæ—¶è¢«å£°æ˜ï¼Œæœ‰åè¿”å›å€¼åˆ™æ˜¯åœ¨å‡½æ•°å£°æ˜çš„åŒæ—¶è¢«å£°æ˜ï¼Œå› æ­¤åœ¨ defer è¯­å¥ä¸­åªèƒ½è®¿é—®æœ‰åè¿”å›å€¼ï¼Œè€Œä¸èƒ½ç›´æ¥è®¿é—®åŒ¿åè¿”å›å€¼ï¼›</li><li>return å…¶å®åº”è¯¥åŒ…å«å‰åä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥æ˜¯ç»™è¿”å›å€¼èµ‹å€¼ï¼ˆè‹¥ä¸ºæœ‰åè¿”å›å€¼åˆ™ç›´æ¥èµ‹å€¼ï¼Œè‹¥ä¸ºåŒ¿åè¿”å›å€¼åˆ™å…ˆå£°æ˜å†èµ‹å€¼ï¼‰ï¼›ç¬¬äºŒæ­¥æ˜¯è°ƒç”¨ RET è¿”å›æŒ‡ä»¤å¹¶ä¼ å…¥è¿”å›å€¼ï¼Œè€Œ RET åˆ™ä¼šæ£€æŸ¥ defer æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨å°±å…ˆé€†åºæ’æ’­ defer è¯­å¥ï¼Œæœ€å RET æºå¸¦è¿”å›å€¼é€€å‡ºå‡½æ•°ï¼›</li><li>defer å£°æ˜æ—¶ä¼šå…ˆç¡®å®šå‡½æ•°å‚æ•°ï¼Œæ¨è¿Ÿæ‰§è¡Œçš„ä»…ä»…æ˜¯å‡½æ•°ä½“</li></ol><h4 id="Golang-æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€é”™è¯¯å¤„ç†æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#Golang-æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€é”™è¯¯å¤„ç†æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="Golang æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€é”™è¯¯å¤„ç†æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"></a>Golang æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€é”™è¯¯å¤„ç†æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h4><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç®€æ´ã€é«˜æ•ˆã€å®‰å…¨</li><li>å¹¶å‘å¤„ç†èƒ½åŠ›å¼º</li><li>é™æ€ç±»å‹å’Œç¼–è¯‘å‹</li><li>ä¸°å¯Œçš„æ ‡å‡†åº“</li><li>è·¨å¹³å°å’Œå¯ç§»æ¤æ€§</li><li>å¼ºå¤§çš„æ€§èƒ½</li><li>åƒåœ¾å›æ”¶æœºåˆ¶<br>åŠ£åŠ¿:</li><li>æ³›å‹ç¼–ç¨‹æ”¯æŒä¸è¶³</li><li>é”™è¯¯å¤„ç†æ–¹å¼å¯èƒ½ä¸åŒ</li></ol><p>é‡‡ç”¨é”™è¯¯è¿”å›æ–¹å¼ï¼Œé”™è¯¯æ˜¯ä¸€ç§å†…ç½®ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ error ç±»å‹æ¥å®šä¹‰ã€‚è€Œå¼‚å¸¸ï¼ˆpanicï¼‰ä¹Ÿå¯ä»¥é€šè¿‡ recover() å‡½æ•°è½¬æ¢ä¸º erroræ¥å¤„ç†ã€‚ä¼˜ç‚¹æ˜¯ç®€å•ç›´è§‚ï¼Œä¸€èˆ¬ä¸ä¸»ä½“ç¨‹åºåˆ†ç¦»ã€‚å¯èƒ½çš„ç¼ºç‚¹æ˜¯ï¼Œéœ€è¦åœ¨è°ƒç”¨é“¾ä¸­åšå¥½æ”¶é›†å’Œå¤„ç†ï¼Œå¦‚æœæ¼å¤„ç†å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">panic</span> := <span class="built_in">recover</span>(); <span class="built_in">panic</span> != <span class="literal">nil</span> &#123;  </span><br><span class="line">      err = DumpStack(<span class="built_in">panic</span>)  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>ä¸¤æ¬¡ GC å‘¨æœŸé‡å ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼ŒGC è§¦å‘æœºåˆ¶æ˜¯ä»€ä¹ˆæ ·çš„ï¼ŸÂ Â ç®€å•</p><p>Golang çš„åç¨‹é€šä¿¡æ–¹å¼æœ‰å“ªäº›ï¼ŸÂ Â ä¸­ç­‰</p><p>â–³ 4æ¬¡</p><p>ç®€è¿° Golang çš„ä¼ªæŠ¢å å¼è°ƒåº¦Â Â ä¸­ç­‰</p><p>â–³ 4æ¬¡</p><p>ä»€ä¹ˆæ˜¯ goroutine æ³„æ¼Â Â ç®€å•</p><p>â–³ 4æ¬¡</p><p>groutinue ä»€ä¹ˆæ—¶å€™ä¼šè¢«æŒ‚èµ·ï¼ŸÂ Â ç®€å•</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golangè¯­è¨€é¢è¯•é¢˜ - åŸºç¡€è¯­æ³•</title>
      <link href="/interview/go/golang101-1/"/>
      <url>/interview/go/golang101-1/</url>
      
        <content type="html"><![CDATA[<h4 id="1-å’Œ-çš„åŒºåˆ«ï¼Ÿ"><a href="#1-å’Œ-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="1.  = å’Œ := çš„åŒºåˆ«ï¼Ÿ"></a>1.  <code>=</code> å’Œ <code>:=</code> çš„åŒºåˆ«ï¼Ÿ</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo <span class="type">int</span>  </span><br><span class="line">foo = <span class="number">10</span> </span><br><span class="line"><span class="comment">// ç­‰ä»·äº  </span></span><br><span class="line">foo := <span class="number">10</span></span><br></pre></td></tr></table></figure><h4 id="2-æŒ‡é’ˆçš„ä½œç”¨"><a href="#2-æŒ‡é’ˆçš„ä½œç”¨" class="headerlink" title="2. æŒ‡é’ˆçš„ä½œç”¨"></a>2. æŒ‡é’ˆçš„ä½œç”¨</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x =  <span class="number">5</span>  </span><br><span class="line"><span class="keyword">var</span> p *<span class="type">int</span> = &amp;x  </span><br><span class="line">fmt.Printf(<span class="string">&quot;x = %d&quot;</span>,  *p) <span class="comment">// x å¯ä»¥ç”¨ *p è®¿é—®</span></span><br><span class="line"><span class="comment">//  `*` è¿ç®—ç¬¦ï¼Œä¹Ÿç§°ä¸ºè§£å¼•ç”¨è¿ç®—ç¬¦ï¼Œç”¨äºè®¿é—®åœ°å€ä¸­çš„å€¼ã€‚</span></span><br><span class="line"><span class="comment">//  `ï¼†`è¿ç®—ç¬¦ï¼Œä¹Ÿç§°ä¸ºåœ°å€è¿ç®—ç¬¦ï¼Œç”¨äºè¿”å›å˜é‡çš„åœ°å€ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="3-Go-æœ‰å¼‚å¸¸ç±»å‹ä¹ˆï¼Ÿ"><a href="#3-Go-æœ‰å¼‚å¸¸ç±»å‹ä¹ˆï¼Ÿ" class="headerlink" title="3. Go æœ‰å¼‚å¸¸ç±»å‹ä¹ˆï¼Ÿ"></a>3. Go æœ‰å¼‚å¸¸ç±»å‹ä¹ˆï¼Ÿ</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go åªæœ‰é”™è¯¯ç±»å‹</span></span><br><span class="line">f, err := os.Open(<span class="string">&quot;test.txt&quot;</span>)  </span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;  </span><br><span class="line">  log.Fatal(err)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-åç¨‹å’Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ"><a href="#4-åç¨‹å’Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="4. åç¨‹å’Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ"></a>4. åç¨‹å’Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ</h4><p>Goroutinesæ˜¯å¯ä»¥åŒæ—¶è¿è¡Œçš„å‡½æ•°ä¸æ–¹æ³•ã€‚Goroutines å¯ä»¥è¢«è®¤ä¸ºæ˜¯è½»é‡çº§çš„çº¿ç¨‹ã€‚ ä¸çº¿ç¨‹ç›¸æ¯”ï¼Œåˆ›å»º Goroutine çš„å¼€é”€å¾ˆå°ã€‚ Goåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œæ•°åƒä¸ª Goroutine æ˜¯éå¸¸å¸¸è§çš„åšæ³•ã€‚<br>å¹¶å‘æŒæ¡ï¼Œgoroutineå’Œchannelå£°æ˜ä¸ä½¿ç”¨ï¼</p><h4 id="5-æ‹¼æ¥å­—ç¬¦ä¸²"><a href="#5-æ‹¼æ¥å­—ç¬¦ä¸²" class="headerlink" title="5. æ‹¼æ¥å­—ç¬¦ä¸²"></a>5. æ‹¼æ¥å­—ç¬¦ä¸²</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­—ç¬¦ä¸²æ˜¯åªè¯»çš„ï¼Œä¹Ÿå°±æ„å‘³ç€æ¯æ¬¡ä¿®æ”¹æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">a := <span class="string">&quot;a&quot;</span></span><br><span class="line">b := <span class="string">&quot;b&quot;</span></span><br><span class="line"><span class="keyword">var</span> str1 <span class="type">string</span></span><br><span class="line">str1 += a</span><br><span class="line">str1 += b</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨èä½¿ç”¨ `strings.Builder`ï¼Œæœ€å°åŒ–å†…å­˜æ‹·è´æ¬¡æ•°ã€‚</span></span><br><span class="line"><span class="keyword">var</span> str strings.Builder  </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;  </span><br><span class="line">  str.WriteString(<span class="string">&quot;a&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">fmt.Println(str.String())</span><br></pre></td></tr></table></figure><h4 id="6-ä»€ä¹ˆæ˜¯-rune-ç±»å‹"><a href="#6-ä»€ä¹ˆæ˜¯-rune-ç±»å‹" class="headerlink" title="6. ä»€ä¹ˆæ˜¯ rune ç±»å‹"></a>6. ä»€ä¹ˆæ˜¯ rune ç±»å‹</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Go è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²çš„åº•å±‚è¡¨ç¤ºæ˜¯ byte (8 bit) åºåˆ—ï¼Œè€Œé rune (32 bit) åºåˆ—ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ `è¯­` å’Œ `è¨€` ä½¿ç”¨ UTF-8 ç¼–ç åå„å  3 ä¸ª byteï¼Œå› æ­¤ `len(&quot;Goè¯­è¨€&quot;)` ç­‰äº 8ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º rune åºåˆ—ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">fmt.Println(<span class="built_in">len</span>(<span class="string">&quot;Goè¯­è¨€&quot;</span>)) <span class="comment">// 8  </span></span><br><span class="line">fmt.Println(<span class="built_in">len</span>([]<span class="type">rune</span>(<span class="string">&quot;Goè¯­è¨€&quot;</span>))) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><h4 id="7-åˆ¤æ–­-map-ç»“æ„ä¸­æ˜¯å¦åŒ…å«æŸä¸ª-key-çš„æ–¹æ³•"><a href="#7-åˆ¤æ–­-map-ç»“æ„ä¸­æ˜¯å¦åŒ…å«æŸä¸ª-key-çš„æ–¹æ³•" class="headerlink" title="7. åˆ¤æ–­ map ç»“æ„ä¸­æ˜¯å¦åŒ…å«æŸä¸ª key çš„æ–¹æ³•"></a>7. åˆ¤æ–­ map ç»“æ„ä¸­æ˜¯å¦åŒ…å«æŸä¸ª key çš„æ–¹æ³•</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ok ä¸º true ä»£è¡¨æœ‰è¿™ä¸ª keyï¼Œä¸” val æ˜¯è¿™ä¸ª key çš„å€¼</span></span><br><span class="line"><span class="keyword">if</span> val, ok := map_[<span class="string">&quot;key&quot;</span>]; ok &#123;  </span><br><span class="line">  <span class="comment">//do something  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-defer-çš„æ‰§è¡Œé¡ºåº"><a href="#8-defer-çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="8. defer çš„æ‰§è¡Œé¡ºåº"></a>8. defer çš„æ‰§è¡Œé¡ºåº</h4><p>å¤šä¸ª defer è¯­å¥ï¼Œéµä»åè¿›å…ˆå‡º(Last In First Outï¼ŒLIFO)çš„åŸåˆ™ï¼Œæœ€åå£°æ˜çš„ defer è¯­å¥ï¼Œæœ€å…ˆå¾—åˆ°æ‰§è¡Œã€‚<br>panic éœ€è¦ç­‰defer ç»“æŸåæ‰ä¼šå‘ä¸Šä¼ é€’ã€‚å‡ºç°panicææ…Œæ—¶å€™ï¼Œä¼šå…ˆæŒ‰ç…§deferçš„åå…¥å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œï¼Œæœ€åæ‰ä¼šæ‰§è¡Œpanicã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> <span class="type">int</span> &#123;  </span><br><span class="line">  i := <span class="number">0</span>  </span><br><span class="line">  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    fmt.Println(<span class="string">&quot;defer1&quot;</span>)  </span><br><span class="line">  &#125;()  </span><br><span class="line">  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    i += <span class="number">1</span>  </span><br><span class="line">    fmt.Println(<span class="string">&quot;defer2&quot;</span>)  </span><br><span class="line">  &#125;()  </span><br><span class="line">  <span class="keyword">return</span> i  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  fmt.Println(<span class="string">&quot;return&quot;</span>, test())  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">// defer2  </span></span><br><span class="line"><span class="comment">// defer1  </span></span><br><span class="line"><span class="comment">// return 0</span></span><br></pre></td></tr></table></figure><p>defer åœ¨ return è¯­å¥ä¹‹åæ‰§è¡Œï¼Œä½†åœ¨å‡½æ•°çœŸæ­£é€€å‡ºä¹‹å‰ï¼Œdefer å¯ä»¥ä¿®æ”¹è¿”å›å€¼ã€‚æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å‰ä¸€ä¸ªä¾‹å­çš„è¿”å›å€¼å¹¶æ²¡æœ‰è¢«ä¿®æ”¹ï¼ˆæ³¨æ„ï¼šåªæœ‰è¢«é¢„å…ˆå®šä¹‰çš„è¿”å›å€¼æ‰èƒ½è¢« defer è¯­å¥ä¿®æ”¹ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> (i <span class="type">int</span>) &#123;  </span><br><span class="line">  i = <span class="number">0</span>  </span><br><span class="line">  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    i += <span class="number">1</span>  </span><br><span class="line">    fmt.Println(<span class="string">&quot;defer2&quot;</span>)  </span><br><span class="line">  &#125;()  </span><br><span class="line">  <span class="keyword">return</span> i  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  fmt.Println(<span class="string">&quot;return&quot;</span>, test())  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">// defer2  </span></span><br><span class="line"><span class="comment">// return 1</span></span><br></pre></td></tr></table></figure><h4 id="9-tagçš„ç”¨æ³•ï¼Ÿ"><a href="#9-tagçš„ç”¨æ³•ï¼Ÿ" class="headerlink" title="9. tagçš„ç”¨æ³•ï¼Ÿ"></a>9. tagçš„ç”¨æ³•ï¼Ÿ</h4><p>tag æ˜¯ struct ç»“æ„çš„æ³¨è§£ï¼Œä¸åŒçš„æ¡†æ¶æˆ–è€…å·¥å…·å¯ä»¥é€šè¿‡åå°„è·å–åˆ°æŸä¸ªå­—æ®µçš„å±æ€§ï¼Œå¢åŠ è¯­ä¹‰<br>ä¾‹å¦‚ä¸‹æ–¹ä¾‹å­å®šä¹‰äº† struct ç»“æ„å­—æ®µå’Œ json ç»“æ„çš„æ˜ å°„å…³ç³»</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span>  </span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;encoding/json&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> Stu <span class="keyword">struct</span> &#123;  </span><br><span class="line">  Name <span class="type">string</span> <span class="string">`json:&quot;user_name&quot;`</span>  </span><br><span class="line">  Id   <span class="type">string</span> <span class="string">`json:&quot;user_id&quot;`</span>  </span><br><span class="line">  Age  <span class="type">int</span>    <span class="string">`json:&quot;-&quot;`</span>  <span class="comment">// json å¿½ç•¥</span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  buf, _ := json.Marshal(Stu&#123;<span class="string">&quot;Bishop&quot;</span>, <span class="string">&quot;1001&quot;</span>, <span class="number">18</span>&#125;)  </span><br><span class="line">  fmt.Printf(<span class="string">&quot;%s\n&quot;</span>, buf)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-Golang-å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨ï¼ˆsliceï¼‰ç»“æ„ç­‰ä»·"><a href="#10-Golang-å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨ï¼ˆsliceï¼‰ç»“æ„ç­‰ä»·" class="headerlink" title="10. Golang å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨ï¼ˆsliceï¼‰ç»“æ„ç­‰ä»·"></a>10. Golang å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨ï¼ˆsliceï¼‰ç»“æ„ç­‰ä»·</h4><p>å¯ä»¥ä½¿ç”¨åå°„ reflect.DeepEqual(a, b) æ¥åˆ¤æ–­ï¼Œä½†æ˜¯æ­¤ç§æ–¹æ³•æ¯”è¾ƒå½±å“æ€§èƒ½ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯é€šè¿‡åŸºç¡€éå†çš„æ–¹æ³•æ¥å®Œæˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SliceAEqurlSliceB</span><span class="params">(a, b []<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;  </span><br><span class="line">  <span class="comment">// ç­‰é•¿</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(a) != <span class="built_in">len</span>(b) &#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤ç©º</span></span><br><span class="line">  <span class="keyword">if</span> (a == <span class="literal">nil</span>) != (b == <span class="literal">nil</span>) &#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  b = b[:<span class="built_in">len</span>(a)]  </span><br><span class="line">  <span class="keyword">for</span> i, v := <span class="keyword">range</span> a &#123;  </span><br><span class="line"><span class="keyword">if</span> v != b[i] &#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="11-å¦‚ä½•æ ‡è¯†æšä¸¾å€¼ï¼ˆenumsï¼‰"><a href="#11-å¦‚ä½•æ ‡è¯†æšä¸¾å€¼ï¼ˆenumsï¼‰" class="headerlink" title="11. å¦‚ä½•æ ‡è¯†æšä¸¾å€¼ï¼ˆenumsï¼‰"></a>11. å¦‚ä½•æ ‡è¯†æšä¸¾å€¼ï¼ˆenumsï¼‰</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Level <span class="type">int32</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> (  </span><br><span class="line">  Level1 Level = <span class="literal">iota</span>  </span><br><span class="line">  Level2  </span><br><span class="line">  Level3 </span><br><span class="line">  Level4 </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  fmt.Println(Level1, Level2, Level3, Level4) <span class="comment">// 0, 1, 2, 3  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-ç©º-struct-ç»“æ„çš„ä¸€äº›ç”¨æ³•"><a href="#12-ç©º-struct-ç»“æ„çš„ä¸€äº›ç”¨æ³•" class="headerlink" title="12. ç©º struct{} ç»“æ„çš„ä¸€äº›ç”¨æ³•"></a>12. ç©º struct{} ç»“æ„çš„ä¸€äº›ç”¨æ³•</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ¬ä½“æ˜¯ä¸€ä¸ªç©ºç»“æ„ä½“</span></span><br><span class="line">fmt.Println(unsafe.Sizeof(<span class="keyword">struct</span>&#123;&#125;&#123;&#125;)) <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥ç”¨ä½œå ä½ç¬¦ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">type</span> Set <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  set := <span class="built_in">make</span>(Set)  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, item := <span class="keyword">range</span> []<span class="type">string</span>&#123;<span class="string">&quot;A&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>&#125; &#123;  </span><br><span class="line">set[item] = <span class="keyword">struct</span>&#123;&#125;&#123;&#125;  </span><br><span class="line">  &#125;  </span><br><span class="line">  fmt.Println(<span class="built_in">len</span>(set)) <span class="comment">// 3  </span></span><br><span class="line">  <span class="keyword">if</span> _, ok := set[<span class="string">&quot;A&quot;</span>]; ok &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;A exists&quot;</span>) <span class="comment">// A exists  </span></span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨ä½œä¼ é€’ä¿¡å·</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">  ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, <span class="number">1</span>)  </span><br><span class="line">  <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    &lt;-ch  </span><br><span class="line">    <span class="comment">// do something  </span></span><br><span class="line">  &#125;()  </span><br><span class="line">  ch &lt;- <span class="keyword">struct</span>&#123;&#125;&#123;&#125;  </span><br><span class="line">  <span class="comment">// ...  </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="13-å£°æ˜ç»“æ„ä½“æ–¹æ³•"><a href="#13-å£°æ˜ç»“æ„ä½“æ–¹æ³•" class="headerlink" title="13. å£°æ˜ç»“æ„ä½“æ–¹æ³•"></a>13. å£°æ˜ç»“æ„ä½“æ–¹æ³•</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Lamp <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l Lamp)</span></span> On() &#123;  </span><br><span class="line"> <span class="built_in">println</span>(<span class="string">&quot;On&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l Lamp)</span></span> Off() &#123;  </span><br><span class="line"> <span class="built_in">println</span>(<span class="string">&quot;Off&quot;</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="14-make-å’Œ-new"><a href="#14-make-å’Œ-new" class="headerlink" title="14. make å’Œ new"></a>14. make å’Œ new</h4><ol><li>make ä»…ç”¨æ¥åˆ†é…åŠåˆå§‹åŒ–ç±»å‹ä¸º sliceã€mapã€chan çš„æ•°æ®ã€‚new å¯åˆ†é…ä»»æ„ç±»å‹çš„æ•°æ®.</li><li>new åˆ†é…è¿”å›çš„æ˜¯æŒ‡é’ˆï¼Œå³ç±»å‹ *Typeã€‚make è¿”å›å¼•ç”¨ï¼Œå³ Type.</li><li>new åˆ†é…çš„ç©ºé—´è¢«æ¸…é›¶, make åˆ†é…ç©ºé—´åï¼Œä¼šè¿›è¡Œåˆå§‹åŒ–.<br>ä¸€ä¸ªä¾‹å­<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> i *<span class="type">int</span></span><br><span class="line">i = <span class="built_in">new</span>(<span class="type">int</span>) <span class="comment">// åˆ†é…å†…å­˜åœ°å€å¹¶è¿”å›æŒ‡å‘æ”¹åœ°å€çš„æŒ‡é’ˆï¼ŒåŒæ—¶ç½®ä¸ºç±»å‹çš„0å€¼</span></span><br><span class="line">*i = <span class="number">10</span></span><br><span class="line">fmt.Println(*i) <span class="comment">// 10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="15-ä»£ç è¾“å‡ºå•¥ç›¸å…³é¢˜"><a href="#15-ä»£ç è¾“å‡ºå•¥ç›¸å…³é¢˜" class="headerlink" title="15. ä»£ç è¾“å‡ºå•¥ç›¸å…³é¢˜"></a>15. ä»£ç è¾“å‡ºå•¥ç›¸å…³é¢˜</h4><h5 id="1"><a href="#1" class="headerlink" title="(1)"></a>(1)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a <span class="type">uint</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> b <span class="type">uint</span> = <span class="number">2</span></span><br><span class="line">    fmt.Println(a-b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2^32-1 or 2^64-1 æ ¹æ®æ“ä½œç³»ç»Ÿä½æ•°æœ‰ä¸åŒç»“æœ</span></span><br></pre></td></tr></table></figure><p>å¼ºç±»å‹è¯­è¨€ï¼Œè®¡ç®—ç»“æœä¹Ÿæ˜¯ uint ç±»å‹ï¼Œ1-2 å¯ä»¥è½¬æ¢ä¸º 0-1 ï¼Œè®¡ç®—æœºä¸­æŒ‰ç…§ 0 + -1 æ¥è®¡ç®—ï¼Œ-1 é€šå¸¸è¡¨ç¤ºä¸ºè¡¥ç ï¼Œå³æ‰€æœ‰ä½æ•°éƒ½æ˜¯1çš„ä¸€ä¸ªæ•°ï¼Œå³å½“å‰ç³»ç»Ÿå¯è¡¨ç¤ºçš„æœ€å¤§æ•°</p><h5 id="2"><a href="#2" class="headerlink" title="(2)"></a>(2)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="title">main</span><span class="params">()</span></span>Â &#123;</span><br><span class="line">Â Â Â Â runtime.GOMAXPROCS(<span class="number">1</span>)</span><br><span class="line">Â Â Â Â wgÂ :=Â sync.WaitGroup&#123;&#125;</span><br><span class="line">Â Â Â Â wg.Add(<span class="number">20</span>)</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>Â iÂ :=Â <span class="number">0</span>;Â iÂ &lt;Â <span class="number">10</span>;Â i++Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">go</span>Â <span class="function"><span class="keyword">func</span><span class="params">()</span></span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â fmt.Println(<span class="string">&quot;A:Â &quot;</span>,Â i)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â wg.Done()</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;()</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span>Â iÂ :=Â <span class="number">0</span>;Â iÂ &lt;Â <span class="number">10</span>;Â i++Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">go</span>Â <span class="function"><span class="keyword">func</span><span class="params">(iÂ <span class="type">int</span>)</span></span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â fmt.Println(<span class="string">&quot;B:Â &quot;</span>,Â i)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â wg.Done()</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;(i)</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒç‚¹ï¼š<strong>goæ‰§è¡Œçš„éšæœºæ€§å’Œé—­åŒ…</strong><br>è§£ç­”ï¼šè°ä¹Ÿä¸çŸ¥é“æ‰§è¡Œåæ‰“å°çš„é¡ºåºæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥åªèƒ½è¯´æ˜¯éšæœºæ•°å­—ã€‚ä½†æ˜¯<code>A:</code>å‡ä¸ºè¾“å‡º10ï¼Œ<code>B:</code>ä»0~9è¾“å‡º(é¡ºåºä¸å®š)ã€‚ç¬¬ä¸€ä¸ªgo funcä¸­iæ˜¯å¤–éƒ¨forçš„ä¸€ä¸ªå˜é‡ï¼Œåœ°å€ä¸å˜åŒ–ã€‚éå†å®Œæˆåï¼Œæœ€ç»ˆi&#x3D;10ã€‚æ•…go funcæ‰§è¡Œæ—¶ï¼Œiçš„å€¼å§‹ç»ˆæ˜¯10ã€‚<br>ç¬¬äºŒä¸ªgo funcä¸­iæ˜¯å‡½æ•°å‚æ•°ï¼Œä¸å¤–éƒ¨forä¸­çš„iå®Œå…¨æ˜¯ä¸¤ä¸ªå˜é‡ã€‚å°¾éƒ¨(i)å°†å‘ç”Ÿå€¼æ‹·è´ï¼Œgo funcå†…éƒ¨æŒ‡å‘å€¼æ‹·è´åœ°å€ã€‚</p><h5 id="3"><a href="#3" class="headerlink" title="(3)"></a>(3)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span>Â PeopleÂ <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="params">(pÂ *People)</span></span>Â ShowA()Â &#123;</span><br><span class="line">Â Â Â Â fmt.Println(<span class="string">&quot;showA&quot;</span>)</span><br><span class="line">Â Â Â Â p.ShowB()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="params">(pÂ *People)</span></span>Â ShowB()Â &#123;</span><br><span class="line">Â Â Â Â fmt.Println(<span class="string">&quot;showB&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span>Â TeacherÂ <span class="keyword">struct</span>Â &#123;</span><br><span class="line">Â Â Â Â People</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="params">(tÂ *Teacher)</span></span>Â ShowB()Â &#123;</span><br><span class="line">Â Â Â Â fmt.Println(<span class="string">&quot;teacherÂ showB&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="title">main</span><span class="params">()</span></span>Â &#123;</span><br><span class="line">Â Â Â Â tÂ :=Â Teacher&#123;&#125;</span><br><span class="line">Â Â Â Â t.ShowA()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// shwoA</span></span><br><span class="line"><span class="comment">// showB</span></span><br></pre></td></tr></table></figure><p>è€ƒç‚¹ï¼š<strong>goçš„ç»„åˆç»§æ‰¿</strong><br>è§£ç­”ï¼šè¿™æ˜¯Golangçš„ç»„åˆæ¨¡å¼ï¼Œå¯ä»¥å®ç°OOPçš„ç»§æ‰¿ã€‚è¢«ç»„åˆçš„ç±»å‹Peopleæ‰€åŒ…å«çš„æ–¹æ³•è™½ç„¶å‡çº§æˆäº†å¤–éƒ¨ç±»å‹Teacherè¿™ä¸ªç»„åˆç±»å‹çš„æ–¹æ³•ï¼ˆä¸€å®šè¦æ˜¯åŒ¿åå­—æ®µï¼‰ï¼Œä½†å®ƒä»¬çš„æ–¹æ³•(ShowA())è°ƒç”¨æ—¶æ¥å—è€…å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ã€‚æ­¤æ—¶Peopleç±»å‹å¹¶ä¸çŸ¥é“è‡ªå·±ä¼šè¢«ä»€ä¹ˆç±»å‹ç»„åˆï¼Œå½“ç„¶ä¹Ÿå°±æ— æ³•è°ƒç”¨æ–¹æ³•æ—¶å»ä½¿ç”¨æœªçŸ¥çš„ç»„åˆè€…Teacherç±»å‹çš„åŠŸèƒ½ã€‚</p><h5 id="4"><a href="#4" class="headerlink" title="(4)"></a>(4)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span>Â <span class="title">main</span><span class="params">()</span></span>Â &#123;</span><br><span class="line">Â Â Â Â runtime.GOMAXPROCS(<span class="number">1</span>)</span><br><span class="line">Â Â Â Â int_chanÂ :=Â <span class="built_in">make</span>(<span class="keyword">chan</span>Â <span class="type">int</span>,Â <span class="number">1</span>)</span><br><span class="line">Â Â Â Â string_chanÂ :=Â <span class="built_in">make</span>(<span class="keyword">chan</span>Â <span class="type">string</span>,Â <span class="number">1</span>)</span><br><span class="line">Â Â Â Â int_chanÂ &lt;-Â <span class="number">1</span></span><br><span class="line">Â Â Â Â string_chanÂ &lt;-Â <span class="string">&quot;hello&quot;</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â valueÂ :=Â &lt;-int_chan:</span><br><span class="line">Â Â Â Â Â Â Â Â fmt.Println(value)</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â valueÂ :=Â &lt;-string_chan:</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="built_in">panic</span>(value)</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒç‚¹ï¼š<strong>selectéšæœºæ€§</strong><br>è§£ç­”ï¼š selectä¼šéšæœºé€‰æ‹©ä¸€ä¸ªå¯ç”¨é€šç”¨åšæ”¶å‘æ“ä½œã€‚æ‰€ä»¥ä»£ç æ˜¯æœ‰è‚¯è§¦å‘å¼‚å¸¸ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ä¼šã€‚å•ä¸ªchanå¦‚æœæ— ç¼“å†²æ—¶ï¼Œå°†ä¼šé˜»å¡ã€‚ä½†ç»“åˆ selectå¯ä»¥åœ¨å¤šä¸ªchané—´ç­‰å¾…æ‰§è¡Œã€‚æœ‰ä¸‰ç‚¹åŸåˆ™ï¼šÂ </p><ul><li>select ä¸­åªè¦æœ‰ä¸€ä¸ªcaseèƒ½returnï¼Œåˆ™ç«‹åˆ»æ‰§è¡Œã€‚ </li><li>å½“å¦‚æœåŒä¸€æ—¶é—´æœ‰å¤šä¸ªcaseå‡èƒ½returnåˆ™ä¼ªéšæœºæ–¹å¼æŠ½å–ä»»æ„ä¸€ä¸ªæ‰§è¡Œã€‚</li><li>å¦‚æœæ²¡æœ‰ä¸€ä¸ªcaseèƒ½returnåˆ™å¯ä»¥æ‰§è¡Œâ€defaultâ€å—ã€‚<h5 id="5"><a href="#5" class="headerlink" title="(5)"></a>(5)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    s := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">5</span>)  </span><br><span class="line">    s = <span class="built_in">append</span>(s, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  </span><br><span class="line">    fmt.Println(s) <span class="comment">// [0,0,0,0,0,1,2,3] </span></span><br><span class="line">  </span><br><span class="line">    s2 := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>)  </span><br><span class="line">    s2 = <span class="built_in">append</span>(s2, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  </span><br><span class="line">    fmt.Println(s2)  <span class="comment">// [1,2,3]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>æ³¨æ„ make ä¼šç»™å®šä¹‰çš„é•¿åº¦åˆ†é…åˆå€¼<h5 id="6"><a href="#6" class="headerlink" title="(6)"></a>(6)</h5>mapçº¿ç¨‹å®‰å…¨</li></ul><h4 id="16-å¦‚ä½•ç†è§£goè¯­è¨€ä¸­çš„interface"><a href="#16-å¦‚ä½•ç†è§£goè¯­è¨€ä¸­çš„interface" class="headerlink" title="16. å¦‚ä½•ç†è§£goè¯­è¨€ä¸­çš„interface?"></a>16. å¦‚ä½•ç†è§£goè¯­è¨€ä¸­çš„interface?</h4><ol><li>interfaceæ˜¯æ–¹æ³•ç”³æ˜çš„é›†åˆ</li><li>ä»»ä½•ç±»å‹çš„å¯¹è±¡å®ç°äº†åœ¨interfaceæ¥å£ä¸­å£°æ˜çš„å…¨éƒ¨æ–¹æ³•ï¼Œåˆ™è¡¨æ˜è¯¥ç±»å‹å®ç°äº†è¯¥æ¥å£</li><li>interfaceå¯ä»¥ä½œä¸ºä¸€ç§æ•°æ®ç±»å‹ï¼Œå®ç°äº†è¯¥æ¥å£çš„ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ç»™å¯¹åº”çš„æ¥å£ç±»å‹å˜é‡èµ‹å€¼<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ•°æ®å†™å…¥å™¨</span></span><br><span class="line"><span class="keyword">type</span> DataWriter <span class="keyword">interface</span> &#123;</span><br><span class="line">WriteData(data <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰æ–‡ä»¶ç»“æ„ï¼Œç”¨äºå®ç°DataWriter</span></span><br><span class="line"><span class="keyword">type</span> file <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®ç°DataWriteræ¥å£çš„WriteDataæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *file)</span></span> WriteData(data <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span> &#123;</span><br><span class="line"><span class="comment">// æ¨¡æ‹Ÿå†™å…¥æ•°æ®</span></span><br><span class="line">fmt.Println(<span class="string">&quot;WriteData:&quot;</span>, data)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å£å¯ä»¥ä½œä¸ºæ•°æ®ç±»å‹ä¼ é€’ï¼Œä½“ç°2ï¼Œ3</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Cprint</span><span class="params">(writer DataWriter)</span></span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Cprint&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–file</span></span><br><span class="line">f := <span class="built_in">new</span>(file)</span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªDataWriterçš„æ¥å£</span></span><br><span class="line"><span class="keyword">var</span> writer DataWriter</span><br><span class="line"><span class="comment">// å°†æ¥å£èµ‹å€¼fï¼Œä¹Ÿå°±æ˜¯*fileç±»å‹</span></span><br><span class="line">writer = f</span><br><span class="line"><span class="comment">// ä½¿ç”¨DataWriteræ¥å£è¿›è¡Œæ•°æ®å†™å…¥</span></span><br><span class="line">err := writer.WriteData(<span class="string">&quot;data&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;writeData err!&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">Cprint(f)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="17-Go-è¯­è¨€æ˜¯å¦‚ä½•å®ç°åˆ‡ç‰‡æ‰©å®¹çš„ï¼Ÿ"><a href="#17-Go-è¯­è¨€æ˜¯å¦‚ä½•å®ç°åˆ‡ç‰‡æ‰©å®¹çš„ï¼Ÿ" class="headerlink" title="17. Go è¯­è¨€æ˜¯å¦‚ä½•å®ç°åˆ‡ç‰‡æ‰©å®¹çš„ï¼Ÿ"></a>17. Go è¯­è¨€æ˜¯å¦‚ä½•å®ç°åˆ‡ç‰‡æ‰©å®¹çš„ï¼Ÿ</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  arr := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>) </span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++ &#123; </span><br><span class="line">    fmt.Println(<span class="string">&quot;lenä¸º&quot;</span>, <span class="built_in">len</span>(arr), <span class="string">&quot;capä¸º&quot;</span>, <span class="built_in">cap</span>(arr)) </span><br><span class="line">    arr = <span class="built_in">append</span>(arr, i) </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ç»“æœ<br>ä¾æ¬¡æ˜¯ 0,1,2,4,8,16,32,64,128,256,512,1024<br>ä½†åˆ°äº†1024ä¹‹å,å°±å˜æˆäº† 1024,1280,1696,2304<br>æ¯æ¬¡éƒ½æ˜¯æ‰©å®¹äº†å››åˆ†ä¹‹ä¸€å·¦å³</p><h4 id="18-æ•°ç»„å’Œåˆ‡ç‰‡"><a href="#18-æ•°ç»„å’Œåˆ‡ç‰‡" class="headerlink" title="18. æ•°ç»„å’Œåˆ‡ç‰‡"></a>18. æ•°ç»„å’Œåˆ‡ç‰‡</h4><p>golang ä¸­å­˜åœ¨ä¸¤ç§å‡½æ•°ä¼ å…¥æ–¹å¼ï¼šå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹<br>å€¼ç±»å‹åªæ”¹å˜å½“å‰ä½œç”¨åŸŸçš„å€¼ï¼Œåœ¨è¯¥ä½œç”¨åŸŸå¤–éƒ¨ä¸ä¼šç”Ÿæ•ˆï¼›å¼•ç”¨ç±»å‹æ”¹å˜å½“å‰åœ°å€å¯¹åº”çš„å€¼ï¼Œåœ¨ä½œç”¨åŸŸå¤–éƒ¨ç”Ÿæ•ˆã€‚å¯ä»¥å‚è€ƒä¸‹è¾¹çš„ä¾‹å­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•°ç»„ å€¼ç±»å‹</span></span><br><span class="line"><span class="comment">// åˆ‡ç‰‡ å¼•ç”¨ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeArray</span><span class="params">(x [3]<span class="type">int</span>)</span></span> &#123;x[<span class="number">0</span>] = <span class="number">123</span>&#125; <span class="comment">// å®šä¹‰ä¸ºæ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeSlice</span><span class="params">(x []<span class="type">int</span>)</span></span> &#123;x[<span class="number">0</span>] = <span class="number">123</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  x1 := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line">  fmt.Println(<span class="string">&quot;x1 original-&gt;&quot;</span>, x1)</span><br><span class="line">  changeArray(x)</span><br><span class="line">  fmt.Println(<span class="string">&quot;x1 current-&gt;&quot;</span>. x1)</span><br><span class="line"></span><br><span class="line">  x := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line">  fmt.Println(<span class="string">&quot;x2 -&gt;&quot;</span>, x)</span><br><span class="line">  changeSlice(x)</span><br><span class="line">  fmt.Println(<span class="string">&quot;x2 -&gt;&quot;</span>. x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// x1 -&gt; [1,2,3]</span></span><br><span class="line"><span class="comment">// x2 -&gt; [1,2,3]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="19"><a href="#19" class="headerlink" title="19."></a>19.</h4>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå»ºç«™ï¼ˆä¸‰ï¼‰GitHub</title>
      <link href="/blog/build-blog/hexo101-3/"/>
      <url>/blog/build-blog/hexo101-3/</url>
      
        <content type="html"><![CDATA[<p>æ¬¢è¿æ¥åˆ°å»ºç«™è®°å½•çš„ç¬¬äºŒéƒ¨åˆ†ï¼šéƒ¨ç½²åˆ° github page</p><h2 id="GitHubé¡µé¢"><a href="#GitHubé¡µé¢" class="headerlink" title="GitHubé¡µé¢"></a>GitHubé¡µé¢</h2><p>è¿™é‡Œå‡è®¾å·²ç»æ³¨å†Œè¿‡äº†Githubå¸æˆ·ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å»<a href="https://github.com/">Github</a>æ³¨å†Œã€‚</p><p>æ³¨å†Œå¥½äº†åï¼Œç™»å½•Github,åˆ›å»ºä»“åº“ï¼šç‚¹å‡»å³ä¸Šè§’çš„+å·ï¼Œé€‰æ‹©new repository:<br><img src="https://t2.picb.cc/2022/02/21/fpUdSF.jpg" alt="git"></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå»ºç«™ï¼ˆäºŒï¼‰butterfly</title>
      <link href="/blog/build-blog/hexo101-2/"/>
      <url>/blog/build-blog/hexo101-2/</url>
      
        <content type="html"><![CDATA[<p>æ¬¢è¿æ¥åˆ°å»ºç«™è®°å½•çš„ç¬¬äºŒéƒ¨åˆ†ï¼šbutterfly ä¸»é¢˜çš„å®‰è£…ä¸åˆå§‹åŒ–</p><h2 id="ä¸»é¢˜å®‰è£…ä¸ä½¿ç”¨"><a href="#ä¸»é¢˜å®‰è£…ä¸ä½¿ç”¨" class="headerlink" title="ä¸»é¢˜å®‰è£…ä¸ä½¿ç”¨"></a>ä¸»é¢˜å®‰è£…ä¸ä½¿ç”¨</h2><p>ä¸‹è½½ä¸»é¢˜</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">git <span class="built_in">clone</span> -b master https://gitee.com/immyw/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ _config.yml ,æŠŠä¸»é¢˜ä¿®æ”¹ä¸º Butterfly</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">Butterfly</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†åç»­æ–¹ä¾¿é…ç½®ï¼Œéœ€è¦åœ¨å½“å‰ç›®å½• blog&#x2F; åˆ›å»º _config.butterfly.yml æ–‡ä»¶ï¼Œå¹¶å°†æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶å†…å®¹å¤åˆ¶è¿›å»ã€‚æ›´å¤šçš„ä¸»é¢˜é…ç½®ä¿¡æ¯å¯ä»¥ç­‰å¾…ä¹‹åçš„æ–‡ç« ~</p><p>å°è¯•æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤,ä»¥æŸ¥çœ‹åº”ç”¨ä¸»é¢˜åçš„æ•ˆæœ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean <span class="comment">#æ¸…é™¤æ—§çš„å†…å®¹</span></span><br><span class="line">hexo g <span class="comment">#ç”Ÿæˆå‘å¸ƒç”¨çš„é™æ€é¡µé¢</span></span><br></pre></td></tr></table></figure><p>æœ¬åœ°æŸ¥çœ‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s <span class="comment"># hexo server</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œè¯¥å‘½ä»¤å¯ä»¥å» <a href="localhost:4000">localhost:4000</a> æŸ¥çœ‹æ•ˆæœ</p><h5 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h5><h4 id="case1-ï¼š"><a href="#case1-ï¼š" class="headerlink" title="case1 ï¼š"></a>case1 ï¼š</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ERROR TypeError: /data/blog/themes/butterfly/layout/includes/head.pug:40  </span><br><span class="line">38|  </span><br><span class="line">39| !=favicon_tag(theme.favicon || config.favicon)</span><br><span class="line"></span><br><span class="line">&gt; 40| <span class="built_in">link</span>(rel=<span class="string">&quot;canonical&quot;</span> href=urlNoIndex())  </span><br><span class="line">&gt; 41|  </span><br><span class="line">&gt; 42| //- é è§£æ  </span><br><span class="line">&gt; 43| !=partial(<span class="string">&#x27;includes/head/preconnect&#x27;</span>, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line"></span><br><span class="line">prettyUrls is not a <span class="keyword">function</span>  </span><br><span class="line">at Object. (/data/blog/themes/butterfly/scripts/helpers/page.js:58:10)  </span><br><span class="line">at <span class="built_in">eval</span> (<span class="built_in">eval</span> at wrap (/data/blog/node_modules/pug-runtime/wrap.js:6:10), :89:77)  </span><br><span class="line">at template (<span class="built_in">eval</span> at wrap (/data/blog/node_modules/pug-runtime/wrap.js:6:10), :4603:215)  </span><br><span class="line">at _View._compiled (/data/blog/node_modules/hexo/lib/theme/view.js:136:50)  </span><br><span class="line">at _View.render (/data/blog/node_modules/hexo/lib/theme/view.js:39:17)  </span><br><span class="line">at /data/blog/node_modules/hexo/lib/hexo/index.js:64:21  </span><br><span class="line">at tryCatcher (/data/blog/node_modules/bluebird/js/release/util.js:16:23)  </span><br><span class="line">at /data/blog/node_modules/bluebird/js/release/method.js:15:34  </span><br><span class="line">at RouteStream._read (/data/blog/node_modules/hexo/lib/hexo/router.js:47:5)  </span><br><span class="line">at RouteStream.Readable.read (_stream_readable.js:479:10)  </span><br><span class="line">at resume_ (_stream_readable.js:966:12)  </span><br><span class="line">at processTicksAndRejections (internal/process/task_queues.js:80:21) &#123;  </span><br><span class="line">path: <span class="string">&#x27;/data/blog/themes/butterfly/layout/includes/head.pug&#x27;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ</p><ol><li>ä¼˜å…ˆç¡®è®¤ themes&#x2F;butterfly ä¸­æœ‰ç›¸å…³çš„æ–‡ä»¶å†…å®¹</li><li>å°è¯•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm cache clean --force</span><br><span class="line"><span class="built_in">rm</span> -rf node_modules</span><br><span class="line"><span class="built_in">rm</span> -rf package-lock.json</span><br><span class="line">npm install</span><br><span class="line">hexo clean</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure></li></ol><h4 id="case2ï¼š"><a href="#case2ï¼š" class="headerlink" title="case2ï¼š"></a>case2ï¼š</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TypeError: /Users/blog/themes/butterfly/layout/includes/widget/index.pug:33</span><br><span class="line">    31|       !=partial(<span class="string">&#x27;includes/widget/card_tags&#x27;</span>, &#123;&#125;, &#123;cache: <span class="literal">true</span>&#125;)</span><br><span class="line">    32|       !=partial(<span class="string">&#x27;includes/widget/card_archives&#x27;</span>, &#123;&#125;, &#123;cache: <span class="literal">true</span>&#125;)</span><br><span class="line">  &gt; 33|       !=partial(<span class="string">&#x27;includes/widget/card_webinfo&#x27;</span>, &#123;&#125;, &#123;cache: <span class="literal">true</span>&#125;)</span><br><span class="line">    34|       !=partial(<span class="string">&#x27;includes/widget/card_bottom_self&#x27;</span>, &#123;&#125;, &#123;cache: <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line">/Users/blog/themes/butterfly/layout/includes/widget/card_webinfo.pug:18</span><br><span class="line">    16|         .webinfo-item</span><br><span class="line">    17|           .item-name=_p(<span class="string">&#x27;aside.card_webinfo.site_wordcount&#x27;</span>) + <span class="string">&quot; :&quot;</span></span><br><span class="line">  &gt; 18|           .item-count=totalcount(site)</span><br><span class="line">    19|       <span class="keyword">if</span> theme.busuanzi.site_uv</span><br><span class="line">    20|         .webinfo-item</span><br><span class="line">    21|           .item-name= _p(<span class="string">&#x27;aside.card_webinfo.site_uv_name&#x27;</span>) + <span class="string">&quot; :&quot;</span></span><br><span class="line"></span><br><span class="line">totalcount is not a <span class="keyword">function</span></span><br></pre></td></tr></table></figure><p>è¯·æ£€æŸ¥æ˜¯å¦å®‰è£äº†wordcountæ’ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save hexo-wordcount</span><br></pre></td></tr></table></figure><h4 id="case3ï¼š"><a href="#case3ï¼š" class="headerlink" title="case3ï¼š"></a>case3ï¼š</h4><p>å¦‚æœä½ æ²’æœ‰ pug ä»¥åŠ stylus çš„æ¸²æŸ“å™¨ä¼šæŠ¥é”™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug block content include ./includes/mixins/post-ui</span><br><span class="line">.pug <span class="comment">#recent-posts.recent-posts +postUI include includes/pagination.pug</span></span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><h4 id="case4ï¼š"><a href="#case4ï¼š" class="headerlink" title="case4ï¼š"></a>case4ï¼š</h4><p>hexoæœ¬åœ°æµ‹è¯•è¿è¡Œé‡å¯åé¡µé¢ç©ºç™½ï¼Œä¸”æç¤º : </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARN No layout: index.html</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‚è€ƒ case1 &amp; case2 ï¼Œå³ hexo generate æ²¡æœ‰æˆåŠŸ</p><h4 id="case5ï¼š"><a href="#case5ï¼š" class="headerlink" title="case5ï¼š"></a>case5ï¼š</h4><p>å°è¯• hexo deploy å‘å¸ƒçš„æ—¶å€™å¤±è´¥ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼Œæ²¡æœ‰ååº”</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">INFO  Validating config</span><br><span class="line">INFO</span><br><span class="line">  ===================================================================</span><br><span class="line"></span><br><span class="line">      <span class="comment">#####  #    # ##### ##### ###### #####  ###### #      #   #</span></span><br><span class="line">      <span class="comment">#    # #    #   #     #   #      #    # #      #       # #</span></span><br><span class="line">      <span class="comment">#####  #    #   #     #   #####  #    # #####  #        #</span></span><br><span class="line">      <span class="comment">#    # #    #   #     #   #      #####  #      #        #</span></span><br><span class="line">      <span class="comment">#    # #    #   #     #   #      #   #  #      #        #</span></span><br><span class="line">      <span class="comment">#####   ####    #     #   ###### #    # #      ######   #</span></span><br><span class="line"></span><br><span class="line">                            4.1.0</span><br><span class="line">  ===================================================================</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼šdeploy å‚æ•°éœ€è¦é…ç½®åˆ° _config.yml æ–‡ä»¶ä¸­ã€‚<br><strong>æ³¨æ„ï¼šå†’å·åé¢éœ€è¦ä¸€ä¸ªç©ºæ ¼</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">repo:</span> <span class="string">git@github.com:yourname/yourname.github.io.git</span></span><br><span class="line"><span class="comment"># æ¨èä½¿ç”¨Gité“¾æ¥ï¼Œä½¿ç”¨httpæ¨¡å¼è¿˜ä¼šå­˜åœ¨éœ€è¦å¡«å†™ ç”¨æˆ·åå’Œé‚®ç®±çš„æƒ…å†µ</span></span><br><span class="line"><span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure><p>æ›´å¤šé—®é¢˜è¯·å‚è€ƒ <a href="https://butterfly.js.org/posts/98d20436/">butterfly</a> å®˜æ–¹æ–‡æ¡£ä¸­çš„è§£ç­”</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå»ºç«™ï¼ˆä¸€ï¼‰hexo</title>
      <link href="/blog/build-blog/hexo101-1/"/>
      <url>/blog/build-blog/hexo101-1/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>ç»ˆäºä¿ºä¹Ÿæœ‰è‡ªå·±çš„ blog äº†ï¼Œä¸‹é¢å°±æ•´ä¸ª hexo å»ºç«™å’Œä¸»é¢˜ butterfly çš„é…ç½®åˆ†å‡ ä¸ªéƒ¨åˆ†ç»™å¤§å®¶åšä¸ªå°å°çš„æ€»ç»“</p><p>æ¬¢è¿æ¥åˆ°å»ºç«™è®°å½•çš„ç¬¬ä¸€éƒ¨åˆ†ï¼šhexo çš„å®‰è£…</p><h2 id="Hexo-å®‰è£…"><a href="#Hexo-å®‰è£…" class="headerlink" title="Hexo å®‰è£…"></a>Hexo å®‰è£…</h2><p>å®˜ç½‘åœ°å€ï¼š<a href="https://hexo.io/zh-cn/">https://hexo.io/zh-cn/</a></p><h4 id="åŸºç¡€ç¯å¢ƒ"><a href="#åŸºç¡€ç¯å¢ƒ" class="headerlink" title="åŸºç¡€ç¯å¢ƒ"></a>åŸºç¡€ç¯å¢ƒ</h4><p>1.node<br>    é¦–å…ˆå» <a href="http://nodejs.cn/download/">node.js</a> çš„å®˜ç½‘ä¸‹è½½æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ mac ç‰ˆæœ¬çš„<br>2.npm<br>    åŒ…ç®¡ç†å·¥å…·</p><h4 id="å®‰è£…-hexo"><a href="#å®‰è£…-hexo" class="headerlink" title="å®‰è£… hexo"></a>å®‰è£… hexo</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install hexo</span><br></pre></td></tr></table></figure><p>è®°å¾—è¿™é‡Œéœ€è¦ä½¿ç”¨ç®¡ç†å‘˜æƒé™å®‰è£…</p><p>åˆå§‹åŒ– hexo è‡³æŸä¸ªæ–‡ä»¶å¤¹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯è‡ªå·±å°†æ¥ç®¡ç†æ–‡ç« çš„åœ°æ–¹</p><p>å·¥ç¨‹é…ç½®</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>è¿›å…¥åˆšæ‰åˆå§‹åŒ–çš„ blog æ–‡ä»¶å¤¹</p><p>æµè§ˆå™¨è°ƒè¯•</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generage</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å¦‚ä¸‹ç®€å†™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>å¿…å¤‡æ’ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save <span class="comment"># hexo æ¸²æŸ“å¿…å¤‡</span></span><br><span class="line">npm install hexo-server --save <span class="comment"># hexo æœ¬åœ°å¯åŠ¨</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install --save hexo-wordcount <span class="comment"># wordcount æ’ä»¶</span></span><br><span class="line">npm install hexo-butterfly-artitalk --save <span class="comment"># artitalk æ’ä»¶</span></span><br><span class="line">npm install hexo-generator-feed --save <span class="comment"># RSS æ’ä»¶</span></span><br><span class="line">npm install hexo-auto-category --save <span class="comment"># è‡ªåŠ¨æ ¹æ®ç›®å½•ç”Ÿæˆcategories</span></span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨ç”Ÿæˆ categories è¯¦æƒ…å’Œé…ç½®æ–¹æ³•å…·ä½“å¯ä»¥å‚è€ƒ <a href="https://github.com/xu-song/hexo-auto-category">auto-category</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/uncategorized/hello-world/"/>
      <url>/uncategorized/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
